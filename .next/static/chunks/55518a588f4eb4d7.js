(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64541,e=>{"use strict";var a=e.i(18050),s=e.i(22016),t=e.i(18566),i=e.i(71645),l=e.i(91918),r=e.i(25913),d=e.i(75254);let n=(0,d.default)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);var c=e.i(22625),o=e.i(48020),x=e.i(7398),h=e.i(29085),m=e.i(52540),u=e.i(9560),j=e.i(50121),p=e.i(80580);let g=i.createContext(null);function b(){let e=i.useContext(g);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}function v({defaultOpen:e=!0,open:s,onOpenChange:t,className:l,style:r,children:d,...n}){let x=(0,c.useIsMobile)(),[h,m]=i.useState(!1),[u,j]=i.useState(e),b=s??u,v=i.useCallback(e=>{let a="function"==typeof e?e(b):e;t?t(a):j(a),document.cookie=`sidebar_state=${a}; path=/; max-age=604800`},[t,b]),y=i.useCallback(()=>x?m(e=>!e):v(e=>!e),[x,v,m]);i.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),y())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[y]);let C=b?"expanded":"collapsed",T=i.useMemo(()=>({state:C,open:b,setOpen:v,isMobile:x,openMobile:h,setOpenMobile:m,toggleSidebar:y}),[C,b,v,x,h,m,y]);return(0,a.jsx)(g.Provider,{value:T,children:(0,a.jsx)(p.TooltipProvider,{delayDuration:0,children:(0,a.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...r},className:(0,o.cn)("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",l),...n,children:d})})})}function y({side:e="left",variant:s="sidebar",collapsible:t="offcanvas",className:i,children:l,...r}){let{isMobile:d,state:n,openMobile:c,setOpenMobile:x}=b();return"none"===t?(0,a.jsx)("div",{"data-slot":"sidebar",className:(0,o.cn)("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",i),...r,children:l}):d?(0,a.jsx)(u.Sheet,{open:c,onOpenChange:x,...r,children:(0,a.jsxs)(u.SheetContent,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:e,children:[(0,a.jsxs)(u.SheetHeader,{className:"sr-only",children:[(0,a.jsx)(u.SheetTitle,{children:"Sidebar"}),(0,a.jsx)(u.SheetDescription,{children:"Displays the mobile sidebar."})]}),(0,a.jsx)("div",{className:"flex h-full w-full flex-col",children:l})]})}):(0,a.jsxs)("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":n,"data-collapsible":"collapsed"===n?t:"","data-variant":s,"data-side":e,"data-slot":"sidebar",children:[(0,a.jsx)("div",{"data-slot":"sidebar-gap",className:(0,o.cn)("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===s||"inset"===s?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),(0,a.jsx)("div",{"data-slot":"sidebar-container",className:(0,o.cn)("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex","left"===e?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===s||"inset"===s?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",i),...r,children:(0,a.jsx)("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:l})})]})}function C({className:e,onClick:s,...t}){let{toggleSidebar:i}=b();return(0,a.jsxs)(x.Button,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:(0,o.cn)("h-7 w-7",e),onClick:e=>{s?.(e),i()},...t,children:[(0,a.jsx)(n,{}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function T({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:(0,o.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...s})}function f({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:(0,o.cn)("relative flex w-full min-w-0 flex-col p-2",e),...s})}function N({className:e,asChild:s=!1,...t}){let i=s?l.Slot:"div";return(0,a.jsx)(i,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:(0,o.cn)("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...t})}function w({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:(0,o.cn)("w-full text-sm",e),...s})}function S({className:e,...s}){return(0,a.jsx)("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:(0,o.cn)("flex w-full min-w-0 flex-col gap-1",e),...s})}function k({className:e,...s}){return(0,a.jsx)("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:(0,o.cn)("group/menu-item relative",e),...s})}let A=(0,r.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function H({asChild:e=!1,isActive:s=!1,variant:t="default",size:i="default",tooltip:r,className:d,...n}){let c=e?l.Slot:"button",{isMobile:x,state:h}=b(),m=(0,a.jsx)(c,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":i,"data-active":s,className:(0,o.cn)(A({variant:t,size:i}),d),...n});return r?("string"==typeof r&&(r={children:r}),(0,a.jsxs)(p.Tooltip,{children:[(0,a.jsx)(p.TooltipTrigger,{asChild:!0,children:m}),(0,a.jsx)(p.TooltipContent,{side:"right",align:"center",hidden:"collapsed"!==h||x,...r})]})):m}var D=e.i(17923),R=e.i(61911),F=e.i(78583),q=e.i(23945);let B=(0,d.default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var I=e.i(12426),L=e.i(25652),P=e.i(39616),K=e.i(98919),M=e.i(63488),$=e.i(18348);let E=(0,d.default)("FileChartColumn",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-1",key:"zg0ygc"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"M16 18v-3",key:"j5jt4h"}]]),Q=(0,d.default)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var V=e.i(64030),U=e.i(55436),O=e.i(39312),z=e.i(26707),W=e.i(21218),G=e.i(27025);let _=(0,d.default)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);var X=e.i(2330),Y=e.i(66027),J=e.i(35321),Z=e.i(35251),ee=e.i(63209),ea=e.i(9637),es=e.i(29228),et=e.i(55706),ei=e.i(9694),el=e.i(80942),er=e.i(85183),ed=e.i(93230),en=e.i(72526),ec=e.i(34239),eo=e.i(44098),ex=e.i(30656);function eh(){let{data:e,isLoading:s}=(0,Y.useQuery)({queryKey:["/api/admin/overview/stats"]}),t=e||{users:{total:0,new24h:0},content:{total:0,new24h:0},revenue:{total:0,today:0},moderation:{pending:0,reports:0}},{data:i,isLoading:l}=(0,Y.useQuery)({queryKey:["/api/admin/overview/activity-feed"]}),r=Array.isArray(i)?i:[],{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/overview/user-growth"]}),c=Array.isArray(d)?d:[],{data:o,isLoading:x}=(0,Y.useQuery)({queryKey:["/api/admin/overview/content-trend"]}),h=Array.isArray(o)?o:[];return s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(j.Skeleton,{className:"h-10 w-64"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s))})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Overview Dashboard"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-total-users",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Users"}),(0,a.jsx)(R.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-users",children:t.users.total}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",t.users.new24h," in last 24h"]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-total-content",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Content"}),(0,a.jsx)(F.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-content",children:t.content.total}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",t.content.new24h," in last 24h"]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-total-revenue",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(I.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-total-revenue",children:["$",t.revenue.total]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+$",t.revenue.today," today"]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-pending-moderation",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Pending Moderation"}),(0,a.jsx)(ee.AlertCircle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-pending-moderation",children:t.moderation.pending}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.moderation.reports," reports"]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-user-growth-chart",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"User Growth (Last 7 Days)"})}),(0,a.jsx)(J.CardContent,{children:n?(0,a.jsx)(j.Skeleton,{className:"h-64"}):c.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:c,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"users",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-content-trend-chart",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Content Trend (Last 7 Days)"})}),(0,a.jsx)(J.CardContent,{children:x?(0,a.jsx)(j.Skeleton,{className:"h-64"}):h.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:h,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-activity-feed",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Recent Admin Activity"})}),(0,a.jsx)(J.CardContent,{children:l?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):r.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Admin"}),(0,a.jsx)(Z.TableHead,{children:"Action"}),(0,a.jsx)(Z.TableHead,{children:"Target"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Time"})]})}),(0,a.jsx)(Z.TableBody,{children:r.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`activity-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`activity-admin-${e.id}`,children:e.adminUsername||"System"}),(0,a.jsx)(Z.TableCell,{"data-testid":`activity-action-${e.id}`,children:e.actionType}),(0,a.jsx)(Z.TableCell,{"data-testid":`activity-target-${e.id}`,children:e.targetType}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"success"===e.status?"default":"destructive",children:e.status})}),(0,a.jsx)(Z.TableCell,{"data-testid":`activity-time-${e.id}`,children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})})]},e.id))})]})}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No recent activity"})})]})]})}var em=e.i(54616),eu=e.i(85024),ej=e.i(79196),ep=e.i(15683),eg=e.i(23622);let eb=(0,d.default)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var ev=e.i(75822),ey=e.i(1831);function eC(){let[e,s]=(0,i.useState)(""),[t,l]=(0,i.useState)("all"),[r,d]=(0,i.useState)("all"),[n,c]=(0,i.useState)(null),{toast:o}=(0,ep.useToast)(),{data:m,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/users",{search:e,role:t,status:r}]}),p=Array.isArray(m)?m:[],g=(0,em.useMutation)({mutationFn:async({userId:e,reason:a})=>(0,ey.apiRequest)("POST",`/api/admin/users/${e}/ban`,{reason:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),o({title:"User banned successfully"})},onError:()=>{o({title:"Failed to ban user",variant:"destructive"})}}),b=(0,em.useMutation)({mutationFn:async({userId:e,amount:a,reason:s})=>(0,ey.apiRequest)("POST",`/api/admin/users/${e}/adjust-coins`,{amount:a,reason:s}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),o({title:"Coins adjusted successfully"})},onError:()=>{o({title:"Failed to adjust coins",variant:"destructive"})}});return u?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(j.Skeleton,{className:"h-10 w-64"}),(0,a.jsx)(j.Skeleton,{className:"h-96"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Search & Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(U.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(h.Input,{placeholder:"Search by username or email...",value:e,onChange:e=>s(e.target.value),className:"pl-9","data-testid":"input-user-search"})]}),(0,a.jsxs)(eu.Select,{value:t,onValueChange:l,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-role-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Filter by role"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Roles"}),(0,a.jsx)(eu.SelectItem,{value:"user",children:"User"}),(0,a.jsx)(eu.SelectItem,{value:"moderator",children:"Moderator"}),(0,a.jsx)(eu.SelectItem,{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)(eu.Select,{value:r,onValueChange:d,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-status-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Filter by status"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(eu.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(eu.SelectItem,{value:"suspended",children:"Suspended"}),(0,a.jsx)(eu.SelectItem,{value:"banned",children:"Banned"})]})]})]})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Users (",p.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Email"}),(0,a.jsx)(Z.TableHead,{children:"Role"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Coins"}),(0,a.jsx)(Z.TableHead,{children:"Joined"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:p.length>0?p.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`user-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`user-name-${e.id}`,children:e.username}),(0,a.jsx)(Z.TableCell,{children:e.email}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.role})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"active"===e.status?"default":"destructive",children:e.status})}),(0,a.jsx)(Z.TableCell,{"data-testid":`user-coins-${e.id}`,children:e.coinBalance}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>c(e),"data-testid":`button-view-user-${e.id}`,children:[(0,a.jsx)(eb,{className:"h-4 w-4 mr-1"}),"View"]}),(0,a.jsxs)(x.Button,{size:"sm",variant:"destructive",onClick:()=>g.mutate({userId:e.id,reason:"Manual ban"}),disabled:"banned"===e.status,"data-testid":`button-ban-user-${e.id}`,children:[(0,a.jsx)(eg.Ban,{className:"h-4 w-4 mr-1"}),"Ban"]})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})})})]})})})]}),(0,a.jsx)(ej.Dialog,{open:!!n,onOpenChange:()=>c(null),children:(0,a.jsxs)(ej.DialogContent,{"data-testid":"dialog-user-detail",children:[(0,a.jsxs)(ej.DialogHeader,{children:[(0,a.jsx)(ej.DialogTitle,{children:"User Details"}),(0,a.jsxs)(ej.DialogDescription,{children:["Detailed information and actions for ",n?.username]})]}),n&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Username"}),(0,a.jsx)("p",{className:"font-medium",children:n.username})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Email"}),(0,a.jsx)("p",{className:"font-medium",children:n.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Coin Balance"}),(0,a.jsx)("p",{className:"font-medium",children:n.coinBalance})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Reputation"}),(0,a.jsx)("p",{className:"font-medium",children:n.reputation})]})]}),(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:(0,a.jsxs)(x.Button,{onClick:()=>{b.mutate({userId:n.id,amount:100,reason:"Admin adjustment"}),c(null)},"data-testid":"button-add-coins",children:[(0,a.jsx)(ev.Coins,{className:"h-4 w-4 mr-1"}),"Add 100 Coins"]})})]})]})})]})}var eT=e.i(69638);let ef=(0,d.default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var eN=e.i(27612),ew=e.i(86536),eS=e.i(40176);function ek(){let[e,s]=(0,i.useState)("all"),[t,l]=(0,i.useState)("pending"),{toast:r}=(0,ep.useToast)(),{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/content/moderation-queue",{type:e,status:t}]}),c=Array.isArray(d)?d:[],{data:o,isLoading:h}=(0,Y.useQuery)({queryKey:["/api/admin/content/reported"]}),m=Array.isArray(o)?o:[],u=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/content/${e}/approve`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content"]}),r({title:"Content approved successfully"})},onError:()=>{r({title:"Failed to approve content",variant:"destructive"})}}),p=(0,em.useMutation)({mutationFn:async({contentId:e,reason:a})=>(0,ey.apiRequest)("POST",`/api/admin/content/${e}/reject`,{reason:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content"]}),r({title:"Content rejected successfully"})},onError:()=>{r({title:"Failed to reject content",variant:"destructive"})}}),g=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("DELETE",`/api/admin/content/${e}`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content"]}),r({title:"Content deleted successfully"})},onError:()=>{r({title:"Failed to delete content",variant:"destructive"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Content Moderation"})}),(0,a.jsxs)(eS.Tabs,{defaultValue:"queue",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"queue","data-testid":"tab-moderation-queue",children:"Moderation Queue"}),(0,a.jsx)(eS.TabsTrigger,{value:"reported","data-testid":"tab-reported-content",children:"Reported Content"})]}),(0,a.jsxs)(eS.TabsContent,{value:"queue",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)(eu.Select,{value:e,onValueChange:s,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-content-type",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Content type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Types"}),(0,a.jsx)(eu.SelectItem,{value:"thread",children:"Threads"}),(0,a.jsx)(eu.SelectItem,{value:"reply",children:"Replies"}),(0,a.jsx)(eu.SelectItem,{value:"ea",children:"EAs"}),(0,a.jsx)(eu.SelectItem,{value:"article",children:"Articles"})]})]}),(0,a.jsxs)(eu.Select,{value:t,onValueChange:l,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-content-status",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Status"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"pending",children:"Pending"}),(0,a.jsx)(eu.SelectItem,{value:"approved",children:"Approved"}),(0,a.jsx)(eu.SelectItem,{value:"rejected",children:"Rejected"})]})]})]})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Content Queue (",c?.length||0,")"]})}),(0,a.jsx)(J.CardContent,{children:n?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Title"}),(0,a.jsx)(Z.TableHead,{children:"Type"}),(0,a.jsx)(Z.TableHead,{children:"Author"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Submitted"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:c&&c.length>0?c.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`content-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`content-title-${e.id}`,children:e.title||"Untitled"}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.type})}),(0,a.jsx)(Z.TableCell,{children:e.authorUsername}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"approved"===e.status?"default":"rejected"===e.status?"destructive":"secondary",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>u.mutate(e.id),disabled:"approved"===e.status,"data-testid":`button-approve-${e.id}`,children:[(0,a.jsx)(eT.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,a.jsxs)(x.Button,{size:"sm",variant:"destructive",onClick:()=>p.mutate({contentId:e.id,reason:"Violates guidelines"}),disabled:"rejected"===e.status,"data-testid":`button-reject-${e.id}`,children:[(0,a.jsx)(ef,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No content in moderation queue"})})})]})})})]})]}),(0,a.jsx)(eS.TabsContent,{value:"reported",className:"space-y-4",children:(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Reported Content (",m?.length||0,")"]})}),(0,a.jsx)(J.CardContent,{children:h?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Content"}),(0,a.jsx)(Z.TableHead,{children:"Reason"}),(0,a.jsx)(Z.TableHead,{children:"Reporter"}),(0,a.jsx)(Z.TableHead,{children:"Reports"}),(0,a.jsx)(Z.TableHead,{children:"Reported"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:m&&m.length>0?m.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`report-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.contentTitle||"Content"}),(0,a.jsx)(Z.TableCell,{children:e.reason}),(0,a.jsx)(Z.TableCell,{children:e.reporterUsername}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{children:e.reportCount||1})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline","data-testid":`button-view-report-${e.id}`,children:[(0,a.jsx)(ew.Eye,{className:"h-4 w-4 mr-1"}),"View"]}),(0,a.jsxs)(x.Button,{size:"sm",variant:"destructive",onClick:()=>g.mutate(e.contentId),"data-testid":`button-delete-reported-${e.id}`,children:[(0,a.jsx)(eN.Trash2,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No reported content"})})})]})})})]})})]})]})}var eA=e.i(88844),eH=e.i(53145),eD=e.i(94814),eR=e.i(43004),eF=e.i(87945),eq=e.i(82403),eB=e.i(10320),eI=e.i(7233);let eL=eR.z.object({type:eR.z.enum(["ea","indicator","article","source_code"]),title:eR.z.string().min(10,"Title must be at least 10 characters").max(120),description:eR.z.string().min(300,"Description must be at least 300 characters"),category:eR.z.string().min(1,"Category is required"),priceCoins:eR.z.number().min(0).max(1e4),isFree:eR.z.boolean(),platform:eR.z.enum(["MT4","MT5","Both"]).optional(),version:eR.z.string().optional(),tags:eR.z.string().optional(),license:eR.z.string().optional(),minDeposit:eR.z.number().optional(),hedging:eR.z.boolean().optional(),changelog:eR.z.string().optional()});function eP({trigger:e}){let{toast:s}=(0,ep.useToast)(),[t,l]=(0,i.useState)(!1),[r,d]=(0,i.useState)([]),n=(0,eH.useForm)({resolver:(0,eD.zodResolver)(eL),defaultValues:{type:"ea",title:"",description:"",category:"",priceCoins:0,isFree:!0,platform:"MT4",version:"1.0",tags:"",license:"Standard",minDeposit:void 0,hedging:!1,changelog:""}}),c=(0,em.useMutation)({mutationFn:async e=>{let a=e.tags?e.tags.split(",").map(e=>e.trim()).filter(Boolean):[],s={...e,tags:a,status:"approved",files:[],images:[]};return(await (0,ey.apiRequest)("POST","/api/admin/content",s)).json()},onSuccess:()=>{s({title:"Content Created!",description:"The marketplace content has been successfully added."}),n.reset(),d([]),l(!1),ey.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/stats"]}),ey.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/items"]}),ey.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-selling"]}),ey.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/revenue-chart"]}),ey.queryClient.invalidateQueries({queryKey:["/api/content"]})},onError:e=>{s({variant:"destructive",title:"Failed to Create Content",description:e.message||"Could not create marketplace content. Please try again."})}}),o=["Expert Advisors","Indicators","Scripts","Templates","Trading Systems","Libraries","Utilities","Educational"],m=["Scalping","Day Trading","Swing Trading","Grid","Martingale","Breakout","Trend Following","Mean Reversion","News Trading","High Frequency","Performance Report"],u=n.watch("isFree");return(0,i.useEffect)(()=>{u&&n.setValue("priceCoins",0)},[u,n]),(0,a.jsxs)(ej.Dialog,{open:t,onOpenChange:l,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:e||(0,a.jsxs)(x.Button,{"data-testid":"button-add-content",children:[(0,a.jsx)(eI.Plus,{className:"h-4 w-4 mr-2"}),"Add Content"]})}),(0,a.jsxs)(ej.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(ej.DialogHeader,{children:[(0,a.jsx)(ej.DialogTitle,{children:"Add Marketplace Content"}),(0,a.jsx)(ej.DialogDescription,{children:"Create new marketplace content (EA, Indicator, Article, or Source Code). All fields marked with * are required."})]}),(0,a.jsx)(eq.Form,{...n,children:(0,a.jsxs)("form",{onSubmit:n.handleSubmit(e=>{c.mutate(e)}),className:"space-y-6",children:[(0,a.jsx)(eq.FormField,{control:n.control,name:"type",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Content Type *"}),(0,a.jsxs)(eu.Select,{onValueChange:e.onChange,value:e.value,children:[(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-content-type",children:(0,a.jsx)(eu.SelectValue,{})})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"ea",children:"Expert Advisor (EA)"}),(0,a.jsx)(eu.SelectItem,{value:"indicator",children:"Indicator"}),(0,a.jsx)(eu.SelectItem,{value:"article",children:"Article"}),(0,a.jsx)(eu.SelectItem,{value:"source_code",children:"Source Code"})]})]}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"title",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Title *"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(h.Input,{placeholder:"e.g., Gold Scalper Pro EA v2.5",...e,"data-testid":"input-content-title"})}),(0,a.jsxs)(eq.FormDescription,{children:[e.value.length,"/120 characters"]}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"description",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Description *"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eF.Textarea,{placeholder:"Detailed description of the content, features, benefits, and usage instructions...",className:"min-h-[150px]",...e,"data-testid":"textarea-content-description"})}),(0,a.jsxs)(eq.FormDescription,{children:[e.value.length," characters (minimum 300)"]}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"category",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Category *"}),(0,a.jsxs)(eu.Select,{onValueChange:e.onChange,value:e.value||void 0,children:[(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-category",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select a category..."})})}),(0,a.jsx)(eu.SelectContent,{children:o.map(e=>(0,a.jsx)(eu.SelectItem,{value:e,children:e},e))})]}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"platform",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Platform"}),(0,a.jsxs)(eu.Select,{onValueChange:e.onChange,value:e.value||void 0,children:[(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-platform",children:(0,a.jsx)(eu.SelectValue,{})})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"MT4",children:"MT4"}),(0,a.jsx)(eu.SelectItem,{value:"MT5",children:"MT5"}),(0,a.jsx)(eu.SelectItem,{value:"Both",children:"Both MT4 & MT5"})]})]}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(eq.FormField,{control:n.control,name:"isFree",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eB.Checkbox,{checked:e.value,onCheckedChange:e.onChange,"data-testid":"checkbox-is-free"})}),(0,a.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,a.jsx)(eq.FormLabel,{children:"Free Content"}),(0,a.jsx)(eq.FormDescription,{children:"Check if this content is free"})]})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"priceCoins",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Price (Coins) *"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(h.Input,{type:"number",min:0,max:1e4,disabled:u,...e,onChange:a=>e.onChange(parseInt(a.target.value)||0),"data-testid":"input-price-coins"})}),(0,a.jsx)(eq.FormDescription,{children:"0-10,000 coins"}),(0,a.jsx)(eq.FormMessage,{})]})})]}),(0,a.jsx)(eq.FormField,{control:n.control,name:"tags",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:m.map(e=>(0,a.jsx)(ex.Badge,{variant:r.includes(e)?"default":"outline",className:"cursor-pointer",onClick:()=>{let a;d(a=r.includes(e)?r.filter(a=>a!==e):[...r,e]),n.setValue("tags",a.join(", "))},"data-testid":`tag-${e.toLowerCase().replace(/\s+/g,"-")}`,children:e},e))}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(h.Input,{placeholder:"Or enter custom tags separated by commas...",...e,"data-testid":"input-tags"})}),(0,a.jsx)(eq.FormDescription,{children:"Click tags above or enter custom tags separated by commas (max 8)"}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(eq.FormField,{control:n.control,name:"version",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Version"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(h.Input,{placeholder:"e.g., 1.0, 2.5.1",...e,"data-testid":"input-version"})}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"license",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"License"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(h.Input,{placeholder:"e.g., Standard, Extended, GPL",...e,"data-testid":"input-license"})}),(0,a.jsx)(eq.FormMessage,{})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(eq.FormField,{control:n.control,name:"minDeposit",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Minimum Deposit"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(h.Input,{type:"number",placeholder:"e.g., 100",...e,onChange:a=>e.onChange(a.target.value?parseInt(a.target.value):void 0),value:e.value||"","data-testid":"input-min-deposit"})}),(0,a.jsx)(eq.FormDescription,{children:"Minimum account balance required"}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsx)(eq.FormField,{control:n.control,name:"hedging",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4 mt-2",children:[(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eB.Checkbox,{checked:e.value,onCheckedChange:e.onChange,"data-testid":"checkbox-hedging"})}),(0,a.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,a.jsx)(eq.FormLabel,{children:"Supports Hedging"}),(0,a.jsx)(eq.FormDescription,{children:"Check if this EA supports hedging"})]})]})})]}),(0,a.jsx)(eq.FormField,{control:n.control,name:"changelog",render:({field:e})=>(0,a.jsxs)(eq.FormItem,{children:[(0,a.jsx)(eq.FormLabel,{children:"Changelog"}),(0,a.jsx)(eq.FormControl,{children:(0,a.jsx)(eF.Textarea,{placeholder:"Version history and updates...",className:"min-h-[100px]",...e,"data-testid":"textarea-changelog"})}),(0,a.jsx)(eq.FormDescription,{children:"Document version changes and improvements"}),(0,a.jsx)(eq.FormMessage,{})]})}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(x.Button,{type:"submit",disabled:c.isPending,"data-testid":"button-submit-content",children:c.isPending?"Creating...":"Create Content"}),(0,a.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>{n.reset(),d([]),l(!1)},"data-testid":"button-cancel",children:"Cancel"})]})]})})]})]})}function eK(){let{toast:e}=(0,ep.useToast)(),{data:s,isLoading:t}=(0,Y.useQuery)({queryKey:["/api/admin/marketplace/stats"]}),i=s||{totalItems:0,pendingItems:0,totalSales:0,salesThisWeek:0,totalRevenue:0,revenueThisWeek:0},{data:l,isLoading:r}=(0,Y.useQuery)({queryKey:["/api/admin/marketplace/items"]}),d=Array.isArray(l)?l:[],{data:n,isLoading:c}=(0,Y.useQuery)({queryKey:["/api/admin/marketplace/top-selling"]}),o=Array.isArray(n)?n:[],{data:h,isLoading:m}=(0,Y.useQuery)({queryKey:["/api/admin/marketplace/revenue-chart"]}),u=Array.isArray(h)?h:[],p=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/marketplace/${e}/approve`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace"]}),e({title:"Item approved successfully"})},onError:()=>{e({title:"Failed to approve item",variant:"destructive"})}}),g=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/marketplace/${e}/reject`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace"]}),e({title:"Item rejected successfully"})},onError:()=>{e({title:"Failed to reject item",variant:"destructive"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Marketplace Management"}),(0,a.jsx)(eP,{})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-total-items",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Items"}),(0,a.jsx)(eA.Package,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:t?(0,a.jsx)(j.Skeleton,{className:"h-8 w-20"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-items",children:i.totalItems}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[i.pendingItems," pending approval"]})]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-total-sales",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Sales"}),(0,a.jsx)(L.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:t?(0,a.jsx)(j.Skeleton,{className:"h-8 w-20"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-sales",children:i.totalSales}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",i.salesThisWeek," this week"]})]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-total-revenue",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(I.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:t?(0,a.jsx)(j.Skeleton,{className:"h-8 w-20"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-marketplace-revenue",children:["$",i.totalRevenue]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+$",i.revenueThisWeek," this week"]})]})})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-revenue-chart",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Revenue Trend (Last 30 Days)"})}),(0,a.jsx)(J.CardContent,{children:m?(0,a.jsx)(j.Skeleton,{className:"h-64"}):u.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:u,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"revenue",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No revenue data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Top Selling Items"})}),(0,a.jsx)(J.CardContent,{children:c?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):o.length>0?(0,a.jsx)("div",{className:"space-y-3",children:o.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-lg font-bold text-muted-foreground",children:["#",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.sales," sales"]})]})]}),(0,a.jsxs)(ex.Badge,{children:[e.coinPrice," coins"]})]},e.id))}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No sales data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Marketplace Items (",d.length,")"]})}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Title"}),(0,a.jsx)(Z.TableHead,{children:"Seller"}),(0,a.jsx)(Z.TableHead,{children:"Price"}),(0,a.jsx)(Z.TableHead,{children:"Sales"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Listed"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:d.length>0?d.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`item-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`item-title-${e.id}`,children:e.title}),(0,a.jsx)(Z.TableCell,{children:e.sellerUsername}),(0,a.jsxs)(Z.TableCell,{children:[e.coinPrice," coins"]}),(0,a.jsx)(Z.TableCell,{children:e.sales}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"approved"===e.status?"default":"secondary",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>p.mutate(e.id),disabled:"approved"===e.status,"data-testid":`button-approve-item-${e.id}`,children:[(0,a.jsx)(eT.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,a.jsxs)(x.Button,{size:"sm",variant:"destructive",onClick:()=>g.mutate(e.id),disabled:"rejected"===e.status,"data-testid":`button-reject-item-${e.id}`,children:[(0,a.jsx)(ef,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No marketplace items found"})})})]})})})]})]})}function eM(){let[e,s]=(0,i.useState)(""),{toast:t}=(0,ep.useToast)(),{data:l,isLoading:r}=(0,Y.useQuery)({queryKey:["/api/admin/brokers",{search:e}]}),d=Array.isArray(l)?l:[],{data:n,isLoading:c}=(0,Y.useQuery)({queryKey:["/api/admin/brokers/scam-reports"]}),o=Array.isArray(n)?n:[],{data:m,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/brokers/reviews"]}),p=Array.isArray(m)?m:[],g=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/brokers/${e}/verify`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),t({title:"Broker verified successfully"})},onError:()=>{t({title:"Failed to verify broker",variant:"destructive"})}}),b=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/brokers/${e}/unverify`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),t({title:"Broker verification removed"})},onError:()=>{t({title:"Failed to unverify broker",variant:"destructive"})}}),v=(0,em.useMutation)({mutationFn:async({reportId:e,action:a})=>(0,ey.apiRequest)("POST",`/api/admin/brokers/scam-reports/${e}/resolve`,{action:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),t({title:"Scam report resolved"})},onError:()=>{t({title:"Failed to resolve report",variant:"destructive"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Broker Management"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"brokers",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"brokers","data-testid":"tab-brokers",children:"Brokers"}),(0,a.jsxs)(eS.TabsTrigger,{value:"scam-reports","data-testid":"tab-scam-reports",children:["Scam Reports (",o.length,")"]}),(0,a.jsx)(eS.TabsTrigger,{value:"reviews","data-testid":"tab-broker-reviews",children:"Reviews"})]}),(0,a.jsxs)(eS.TabsContent,{value:"brokers",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Search Brokers"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(U.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(h.Input,{placeholder:"Search by broker name...",value:e,onChange:e=>s(e.target.value),className:"pl-9","data-testid":"input-broker-search"})]})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Brokers (",d.length,")"]})}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Broker Name"}),(0,a.jsx)(Z.TableHead,{children:"Country"}),(0,a.jsx)(Z.TableHead,{children:"Regulation"}),(0,a.jsx)(Z.TableHead,{children:"Verified"}),(0,a.jsx)(Z.TableHead,{children:"Reviews"}),(0,a.jsx)(Z.TableHead,{children:"Rating"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:d.length>0?d.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`broker-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`broker-name-${e.id}`,children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.country||"N/A"}),(0,a.jsx)(Z.TableCell,{children:e.regulation?(0,a.jsx)(ex.Badge,{variant:"outline",children:e.regulation}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"N/A"})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:e.verified?"default":"secondary",children:e.verified?"Verified":"Unverified"})}),(0,a.jsx)(Z.TableCell,{children:e.reviewCount||0}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.rating?e.rating.toFixed(1):"N/A"})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.verified?(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>b.mutate(e.id),"data-testid":`button-unverify-broker-${e.id}`,children:[(0,a.jsx)(ef,{className:"h-4 w-4 mr-1"}),"Unverify"]}):(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>g.mutate(e.id),"data-testid":`button-verify-broker-${e.id}`,children:[(0,a.jsx)(eT.CheckCircle,{className:"h-4 w-4 mr-1"}),"Verify"]})})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No brokers found"})})})]})})})]})]}),(0,a.jsx)(eS.TabsContent,{value:"scam-reports",className:"space-y-4",children:(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Scam Reports (",o.length,")"]})}),(0,a.jsx)(J.CardContent,{children:c?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Broker"}),(0,a.jsx)(Z.TableHead,{children:"Reporter"}),(0,a.jsx)(Z.TableHead,{children:"Reason"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Reported"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:o.length>0?o.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`scam-report-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.brokerName}),(0,a.jsx)(Z.TableCell,{children:e.reporterUsername}),(0,a.jsx)(Z.TableCell,{children:e.reason}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"resolved"===e.status?"default":"destructive",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>v.mutate({reportId:e.id,action:"verified"}),disabled:"resolved"===e.status,"data-testid":`button-resolve-report-${e.id}`,children:[(0,a.jsx)(eT.CheckCircle,{className:"h-4 w-4 mr-1"}),"Resolve"]}),(0,a.jsxs)(x.Button,{size:"sm",variant:"outline","data-testid":`button-view-report-${e.id}`,children:[(0,a.jsx)(ew.Eye,{className:"h-4 w-4 mr-1"}),"View"]})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No scam reports"})})})]})})})]})}),(0,a.jsx)(eS.TabsContent,{value:"reviews",className:"space-y-4",children:(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Recent Broker Reviews (",p.length,")"]})}),(0,a.jsx)(J.CardContent,{children:u?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Broker"}),(0,a.jsx)(Z.TableHead,{children:"Reviewer"}),(0,a.jsx)(Z.TableHead,{children:"Rating"}),(0,a.jsx)(Z.TableHead,{children:"Review"}),(0,a.jsx)(Z.TableHead,{children:"Posted"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:p.length>0?p.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`review-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.brokerName}),(0,a.jsx)(Z.TableCell,{children:e.reviewerUsername}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"outline",children:[e.rating,"/5"]})}),(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.comment||"No comment"}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(x.Button,{size:"sm",variant:"outline","data-testid":`button-view-review-${e.id}`,children:[(0,a.jsx)(ew.Eye,{className:"h-4 w-4 mr-1"}),"View"]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No reviews found"})})})]})})})]})})]})]})}var e$=e.i(35408),eE=e.i(33808),eQ=e.i(38814),eV=e.i(22787);let eU=["hsl(var(--primary))","hsl(var(--secondary))","hsl(var(--accent))","hsl(var(--muted))"];function eO(){let[e,s]=(0,i.useState)("30d"),{toast:t}=(0,ep.useToast)(),{data:l,isLoading:r}=(0,Y.useQuery)({queryKey:["/api/admin/finance/overview"]}),d=l??{totalRevenue:0,revenueGrowth:0,pendingWithdrawals:0,pendingWithdrawalCount:0,totalTransactions:0,transactionsToday:0},{data:n,isLoading:c}=(0,Y.useQuery)({queryKey:["/api/admin/finance/transactions",{period:e}]}),o=Array.isArray(n)?n:[],{data:h,isLoading:m}=(0,Y.useQuery)({queryKey:["/api/admin/finance/withdrawals/pending"]}),u=Array.isArray(h)?h:[],{data:p,isLoading:g}=(0,Y.useQuery)({queryKey:["/api/admin/finance/revenue-chart",{period:e}]}),b=Array.isArray(p)?p:[],{data:v,isLoading:y}=(0,Y.useQuery)({queryKey:["/api/admin/finance/revenue-by-source"]}),C=Array.isArray(v)?v:[],T=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/finance/withdrawals/${e}/approve`,{}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/finance"]}),t({title:"Withdrawal approved successfully"})},onError:()=>{t({title:"Failed to approve withdrawal",variant:"destructive"})}}),f=(0,em.useMutation)({mutationFn:async({withdrawalId:e,reason:a})=>(0,ey.apiRequest)("POST",`/api/admin/finance/withdrawals/${e}/reject`,{reason:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/finance"]}),t({title:"Withdrawal rejected successfully"})},onError:()=>{t({title:"Failed to reject withdrawal",variant:"destructive"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Finance Management"}),(0,a.jsxs)(eu.Select,{value:e,onValueChange:s,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-48","data-testid":"select-period-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select period"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"7d",children:"Last 7 Days"}),(0,a.jsx)(eu.SelectItem,{value:"30d",children:"Last 30 Days"}),(0,a.jsx)(eu.SelectItem,{value:"90d",children:"Last 90 Days"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-total-revenue",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(I.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)(j.Skeleton,{className:"h-8 w-24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-finance-revenue",children:["$",d.totalRevenue]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(L.TrendingUp,{className:"h-3 w-3"}),"+",d.revenueGrowth,"% vs last period"]})]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-pending-withdrawals",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Pending Withdrawals"}),(0,a.jsx)(e$.TrendingDown,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)(j.Skeleton,{className:"h-8 w-24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-pending-withdrawals",children:["$",d.pendingWithdrawals]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[d.pendingWithdrawalCount," requests"]})]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-total-transactions",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Transactions"}),(0,a.jsx)(ev.Coins,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)(j.Skeleton,{className:"h-8 w-24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-transactions",children:d.totalTransactions}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[d.transactionsToday," today"]})]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-top-earner",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Top Earner"}),(0,a.jsx)(L.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)(j.Skeleton,{className:"h-8 w-24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-lg font-bold truncate",children:d.topEarner?.username||"N/A"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",d.topEarner?.earnings||0," earned"]})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-revenue-trend",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Revenue Trend"})}),(0,a.jsx)(J.CardContent,{children:g?(0,a.jsx)(j.Skeleton,{className:"h-64"}):b.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:b,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"revenue",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No revenue data available"})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-revenue-by-source",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Revenue by Source"})}),(0,a.jsx)(J.CardContent,{children:y?(0,a.jsx)(j.Skeleton,{className:"h-64"}):C.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:C,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:C.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:eU[s%eU.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No source data available"})})]})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Pending Withdrawals (",u.length,")"]})}),(0,a.jsx)(J.CardContent,{children:m?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Amount"}),(0,a.jsx)(Z.TableHead,{children:"Method"}),(0,a.jsx)(Z.TableHead,{children:"Wallet"}),(0,a.jsx)(Z.TableHead,{children:"Requested"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:u.length>0?u.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`withdrawal-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`withdrawal-user-${e.id}`,children:e.username}),(0,a.jsxs)(Z.TableCell,{"data-testid":`withdrawal-amount-${e.id}`,children:["$",e.amount]}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.method||"USDT"})}),(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.walletAddress||"N/A"}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>T.mutate(e.id),"data-testid":`button-approve-withdrawal-${e.id}`,children:[(0,a.jsx)(eT.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,a.jsxs)(x.Button,{size:"sm",variant:"destructive",onClick:()=>f.mutate({withdrawalId:e.id,reason:"Manual rejection"}),"data-testid":`button-reject-withdrawal-${e.id}`,children:[(0,a.jsx)(ef,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No pending withdrawals"})})})]})})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Recent Transactions (",o.length,")"]})}),(0,a.jsx)(J.CardContent,{children:c?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-16"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Type"}),(0,a.jsx)(Z.TableHead,{children:"Amount"}),(0,a.jsx)(Z.TableHead,{children:"Description"}),(0,a.jsx)(Z.TableHead,{children:"Date"})]})}),(0,a.jsx)(Z.TableBody,{children:o.length>0?o.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`transaction-row-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.username}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"credit"===e.type?"default":"secondary",children:e.type})}),(0,a.jsxs)(Z.TableCell,{"data-testid":`transaction-amount-${e.id}`,children:["credit"===e.type?"+":"-",e.amount," coins"]}),(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.description||"N/A"}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No transactions found"})})})]})})})]})]})}var ez=e.i(1725),eW=e.i(237),eG=e.i(59559);let e_=["hsl(var(--primary))","hsl(var(--secondary))","hsl(var(--accent))","hsl(var(--muted))","#8884d8","#82ca9d","#ffc658","#ff7c7c"];function eX(){let[e,s]=(0,i.useState)("users"),{data:t,isLoading:l}=(0,Y.useQuery)({queryKey:["/api/admin/analytics/users"]}),r=t||{dau:0,mau:0,newUsers:0,churnRate:0,growthData:[],countryData:[],activeInactiveData:[]},{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/analytics/content"]}),c=d||{trendData:[],typeDistribution:[],topCreators:[],qualityScores:[]},{data:o,isLoading:x}=(0,Y.useQuery)({queryKey:["/api/admin/analytics/financial"]}),h=o||{revenueTrend:[],revenueBySource:[],topEarners:[],transactionVolume:[]},{data:m,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/analytics/engagement"]}),p=m||{avgSessionDuration:"0m",bounceRate:0,pagesPerSession:0,heatmapData:[]};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics & Reports"}),(0,a.jsxs)(eS.Tabs,{value:e,onValueChange:s,"data-testid":"tabs-analytics",children:[(0,a.jsxs)(eS.TabsList,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(eS.TabsTrigger,{value:"users","data-testid":"tab-users",children:"Users"}),(0,a.jsx)(eS.TabsTrigger,{value:"content","data-testid":"tab-content",children:"Content"}),(0,a.jsx)(eS.TabsTrigger,{value:"financial","data-testid":"tab-financial",children:"Financial"}),(0,a.jsx)(eS.TabsTrigger,{value:"engagement","data-testid":"tab-engagement",children:"Engagement"})]}),(0,a.jsx)(eS.TabsContent,{value:"users",className:"space-y-4",children:l?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s))}),(0,a.jsx)(j.Skeleton,{className:"h-96"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-dau",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"DAU"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-dau",children:r.dau}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Daily Active Users"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-mau",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"MAU"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-mau",children:r.mau}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monthly Active Users"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-new-users",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"New Users"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-new-users",children:r.newUsers}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last 30 days"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-churn-rate",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Churn Rate"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-churn-rate",children:[r.churnRate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monthly churn"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-user-growth",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"User Growth (Last 30 Days)"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:r.growthData,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"users",stroke:"hsl(var(--primary))",strokeWidth:2})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-users-by-country",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Users by Country (Top 10)"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:r.countryData,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"country"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"users",fill:"hsl(var(--primary))"})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-active-inactive",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Active vs Inactive Users"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:r.activeInactiveData,cx:"50%",cy:"50%",labelLine:!1,label:e=>`${e.name}: ${e.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.activeInactiveData.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:e_[s%e_.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{})]})})})]})]})]})}),(0,a.jsx)(eS.TabsContent,{value:"content",className:"space-y-4",children:n?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(j.Skeleton,{className:"h-96"}),(0,a.jsx)(j.Skeleton,{className:"h-64"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-content-trend",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Content Creation Trend (Last 30 Days)"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:c.trendData,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"count",stroke:"hsl(var(--primary))",strokeWidth:2})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-content-type-distribution",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Content Type Distribution"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:c.typeDistribution,cx:"50%",cy:"50%",labelLine:!1,label:e=>`${e.name}: ${e.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:c.typeDistribution.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:e_[s%e_.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{})]})})})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-top-creators",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Top Content Creators"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Rank"}),(0,a.jsx)(Z.TableHead,{children:"Creator"}),(0,a.jsx)(Z.TableHead,{children:"Posts"}),(0,a.jsx)(Z.TableHead,{children:"Views"}),(0,a.jsx)(Z.TableHead,{children:"Avg Quality"})]})}),(0,a.jsx)(Z.TableBody,{children:c.topCreators.length>0?c.topCreators.map((e,s)=>(0,a.jsxs)(Z.TableRow,{"data-testid":`creator-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`creator-rank-${e.id}`,children:s+1}),(0,a.jsx)(Z.TableCell,{children:e.username}),(0,a.jsx)(Z.TableCell,{children:e.posts}),(0,a.jsx)(Z.TableCell,{children:e.views}),(0,a.jsx)(Z.TableCell,{children:e.avgQuality?.toFixed(1)||"N/A"})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No data available"})})})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-quality-scores",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Quality Scores Histogram"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:c.qualityScores,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"score"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})})})]})]})}),(0,a.jsx)(eS.TabsContent,{value:"financial",className:"space-y-4",children:x?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(j.Skeleton,{className:"h-96"}),(0,a.jsx)(j.Skeleton,{className:"h-64"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-revenue-trend",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Revenue Trend (Last 30 Days)"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ez.AreaChart,{data:h.revenueTrend,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{}),(0,a.jsx)(eW.Area,{type:"monotone",dataKey:"revenue",stroke:"hsl(var(--primary))",fill:"hsl(var(--primary))",fillOpacity:.6})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-revenue-by-source",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Revenue by Source"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:h.revenueBySource,cx:"50%",cy:"50%",labelLine:!1,label:e=>`${e.name}: $${e.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:h.revenueBySource.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:e_[s%e_.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{})]})})})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-top-earners",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Top Earners"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Rank"}),(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Total Earnings"}),(0,a.jsx)(Z.TableHead,{children:"This Month"}),(0,a.jsx)(Z.TableHead,{children:"Sales"})]})}),(0,a.jsx)(Z.TableBody,{children:h.topEarners.length>0?h.topEarners.map((e,s)=>(0,a.jsxs)(Z.TableRow,{"data-testid":`earner-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`earner-rank-${e.id}`,children:s+1}),(0,a.jsx)(Z.TableCell,{children:e.username}),(0,a.jsxs)(Z.TableCell,{children:["$",e.totalEarnings]}),(0,a.jsxs)(Z.TableCell,{children:["$",e.monthlyEarnings]}),(0,a.jsx)(Z.TableCell,{children:e.sales})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No data available"})})})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-transaction-volume",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Transaction Volume"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:h.transactionVolume,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"volume",fill:"hsl(var(--primary))"})]})})})]})]})}),(0,a.jsx)(eS.TabsContent,{value:"engagement",className:"space-y-4",children:u?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s))})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-avg-session",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Avg Session Duration"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-session",children:p.avgSessionDuration}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per user session"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-bounce-rate",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Bounce Rate"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-bounce-rate",children:[p.bounceRate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Single page visits"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-pages-per-session",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Pages Per Session"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-pages-per-session",children:p.pagesPerSession}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average pages"})]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-engagement-heatmap",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Engagement Heatmap (Hourly Activity)"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:300,children:(0,a.jsxs)(ei.BarChart,{data:p.heatmapData,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"hour"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{}),(0,a.jsx)(el.Bar,{dataKey:"activity",fill:"hsl(var(--primary))"})]})})})]})]})})]})]})}var eY=e.i(45305),eJ=e.i(27876),eZ=e.i(93753);function e0(){let[e,s]=(0,i.useState)("general"),[t,l]=(0,i.useState)(""),{toast:r}=(0,ep.useToast)(),{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/settings/general"]}),c=d||{siteName:"YoForex",siteDescription:"",maintenanceMode:!1,registrationEnabled:!0},{data:o,isLoading:m}=(0,Y.useQuery)({queryKey:["/api/admin/settings/coin-economy"]}),u=o||{usdToCoinsRate:100,packages:[],minWithdrawal:1e3,withdrawalFee:5},{data:p,isLoading:g}=(0,Y.useQuery)({queryKey:["/api/admin/settings/email-templates",{search:t}]}),b=Array.isArray(p)?p:[],{data:v,isLoading:y}=(0,Y.useQuery)({queryKey:["/api/admin/settings/feature-flags"]}),C=Array.isArray(v)?v:[],{data:T,isLoading:f}=(0,Y.useQuery)({queryKey:["/api/admin/settings/admin-roles"]}),N=Array.isArray(T)?T:[],w=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("PUT","/api/admin/settings/general",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/settings/general"]}),r({title:"Settings updated successfully"})},onError:()=>{r({title:"Failed to update settings",variant:"destructive"})}});(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("PUT","/api/admin/settings/coin-economy",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/settings/coin-economy"]}),r({title:"Coin settings updated successfully"})},onError:()=>{r({title:"Failed to update coin settings",variant:"destructive"})}});let S=(0,em.useMutation)({mutationFn:async({flagId:e,enabled:a})=>(0,ey.apiRequest)("PUT",`/api/admin/settings/feature-flags/${e}`,{enabled:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/settings/feature-flags"]}),r({title:"Feature flag updated"})},onError:()=>{r({title:"Failed to update feature flag",variant:"destructive"})}});return(0,em.useMutation)({mutationFn:async({userId:e,role:a})=>(0,ey.apiRequest)("POST","/api/admin/settings/admin-roles/grant",{userId:e,role:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/settings/admin-roles"]}),r({title:"Admin role granted successfully"})},onError:()=>{r({title:"Failed to grant admin role",variant:"destructive"})}}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"System Settings"}),(0,a.jsxs)(eS.Tabs,{value:e,onValueChange:s,"data-testid":"tabs-settings",children:[(0,a.jsxs)(eS.TabsList,{className:"grid w-full grid-cols-5",children:[(0,a.jsx)(eS.TabsTrigger,{value:"general","data-testid":"tab-general",children:"General"}),(0,a.jsx)(eS.TabsTrigger,{value:"coin-economy","data-testid":"tab-coin-economy",children:"Coin Economy"}),(0,a.jsx)(eS.TabsTrigger,{value:"email-templates","data-testid":"tab-email-templates",children:"Email Templates"}),(0,a.jsx)(eS.TabsTrigger,{value:"feature-flags","data-testid":"tab-feature-flags",children:"Feature Flags"}),(0,a.jsx)(eS.TabsTrigger,{value:"admin-roles","data-testid":"tab-admin-roles",children:"Admin Roles"})]}),(0,a.jsx)(eS.TabsContent,{value:"general",className:"space-y-4",children:n?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-general-settings",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"General Settings"})}),(0,a.jsxs)(J.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"site-name",children:"Site Name"}),(0,a.jsx)(h.Input,{id:"site-name",defaultValue:c.siteName,"data-testid":"input-site-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"site-description",children:"Site Description"}),(0,a.jsx)(eF.Textarea,{id:"site-description",defaultValue:c.siteDescription,"data-testid":"textarea-site-description"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(eZ.Label,{htmlFor:"maintenance-mode",children:"Maintenance Mode"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enable site maintenance mode"})]}),(0,a.jsx)(eY.Switch,{id:"maintenance-mode",defaultChecked:c.maintenanceMode,"data-testid":"switch-maintenance-mode"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(eZ.Label,{htmlFor:"registration-enabled",children:"Registration Enabled"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Allow new user registrations"})]}),(0,a.jsx)(eY.Switch,{id:"registration-enabled",defaultChecked:c.registrationEnabled,"data-testid":"switch-registration-enabled"})]}),(0,a.jsx)(x.Button,{onClick:()=>w.mutate(c),disabled:w.isPending,"data-testid":"button-save-general",children:"Save Changes"})]})]})}),(0,a.jsx)(eS.TabsContent,{value:"coin-economy",className:"space-y-4",children:m?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-exchange-rate",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Exchange Rate"})}),(0,a.jsxs)(J.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"usd-to-coins",children:"USD to Coins Rate"}),(0,a.jsx)(h.Input,{id:"usd-to-coins",type:"number",defaultValue:u.usdToCoinsRate,"data-testid":"input-usd-to-coins"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"1 USD = X coins"})]}),(0,a.jsx)(x.Button,{"data-testid":"button-save-exchange-rate",children:"Save Exchange Rate"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-recharge-packages",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Recharge Packages"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Package"}),(0,a.jsx)(Z.TableHead,{children:"Coins"}),(0,a.jsx)(Z.TableHead,{children:"Price (USD)"}),(0,a.jsx)(Z.TableHead,{children:"Bonus"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:u.packages.length>0?u.packages.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`package-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.coins}),(0,a.jsxs)(Z.TableCell,{children:["$",e.price]}),(0,a.jsxs)(Z.TableCell,{children:[e.bonus,"%"]}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-edit-package-${e.id}`,children:"Edit"})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No packages configured"})})})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-withdrawal-settings",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Withdrawal Settings"})}),(0,a.jsxs)(J.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"min-withdrawal",children:"Minimum Withdrawal Amount"}),(0,a.jsx)(h.Input,{id:"min-withdrawal",type:"number",defaultValue:u.minWithdrawal,"data-testid":"input-min-withdrawal"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"withdrawal-fee",children:"Withdrawal Fee (%)"}),(0,a.jsx)(h.Input,{id:"withdrawal-fee",type:"number",defaultValue:u.withdrawalFee,"data-testid":"input-withdrawal-fee"})]}),(0,a.jsx)(x.Button,{"data-testid":"button-save-withdrawal",children:"Save Withdrawal Settings"})]})]})]})}),(0,a.jsxs)(eS.TabsContent,{value:"email-templates",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Search Templates"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(h.Input,{placeholder:"Search templates...",value:t,onChange:e=>l(e.target.value),"data-testid":"input-search-templates"})})]}),g?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-email-templates",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Email Templates"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Subject"}),(0,a.jsx)(Z.TableHead,{children:"Type"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:b.length>0?b.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`template-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.subject}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.type})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-edit-template-${e.id}`,children:"Edit"}),(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-preview-template-${e.id}`,children:"Preview"})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No templates found"})})})]})})})]})]}),(0,a.jsx)(eS.TabsContent,{value:"feature-flags",className:"space-y-4",children:y?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-feature-flags",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Feature Flags"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Feature"}),(0,a.jsx)(Z.TableHead,{children:"Description"}),(0,a.jsx)(Z.TableHead,{children:"Enabled"}),(0,a.jsx)(Z.TableHead,{children:"Rollout %"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:C.length>0?C.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`flag-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.description}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(eY.Switch,{checked:e.enabled,onCheckedChange:a=>S.mutate({flagId:e.id,enabled:a}),"data-testid":`switch-flag-${e.id}`})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)("div",{className:"w-24",children:(0,a.jsx)(eJ.Slider,{defaultValue:[e.rolloutPercentage],max:100,step:1,"data-testid":`slider-rollout-${e.id}`})})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-configure-flag-${e.id}`,children:"Configure"})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No feature flags configured"})})})]})})})]})}),(0,a.jsx)(eS.TabsContent,{value:"admin-roles",className:"space-y-4",children:f?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-admin-roles",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Admin Roles & Permissions"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Email"}),(0,a.jsx)(Z.TableHead,{children:"Role"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:N.length>0?N.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`admin-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.username}),(0,a.jsx)(Z.TableCell,{children:e.email}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{children:e.role})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-edit-permissions-${e.id}`,children:"Edit Permissions"}),(0,a.jsx)(x.Button,{size:"sm",variant:"destructive","data-testid":`button-revoke-admin-${e.id}`,children:"Revoke"})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No admins found"})})})]})})})]})})]})]})}function e2(){let[e,s]=(0,i.useState)("security-events"),[t,l]=(0,i.useState)("all"),[r,d]=(0,i.useState)("all"),[n,c]=(0,i.useState)("all"),[o,m]=(0,i.useState)("active"),[u,p]=(0,i.useState)(null),{toast:g}=(0,ep.useToast)(),{data:b,isLoading:v}=(0,Y.useQuery)({queryKey:["/api/admin/security/events",{type:t,severity:r,resolved:n}]}),y=Array.isArray(b)?b:[],{data:C,isLoading:T}=(0,Y.useQuery)({queryKey:["/api/admin/security/ip-bans",{status:o}]}),f=Array.isArray(C)?C:[],{data:N,isLoading:w}=(0,Y.useQuery)({queryKey:["/api/admin/security/performance-metrics"]}),S=N||{cpu:0,memory:0,disk:0,network:0,responseTimeData:[],errorRateData:[],dbQueryTime:{avg:0,min:0,max:0},alerts:[]},k=(0,em.useMutation)({mutationFn:async({eventId:e,notes:a})=>(0,ey.apiRequest)("POST",`/api/admin/security/events/${e}/resolve`,{notes:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/security/events"]}),g({title:"Event resolved successfully"}),p(null)},onError:()=>{g({title:"Failed to resolve event",variant:"destructive"})}}),A=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST","/api/admin/security/ip-bans",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/security/ip-bans"]}),g({title:"IP banned successfully"})},onError:()=>{g({title:"Failed to ban IP",variant:"destructive"})}}),H=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("DELETE",`/api/admin/security/ip-bans/${e}`),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/security/ip-bans"]}),g({title:"IP unbanned successfully"})},onError:()=>{g({title:"Failed to unban IP",variant:"destructive"})}}),D=e=>{switch(e){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Security & Safety"}),(0,a.jsxs)(eS.Tabs,{value:e,onValueChange:s,"data-testid":"tabs-security",children:[(0,a.jsxs)(eS.TabsList,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(eS.TabsTrigger,{value:"security-events","data-testid":"tab-security-events",children:"Security Events"}),(0,a.jsx)(eS.TabsTrigger,{value:"ip-bans","data-testid":"tab-ip-bans",children:"IP Bans"}),(0,a.jsx)(eS.TabsTrigger,{value:"performance","data-testid":"tab-performance",children:"Performance Metrics"})]}),(0,a.jsxs)(eS.TabsContent,{value:"security-events",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)(eu.Select,{value:t,onValueChange:l,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-type-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Event Type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Types"}),(0,a.jsx)(eu.SelectItem,{value:"login_attempt",children:"Login Attempt"}),(0,a.jsx)(eu.SelectItem,{value:"suspicious_activity",children:"Suspicious Activity"}),(0,a.jsx)(eu.SelectItem,{value:"data_breach",children:"Data Breach"})]})]}),(0,a.jsxs)(eu.Select,{value:r,onValueChange:d,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-severity-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Severity"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Severities"}),(0,a.jsx)(eu.SelectItem,{value:"critical",children:"Critical"}),(0,a.jsx)(eu.SelectItem,{value:"high",children:"High"}),(0,a.jsx)(eu.SelectItem,{value:"medium",children:"Medium"}),(0,a.jsx)(eu.SelectItem,{value:"low",children:"Low"})]})]}),(0,a.jsxs)(eu.Select,{value:n,onValueChange:c,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-resolved-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Status"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(eu.SelectItem,{value:"resolved",children:"Resolved"}),(0,a.jsx)(eu.SelectItem,{value:"unresolved",children:"Unresolved"})]})]})]})})]}),v?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-security-events",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Security Events (",y.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Type"}),(0,a.jsx)(Z.TableHead,{children:"Severity"}),(0,a.jsx)(Z.TableHead,{children:"Description"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:y.length>0?y.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`event-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:e.type}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:D(e.severity),children:e.severity})}),(0,a.jsx)(Z.TableCell,{children:e.description}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:e.resolved?"secondary":"default",children:e.resolved?"Resolved":"Unresolved"})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>p(e),"data-testid":`button-view-event-${e.id}`,children:e.resolved?"View":"Resolve"})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No security events found"})})})]})})})]}),(0,a.jsx)(ej.Dialog,{open:!!u,onOpenChange:()=>p(null),children:(0,a.jsxs)(ej.DialogContent,{"data-testid":"dialog-event-detail",children:[(0,a.jsxs)(ej.DialogHeader,{children:[(0,a.jsx)(ej.DialogTitle,{children:"Security Event Details"}),(0,a.jsxs)(ej.DialogDescription,{children:["Event ID: ",u?.id]})]}),u&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Type"}),(0,a.jsx)("p",{className:"font-medium",children:u.type})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Severity"}),(0,a.jsx)(ex.Badge,{variant:D(u.severity),children:u.severity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Description"}),(0,a.jsx)("p",{children:u.description})]}),!u.resolved&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"resolution-notes",children:"Resolution Notes"}),(0,a.jsx)(eF.Textarea,{id:"resolution-notes",placeholder:"Enter resolution notes...","data-testid":"textarea-resolution-notes"}),(0,a.jsx)(x.Button,{onClick:()=>{let e=document.getElementById("resolution-notes")?.value;k.mutate({eventId:u.id,notes:e})},disabled:k.isPending,"data-testid":"button-resolve-event",children:"Resolve Event"})]})]})]})})]}),(0,a.jsxs)(eS.TabsContent,{value:"ip-bans",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Add IP Ban"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)(h.Input,{placeholder:"IP Address",id:"ban-ip-address","data-testid":"input-ban-ip-address"}),(0,a.jsx)(h.Input,{placeholder:"Reason",id:"ban-reason","data-testid":"input-ban-reason"}),(0,a.jsxs)(eu.Select,{defaultValue:"permanent",children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-ban-duration",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Duration"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"permanent",children:"Permanent"}),(0,a.jsx)(eu.SelectItem,{value:"7",children:"7 Days"}),(0,a.jsx)(eu.SelectItem,{value:"30",children:"30 Days"})]})]}),(0,a.jsx)(x.Button,{onClick:()=>{let e=document.getElementById("ban-ip-address")?.value,a=document.getElementById("ban-reason")?.value;A.mutate({ipAddress:e,reason:a,duration:0})},disabled:A.isPending,"data-testid":"button-add-ban",children:"Add Ban"})]})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-4 space-y-0",children:[(0,a.jsx)(J.CardTitle,{children:"IP Bans"}),(0,a.jsxs)(eu.Select,{value:o,onValueChange:m,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-48","data-testid":"select-ban-status-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Filter"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All"}),(0,a.jsx)(eu.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(eu.SelectItem,{value:"expired",children:"Expired"})]})]})]}),(0,a.jsx)(J.CardContent,{children:T?(0,a.jsx)(j.Skeleton,{className:"h-64"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"IP Address"}),(0,a.jsx)(Z.TableHead,{children:"Reason"}),(0,a.jsx)(Z.TableHead,{children:"Banned By"}),(0,a.jsx)(Z.TableHead,{children:"Banned At"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:f.length>0?f.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`ban-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.ipAddress}),(0,a.jsx)(Z.TableCell,{children:e.reason}),(0,a.jsx)(Z.TableCell,{children:e.bannedBy}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:e.active?"destructive":"secondary",children:e.active?"Active":"Expired"})}),(0,a.jsx)(Z.TableCell,{children:e.active&&(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>H.mutate(e.id),disabled:H.isPending,"data-testid":`button-unban-${e.id}`,children:"Unban"})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No IP bans found"})})})]})})})]})]}),(0,a.jsx)(eS.TabsContent,{value:"performance",className:"space-y-4",children:w?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s))})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-cpu",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"CPU Usage"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-cpu",children:[S.cpu,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current usage"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-memory",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Memory"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-memory",children:[S.memory,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-disk",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Disk"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-disk",children:[S.disk,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-network",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Network"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-network",children:[S.network," MB/s"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Throughput"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-response-time",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Response Time (Last 24 Hours)"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:S.responseTimeData,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"time"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"responseTime",stroke:"hsl(var(--primary))",strokeWidth:2})]})})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-error-rate",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Error Rate"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:S.errorRateData,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"time"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"errors",stroke:"hsl(var(--destructive))",strokeWidth:2})]})})})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-db-metrics",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Database Query Time Metrics"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Average"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[S.dbQueryTime.avg,"ms"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Min"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[S.dbQueryTime.min,"ms"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Max"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[S.dbQueryTime.max,"ms"]})]})]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-performance-alerts",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Performance Alerts"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Alert"}),(0,a.jsx)(Z.TableHead,{children:"Severity"}),(0,a.jsx)(Z.TableHead,{children:"Time"})]})}),(0,a.jsx)(Z.TableBody,{children:S.alerts.length>0?S.alerts.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{children:e.message}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:D(e.severity),children:e.severity})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.time),{addSuffix:!0})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:3,className:"text-center py-8 text-muted-foreground",children:"No performance alerts"})})})]})})})]})]})})]})]})}var e4=e.i(96112);function e1(){let[e,s]=(0,i.useState)("announcements"),[t,l]=(0,i.useState)(!1),{toast:r}=(0,ep.useToast)(),{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/communications/announcements"]}),c=Array.isArray(d)?d:[],{data:o,isLoading:m}=(0,Y.useQuery)({queryKey:["/api/admin/communications/campaigns"]}),u=Array.isArray(o)?o:[],{data:p,isLoading:g}=(0,Y.useQuery)({queryKey:["/api/admin/communications/campaign-stats"]}),b=p||{sent:0,opened:0,openRate:0,clicked:0,clickRate:0,bounced:0,bounceRate:0},v=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST","/api/admin/communications/announcements",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/communications/announcements"]}),r({title:"Announcement created successfully"}),l(!1)},onError:()=>{r({title:"Failed to create announcement",variant:"destructive"})}}),y=(0,em.useMutation)({mutationFn:async({id:e,active:a})=>(0,ey.apiRequest)("PUT",`/api/admin/communications/announcements/${e}`,{active:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/communications/announcements"]}),r({title:"Announcement updated"})},onError:()=>{r({title:"Failed to update announcement",variant:"destructive"})}}),C=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("DELETE",`/api/admin/communications/announcements/${e}`),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/communications/announcements"]}),r({title:"Announcement deleted"})},onError:()=>{r({title:"Failed to delete announcement",variant:"destructive"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Communications"}),(0,a.jsxs)(eS.Tabs,{value:e,onValueChange:s,"data-testid":"tabs-communications",children:[(0,a.jsxs)(eS.TabsList,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(eS.TabsTrigger,{value:"announcements","data-testid":"tab-announcements",children:"Announcements"}),(0,a.jsx)(eS.TabsTrigger,{value:"email-campaigns","data-testid":"tab-email-campaigns",children:"Email Campaigns"})]}),(0,a.jsxs)(eS.TabsContent,{value:"announcements",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Announcements"}),(0,a.jsxs)(ej.Dialog,{open:t,onOpenChange:l,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-announcement",children:"Create Announcement"})}),(0,a.jsxs)(ej.DialogContent,{"data-testid":"dialog-create-announcement",children:[(0,a.jsxs)(ej.DialogHeader,{children:[(0,a.jsx)(ej.DialogTitle,{children:"Create Announcement"}),(0,a.jsx)(ej.DialogDescription,{children:"Create a new announcement for your users"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-title",children:"Title"}),(0,a.jsx)(h.Input,{id:"announcement-title",placeholder:"Announcement title","data-testid":"input-announcement-title"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-content",children:"Content"}),(0,a.jsx)(eF.Textarea,{id:"announcement-content",placeholder:"Announcement content",rows:4,"data-testid":"textarea-announcement-content"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-type",children:"Type"}),(0,a.jsxs)(eu.Select,{defaultValue:"info",children:[(0,a.jsx)(eu.SelectTrigger,{id:"announcement-type","data-testid":"select-announcement-type",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"info",children:"Info"}),(0,a.jsx)(eu.SelectItem,{value:"warning",children:"Warning"}),(0,a.jsx)(eu.SelectItem,{value:"success",children:"Success"}),(0,a.jsx)(eu.SelectItem,{value:"error",children:"Error"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-audience",children:"Target Audience"}),(0,a.jsxs)(eu.Select,{defaultValue:"all",children:[(0,a.jsx)(eu.SelectTrigger,{id:"announcement-audience","data-testid":"select-announcement-audience",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select audience"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Users"}),(0,a.jsx)(eu.SelectItem,{value:"premium",children:"Premium Users"}),(0,a.jsx)(eu.SelectItem,{value:"free",children:"Free Users"}),(0,a.jsx)(eu.SelectItem,{value:"sellers",children:"Sellers"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-display",children:"Display Type"}),(0,a.jsxs)(eu.Select,{defaultValue:"banner",children:[(0,a.jsx)(eu.SelectTrigger,{id:"announcement-display","data-testid":"select-announcement-display",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select display type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"banner",children:"Banner"}),(0,a.jsx)(eu.SelectItem,{value:"modal",children:"Modal"}),(0,a.jsx)(eu.SelectItem,{value:"toast",children:"Toast"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-start",children:"Start Date"}),(0,a.jsx)(h.Input,{id:"announcement-start",type:"date","data-testid":"input-announcement-start"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"announcement-end",children:"End Date"}),(0,a.jsx)(h.Input,{id:"announcement-end",type:"date","data-testid":"input-announcement-end"})]})]}),(0,a.jsx)(x.Button,{onClick:()=>{let e=document.getElementById("announcement-title")?.value,a=document.getElementById("announcement-content")?.value;v.mutate({title:e,content:a,type:"info",audience:"all"})},disabled:v.isPending,"data-testid":"button-submit-announcement",children:"Create Announcement"})]})]})]})]}),n?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsx)(J.Card,{"data-testid":"card-announcements",children:(0,a.jsx)(J.CardContent,{className:"p-0",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Title"}),(0,a.jsx)(Z.TableHead,{children:"Type"}),(0,a.jsx)(Z.TableHead,{children:"Audience"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Views"}),(0,a.jsx)(Z.TableHead,{children:"Clicks"}),(0,a.jsx)(Z.TableHead,{children:"Created"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:c.length>0?c.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`announcement-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.title}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.type})}),(0,a.jsx)(Z.TableCell,{children:e.audience}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(eY.Switch,{checked:e.active,onCheckedChange:a=>y.mutate({id:e.id,active:a}),"data-testid":`switch-announcement-${e.id}`})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(ew.Eye,{className:"h-4 w-4"}),e.views||0]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(e4.MousePointer,{className:"h-4 w-4"}),e.clicks||0]})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-edit-announcement-${e.id}`,children:"Edit"}),(0,a.jsx)(x.Button,{size:"sm",variant:"destructive",onClick:()=>C.mutate(e.id),disabled:C.isPending,"data-testid":`button-delete-announcement-${e.id}`,children:"Delete"})]})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No announcements found"})})})]})})})})]}),(0,a.jsxs)(eS.TabsContent,{value:"email-campaigns",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Email Campaigns"}),(0,a.jsx)(x.Button,{"data-testid":"button-create-campaign",children:"Create Campaign"})]}),g?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s))}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-sent",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Sent"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-sent",children:b.sent}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Emails sent"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-opened",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Opened"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-opened",children:b.opened}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[b.openRate,"% open rate"]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-clicked",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Clicked"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-clicked",children:b.clicked}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[b.clickRate,"% click rate"]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-bounced",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Bounced"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-bounced",children:b.bounced}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[b.bounceRate,"% bounce rate"]})]})]})]}),m?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-campaigns",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Recent Campaigns"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Subject"}),(0,a.jsx)(Z.TableHead,{children:"Sent"}),(0,a.jsx)(Z.TableHead,{children:"Opened"}),(0,a.jsx)(Z.TableHead,{children:"Clicked"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Created"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:u.length>0?u.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`campaign-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.subject}),(0,a.jsx)(Z.TableCell,{children:e.sent||0}),(0,a.jsx)(Z.TableCell,{children:e.opened||0}),(0,a.jsx)(Z.TableCell,{children:e.clicked||0}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"sent"===e.status?"default":"secondary",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-view-campaign-${e.id}`,children:"View Report"})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No campaigns found"})})})]})})})]})]})]})]})}function e3(){let[e,s]=(0,i.useState)("all"),[t,l]=(0,i.useState)("all"),[r,d]=(0,i.useState)("all"),[n,c]=(0,i.useState)(null),{toast:o}=(0,ep.useToast)(),{data:h,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/support/tickets",{status:e,priority:t,category:r}]}),p=Array.isArray(h)?h:[],{data:g,isLoading:b}=(0,Y.useQuery)({queryKey:["/api/admin/support/stats"]}),v=g||{openTickets:0,avgResponseTime:"0h",avgResolutionTime:"0h",satisfactionScore:0},y=(0,em.useMutation)({mutationFn:async({ticketId:e,data:a})=>(0,ey.apiRequest)("PUT",`/api/admin/support/tickets/${e}`,a),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/support/tickets"]}),o({title:"Ticket updated successfully"})},onError:()=>{o({title:"Failed to update ticket",variant:"destructive"})}}),C=(0,em.useMutation)({mutationFn:async({ticketId:e,message:a})=>(0,ey.apiRequest)("POST",`/api/admin/support/tickets/${e}/reply`,{message:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/support/tickets"]}),o({title:"Reply sent successfully"})},onError:()=>{o({title:"Failed to send reply",variant:"destructive"})}}),T=(0,em.useMutation)({mutationFn:async e=>(0,ey.apiRequest)("POST",`/api/admin/support/tickets/${e}/close`),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/support/tickets"]}),o({title:"Ticket closed"}),c(null)},onError:()=>{o({title:"Failed to close ticket",variant:"destructive"})}}),f=e=>{switch(e){case"urgent":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Support & Tickets"}),b?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s))}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-open-tickets",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Open Tickets"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-open-tickets",children:v.openTickets}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting response"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-avg-response-time",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Avg Response Time"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-response-time",children:v.avgResponseTime}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Time to first response"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-avg-resolution-time",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Avg Resolution Time"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-resolution-time",children:v.avgResolutionTime}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Time to close"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-satisfaction-score",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Satisfaction Score"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-satisfaction-score",children:[v.satisfactionScore,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"User satisfaction"})]})]})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)(eu.Select,{value:e,onValueChange:s,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-status-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Status"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(eu.SelectItem,{value:"open",children:"Open"}),(0,a.jsx)(eu.SelectItem,{value:"in_progress",children:"In Progress"}),(0,a.jsx)(eu.SelectItem,{value:"resolved",children:"Resolved"}),(0,a.jsx)(eu.SelectItem,{value:"closed",children:"Closed"})]})]}),(0,a.jsxs)(eu.Select,{value:t,onValueChange:l,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-priority-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Priority"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Priorities"}),(0,a.jsx)(eu.SelectItem,{value:"urgent",children:"Urgent"}),(0,a.jsx)(eu.SelectItem,{value:"high",children:"High"}),(0,a.jsx)(eu.SelectItem,{value:"medium",children:"Medium"}),(0,a.jsx)(eu.SelectItem,{value:"low",children:"Low"})]})]}),(0,a.jsxs)(eu.Select,{value:r,onValueChange:d,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-category-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Category"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Categories"}),(0,a.jsx)(eu.SelectItem,{value:"technical",children:"Technical"}),(0,a.jsx)(eu.SelectItem,{value:"billing",children:"Billing"}),(0,a.jsx)(eu.SelectItem,{value:"general",children:"General"})]})]})]})})]}),u?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-tickets",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Support Tickets (",p.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Ticket #"}),(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Subject"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Priority"}),(0,a.jsx)(Z.TableHead,{children:"Created"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:p.length>0?p.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`ticket-${e.id}`,children:[(0,a.jsxs)(Z.TableCell,{children:["#",e.id]}),(0,a.jsx)(Z.TableCell,{children:e.username}),(0,a.jsx)(Z.TableCell,{children:e.subject}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:f(e.priority),children:e.priority})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>c(e),"data-testid":`button-view-ticket-${e.id}`,children:"View"})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No tickets found"})})})]})})})]}),(0,a.jsx)(ej.Dialog,{open:!!n,onOpenChange:()=>c(null),children:(0,a.jsxs)(ej.DialogContent,{className:"max-w-3xl","data-testid":"dialog-ticket-detail",children:[(0,a.jsxs)(ej.DialogHeader,{children:[(0,a.jsxs)(ej.DialogTitle,{children:["Ticket #",n?.id]}),(0,a.jsx)(ej.DialogDescription,{children:n?.subject})]}),n&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"User"}),(0,a.jsx)("p",{className:"font-medium",children:n.username})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,a.jsx)(ex.Badge,{variant:"outline",children:n.status})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Priority"}),(0,a.jsx)(ex.Badge,{variant:f(n.priority),children:n.priority})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Category"}),(0,a.jsx)("p",{className:"font-medium",children:n.category||"N/A"})]})]}),(0,a.jsx)(m.Separator,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{children:"Conversation"}),(0,a.jsx)("div",{className:"border rounded-md p-4 space-y-4 max-h-96 overflow-y-auto",children:n.messages&&n.messages.length>0?n.messages.map(e=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"font-medium",children:e.sender}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})})]}),(0,a.jsx)("p",{className:"text-sm",children:e.content}),(0,a.jsx)(m.Separator,{className:"mt-2"})]},e.id)):(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No messages yet"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"reply-message",children:"Reply"}),(0,a.jsx)(eF.Textarea,{id:"reply-message",placeholder:"Type your reply...",rows:4,"data-testid":"textarea-reply"}),(0,a.jsx)(x.Button,{onClick:()=>{let e=document.getElementById("reply-message")?.value;C.mutate({ticketId:n.id,message:e})},disabled:C.isPending,"data-testid":"button-send-reply",children:"Send Reply"})]}),(0,a.jsx)(m.Separator,{}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"assign-admin",children:"Assign to Admin"}),(0,a.jsxs)(eu.Select,{children:[(0,a.jsx)(eu.SelectTrigger,{id:"assign-admin","data-testid":"select-assign-admin",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select admin"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"admin1",children:"Admin 1"}),(0,a.jsx)(eu.SelectItem,{value:"admin2",children:"Admin 2"})]})]})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"update-status",children:"Update Status"}),(0,a.jsxs)(eu.Select,{defaultValue:n.status,onValueChange:e=>{y.mutate({ticketId:n.id,data:{status:e}})},children:[(0,a.jsx)(eu.SelectTrigger,{id:"update-status","data-testid":"select-update-status",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select status"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"open",children:"Open"}),(0,a.jsx)(eu.SelectItem,{value:"in_progress",children:"In Progress"}),(0,a.jsx)(eu.SelectItem,{value:"resolved",children:"Resolved"}),(0,a.jsx)(eu.SelectItem,{value:"closed",children:"Closed"})]})]})]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(x.Button,{variant:"destructive",onClick:()=>T.mutate(n.id),disabled:T.isPending,"data-testid":"button-close-ticket",children:"Close Ticket"})}),n.tags&&n.tags.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:n.tags.map((e,s)=>(0,a.jsx)(ex.Badge,{variant:"secondary",children:e},s))})]})]})]})})]})}var e6=e.i(40160);function e8(){let[e,s]=(0,i.useState)("admin-actions"),[t,l]=(0,i.useState)("all"),[r,d]=(0,i.useState)("all"),[n,c]=(0,i.useState)("all"),[o,m]=(0,i.useState)(""),[u,p]=(0,i.useState)("all"),[g,b]=(0,i.useState)("all"),[v,y]=(0,i.useState)("all"),{data:C,isLoading:T}=(0,Y.useQuery)({queryKey:["/api/admin/logs/admin-actions",{admin:t,actionType:r,targetType:n,search:o}]}),f=Array.isArray(C)?C:[],{data:N,isLoading:w}=(0,Y.useQuery)({queryKey:["/api/admin/logs/security",{severity:u,eventType:v}]}),S=Array.isArray(N)?N:[],{data:k,isLoading:A}=(0,Y.useQuery)({queryKey:["/api/admin/logs/performance",{metricType:g}]}),H=k??{aggregations:{avg:0,min:0,max:0},logs:[]},{data:D,isLoading:R}=(0,Y.useQuery)({queryKey:["/api/admin/logs/system-events",{severity:u,eventType:v}]}),F=Array.isArray(D)?D:[],q=e=>{console.log(`Exporting logs as ${e}`)},B=e=>{switch(e){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Audit Logs"}),(0,a.jsxs)(eS.Tabs,{value:e,onValueChange:s,"data-testid":"tabs-logs",children:[(0,a.jsxs)(eS.TabsList,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(eS.TabsTrigger,{value:"admin-actions","data-testid":"tab-admin-actions",children:"Admin Actions"}),(0,a.jsx)(eS.TabsTrigger,{value:"security","data-testid":"tab-security-logs",children:"Security Logs"}),(0,a.jsx)(eS.TabsTrigger,{value:"performance","data-testid":"tab-performance-logs",children:"Performance Logs"}),(0,a.jsx)(eS.TabsTrigger,{value:"system","data-testid":"tab-system-events",children:"System Events"})]}),(0,a.jsxs)(eS.TabsContent,{value:"admin-actions",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters & Search"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,a.jsx)(h.Input,{placeholder:"Search logs...",value:o,onChange:e=>{let a=e.target.value;setTimeout(()=>m(a),300)},"data-testid":"input-search-logs"}),(0,a.jsxs)(eu.Select,{value:t,onValueChange:l,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-admin-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Admin User"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Admins"}),(0,a.jsx)(eu.SelectItem,{value:"admin1",children:"Admin 1"}),(0,a.jsx)(eu.SelectItem,{value:"admin2",children:"Admin 2"})]})]}),(0,a.jsxs)(eu.Select,{value:r,onValueChange:d,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-action-type-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Action Type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Actions"}),(0,a.jsx)(eu.SelectItem,{value:"create",children:"Create"}),(0,a.jsx)(eu.SelectItem,{value:"update",children:"Update"}),(0,a.jsx)(eu.SelectItem,{value:"delete",children:"Delete"})]})]}),(0,a.jsxs)(eu.Select,{value:n,onValueChange:c,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-target-type-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Target Type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Targets"}),(0,a.jsx)(eu.SelectItem,{value:"user",children:"User"}),(0,a.jsx)(eu.SelectItem,{value:"content",children:"Content"}),(0,a.jsx)(eu.SelectItem,{value:"settings",children:"Settings"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)(h.Input,{type:"date",placeholder:"Start Date",className:"w-full md:w-auto","data-testid":"input-start-date"}),(0,a.jsx)(h.Input,{type:"date",placeholder:"End Date",className:"w-full md:w-auto","data-testid":"input-end-date"}),(0,a.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,a.jsxs)(x.Button,{variant:"outline",onClick:()=>q("csv"),"data-testid":"button-export-csv",children:[(0,a.jsx)(e6.Download,{className:"h-4 w-4 mr-1"}),"CSV"]}),(0,a.jsxs)(x.Button,{variant:"outline",onClick:()=>q("json"),"data-testid":"button-export-json",children:[(0,a.jsx)(e6.Download,{className:"h-4 w-4 mr-1"}),"JSON"]})]})]})]})]}),T?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-admin-logs",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Admin Action Logs (",f.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Admin"}),(0,a.jsx)(Z.TableHead,{children:"Action Type"}),(0,a.jsx)(Z.TableHead,{children:"Target"}),(0,a.jsx)(Z.TableHead,{children:"Details"}),(0,a.jsx)(Z.TableHead,{children:"IP Address"})]})}),(0,a.jsx)(Z.TableBody,{children:f.length>0?f.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`log-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:e.adminUsername}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.actionType})}),(0,a.jsx)(Z.TableCell,{children:e.targetType}),(0,a.jsx)(Z.TableCell,{children:e.details}),(0,a.jsx)(Z.TableCell,{children:e.ipAddress})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No logs found"})})})]})})})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"security",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)(eu.Select,{value:u,onValueChange:p,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-security-severity-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Severity"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Severities"}),(0,a.jsx)(eu.SelectItem,{value:"critical",children:"Critical"}),(0,a.jsx)(eu.SelectItem,{value:"high",children:"High"}),(0,a.jsx)(eu.SelectItem,{value:"medium",children:"Medium"}),(0,a.jsx)(eu.SelectItem,{value:"low",children:"Low"})]})]}),(0,a.jsxs)(eu.Select,{value:v,onValueChange:y,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-security-event-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Event Type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Events"}),(0,a.jsx)(eu.SelectItem,{value:"login",children:"Login"}),(0,a.jsx)(eu.SelectItem,{value:"access",children:"Access"}),(0,a.jsx)(eu.SelectItem,{value:"breach",children:"Breach"})]})]})]})})]}),w?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-security-logs",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Security Event Logs (",S.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Event Type"}),(0,a.jsx)(Z.TableHead,{children:"Severity"}),(0,a.jsx)(Z.TableHead,{children:"Description"}),(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"IP Address"})]})}),(0,a.jsx)(Z.TableBody,{children:S.length>0?S.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`security-log-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:e.eventType}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:B(e.severity),children:e.severity})}),(0,a.jsx)(Z.TableCell,{children:e.description}),(0,a.jsx)(Z.TableCell,{children:e.username||"N/A"}),(0,a.jsx)(Z.TableCell,{children:e.ipAddress})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No security logs found"})})})]})})})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"performance",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)(eu.Select,{value:g,onValueChange:b,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-metric-type-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Metric Type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Metrics"}),(0,a.jsx)(eu.SelectItem,{value:"cpu",children:"CPU"}),(0,a.jsx)(eu.SelectItem,{value:"memory",children:"Memory"}),(0,a.jsx)(eu.SelectItem,{value:"response_time",children:"Response Time"})]})]}),(0,a.jsx)(h.Input,{type:"date",placeholder:"Start Date","data-testid":"input-perf-start-date"}),(0,a.jsx)(h.Input,{type:"date",placeholder:"End Date","data-testid":"input-perf-end-date"})]})})]}),A?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)(J.Card,{"data-testid":"card-avg-metric",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Average"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-metric",children:H.aggregations?.avg||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average value"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-min-metric",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Minimum"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-min-metric",children:H.aggregations?.min||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Minimum value"})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-max-metric",children:[(0,a.jsx)(J.CardHeader,{className:"pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Maximum"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-max-metric",children:H.aggregations?.max||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Maximum value"})]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-performance-logs",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["Performance Metrics (",H.logs.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Metric Type"}),(0,a.jsx)(Z.TableHead,{children:"Value"}),(0,a.jsx)(Z.TableHead,{children:"Unit"}),(0,a.jsx)(Z.TableHead,{children:"Status"})]})}),(0,a.jsx)(Z.TableBody,{children:H.logs.length>0?H.logs.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`perf-log-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:e.metricType}),(0,a.jsx)(Z.TableCell,{children:e.value}),(0,a.jsx)(Z.TableCell,{children:e.unit}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"normal"===e.status?"secondary":"destructive",children:e.status})})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No performance logs found"})})})]})})})]})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"system",className:"space-y-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Filters"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)(eu.Select,{value:v,onValueChange:y,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-system-event-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Event Type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Events"}),(0,a.jsx)(eu.SelectItem,{value:"startup",children:"Startup"}),(0,a.jsx)(eu.SelectItem,{value:"shutdown",children:"Shutdown"}),(0,a.jsx)(eu.SelectItem,{value:"error",children:"Error"})]})]}),(0,a.jsxs)(eu.Select,{value:u,onValueChange:p,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-system-severity-filter",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Severity"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Severities"}),(0,a.jsx)(eu.SelectItem,{value:"critical",children:"Critical"}),(0,a.jsx)(eu.SelectItem,{value:"high",children:"High"}),(0,a.jsx)(eu.SelectItem,{value:"medium",children:"Medium"}),(0,a.jsx)(eu.SelectItem,{value:"low",children:"Low"})]})]})]})})]}),R?(0,a.jsx)(j.Skeleton,{className:"h-96"}):(0,a.jsxs)(J.Card,{"data-testid":"card-system-events",children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsxs)(J.CardTitle,{children:["System Events (",F.length,")"]})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Event Type"}),(0,a.jsx)(Z.TableHead,{children:"Severity"}),(0,a.jsx)(Z.TableHead,{children:"Description"}),(0,a.jsx)(Z.TableHead,{children:"Component"})]})}),(0,a.jsx)(Z.TableBody,{children:F.length>0?F.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`system-event-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:e.eventType}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:B(e.severity),children:e.severity})}),(0,a.jsx)(Z.TableCell,{children:e.description}),(0,a.jsx)(Z.TableCell,{children:e.component})]},e.id)):(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No system events found"})})})]})})})]})]})]})]})}let e5=(0,d.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);function e9(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(!1),[l,r]=(0,i.useState)([70]),{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/automation/rules"]}),c=Array.isArray(d)?d:[],{data:o,isLoading:m}=(0,Y.useQuery)({queryKey:["/api/admin/ai/moderation-stats"]}),u=o||{accuracyRate:0,falsePositives:0,falseNegatives:0,timeSavedHours:0},{data:p,isLoading:g}=(0,Y.useQuery)({queryKey:["/api/admin/ai/moderation-decisions"]}),b=Array.isArray(p)?p:[],{data:v,isLoading:y}=(0,Y.useQuery)({queryKey:["/api/admin/ai/sentiment-distribution"]}),C=Array.isArray(v)?v:[],{data:T,isLoading:f}=(0,Y.useQuery)({queryKey:["/api/admin/ai/spam-metrics"]}),N=T||{accuracy:0,blocked:0,flagged:0},{data:w,isLoading:S}=(0,Y.useQuery)({queryKey:["/api/admin/ai/flagged-content"]}),k=Array.isArray(w)?w:[],A=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/automation/rules","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/automation/rules"]}),e({title:"Rule created successfully"}),t(!1)}}),H=(0,em.useMutation)({mutationFn:({id:e,enabled:a})=>(0,ey.apiRequest)(`/api/admin/automation/rules/${e}`,"PATCH",{enabled:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/automation/rules"]}),e({title:"Rule updated"})}}),D=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/automation/rules/${e}/execute`,"POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/automation/rules"]}),e({title:"Rule executed successfully"})}}),R=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/ai/moderation-decisions/${e}/override`,"POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/ai/moderation-decisions"]}),e({title:"Decision overridden"})}}),F=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/ai/spam-sensitivity","PATCH",{sensitivity:e}),onSuccess:()=>{e({title:"Sensitivity updated"})}}),q=["hsl(var(--primary))","hsl(var(--accent))","hsl(var(--muted))"];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"AI & Automation"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"automation",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"automation","data-testid":"tab-automation",children:"Automation Rules"}),(0,a.jsx)(eS.TabsTrigger,{value:"moderation","data-testid":"tab-moderation",children:"Content Moderation AI"}),(0,a.jsx)(eS.TabsTrigger,{value:"spam","data-testid":"tab-spam",children:"Spam Detection"})]}),(0,a.jsxs)(eS.TabsContent,{value:"automation",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Automation Rules"}),(0,a.jsxs)(ej.Dialog,{open:s,onOpenChange:t,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-rule",children:"Create Rule"})}),(0,a.jsxs)(ej.DialogContent,{className:"max-w-2xl",children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create Automation Rule"})}),(0,a.jsxs)("form",{onSubmit:a=>{a.preventDefault();let s=new FormData(a.currentTarget),t=s.get("triggerConfig"),i=s.get("actionConfig");try{JSON.parse(t),JSON.parse(i)}catch(a){e({title:"Invalid JSON in configuration",variant:"destructive"});return}A.mutate({name:s.get("name"),triggerType:s.get("triggerType"),triggerConfig:t,actionType:s.get("actionType"),actionConfig:i})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"name",children:"Rule Name"}),(0,a.jsx)(h.Input,{id:"name",name:"name",required:!0,"data-testid":"input-rule-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"triggerType",children:"Trigger Type"}),(0,a.jsxs)(eu.Select,{name:"triggerType",required:!0,children:[(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-trigger-type",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select trigger type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"user_signup",children:"User Signup"}),(0,a.jsx)(eu.SelectItem,{value:"content_published",children:"Content Published"}),(0,a.jsx)(eu.SelectItem,{value:"time_based",children:"Time Based"}),(0,a.jsx)(eu.SelectItem,{value:"threshold_reached",children:"Threshold Reached"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"triggerConfig",children:"Trigger Configuration (JSON)"}),(0,a.jsx)(eF.Textarea,{id:"triggerConfig",name:"triggerConfig",placeholder:'{"key": "value"}',className:"font-mono text-sm",required:!0,"data-testid":"textarea-trigger-config"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"actionType",children:"Action Type"}),(0,a.jsxs)(eu.Select,{name:"actionType",required:!0,children:[(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-action-type",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select action type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"send_email",children:"Send Email"}),(0,a.jsx)(eu.SelectItem,{value:"create_notification",children:"Create Notification"}),(0,a.jsx)(eu.SelectItem,{value:"award_coins",children:"Award Coins"}),(0,a.jsx)(eu.SelectItem,{value:"assign_badge",children:"Assign Badge"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"actionConfig",children:"Action Configuration (JSON)"}),(0,a.jsx)(eF.Textarea,{id:"actionConfig",name:"actionConfig",placeholder:'{"key": "value"}',className:"font-mono text-sm",required:!0,"data-testid":"textarea-action-config"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:A.isPending,"data-testid":"button-submit-rule",children:A.isPending?"Creating...":"Create Rule"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:n?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Trigger"}),(0,a.jsx)(Z.TableHead,{children:"Action"}),(0,a.jsx)(Z.TableHead,{children:"Executions"}),(0,a.jsx)(Z.TableHead,{children:"Last Executed"}),(0,a.jsx)(Z.TableHead,{children:"Enabled"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[c.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`rule-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{"data-testid":`rule-name-${e.id}`,children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.triggerType}),(0,a.jsx)(Z.TableCell,{children:e.actionType}),(0,a.jsx)(Z.TableCell,{children:e.executionCount||0}),(0,a.jsx)(Z.TableCell,{children:e.lastExecutedAt?(0,ea.formatDistanceToNow)(new Date(e.lastExecutedAt),{addSuffix:!0}):"Never"}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(eY.Switch,{checked:e.enabled,onCheckedChange:a=>H.mutate({id:e.id,enabled:a}),"data-testid":`switch-rule-${e.id}`})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>D.mutate(e.id),disabled:D.isPending,"data-testid":`button-execute-${e.id}`,children:[(0,a.jsx)(e5,{className:"w-3 h-3 mr-1"}),"Execute"]})})]},e.id)),0===c.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No automation rules created"})})]})]})})})})]}),(0,a.jsxs)(eS.TabsContent,{value:"moderation",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Content Moderation AI"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:m?[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-accuracy-rate",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Accuracy Rate"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-accuracy-rate",children:[u.accuracyRate,"%"]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-false-positives",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"False Positives"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-false-positives",children:u.falsePositives})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-false-negatives",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"False Negatives"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-false-negatives",children:u.falseNegatives})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-time-saved",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Time Saved"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-time-saved",children:[u.timeSavedHours,"h"]})})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Recent AI Decisions"})}),(0,a.jsx)(J.CardContent,{children:g?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Content"}),(0,a.jsx)(Z.TableHead,{children:"Decision"}),(0,a.jsx)(Z.TableHead,{children:"Confidence"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[b.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.contentPreview}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"approved"===e.decision?"default":"destructive",children:e.decision})}),(0,a.jsxs)(Z.TableCell,{children:[e.confidence,"%"]}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>R.mutate(e.id),"data-testid":`button-override-${e.id}`,children:"Override"})})]},e.id)),0===b.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No recent decisions"})})]})]})})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Sentiment Distribution"})}),(0,a.jsx)(J.CardContent,{children:y?(0,a.jsx)(j.Skeleton,{className:"h-64"}):C.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:C,cx:"50%",cy:"50%",labelLine:!1,label:e=>e.name,outerRadius:80,fill:"hsl(var(--primary))",dataKey:"value",children:C.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:q[s%q.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"spam",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Spam Detection"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f?[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-spam-accuracy",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Detection Accuracy"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-spam-accuracy",children:[N.accuracy,"%"]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-spam-blocked",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Spam Blocked"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-spam-blocked",children:N.blocked})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-spam-flagged",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Currently Flagged"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-spam-flagged",children:N.flagged})})]})]})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Adjust Sensitivity"})}),(0,a.jsxs)(J.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eZ.Label,{children:["Sensitivity Level: ",l[0],"%"]}),(0,a.jsx)(eJ.Slider,{value:l,onValueChange:r,max:100,step:1,"data-testid":"slider-sensitivity"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Higher values will flag more content as potential spam"})]}),(0,a.jsx)(x.Button,{onClick:()=>F.mutate(l[0]),disabled:F.isPending,"data-testid":"button-update-sensitivity",children:"Update Sensitivity"})]})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Flagged Content"})}),(0,a.jsx)(J.CardContent,{children:S?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Content"}),(0,a.jsx)(Z.TableHead,{children:"Spam Score"}),(0,a.jsx)(Z.TableHead,{children:"Author"}),(0,a.jsx)(Z.TableHead,{children:"Flagged At"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[k.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.contentPreview}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:e.spamScore>80?"destructive":"secondary",children:[e.spamScore,"%"]})}),(0,a.jsx)(Z.TableCell,{children:e.authorUsername}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.flaggedAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline","data-testid":`button-approve-${e.id}`,children:"Approve"})})]},e.id)),0===k.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No flagged content"})})]})]})})})]})]})]})]})}var e7=e.i(42009);function ae(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(!1),[l,r]=(0,i.useState)(!1),[d,n]=(0,i.useState)("contributors"),[c,o]=(0,i.useState)("all-time"),{data:m,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/gamification/badges"]}),p=Array.isArray(m)?m:[],{data:g,isLoading:b}=(0,Y.useQuery)({queryKey:["/api/admin/gamification/achievements"]}),v=Array.isArray(g)?g:[],{data:y,isLoading:C}=(0,Y.useQuery)({queryKey:["/api/admin/gamification/leaderboard",d,c]}),T=Array.isArray(y)?y:[],{data:f,isLoading:N}=(0,Y.useQuery)({queryKey:["/api/admin/gamification/goals"]}),w=Array.isArray(f)?f:[],{data:S,isLoading:k}=(0,Y.useQuery)({queryKey:["/api/admin/gamification/goal-completion"]}),A=Array.isArray(S)?S:[],H=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/gamification/badges","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/gamification/badges"]}),e({title:"Badge created successfully"}),t(!1)}}),D=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/gamification/achievements","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/gamification/achievements"]}),e({title:"Achievement created successfully"}),r(!1)}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Gamification"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"badges",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"badges","data-testid":"tab-badges",children:"Badges"}),(0,a.jsx)(eS.TabsTrigger,{value:"achievements","data-testid":"tab-achievements",children:"Achievements"}),(0,a.jsx)(eS.TabsTrigger,{value:"leaderboards","data-testid":"tab-leaderboards",children:"Leaderboards"}),(0,a.jsx)(eS.TabsTrigger,{value:"goals","data-testid":"tab-goals",children:"Goals"})]}),(0,a.jsxs)(eS.TabsContent,{value:"badges",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Badges"}),(0,a.jsxs)(ej.Dialog,{open:s,onOpenChange:t,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-badge",children:"Create Badge"})}),(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create New Badge"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);H.mutate({name:a.get("name"),description:a.get("description"),imageUrl:a.get("imageUrl"),rarity:a.get("rarity")})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"name",children:"Badge Name"}),(0,a.jsx)(h.Input,{id:"name",name:"name",required:!0,"data-testid":"input-badge-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"description",children:"Description"}),(0,a.jsx)(h.Input,{id:"description",name:"description",required:!0,"data-testid":"input-badge-description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"imageUrl",children:"Image URL"}),(0,a.jsx)(h.Input,{id:"imageUrl",name:"imageUrl",type:"url",required:!0,"data-testid":"input-badge-image"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"rarity",children:"Rarity"}),(0,a.jsxs)(eu.Select,{name:"rarity",required:!0,children:[(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-badge-rarity",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select rarity"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"common",children:"Common"}),(0,a.jsx)(eu.SelectItem,{value:"rare",children:"Rare"}),(0,a.jsx)(eu.SelectItem,{value:"epic",children:"Epic"}),(0,a.jsx)(eu.SelectItem,{value:"legendary",children:"Legendary"})]})]})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:H.isPending,"data-testid":"button-submit-badge",children:H.isPending?"Creating...":"Create Badge"})})]})]})]})]}),u?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-48"},s))}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[p.map(e=>(0,a.jsxs)(J.Card,{"data-testid":`badge-card-${e.id}`,children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center",children:e.imageUrl?(0,a.jsx)("img",{src:e.imageUrl,alt:e.name,className:"w-12 h-12"}):(0,a.jsx)(e7.Award,{className:"w-8 h-8"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(J.CardTitle,{className:"text-lg","data-testid":`badge-name-${e.id}`,children:e.name}),(0,a.jsx)(ex.Badge,{variant:"secondary",children:e.rarity})]})]}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})}),(0,a.jsx)(J.CardFooter,{className:"flex justify-between gap-2",children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-semibold",children:e.totalEarned||0})," earned"]})})]},e.id)),0===p.length&&(0,a.jsx)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"No badges created yet"})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"achievements",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Achievements"}),(0,a.jsxs)(ej.Dialog,{open:l,onOpenChange:r,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-achievement",children:"Create Achievement"})}),(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create New Achievement"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);D.mutate({name:a.get("name"),description:a.get("description"),criteria:a.get("criteria"),rewardCoins:parseInt(a.get("rewardCoins"))})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"ach-name",children:"Achievement Name"}),(0,a.jsx)(h.Input,{id:"ach-name",name:"name",required:!0,"data-testid":"input-achievement-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"ach-description",children:"Description"}),(0,a.jsx)(h.Input,{id:"ach-description",name:"description",required:!0,"data-testid":"input-achievement-description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"criteria",children:"Criteria"}),(0,a.jsx)(h.Input,{id:"criteria",name:"criteria",required:!0,"data-testid":"input-achievement-criteria"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"rewardCoins",children:"Reward Coins"}),(0,a.jsx)(h.Input,{id:"rewardCoins",name:"rewardCoins",type:"number",required:!0,"data-testid":"input-achievement-reward"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:D.isPending,"data-testid":"button-submit-achievement",children:D.isPending?"Creating...":"Create Achievement"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:b?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Description"}),(0,a.jsx)(Z.TableHead,{children:"Criteria"}),(0,a.jsx)(Z.TableHead,{children:"Reward"}),(0,a.jsx)(Z.TableHead,{children:"Completion Rate"})]})}),(0,a.jsxs)(Z.TableBody,{children:[v.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`achievement-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-medium","data-testid":`achievement-name-${e.id}`,children:e.name}),(0,a.jsx)(Z.TableCell,{children:e.description}),(0,a.jsx)(Z.TableCell,{children:e.criteria}),(0,a.jsxs)(Z.TableCell,{children:[e.rewardCoins," coins"]}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:[e.completionRate||0,"%"]})})]},e.id)),0===v.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No achievements created"})})]})]})})})})]}),(0,a.jsxs)(eS.TabsContent,{value:"leaderboards",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Leaderboards"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(eu.Select,{value:d,onValueChange:n,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-48","data-testid":"select-leaderboard-type",children:(0,a.jsx)(eu.SelectValue,{})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"contributors",children:"Top Contributors"}),(0,a.jsx)(eu.SelectItem,{value:"earners",children:"Top Earners"}),(0,a.jsx)(eu.SelectItem,{value:"uploaders",children:"Top Uploaders"})]})]}),(0,a.jsxs)(eu.Select,{value:c,onValueChange:o,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-40","data-testid":"select-time-period",children:(0,a.jsx)(eu.SelectValue,{})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"weekly",children:"Weekly"}),(0,a.jsx)(eu.SelectItem,{value:"monthly",children:"Monthly"}),(0,a.jsx)(eu.SelectItem,{value:"all-time",children:"All Time"})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:C?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[...Array(10)].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{className:"w-20",children:"Rank"}),(0,a.jsx)(Z.TableHead,{children:"User"}),(0,a.jsx)(Z.TableHead,{children:"Score"})]})}),(0,a.jsxs)(Z.TableBody,{children:[T.map((e,s)=>(0,a.jsxs)(Z.TableRow,{"data-testid":`leaderboard-${s}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s<3&&(0,a.jsx)(V.Trophy,{className:`w-4 h-4 ${0===s?"text-yellow-500":1===s?"text-gray-400":"text-amber-700"}`}),(0,a.jsxs)("span",{className:"font-semibold",children:["#",s+1]})]})}),(0,a.jsx)(Z.TableCell,{"data-testid":`leaderboard-user-${s}`,children:e.username}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{children:e.score})})]},e.id)),0===T.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:3,className:"text-center text-muted-foreground py-8",children:"No data available"})})]})]})})})})]}),(0,a.jsxs)(eS.TabsContent,{value:"goals",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"User Goals Analytics"}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Goal Completion Rate"})}),(0,a.jsx)(J.CardContent,{children:k?(0,a.jsx)(j.Skeleton,{className:"h-64"}):A.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:A,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"completionRate",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Top Goals by Participation"})}),(0,a.jsx)(J.CardContent,{children:N?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):w.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:w,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"name"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"participants",fill:"hsl(var(--primary))"})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]})]})}var aa=e.i(78917);function as(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(""),[l,r]=(0,i.useState)(!1),[d,n]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null),{data:m,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/seo/content",s]}),p=Array.isArray(m)?m:[],{data:g,isLoading:b}=(0,Y.useQuery)({queryKey:["/api/admin/seo/campaigns"]}),v=Array.isArray(g)?g:[],{data:y,isLoading:C}=(0,Y.useQuery)({queryKey:["/api/admin/seo/campaign-stats"]}),T=y||{reach:0,conversions:0,roi:0},{data:f,isLoading:N}=(0,Y.useQuery)({queryKey:["/api/admin/seo/search-rankings"]}),w=Array.isArray(f)?f:[],{data:S,isLoading:k}=(0,Y.useQuery)({queryKey:["/api/admin/seo/top-queries"]}),A=Array.isArray(S)?S:[],{data:H,isLoading:D}=(0,Y.useQuery)({queryKey:["/api/admin/seo/sitemap-status"]}),R=H||{totalUrls:0},q=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/seo/meta/${e.id}`,"PATCH",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/seo/content"]}),e({title:"Meta tags updated successfully"}),r(!1)}}),B=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/seo/campaigns","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/seo/campaigns"]}),ey.queryClient.invalidateQueries({queryKey:["/api/admin/seo/campaign-stats"]}),e({title:"Campaign created successfully"}),n(!1)}}),I=(0,em.useMutation)({mutationFn:()=>(0,ey.apiRequest)("/api/admin/seo/sitemap/generate","POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/seo/sitemap-status"]}),e({title:"Sitemap generated successfully"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"SEO & Marketing"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"meta",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"meta","data-testid":"tab-meta",children:"Meta Tags"}),(0,a.jsx)(eS.TabsTrigger,{value:"campaigns","data-testid":"tab-campaigns",children:"Campaigns"}),(0,a.jsx)(eS.TabsTrigger,{value:"analytics","data-testid":"tab-seo-analytics",children:"SEO Analytics"})]}),(0,a.jsxs)(eS.TabsContent,{value:"meta",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Meta Tags Management"}),(0,a.jsxs)("div",{className:"relative w-full md:w-auto md:min-w-80",children:[(0,a.jsx)(U.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(h.Input,{placeholder:"Search content...",value:s,onChange:e=>t(e.target.value),className:"pl-10","data-testid":"input-search-content"})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:u?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Title"}),(0,a.jsx)(Z.TableHead,{children:"Type"}),(0,a.jsx)(Z.TableHead,{children:"Meta Title"}),(0,a.jsx)(Z.TableHead,{children:"Meta Description"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[p.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`content-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-medium max-w-xs truncate","data-testid":`content-title-${e.id}`,children:e.title}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"secondary",children:e.type})}),(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.metaTitle||"-"}),(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.metaDescription||"-"}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>{o(e),r(!0)},"data-testid":`button-edit-meta-${e.id}`,children:"Edit Meta"})})]},e.id)),0===p.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No content found"})})]})]})})})}),(0,a.jsx)(ej.Dialog,{open:l,onOpenChange:r,children:(0,a.jsxs)(ej.DialogContent,{className:"max-w-2xl",children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Edit Meta Tags"})}),c&&(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);q.mutate({id:c.id,title:a.get("title"),description:a.get("description"),keywords:a.get("keywords")})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"title",children:"Meta Title"}),(0,a.jsx)(h.Input,{id:"title",name:"title",defaultValue:c.metaTitle,maxLength:60,"data-testid":"input-meta-title"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recommended: 50-60 characters"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"description",children:"Meta Description"}),(0,a.jsx)(eF.Textarea,{id:"description",name:"description",defaultValue:c.metaDescription,maxLength:160,rows:3,"data-testid":"textarea-meta-description"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recommended: 150-160 characters"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"keywords",children:"Keywords (comma-separated)"}),(0,a.jsx)(h.Input,{id:"keywords",name:"keywords",defaultValue:c.metaKeywords,"data-testid":"input-meta-keywords"})]}),(0,a.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Search Result Preview"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-sm text-blue-600 hover:underline cursor-pointer",children:c.metaTitle||c.title}),(0,a.jsx)("div",{className:"text-xs text-green-700",children:"https://yoforex.com/..."}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:c.metaDescription||"No description provided"})]})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:q.isPending,"data-testid":"button-save-meta",children:q.isPending?"Saving...":"Save Changes"})})]})]})})]}),(0,a.jsxs)(eS.TabsContent,{value:"campaigns",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Marketing Campaigns"}),(0,a.jsxs)(ej.Dialog,{open:d,onOpenChange:n,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-campaign",children:"Create Campaign"})}),(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create Marketing Campaign"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);B.mutate({name:a.get("name"),description:a.get("description"),startDate:a.get("startDate"),endDate:a.get("endDate"),budget:parseFloat(a.get("budget"))})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"camp-name",children:"Campaign Name"}),(0,a.jsx)(h.Input,{id:"camp-name",name:"name",required:!0,"data-testid":"input-campaign-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"camp-description",children:"Description"}),(0,a.jsx)(eF.Textarea,{id:"camp-description",name:"description",required:!0,"data-testid":"textarea-campaign-description"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsx)(h.Input,{id:"startDate",name:"startDate",type:"date",required:!0,"data-testid":"input-campaign-start"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"endDate",children:"End Date"}),(0,a.jsx)(h.Input,{id:"endDate",name:"endDate",type:"date",required:!0,"data-testid":"input-campaign-end"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"budget",children:"Budget ($)"}),(0,a.jsx)(h.Input,{id:"budget",name:"budget",type:"number",step:"0.01",required:!0,"data-testid":"input-campaign-budget"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:B.isPending,"data-testid":"button-submit-campaign",children:B.isPending?"Creating...":"Create Campaign"})})]})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:C?[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-campaign-reach",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Total Reach"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-campaign-reach",children:T.reach.toLocaleString()})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-campaign-conversions",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Conversions"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-campaign-conversions",children:T.conversions})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-campaign-roi",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"ROI"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-campaign-roi",children:[T.roi,"%"]})})]})]})}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:b?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Start Date"}),(0,a.jsx)(Z.TableHead,{children:"End Date"}),(0,a.jsx)(Z.TableHead,{children:"Budget"}),(0,a.jsx)(Z.TableHead,{children:"Performance"})]})}),(0,a.jsxs)(Z.TableBody,{children:[v.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`campaign-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-medium","data-testid":`campaign-name-${e.id}`,children:e.name}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"active"===e.status?"default":"secondary",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:new Date(e.startDate).toLocaleDateString()}),(0,a.jsx)(Z.TableCell,{children:new Date(e.endDate).toLocaleDateString()}),(0,a.jsxs)(Z.TableCell,{children:["$",e.budget.toLocaleString()]}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"outline",children:[e.performance||0,"% CTR"]})})]},e.id)),0===v.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No campaigns created"})})]})]})})})})]}),(0,a.jsxs)(eS.TabsContent,{value:"analytics",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"SEO Analytics"}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Search Rankings"})}),(0,a.jsx)(J.CardContent,{children:N?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Page"}),(0,a.jsx)(Z.TableHead,{children:"Keyword"}),(0,a.jsx)(Z.TableHead,{children:"Position"}),(0,a.jsx)(Z.TableHead,{children:"Change"})]})}),(0,a.jsxs)(Z.TableBody,{children:[w.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.page}),(0,a.jsx)(Z.TableCell,{children:e.keyword}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:["#",e.position]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:(e.change??0)>0?"default":"destructive",children:[(e.change??0)>0?"+":"",e.change??0]})})]},e.id)),0===w.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No ranking data available"})})]})]})})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Top Search Queries"})}),(0,a.jsx)(J.CardContent,{children:k?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Query"}),(0,a.jsx)(Z.TableHead,{children:"Impressions"}),(0,a.jsx)(Z.TableHead,{children:"Clicks"}),(0,a.jsx)(Z.TableHead,{children:"CTR"})]})}),(0,a.jsxs)(Z.TableBody,{children:[A.map((e,s)=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-medium",children:e.query}),(0,a.jsx)(Z.TableCell,{children:e.impressions.toLocaleString()}),(0,a.jsx)(Z.TableCell,{children:e.clicks.toLocaleString()}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"outline",children:[e.ctr,"%"]})})]},s)),0===A.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No query data available"})})]})]})})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsx)(J.CardTitle,{children:"Sitemap Status"}),(0,a.jsxs)(x.Button,{onClick:()=>I.mutate(),disabled:I.isPending,"data-testid":"button-generate-sitemap",children:[(0,a.jsx)(F.FileText,{className:"w-4 h-4 mr-2"}),"Generate Sitemap"]})]}),(0,a.jsx)(J.CardContent,{children:D?(0,a.jsx)(j.Skeleton,{className:"h-20"}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Last Generated:"}),(0,a.jsx)("span",{className:"font-medium",children:R.lastGenerated?(0,ea.formatDistanceToNow)(new Date(R.lastGenerated),{addSuffix:!0}):"Never"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total URLs:"}),(0,a.jsx)(ex.Badge,{variant:"secondary",children:R.totalUrls})]}),R.sitemapUrl&&(0,a.jsx)("div",{className:"flex items-center gap-2 pt-2",children:(0,a.jsxs)("a",{href:R.sitemapUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline flex items-center gap-1",children:["View Sitemap ",(0,a.jsx)(aa.ExternalLink,{className:"w-3 h-3"})]})})]})})]})]})]})]})}var at=e.i(77148),ai=e.i(34161);let al=(0,d.default)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]),ar=(0,d.default)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),ad=[{id:"user.created",label:"User Created"},{id:"user.updated",label:"User Updated"},{id:"content.published",label:"Content Published"},{id:"content.deleted",label:"Content Deleted"},{id:"transaction.completed",label:"Transaction Completed"},{id:"comment.posted",label:"Comment Posted"}];function an(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(!1),[l,r]=(0,i.useState)(!1),[d,n]=(0,i.useState)(null),[c,o]=(0,i.useState)([]),[m,u]=(0,i.useState)("all"),[p,g]=(0,i.useState)("all"),[b,v]=(0,i.useState)("all"),{data:y,isLoading:C}=(0,Y.useQuery)({queryKey:["/api/admin/integrations/api-keys"]}),T=Array.isArray(y)?y:[],{data:f,isLoading:N}=(0,Y.useQuery)({queryKey:["/api/admin/integrations/webhooks"]}),w=Array.isArray(f)?f:[],{data:S,isLoading:k}=(0,Y.useQuery)({queryKey:["/api/admin/integrations/event-logs",m,p,b]}),A=Array.isArray(S)?S:[],H=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/integrations/api-keys","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/api-keys"]}),e({title:"API key created successfully"}),t(!1)}}),D=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/integrations/api-keys/${e}/revoke`,"DELETE"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/api-keys"]}),e({title:"API key revoked"}),n(null)}}),R=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/integrations/webhooks","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/webhooks"]}),e({title:"Webhook created successfully"}),r(!1),o([])}}),F=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/integrations/webhooks/${e}/test`,"POST"),onSuccess:()=>{e({title:"Test webhook sent"})}}),q=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/integrations/event-logs/${e}/retry`,"POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/event-logs"]}),e({title:"Event retry initiated"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"API & Integrations"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"api-keys",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"api-keys","data-testid":"tab-api-keys",children:"API Keys"}),(0,a.jsx)(eS.TabsTrigger,{value:"webhooks","data-testid":"tab-webhooks",children:"Webhooks"}),(0,a.jsx)(eS.TabsTrigger,{value:"event-logs","data-testid":"tab-event-logs",children:"Event Logs"})]}),(0,a.jsxs)(eS.TabsContent,{value:"api-keys",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"API Keys"}),(0,a.jsxs)(ej.Dialog,{open:s,onOpenChange:t,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(x.Button,{"data-testid":"button-create-api-key",children:[(0,a.jsx)(ai.Key,{className:"w-4 h-4 mr-2"}),"Create API Key"]})}),(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create API Key"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);H.mutate({name:a.get("name"),permissions:a.get("permissions"),rateLimit:parseInt(a.get("rateLimit"))})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"key-name",children:"Name"}),(0,a.jsx)(h.Input,{id:"key-name",name:"name",required:!0,"data-testid":"input-api-key-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"permissions",children:"Permissions"}),(0,a.jsxs)(eu.Select,{name:"permissions",required:!0,children:[(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-api-key-permissions",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select permissions"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"read",children:"Read Only"}),(0,a.jsx)(eu.SelectItem,{value:"write",children:"Read & Write"}),(0,a.jsx)(eu.SelectItem,{value:"admin",children:"Admin"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"rateLimit",children:"Rate Limit (requests/hour)"}),(0,a.jsx)(h.Input,{id:"rateLimit",name:"rateLimit",type:"number",defaultValue:"1000",required:!0,"data-testid":"input-api-key-rate-limit"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:H.isPending,"data-testid":"button-submit-api-key",children:H.isPending?"Creating...":"Create API Key"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:C?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Key"}),(0,a.jsx)(Z.TableHead,{children:"Permissions"}),(0,a.jsx)(Z.TableHead,{children:"Rate Limit"}),(0,a.jsx)(Z.TableHead,{children:"Last Used"}),(0,a.jsx)(Z.TableHead,{children:"Usage"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[T.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`api-key-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-medium","data-testid":`api-key-name-${e.id}`,children:e.name}),(0,a.jsxs)(Z.TableCell,{className:"font-mono text-xs",children:[e.key.substring(0,12),"...",e.key.substring(e.key.length-4)]}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.permissions})}),(0,a.jsxs)(Z.TableCell,{children:[e.rateLimit,"/hr"]}),(0,a.jsx)(Z.TableCell,{children:e.lastUsedAt?(0,ea.formatDistanceToNow)(new Date(e.lastUsedAt),{addSuffix:!0}):"Never"}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:[e.usageCount||0," requests"]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"destructive",onClick:()=>n(e.id),"data-testid":`button-revoke-${e.id}`,children:"Revoke"})})]},e.id)),0===T.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No API keys created"})})]})]})})})}),(0,a.jsx)(at.AlertDialog,{open:!!d,onOpenChange:e=>!e&&n(null),children:(0,a.jsxs)(at.AlertDialogContent,{children:[(0,a.jsxs)(at.AlertDialogHeader,{children:[(0,a.jsx)(at.AlertDialogTitle,{children:"Revoke API Key"}),(0,a.jsx)(at.AlertDialogDescription,{children:"Are you sure you want to revoke this API key? This action cannot be undone and will immediately invalidate the key."})]}),(0,a.jsxs)(at.AlertDialogFooter,{children:[(0,a.jsx)(at.AlertDialogCancel,{"data-testid":"button-cancel-revoke",children:"Cancel"}),(0,a.jsx)(at.AlertDialogAction,{onClick:()=>d&&D.mutate(d),"data-testid":"button-confirm-revoke",children:"Revoke"})]})]})})]}),(0,a.jsxs)(eS.TabsContent,{value:"webhooks",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Webhooks"}),(0,a.jsxs)(ej.Dialog,{open:l,onOpenChange:r,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(x.Button,{"data-testid":"button-create-webhook",children:[(0,a.jsx)(al,{className:"w-4 h-4 mr-2"}),"Create Webhook"]})}),(0,a.jsxs)(ej.DialogContent,{className:"max-w-2xl",children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create Webhook"})}),(0,a.jsxs)("form",{onSubmit:a=>{a.preventDefault();let s=new FormData(a.currentTarget);0===c.length?e({title:"Please select at least one event",variant:"destructive"}):R.mutate({url:s.get("url"),events:c,secret:s.get("secret")})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"url",children:"Webhook URL"}),(0,a.jsx)(h.Input,{id:"url",name:"url",type:"url",placeholder:"https://example.com/webhook",required:!0,"data-testid":"input-webhook-url"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{children:"Events"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 p-4 border rounded-lg",children:ad.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eB.Checkbox,{id:e.id,checked:c.includes(e.id),onCheckedChange:a=>{o(a?[...c,e.id]:c.filter(a=>a!==e.id))},"data-testid":`checkbox-event-${e.id}`}),(0,a.jsx)(eZ.Label,{htmlFor:e.id,className:"text-sm cursor-pointer",children:e.label})]},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"secret",children:"Secret (optional)"}),(0,a.jsx)(h.Input,{id:"secret",name:"secret",placeholder:"Webhook signing secret","data-testid":"input-webhook-secret"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used to verify webhook authenticity"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:R.isPending,"data-testid":"button-submit-webhook",children:R.isPending?"Creating...":"Create Webhook"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:N?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"URL"}),(0,a.jsx)(Z.TableHead,{children:"Events"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Success"}),(0,a.jsx)(Z.TableHead,{children:"Failures"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[w.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`webhook-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-mono text-xs max-w-xs truncate","data-testid":`webhook-url-${e.id}`,children:e.url}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.events?.slice(0,2).map(e=>(0,a.jsx)(ex.Badge,{variant:"secondary",className:"text-xs",children:e},e)),(e.events?.length??0)>2&&(0,a.jsxs)(ex.Badge,{variant:"secondary",className:"text-xs",children:["+",(e.events?.length??0)-2]})]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:e.active?"default":"secondary",children:e.active?"Active":"Inactive"})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"outline",children:e.successCount||0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:(e.failureCount??0)>0?"destructive":"outline",children:e.failureCount||0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>F.mutate(e.id),disabled:F.isPending,"data-testid":`button-test-webhook-${e.id}`,children:"Test"})})]},e.id)),0===w.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No webhooks configured"})})]})]})})})})]}),(0,a.jsxs)(eS.TabsContent,{value:"event-logs",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Event Logs"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(eu.Select,{value:m,onValueChange:u,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-48","data-testid":"select-filter-webhook",children:(0,a.jsx)(eu.SelectValue,{placeholder:"All Webhooks"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Webhooks"}),w.map(e=>(0,a.jsxs)(eu.SelectItem,{value:e.id,children:[e.url.substring(0,30),"..."]},e.id))]})]}),(0,a.jsxs)(eu.Select,{value:p,onValueChange:g,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-48","data-testid":"select-filter-event-type",children:(0,a.jsx)(eu.SelectValue,{placeholder:"All Events"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Events"}),ad.map(e=>(0,a.jsx)(eu.SelectItem,{value:e.id,children:e.label},e.id))]})]}),(0,a.jsxs)(eu.Select,{value:b,onValueChange:v,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-40","data-testid":"select-filter-status",children:(0,a.jsx)(eu.SelectValue,{placeholder:"All Status"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(eu.SelectItem,{value:"success",children:"Success"}),(0,a.jsx)(eu.SelectItem,{value:"failed",children:"Failed"}),(0,a.jsx)(eu.SelectItem,{value:"pending",children:"Pending"})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:k?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[...Array(10)].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Event Type"}),(0,a.jsx)(Z.TableHead,{children:"Webhook"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Response"}),(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[A.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"secondary",children:e.eventType})}),(0,a.jsx)(Z.TableCell,{className:"font-mono text-xs max-w-xs truncate",children:e.webhookUrl}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"success"===e.status?"default":"failed"===e.status?"destructive":"secondary",children:e.status})}),(0,a.jsx)(Z.TableCell,{className:"max-w-xs truncate",children:e.response||"-"}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:"failed"===e.status&&(0,a.jsxs)(x.Button,{size:"sm",variant:"outline",onClick:()=>q.mutate(e.id),disabled:q.isPending,"data-testid":`button-retry-${e.id}`,children:[(0,a.jsx)(ar,{className:"w-3 h-3 mr-1"}),"Retry"]})})]},e.id)),0===A.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No event logs found"})})]})]})})})})]})]})]})}var ac=e.i(45423);let ao=["hsl(var(--primary))","hsl(var(--accent))","hsl(var(--muted))","hsl(var(--destructive))"];function ax(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)("all"),{data:l,isLoading:r}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/notification-history"]}),d=Array.isArray(l)?l:[],{data:n,isLoading:c}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/app-versions"]}),o=Array.isArray(n)?n:[],{data:m,isLoading:u}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/version-distribution"]}),p=Array.isArray(m)?m:[],{data:g,isLoading:b}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/device-types"]}),v=Array.isArray(g)?g:[],{data:y,isLoading:C}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/os-distribution"]}),T=Array.isArray(y)?y:[],{data:f,isLoading:N}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/browser-distribution"]}),w=Array.isArray(f)?f:[],{data:S,isLoading:k}=(0,Y.useQuery)({queryKey:["/api/admin/mobile/screen-resolutions"]}),A=Array.isArray(S)?S:[],H=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/mobile/send-notification","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/mobile/notification-history"]}),e({title:"Notification sent successfully"})}}),D=(0,em.useMutation)({mutationFn:({id:e,forceUpdate:a})=>(0,ey.apiRequest)(`/api/admin/mobile/app-versions/${e}/force-update`,"PATCH",{forceUpdate:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/mobile/app-versions"]}),e({title:"Force update setting updated"})}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Mobile & Push Notifications"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"push",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"push","data-testid":"tab-push",children:"Push Notifications"}),(0,a.jsx)(eS.TabsTrigger,{value:"versions","data-testid":"tab-versions",children:"App Versions"}),(0,a.jsx)(eS.TabsTrigger,{value:"analytics","data-testid":"tab-device-analytics",children:"Device Analytics"})]}),(0,a.jsxs)(eS.TabsContent,{value:"push",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Send Push Notification"}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"pt-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);H.mutate({title:a.get("title"),body:a.get("body"),targetType:s,targetValue:a.get("targetValue")})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"title",children:"Notification Title"}),(0,a.jsx)(h.Input,{id:"title",name:"title",required:!0,"data-testid":"input-notification-title"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"body",children:"Notification Body"}),(0,a.jsx)(eF.Textarea,{id:"body",name:"body",rows:3,required:!0,"data-testid":"textarea-notification-body"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{children:"Target"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eB.Checkbox,{id:"target-all",checked:"all"===s,onCheckedChange:()=>t("all"),"data-testid":"checkbox-target-all"}),(0,a.jsx)(eZ.Label,{htmlFor:"target-all",className:"cursor-pointer",children:"All Users"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eB.Checkbox,{id:"target-segments",checked:"segments"===s,onCheckedChange:()=>t("segments"),"data-testid":"checkbox-target-segments"}),(0,a.jsx)(eZ.Label,{htmlFor:"target-segments",className:"cursor-pointer",children:"Specific Segments"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eB.Checkbox,{id:"target-users",checked:"users"===s,onCheckedChange:()=>t("users"),"data-testid":"checkbox-target-users"}),(0,a.jsx)(eZ.Label,{htmlFor:"target-users",className:"cursor-pointer",children:"Specific User IDs"})]})]})]}),("segments"===s||"users"===s)&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"targetValue",children:"segments"===s?"Segment Names (comma-separated)":"User IDs (comma-separated)"}),(0,a.jsx)(h.Input,{id:"targetValue",name:"targetValue",placeholder:"segments"===s?"premium, active-traders":"user-123, user-456","data-testid":"input-target-value"})]}),(0,a.jsxs)(x.Button,{type:"submit",disabled:H.isPending,"data-testid":"button-send-notification",children:[(0,a.jsx)(ac.Bell,{className:"w-4 h-4 mr-2"}),H.isPending?"Sending...":"Send Notification"]})]})})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Notification History"})}),(0,a.jsx)(J.CardContent,{children:r?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Title"}),(0,a.jsx)(Z.TableHead,{children:"Target"}),(0,a.jsx)(Z.TableHead,{children:"Delivered"}),(0,a.jsx)(Z.TableHead,{children:"Opened"}),(0,a.jsx)(Z.TableHead,{children:"CTR"}),(0,a.jsx)(Z.TableHead,{children:"Sent At"})]})}),(0,a.jsxs)(Z.TableBody,{children:[d.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-medium max-w-xs truncate",children:e.title}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"secondary",children:e.targetType})}),(0,a.jsx)(Z.TableCell,{children:e.deliveredCount}),(0,a.jsx)(Z.TableCell,{children:e.openedCount}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"outline",children:[e.ctr,"%"]})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.sentAt),{addSuffix:!0})})]},e.id)),0===d.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No notifications sent yet"})})]})]})})})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"versions",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"App Versions"}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:c?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Version"}),(0,a.jsx)(Z.TableHead,{children:"Platform"}),(0,a.jsx)(Z.TableHead,{children:"Release Date"}),(0,a.jsx)(Z.TableHead,{children:"Users"}),(0,a.jsx)(Z.TableHead,{children:"Force Update"})]})}),(0,a.jsxs)(Z.TableBody,{children:[o.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`version-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-medium",children:e.version}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"secondary",children:e.platform})}),(0,a.jsx)(Z.TableCell,{children:new Date(e.releaseDate).toLocaleDateString()}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"outline",children:[e.userCount," users"]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(eY.Switch,{checked:e.forceUpdate,onCheckedChange:a=>D.mutate({id:e.id,forceUpdate:a}),"data-testid":`switch-force-update-${e.id}`})})]},e.id)),0===o.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No app versions found"})})]})]})})})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"User Distribution by Version"})}),(0,a.jsx)(J.CardContent,{children:u?(0,a.jsx)(j.Skeleton,{className:"h-64"}):p.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:p,cx:"50%",cy:"50%",labelLine:!1,label:e=>`v${e.version}: ${e.percentage}%`,outerRadius:80,fill:"hsl(var(--primary))",dataKey:"count",children:p.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:ao[s%ao.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"analytics",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Device Analytics"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Device Types"})}),(0,a.jsx)(J.CardContent,{children:b?(0,a.jsx)(j.Skeleton,{className:"h-64"}):v.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(eE.PieChart,{children:[(0,a.jsx)(eQ.Pie,{data:v,cx:"50%",cy:"50%",labelLine:!1,label:e=>`${e.name}: ${e.percentage}%`,outerRadius:80,fill:"hsl(var(--primary))",dataKey:"value",children:v.map((e,s)=>(0,a.jsx)(eV.Cell,{fill:ao[s%ao.length]},`cell-${s}`))}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(eG.Legend,{})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"OS Distribution"})}),(0,a.jsx)(J.CardContent,{children:C?(0,a.jsx)(j.Skeleton,{className:"h-64"}):T.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:T,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"name"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Browser Distribution"})}),(0,a.jsx)(J.CardContent,{children:N?(0,a.jsx)(j.Skeleton,{className:"h-64"}):w.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:w,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"name"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Screen Resolutions"})}),(0,a.jsx)(J.CardContent,{children:k?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-8"},s))}):A.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Resolution"}),(0,a.jsx)(Z.TableHead,{children:"Users"}),(0,a.jsx)(Z.TableHead,{children:"Percentage"})]})}),(0,a.jsx)(Z.TableBody,{children:A.map((e,s)=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-medium",children:e.resolution}),(0,a.jsx)(Z.TableCell,{children:e.count}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:[e.percentage,"%"]})})]},s))})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]})]})]})}let ah=(0,d.default)("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),am=(0,d.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function au(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(!1),[l,r]=(0,i.useState)(!1),{data:d,isLoading:n}=(0,Y.useQuery)({queryKey:["/api/admin/performance/system-metrics"]}),c=d||{cpu:0,memory:0,diskIO:0,network:0},{data:o,isLoading:m}=(0,Y.useQuery)({queryKey:["/api/admin/performance/response-time"]}),u=Array.isArray(o)?o:[],{data:p,isLoading:g}=(0,Y.useQuery)({queryKey:["/api/admin/performance/throughput"]}),b=Array.isArray(p)?p:[],{data:v,isLoading:y}=(0,Y.useQuery)({queryKey:["/api/admin/performance/alerts"]}),C=Array.isArray(v)?v:[],{data:T,isLoading:f}=(0,Y.useQuery)({queryKey:["/api/admin/performance/alert-history"]}),N=Array.isArray(T)?T:[],{data:w,isLoading:S}=(0,Y.useQuery)({queryKey:["/api/admin/performance/slow-queries"]}),k=Array.isArray(w)?w:[],{data:A,isLoading:H}=(0,Y.useQuery)({queryKey:["/api/admin/performance/database-metrics"]}),D=A||{avgQueryTime:0,activeConnections:0,maxConnections:0,poolUsage:0},{data:R,isLoading:F}=(0,Y.useQuery)({queryKey:["/api/admin/performance/query-histogram"]}),q=Array.isArray(R)?R:[],{data:B,isLoading:I}=(0,Y.useQuery)({queryKey:["/api/admin/performance/cache-stats"]}),L=B||{hitRate:0,hits:0,misses:0,size:0,keyCount:0},{data:P,isLoading:K}=(0,Y.useQuery)({queryKey:["/api/admin/performance/cached-keys"]}),M=Array.isArray(P)?P:[],$=(0,em.useMutation)({mutationFn:()=>(0,ey.apiRequest)("/api/admin/performance/record-metric","POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/performance/system-metrics"]}),e({title:"Metric recorded"})}}),E=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/performance/alerts","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/performance/alerts"]}),e({title:"Alert threshold configured"}),t(!1)}}),Q=(0,em.useMutation)({mutationFn:()=>(0,ey.apiRequest)("/api/admin/performance/cache/clear","DELETE"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/performance/cache-stats"]}),ey.queryClient.invalidateQueries({queryKey:["/api/admin/performance/cached-keys"]}),e({title:"Cache cleared successfully"}),r(!1)}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Performance Monitor"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"metrics",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"metrics","data-testid":"tab-metrics",children:"Metrics"}),(0,a.jsx)(eS.TabsTrigger,{value:"alerts","data-testid":"tab-alerts",children:"Alerts"}),(0,a.jsx)(eS.TabsTrigger,{value:"database","data-testid":"tab-database",children:"Database Performance"}),(0,a.jsx)(eS.TabsTrigger,{value:"cache","data-testid":"tab-cache",children:"Cache Stats"})]}),(0,a.jsxs)(eS.TabsContent,{value:"metrics",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"System Metrics"}),(0,a.jsxs)(x.Button,{onClick:()=>$.mutate(),disabled:$.isPending,"data-testid":"button-record-metric",children:[(0,a.jsx)(W.Activity,{className:"w-4 h-4 mr-2"}),"Record Metric"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:n?[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-cpu",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"CPU Usage"}),(0,a.jsx)(ah,{className:"w-4 h-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-cpu-usage",children:[c.cpu,"%"]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-memory",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Memory Usage"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-memory-usage",children:[c.memory,"%"]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-disk",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Disk I/O"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-disk-io",children:[c.diskIO," MB/s"]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-network",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Network"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-network",children:[c.network," MB/s"]})})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Response Time (Last 24 Hours)"})}),(0,a.jsx)(J.CardContent,{children:m?(0,a.jsx)(j.Skeleton,{className:"h-64"}):u.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:u,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"time"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"responseTime",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Throughput (Requests/Second)"})}),(0,a.jsx)(J.CardContent,{children:g?(0,a.jsx)(j.Skeleton,{className:"h-64"}):b.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(es.LineChart,{data:b,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"time"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(et.Line,{type:"monotone",dataKey:"rps",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"alerts",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Performance Alerts"}),(0,a.jsxs)(ej.Dialog,{open:s,onOpenChange:t,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-configure-alert",children:"Configure Alert"})}),(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Configure Alert Threshold"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget);E.mutate({metricType:a.get("metricType"),threshold:parseFloat(a.get("threshold")),condition:a.get("condition")})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"metricType",children:"Metric Type"}),(0,a.jsx)(h.Input,{id:"metricType",name:"metricType",required:!0,"data-testid":"input-metric-type"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"threshold",children:"Threshold Value"}),(0,a.jsx)(h.Input,{id:"threshold",name:"threshold",type:"number",step:"0.01",required:!0,"data-testid":"input-threshold"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"condition",children:"Condition"}),(0,a.jsx)(h.Input,{id:"condition",name:"condition",placeholder:"e.g., greater than",required:!0,"data-testid":"input-condition"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:E.isPending,"data-testid":"button-submit-alert",children:E.isPending?"Configuring...":"Configure Alert"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:y?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Metric"}),(0,a.jsx)(Z.TableHead,{children:"Condition"}),(0,a.jsx)(Z.TableHead,{children:"Threshold"}),(0,a.jsx)(Z.TableHead,{children:"Current Value"}),(0,a.jsx)(Z.TableHead,{children:"Status"})]})}),(0,a.jsxs)(Z.TableBody,{children:[C.map(e=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-medium",children:e.metricType}),(0,a.jsx)(Z.TableCell,{children:e.condition}),(0,a.jsx)(Z.TableCell,{children:e.threshold}),(0,a.jsx)(Z.TableCell,{children:e.currentValue}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:e.triggered?"destructive":"default",children:e.triggered?"Triggered":"OK"})})]},e.id)),0===C.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No alerts configured"})})]})]})})})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Alert History"})}),(0,a.jsx)(J.CardContent,{children:f?(0,a.jsx)(j.Skeleton,{className:"h-64"}):N.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:N,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"date"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"count",fill:"hsl(var(--destructive))"})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No alert history"})})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"database",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Database Performance"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:H?[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-query-time",children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Avg Query Time"}),(0,a.jsx)(am,{className:"w-4 h-4 text-muted-foreground"})]}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-query-time",children:[D.avgQueryTime,"ms"]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-connections",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Active Connections"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-connections",children:[D.activeConnections," / ",D.maxConnections]})})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-pool-usage",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Pool Usage"})}),(0,a.jsx)(J.CardContent,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-pool-usage",children:[D.poolUsage,"%"]})})]})]})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Slow Queries"})}),(0,a.jsx)(J.CardContent,{children:S?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Query"}),(0,a.jsx)(Z.TableHead,{children:"Execution Time"}),(0,a.jsx)(Z.TableHead,{children:"Calls"}),(0,a.jsx)(Z.TableHead,{children:"Last Run"})]})}),(0,a.jsxs)(Z.TableBody,{children:[k.map((e,s)=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-mono text-xs max-w-md truncate",children:e.query}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"destructive",children:[e.executionTime,"ms"]})}),(0,a.jsx)(Z.TableCell,{children:e.callCount}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.lastRun),{addSuffix:!0})})]},s)),0===k.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No slow queries detected"})})]})]})})})]}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Query Execution Time Histogram"})}),(0,a.jsx)(J.CardContent,{children:F?(0,a.jsx)(j.Skeleton,{className:"h-64"}):q.length>0?(0,a.jsx)(eo.ResponsiveContainer,{width:"100%",height:250,children:(0,a.jsxs)(ei.BarChart,{data:q,children:[(0,a.jsx)(en.CartesianGrid,{strokeDasharray:"3 3"}),(0,a.jsx)(er.XAxis,{dataKey:"range"}),(0,a.jsx)(ed.YAxis,{}),(0,a.jsx)(ec.Tooltip,{}),(0,a.jsx)(el.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]}),(0,a.jsxs)(eS.TabsContent,{value:"cache",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Cache Statistics"}),(0,a.jsxs)(x.Button,{variant:"destructive",onClick:()=>r(!0),"data-testid":"button-clear-cache",children:[(0,a.jsx)(eN.Trash2,{className:"w-4 h-4 mr-2"}),"Clear Cache"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:I?[void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-32"},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(J.Card,{"data-testid":"card-hit-rate",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Cache Hit Rate"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-hit-rate",children:[L.hitRate,"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[L.hits," hits / ",L.misses," misses"]})]})]}),(0,a.jsxs)(J.Card,{"data-testid":"card-cache-size",children:[(0,a.jsx)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,a.jsx)(J.CardTitle,{className:"text-sm font-medium",children:"Cache Size"})}),(0,a.jsxs)(J.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-cache-size",children:[L.size," MB"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[L.keyCount," keys stored"]})]})]})]})}),(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Most Cached Keys"})}),(0,a.jsx)(J.CardContent,{children:K?(0,a.jsx)("div",{className:"space-y-2",children:[...Array(10)].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Key"}),(0,a.jsx)(Z.TableHead,{children:"Hits"}),(0,a.jsx)(Z.TableHead,{children:"Size"}),(0,a.jsx)(Z.TableHead,{children:"TTL"})]})}),(0,a.jsxs)(Z.TableBody,{children:[M.map((e,s)=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-mono text-xs max-w-md truncate",children:e.key}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"secondary",children:e.hits})}),(0,a.jsxs)(Z.TableCell,{children:[e.size," KB"]}),(0,a.jsxs)(Z.TableCell,{children:[e.ttl,"s"]})]},s)),0===M.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No cached keys"})})]})]})})})]})]})]}),(0,a.jsx)(at.AlertDialog,{open:l,onOpenChange:r,children:(0,a.jsxs)(at.AlertDialogContent,{children:[(0,a.jsxs)(at.AlertDialogHeader,{children:[(0,a.jsx)(at.AlertDialogTitle,{children:"Clear Cache"}),(0,a.jsx)(at.AlertDialogDescription,{children:"Are you sure you want to clear the entire cache? This action cannot be undone and may temporarily affect performance."})]}),(0,a.jsxs)(at.AlertDialogFooter,{children:[(0,a.jsx)(at.AlertDialogCancel,{children:"Cancel"}),(0,a.jsx)(at.AlertDialogAction,{onClick:()=>Q.mutate(),className:"bg-destructive hover:bg-destructive/90",children:"Clear Cache"})]})]})})]})}var aj=e.i(69074),ap=e.i(73708);let ag=(0,d.default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function ab(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(""),[l,r]=(0,i.useState)("all"),[d,n]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null),[m,u]=(0,i.useState)(null),[p,g]=(0,i.useState)(""),[b,v]=(0,i.useState)(""),[y,C]=(0,i.useState)(!1),[T,f]=(0,i.useState)(null),{data:N,isLoading:w}=(0,Y.useQuery)({queryKey:["/api/admin/content-studio/media",s,l]}),S=Array.isArray(N)?N:[],{data:k,isLoading:A}=(0,Y.useQuery)({queryKey:["/api/admin/content-studio/revisions",p,b],enabled:!!p&&!!b}),H=Array.isArray(k)?k:[],D=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/content-studio/media/upload","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/media"]}),e({title:"Media uploaded successfully"})}}),R=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/content-studio/media/${e.id}`,"PATCH",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/media"]}),e({title:"Media updated successfully"}),n(!1)}}),q=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/content-studio/media/${e}`,"DELETE"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/media"]}),e({title:"Media deleted successfully"}),o(null)}}),B=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/content-studio/revisions/${e}/restore`,"POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/revisions"]}),e({title:"Revision restored successfully"}),C(!1)}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Content Studio"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"media",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"media","data-testid":"tab-media",children:"Media Library"}),(0,a.jsx)(eS.TabsTrigger,{value:"revisions","data-testid":"tab-revisions",children:"Content Revisions"})]}),(0,a.jsxs)(eS.TabsContent,{value:"media",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Media Library"}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)(h.Input,{placeholder:"Search files...",value:s,onChange:e=>t(e.target.value),className:"w-64","data-testid":"input-search-media"}),(0,a.jsxs)(eu.Select,{value:l,onValueChange:r,children:[(0,a.jsx)(eu.SelectTrigger,{className:"w-40","data-testid":"select-file-type",children:(0,a.jsx)(eu.SelectValue,{})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"all",children:"All Types"}),(0,a.jsx)(eu.SelectItem,{value:"images",children:"Images"}),(0,a.jsx)(eu.SelectItem,{value:"documents",children:"Documents"}),(0,a.jsx)(eu.SelectItem,{value:"videos",children:"Videos"})]})]}),(0,a.jsx)(x.Button,{asChild:!0,"data-testid":"button-upload-media",children:(0,a.jsxs)("label",{className:"cursor-pointer",children:[(0,a.jsx)(aj.Upload,{className:"w-4 h-4 mr-2"}),"Upload File",(0,a.jsx)("input",{type:"file",className:"hidden",onChange:e=>{let a=e.target.files?.[0];if(a){let e=new FormData;e.append("file",a),D.mutate(e)}},accept:"image/*,video/*,.pdf,.doc,.docx"})]})})]})]}),w?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[...Array(8)].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-64"},s))}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[S.map(e=>{var s;return(0,a.jsxs)(J.Card,{"data-testid":`media-card-${e.id}`,children:[(0,a.jsx)(J.CardHeader,{className:"p-0",children:(0,a.jsx)("div",{className:"aspect-video bg-muted rounded-t-lg flex items-center justify-center overflow-hidden",children:e.type?.startsWith("image/")?(0,a.jsx)("img",{src:e.url,alt:e.altText||e.filename,className:"w-full h-full object-cover"}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[(s=e.type).startsWith("image/")?(0,a.jsx)(ap.Image,{className:"w-4 h-4"}):s.startsWith("video/")?(0,a.jsx)(ag,{className:"w-4 h-4"}):(0,a.jsx)(F.FileText,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-xs",children:e.type})]})})}),(0,a.jsxs)(J.CardContent,{className:"pt-4 space-y-2",children:[(0,a.jsx)("div",{className:"font-medium truncate","data-testid":`media-filename-${e.id}`,children:e.filename}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.tags?.map((e,s)=>(0,a.jsx)(ex.Badge,{variant:"secondary",className:"text-xs",children:e},s))}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Used ",e.usageCount||0," times"]})]}),(0,a.jsxs)(J.CardFooter,{className:"flex justify-between gap-2",children:[(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>{u(e),n(!0)},"data-testid":`button-edit-media-${e.id}`,children:"Edit"}),(0,a.jsx)(x.Button,{size:"sm",variant:"destructive",onClick:()=>o(e.id),"data-testid":`button-delete-media-${e.id}`,children:(0,a.jsx)(eN.Trash2,{className:"w-3 h-3"})})]})]},e.id)}),0===S.length&&(0,a.jsx)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"No media files found"})]}),(0,a.jsx)(ej.Dialog,{open:d,onOpenChange:n,children:(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Edit Media"})}),m&&(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget),s=a.get("tags").split(",").map(e=>e.trim()).filter(Boolean);R.mutate({id:m?.id,altText:a.get("altText"),tags:s})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"altText",children:"Alt Text"}),(0,a.jsx)(h.Input,{id:"altText",name:"altText",defaultValue:m.altText,"data-testid":"input-alt-text"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"tags",children:"Tags (comma-separated)"}),(0,a.jsx)(h.Input,{id:"tags",name:"tags",defaultValue:m.tags?.join(", "),placeholder:"tag1, tag2, tag3","data-testid":"input-tags"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:R.isPending,"data-testid":"button-save-media",children:R.isPending?"Saving...":"Save Changes"})})]})]})}),(0,a.jsx)(at.AlertDialog,{open:!!c,onOpenChange:e=>!e&&o(null),children:(0,a.jsxs)(at.AlertDialogContent,{children:[(0,a.jsxs)(at.AlertDialogHeader,{children:[(0,a.jsx)(at.AlertDialogTitle,{children:"Delete Media"}),(0,a.jsx)(at.AlertDialogDescription,{children:"Are you sure you want to delete this media file? This action cannot be undone."})]}),(0,a.jsxs)(at.AlertDialogFooter,{children:[(0,a.jsx)(at.AlertDialogCancel,{"data-testid":"button-cancel-delete",children:"Cancel"}),(0,a.jsx)(at.AlertDialogAction,{onClick:()=>c&&q.mutate(c),"data-testid":"button-confirm-delete",children:"Delete"})]})]})})]}),(0,a.jsxs)(eS.TabsContent,{value:"revisions",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Content Revisions"}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"pt-6 space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"contentType",children:"Content Type"}),(0,a.jsxs)(eu.Select,{value:p,onValueChange:g,children:[(0,a.jsx)(eu.SelectTrigger,{"data-testid":"select-content-type",children:(0,a.jsx)(eu.SelectValue,{placeholder:"Select type"})}),(0,a.jsxs)(eu.SelectContent,{children:[(0,a.jsx)(eu.SelectItem,{value:"thread",children:"Thread"}),(0,a.jsx)(eu.SelectItem,{value:"comment",children:"Comment"}),(0,a.jsx)(eu.SelectItem,{value:"content",children:"Content"}),(0,a.jsx)(eu.SelectItem,{value:"user",children:"User Profile"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"contentId",children:"Content ID"}),(0,a.jsx)(h.Input,{id:"contentId",value:b,onChange:e=>v(e.target.value),placeholder:"Enter content ID","data-testid":"input-content-id"})]})]})})}),p&&b&&(0,a.jsxs)(J.Card,{children:[(0,a.jsx)(J.CardHeader,{children:(0,a.jsx)(J.CardTitle,{children:"Revision History"})}),(0,a.jsx)(J.CardContent,{children:A?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Revision #"}),(0,a.jsx)(Z.TableHead,{children:"Changed By"}),(0,a.jsx)(Z.TableHead,{children:"Changed Fields"}),(0,a.jsx)(Z.TableHead,{children:"Timestamp"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[H.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`revision-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:["#",e.revisionNumber]})}),(0,a.jsx)(Z.TableCell,{children:e.changedBy}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.changedFields?.map((e,s)=>(0,a.jsx)(ex.Badge,{variant:"outline",className:"text-xs",children:e},s))})}),(0,a.jsx)(Z.TableCell,{children:(0,ea.formatDistanceToNow)(new Date(e.timestamp),{addSuffix:!0})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x.Button,{size:"sm",variant:"outline","data-testid":`button-view-diff-${e.id}`,children:[(0,a.jsx)(ew.Eye,{className:"w-3 h-3 mr-1"}),"View Diff"]}),(0,a.jsx)(x.Button,{size:"sm",variant:"default",onClick:()=>{f(e),C(!0)},"data-testid":`button-restore-${e.id}`,children:"Restore"})]})})]},e.id)),0===H.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No revisions found"})})]})]})})})]}),(0,a.jsx)(at.AlertDialog,{open:y,onOpenChange:C,children:(0,a.jsxs)(at.AlertDialogContent,{children:[(0,a.jsxs)(at.AlertDialogHeader,{children:[(0,a.jsx)(at.AlertDialogTitle,{children:"Restore Revision"}),(0,a.jsxs)(at.AlertDialogDescription,{children:["Are you sure you want to restore this revision? This will overwrite the current content with revision #",T?.revisionNumber,"."]})]}),(0,a.jsxs)(at.AlertDialogFooter,{children:[(0,a.jsx)(at.AlertDialogCancel,{"data-testid":"button-cancel-restore",children:"Cancel"}),(0,a.jsx)(at.AlertDialogAction,{onClick:()=>T&&B.mutate(T.id),"data-testid":"button-confirm-restore",children:"Restore"})]})]})})]})]})]})}let av=(0,d.default)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function ay(){let{toast:e}=(0,ep.useToast)(),[s,t]=(0,i.useState)(!1),[l,r]=(0,i.useState)(!1),[d,n]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null),[m,u]=(0,i.useState)([0]),{data:p,isLoading:g}=(0,Y.useQuery)({queryKey:["/api/admin/testing/ab-tests"]}),b=Array.isArray(p)?p:[],{data:v,isLoading:y}=(0,Y.useQuery)({queryKey:["/api/admin/testing/feature-flags"]}),C=Array.isArray(v)?v:[],T=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/testing/ab-tests","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),e({title:"A/B test created successfully"}),t(!1)}}),f=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/testing/ab-tests/${e}/start`,"POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),e({title:"Test started"})}}),N=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)(`/api/admin/testing/ab-tests/${e}/stop`,"POST"),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),e({title:"Test stopped"})}}),w=(0,em.useMutation)({mutationFn:({testId:e,variantId:a})=>(0,ey.apiRequest)(`/api/admin/testing/ab-tests/${e}/winner`,"POST",{variantId:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),e({title:"Winner declared"})}}),S=(0,em.useMutation)({mutationFn:e=>(0,ey.apiRequest)("/api/admin/testing/feature-flags","POST",e),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/feature-flags"]}),e({title:"Feature flag created successfully"}),r(!1)}}),k=(0,em.useMutation)({mutationFn:({id:e,enabled:a})=>(0,ey.apiRequest)(`/api/admin/testing/feature-flags/${e}/toggle`,"PATCH",{enabled:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/feature-flags"]}),e({title:"Feature flag updated"})}}),A=(0,em.useMutation)({mutationFn:({id:e,rollout:a})=>(0,ey.apiRequest)(`/api/admin/testing/feature-flags/${e}/rollout`,"PATCH",{rollout:a}),onSuccess:()=>{ey.queryClient.invalidateQueries({queryKey:["/api/admin/testing/feature-flags"]}),e({title:"Rollout percentage updated"}),n(!1)}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Testing & Experiments"}),(0,a.jsxs)(eS.Tabs,{defaultValue:"ab-tests",className:"space-y-4",children:[(0,a.jsxs)(eS.TabsList,{children:[(0,a.jsx)(eS.TabsTrigger,{value:"ab-tests","data-testid":"tab-ab-tests",children:"A/B Tests"}),(0,a.jsx)(eS.TabsTrigger,{value:"feature-flags","data-testid":"tab-feature-flags",children:"Feature Flags"})]}),(0,a.jsxs)(eS.TabsContent,{value:"ab-tests",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"A/B Tests"}),(0,a.jsxs)(ej.Dialog,{open:s,onOpenChange:t,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-test",children:"Create A/B Test"})}),(0,a.jsxs)(ej.DialogContent,{className:"max-w-2xl",children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create A/B Test"})}),(0,a.jsxs)("form",{onSubmit:a=>{a.preventDefault();let s=new FormData(a.currentTarget),t=s.get("variants"),i=s.get("trafficAllocation");try{let e=JSON.parse(t),a=JSON.parse(i);T.mutate({name:s.get("name"),description:s.get("description"),variants:e,trafficAllocation:a})}catch(a){e({title:"Invalid JSON format",variant:"destructive"})}},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"test-name",children:"Test Name"}),(0,a.jsx)(h.Input,{id:"test-name",name:"name",required:!0,"data-testid":"input-test-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"test-description",children:"Description"}),(0,a.jsx)(eF.Textarea,{id:"test-description",name:"description",required:!0,"data-testid":"textarea-test-description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"variants",children:"Variants (JSON Array)"}),(0,a.jsx)(eF.Textarea,{id:"variants",name:"variants",placeholder:'[{"id": "A", "name": "Control"}, {"id": "B", "name": "Variant B"}]',className:"font-mono text-sm",rows:3,required:!0,"data-testid":"textarea-variants"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"trafficAllocation",children:"Traffic Allocation (JSON Object)"}),(0,a.jsx)(eF.Textarea,{id:"trafficAllocation",name:"trafficAllocation",placeholder:'{"A": 50, "B": 50}',className:"font-mono text-sm",rows:2,required:!0,"data-testid":"textarea-traffic-allocation"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Percentages should add up to 100"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:T.isPending,"data-testid":"button-submit-test",children:T.isPending?"Creating...":"Create Test"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:g?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Status"}),(0,a.jsx)(Z.TableHead,{children:"Variants"}),(0,a.jsx)(Z.TableHead,{children:"Traffic"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[b.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`test-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-medium","data-testid":`test-name-${e.id}`,children:e.name}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(ex.Badge,{variant:"running"===e.status?"default":"completed"===e.status?"secondary":"outline",children:e.status})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.variants.map(e=>(0,a.jsx)(ex.Badge,{variant:"outline",className:"text-xs",children:e.name},e.id))})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)("div",{className:"text-xs",children:Object.entries(e.trafficAllocation).map(([e,s])=>(0,a.jsxs)("div",{children:[e,": ",s,"%"]},e))})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:["draft"===e.status&&(0,a.jsxs)(x.Button,{size:"sm",variant:"default",onClick:()=>f.mutate(e.id),disabled:f.isPending,"data-testid":`button-start-${e.id}`,children:[(0,a.jsx)(e5,{className:"w-3 h-3 mr-1"}),"Start"]}),"running"===e.status&&(0,a.jsxs)(x.Button,{size:"sm",variant:"destructive",onClick:()=>N.mutate(e.id),disabled:N.isPending,"data-testid":`button-stop-${e.id}`,children:[(0,a.jsx)(av,{className:"w-3 h-3 mr-1"}),"Stop"]})]})})]},e.id)),0===b.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No A/B tests created"})})]})]})})})}),b.filter(e=>"running"===e.status||"completed"===e.status).map(e=>(0,a.jsxs)(J.Card,{children:[(0,a.jsxs)(J.CardHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsxs)(J.CardTitle,{children:["Results: ",e.name]}),"completed"===e.status&&e.winner&&(0,a.jsxs)(ex.Badge,{variant:"default",children:[(0,a.jsx)(V.Trophy,{className:"w-3 h-3 mr-1"}),"Winner: ",e.winner]})]}),(0,a.jsx)(J.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Variant"}),(0,a.jsx)(Z.TableHead,{children:"Impressions"}),(0,a.jsx)(Z.TableHead,{children:"Conversions"}),(0,a.jsx)(Z.TableHead,{children:"Conversion Rate"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsx)(Z.TableBody,{children:(e.results||[]).map(s=>(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableCell,{className:"font-medium",children:s.variantName}),(0,a.jsx)(Z.TableCell,{children:s.impressions}),(0,a.jsx)(Z.TableCell,{children:s.conversions}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:[s.conversionRate,"%"]})}),(0,a.jsx)(Z.TableCell,{children:"running"===e.status&&!e.winner&&(0,a.jsx)(x.Button,{size:"sm",variant:"default",onClick:()=>w.mutate({testId:e.id,variantId:s.variantId}),disabled:w.isPending,"data-testid":`button-declare-winner-${s.variantId}`,children:"Declare Winner"})})]},s.variantId))})]})})})]},`results-${e.id}`))]}),(0,a.jsxs)(eS.TabsContent,{value:"feature-flags",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Feature Flags"}),(0,a.jsxs)(ej.Dialog,{open:l,onOpenChange:r,children:[(0,a.jsx)(ej.DialogTrigger,{asChild:!0,children:(0,a.jsx)(x.Button,{"data-testid":"button-create-flag",children:"Create Feature Flag"})}),(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Create Feature Flag"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=new FormData(e.currentTarget),s=a.get("targetUsers").split(",").map(e=>e.trim()).filter(Boolean);S.mutate({key:a.get("key"),name:a.get("name"),description:a.get("description"),enabled:!1,rollout:0,targetUsers:s})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"flag-key",children:"Flag Key"}),(0,a.jsx)(h.Input,{id:"flag-key",name:"key",placeholder:"new_feature_enabled",required:!0,"data-testid":"input-flag-key"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"flag-name",children:"Flag Name"}),(0,a.jsx)(h.Input,{id:"flag-name",name:"name",required:!0,"data-testid":"input-flag-name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"flag-description",children:"Description"}),(0,a.jsx)(eF.Textarea,{id:"flag-description",name:"description","data-testid":"textarea-flag-description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eZ.Label,{htmlFor:"targetUsers",children:"Target Users (comma-separated IDs, optional)"}),(0,a.jsx)(eF.Textarea,{id:"targetUsers",name:"targetUsers",placeholder:"user-123, user-456","data-testid":"textarea-target-users"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{type:"submit",disabled:S.isPending,"data-testid":"button-submit-flag",children:S.isPending?"Creating...":"Create Flag"})})]})]})]})]}),(0,a.jsx)(J.Card,{children:(0,a.jsx)(J.CardContent,{className:"p-0",children:y?(0,a.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(j.Skeleton,{className:"h-12"},s))}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(Z.Table,{children:[(0,a.jsx)(Z.TableHeader,{children:(0,a.jsxs)(Z.TableRow,{children:[(0,a.jsx)(Z.TableHead,{children:"Flag Key"}),(0,a.jsx)(Z.TableHead,{children:"Name"}),(0,a.jsx)(Z.TableHead,{children:"Enabled"}),(0,a.jsx)(Z.TableHead,{children:"Rollout %"}),(0,a.jsx)(Z.TableHead,{children:"Target Users"}),(0,a.jsx)(Z.TableHead,{children:"Actions"})]})}),(0,a.jsxs)(Z.TableBody,{children:[C.map(e=>(0,a.jsxs)(Z.TableRow,{"data-testid":`flag-${e.id}`,children:[(0,a.jsx)(Z.TableCell,{className:"font-mono text-sm","data-testid":`flag-key-${e.id}`,children:e.key}),(0,a.jsx)(Z.TableCell,{className:"font-medium",children:e.name}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(eY.Switch,{checked:e.enabled,onCheckedChange:a=>k.mutate({id:e.id,enabled:a}),"data-testid":`switch-flag-${e.id}`})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"secondary",children:[e.rollout,"%"]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsxs)(ex.Badge,{variant:"outline",children:[e.targetUsers.length," users"]})}),(0,a.jsx)(Z.TableCell,{children:(0,a.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>{o(e),u([e.rollout]),n(!0)},"data-testid":`button-rollout-${e.id}`,children:"Adjust Rollout"})})]},e.id)),0===C.length&&(0,a.jsx)(Z.TableRow,{children:(0,a.jsx)(Z.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No feature flags created"})})]})]})})})}),(0,a.jsx)(ej.Dialog,{open:d,onOpenChange:n,children:(0,a.jsxs)(ej.DialogContent,{children:[(0,a.jsx)(ej.DialogHeader,{children:(0,a.jsx)(ej.DialogTitle,{children:"Adjust Rollout Percentage"})}),c&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eZ.Label,{children:["Rollout: ",m[0],"%"]}),(0,a.jsx)(eJ.Slider,{value:m,onValueChange:u,max:100,step:1,"data-testid":"slider-rollout"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Percentage of users who will see this feature"})]}),(0,a.jsx)(ej.DialogFooter,{children:(0,a.jsx)(x.Button,{onClick:()=>A.mutate({id:c.id,rollout:m[0]}),disabled:A.isPending,"data-testid":"button-save-rollout",children:A.isPending?"Saving...":"Save"})})]})]})})]})]})]})}let aC=[{id:"overview",icon:D.BarChart3,label:"Overview",path:"/admin"},{id:"users",icon:R.Users,label:"Users",path:"/admin/users"},{id:"content",icon:F.FileText,label:"Content",path:"/admin/content"},{id:"marketplace",icon:q.Store,label:"Marketplace",path:"/admin/marketplace"},{id:"brokers",icon:B,label:"Brokers",path:"/admin/brokers"},{id:"finance",icon:I.DollarSign,label:"Finance",path:"/admin/finance"},{id:"analytics",icon:L.TrendingUp,label:"Analytics",path:"/admin/analytics"},{id:"ai-automation",icon:Q,label:"AI & Automation",path:"/admin/ai-automation"},{id:"gamification",icon:V.Trophy,label:"Gamification",path:"/admin/gamification"},{id:"seo-marketing",icon:U.Search,label:"SEO & Marketing",path:"/admin/seo-marketing"},{id:"integrations",icon:O.Zap,label:"API & Integrations",path:"/admin/integrations"},{id:"mobile",icon:z.Smartphone,label:"Mobile & Push",path:"/admin/mobile"},{id:"performance",icon:W.Activity,label:"Performance",path:"/admin/performance"},{id:"content-studio",icon:G.Folder,label:"Content Studio",path:"/admin/content-studio"},{id:"testing",icon:_,label:"Testing",path:"/admin/testing"},{id:"settings",icon:P.Settings,label:"Settings",path:"/admin/settings"},{id:"security",icon:K.Shield,label:"Security",path:"/admin/security"},{id:"communications",icon:M.Mail,label:"Communications",path:"/admin/communications"},{id:"support",icon:$.HelpCircle,label:"Support",path:"/admin/support"},{id:"logs",icon:E,label:"Audit Logs",path:"/admin/logs"}];function aT(){let e=(0,t.usePathname)();return(0,a.jsx)(y,{children:(0,a.jsx)(T,{children:(0,a.jsxs)(f,{children:[(0,a.jsx)(N,{children:"Admin Dashboard"}),(0,a.jsx)(w,{children:(0,a.jsx)(S,{children:aC.map(t=>{let i=e===t.path;return(0,a.jsx)(k,{children:(0,a.jsx)(H,{asChild:!0,isActive:i,children:(0,a.jsxs)(s.default,{href:t.path,"data-testid":`nav-${t.id}`,children:[(0,a.jsx)(t.icon,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:t.label})]})})},t.id)})})})]})})})}function af(){let e=(0,t.usePathname)();return(0,a.jsx)(v,{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"},children:(0,a.jsxs)("div",{className:"flex h-screen w-full",children:[(0,a.jsx)(aT,{}),(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-4 border-b gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(C,{"data-testid":"button-sidebar-toggle"}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"})]}),(0,a.jsx)(X.ThemeToggle,{})]}),(0,a.jsx)("main",{className:"flex-1 overflow-auto p-6",children:(()=>{switch(e){case"/admin/users":return(0,a.jsx)(eC,{});case"/admin/content":return(0,a.jsx)(ek,{});case"/admin/marketplace":return(0,a.jsx)(eK,{});case"/admin/brokers":return(0,a.jsx)(eM,{});case"/admin/finance":return(0,a.jsx)(eO,{});case"/admin/analytics":return(0,a.jsx)(eX,{});case"/admin/ai-automation":return(0,a.jsx)(e9,{});case"/admin/gamification":return(0,a.jsx)(ae,{});case"/admin/seo-marketing":return(0,a.jsx)(as,{});case"/admin/integrations":return(0,a.jsx)(an,{});case"/admin/mobile":return(0,a.jsx)(ax,{});case"/admin/performance":return(0,a.jsx)(au,{});case"/admin/content-studio":return(0,a.jsx)(ab,{});case"/admin/testing":return(0,a.jsx)(ay,{});case"/admin/settings":return(0,a.jsx)(e0,{});case"/admin/security":return(0,a.jsx)(e2,{});case"/admin/communications":return(0,a.jsx)(e1,{});case"/admin/support":return(0,a.jsx)(e3,{});case"/admin/logs":return(0,a.jsx)(e8,{});default:return(0,a.jsx)(eh,{})}})()})]})]})})}e.s(["AdminDashboardClient",()=>af],64541)}]);