module.exports=[15428,11909,e=>{"use strict";var t=e.i(5672),a=e.i(44988),i=e.i(69e3);function r(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(e=>e.toLowerCase()).join("_")}function s(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((e,t,a)=>e+(0===a?t.toLowerCase():`${t[0].toUpperCase()}${t.slice(1)}`),"")}function n(e){return e}class o{static [a.entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert="snake_case"===e?r:"camelCase"===e?s:n}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[i.Table.Symbol.Schema]??"public",a=e.table[i.Table.Symbol.OriginalName],r=`${t}.${a}.${e.name}`;return this.cache[r]||this.cacheTable(e.table),this.cache[r]}cacheTable(e){let t=e[i.Table.Symbol.Schema]??"public",a=e[i.Table.Symbol.OriginalName],r=`${t}.${a}`;if(!this.cachedTables[r]){for(let t of Object.values(e[i.Table.Symbol.Columns])){let e=`${r}.${t.name}`;this.cache[e]=this.convert(t.name)}this.cachedTables[r]=!0}}clearCache(){this.cache={},this.cachedTables={}}}var l=e.i(56325),d=e.i(71783),u=e.i(4775),c=e.i(56923),p=e.i(1727),m=e.i(38257),h=e.i(48209),f=e.i(93486),_=e.i(3090),g=e.i(67751),y=e.i(94093),v=e.i(79822),b=e.i(75225),x=e.i(18899),N=e.i(92352),w=e.i(4313),I=e.i(88274),T=x;class A extends T.View{static [a.entityKind]="PgViewBase"}e.s(["PgViewBase",()=>A],11909);class S{static [a.entityKind]="PgDialect";casing;constructor(e){this.casing=new o(e?.casing)}async migrate(e,t,a){let i="string"==typeof a?"__drizzle_migrations":a.migrationsTable??"__drizzle_migrations",r="string"==typeof a?"drizzle":a.migrationsSchema??"drizzle",s=x.sql`
			CREATE TABLE IF NOT EXISTS ${x.sql.identifier(r)}.${x.sql.identifier(i)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(x.sql`CREATE SCHEMA IF NOT EXISTS ${x.sql.identifier(r)}`),await t.execute(s);let n=(await t.all(x.sql`select id, hash, created_at from ${x.sql.identifier(r)}.${x.sql.identifier(i)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let a of e)if(!n||Number(n.created_at)<a.folderMillis){for(let e of a.sql)await t.execute(x.sql.raw(e));await t.execute(x.sql`insert into ${x.sql.identifier(r)}.${x.sql.identifier(i)} ("hash", "created_at") values(${a.hash}, ${a.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[x.sql`with `];for(let[a,i]of e.entries())t.push(x.sql`${x.sql.identifier(i._.alias)} as (${i._.sql})`),a<e.length-1&&t.push(x.sql`, `);return t.push(x.sql` `),x.sql.join(t)}buildDeleteQuery({table:e,where:t,returning:a,withList:i}){let r=this.buildWithCTE(i),s=a?x.sql` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,n=t?x.sql` where ${t}`:void 0;return x.sql`${r}delete from ${e}${n}${s}`}buildUpdateSet(e,t){let a=e[i.Table.Symbol.Columns],r=Object.keys(a).filter(e=>void 0!==t[e]||a[e]?.onUpdateFn!==void 0),s=r.length;return x.sql.join(r.flatMap((e,i)=>{let r=a[e],n=t[e]??x.sql.param(r.onUpdateFn(),r),o=x.sql`${x.sql.identifier(this.casing.getColumnCasing(r))} = ${n}`;return i<s-1?[o,x.sql.raw(", ")]:[o]}))}buildUpdateQuery({table:e,set:t,where:a,returning:i,withList:r,from:s,joins:n}){let o=this.buildWithCTE(r),l=e[y.PgTable.Symbol.Name],d=e[y.PgTable.Symbol.Schema],u=e[y.PgTable.Symbol.OriginalName],c=l===u?void 0:l,p=x.sql`${d?x.sql`${x.sql.identifier(d)}.`:void 0}${x.sql.identifier(u)}${c&&x.sql` ${x.sql.identifier(c)}`}`,m=this.buildUpdateSet(e,t),h=s&&x.sql.join([x.sql.raw(" from "),this.buildFromTable(s)]),f=this.buildJoins(n),_=i?x.sql` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,g=a?x.sql` where ${a}`:void 0;return x.sql`${o}update ${p} set ${m}${h}${f}${g}${_}`}buildSelection(e,{isSingleTable:t=!1}={}){let i=e.length,r=e.flatMap(({field:e},r)=>{let s=[];if((0,a.is)(e,x.SQL.Aliased)&&e.isSelectionField)s.push(x.sql.identifier(e.fieldAlias));else if((0,a.is)(e,x.SQL.Aliased)||(0,a.is)(e,x.SQL)){let i=(0,a.is)(e,x.SQL.Aliased)?e.sql:e;t?s.push(new x.SQL(i.queryChunks.map(e=>(0,a.is)(e,u.PgColumn)?x.sql.identifier(this.casing.getColumnCasing(e)):e))):s.push(i),(0,a.is)(e,x.SQL.Aliased)&&s.push(x.sql` as ${x.sql.identifier(e.fieldAlias)}`)}else(0,a.is)(e,l.Column)&&(t?s.push(x.sql.identifier(this.casing.getColumnCasing(e))):s.push(e));return r<i-1&&s.push(x.sql`, `),s});return x.sql.join(r)}buildJoins(e){if(!e||0===e.length)return;let t=[];for(let[i,r]of e.entries()){0===i&&t.push(x.sql` `);let s=r.table,n=r.lateral?x.sql` lateral`:void 0;if((0,a.is)(s,y.PgTable)){let e=s[y.PgTable.Symbol.Name],a=s[y.PgTable.Symbol.Schema],i=s[y.PgTable.Symbol.OriginalName],o=e===i?void 0:r.alias;t.push(x.sql`${x.sql.raw(r.joinType)} join${n} ${a?x.sql`${x.sql.identifier(a)}.`:void 0}${x.sql.identifier(i)}${o&&x.sql` ${x.sql.identifier(o)}`} on ${r.on}`)}else if((0,a.is)(s,x.View)){let e=s[I.ViewBaseConfig].name,a=s[I.ViewBaseConfig].schema,i=s[I.ViewBaseConfig].originalName,o=e===i?void 0:r.alias;t.push(x.sql`${x.sql.raw(r.joinType)} join${n} ${a?x.sql`${x.sql.identifier(a)}.`:void 0}${x.sql.identifier(i)}${o&&x.sql` ${x.sql.identifier(o)}`} on ${r.on}`)}else t.push(x.sql`${x.sql.raw(r.joinType)} join${n} ${s} on ${r.on}`);i<e.length-1&&t.push(x.sql` `)}return x.sql.join(t)}buildFromTable(e){if((0,a.is)(e,i.Table)&&e[i.Table.Symbol.OriginalName]!==e[i.Table.Symbol.Name]){let t=x.sql`${x.sql.identifier(e[i.Table.Symbol.OriginalName])}`;return e[i.Table.Symbol.Schema]&&(t=x.sql`${x.sql.identifier(e[i.Table.Symbol.Schema])}.${t}`),x.sql`${t} ${x.sql.identifier(e[i.Table.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:s,having:n,table:o,joins:d,orderBy:u,groupBy:c,limit:p,offset:m,lockingClause:h,distinct:f,setOperators:_}){let g,y,v,b=r??(0,w.orderSelectedFields)(t);for(let e of b){let t;if((0,a.is)(e.field,l.Column)&&(0,i.getTableName)(e.field.table)!==((0,a.is)(o,N.Subquery)?o._.alias:(0,a.is)(o,A)?o[I.ViewBaseConfig].name:(0,a.is)(o,x.SQL)?void 0:(0,i.getTableName)(o))&&(t=e.field.table,!d?.some(({alias:e})=>e===(t[i.Table.Symbol.IsAlias]?(0,i.getTableName)(t):t[i.Table.Symbol.BaseName])))){let t=(0,i.getTableName)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let T=!d||0===d.length,S=this.buildWithCTE(e);f&&(g=!0===f?x.sql` distinct`:x.sql` distinct on (${x.sql.join(f.on,x.sql`, `)})`);let k=this.buildSelection(b,{isSingleTable:T}),q=this.buildFromTable(o),C=this.buildJoins(d),j=s?x.sql` where ${s}`:void 0,P=n?x.sql` having ${n}`:void 0;u&&u.length>0&&(y=x.sql` order by ${x.sql.join(u,x.sql`, `)}`),c&&c.length>0&&(v=x.sql` group by ${x.sql.join(c,x.sql`, `)}`);let $="object"==typeof p||"number"==typeof p&&p>=0?x.sql` limit ${p}`:void 0,E=m?x.sql` offset ${m}`:void 0,R=x.sql.empty();if(h){let e=x.sql` for ${x.sql.raw(h.strength)}`;h.config.of&&e.append(x.sql` of ${x.sql.join(Array.isArray(h.config.of)?h.config.of:[h.config.of],x.sql`, `)}`),h.config.noWait?e.append(x.sql` no wait`):h.config.skipLocked&&e.append(x.sql` skip locked`),R.append(e)}let O=x.sql`${S}select${g} ${k} from ${q}${C}${j}${v}${P}${y}${$}${E}${R}`;return _.length>0?this.buildSetOperations(O,_):O}buildSetOperations(e,t){let[a,...i]=t;if(!a)throw Error("Cannot pass undefined values to any set operator");return 0===i.length?this.buildSetOperationQuery({leftSelect:e,setOperator:a}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:a}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:i,rightSelect:r,limit:s,orderBy:n,offset:o}}){let l,d=x.sql`(${e.getSQL()}) `,c=x.sql`(${r.getSQL()})`;if(n&&n.length>0){let e=[];for(let t of n)if((0,a.is)(t,u.PgColumn))e.push(x.sql.identifier(t.name));else if((0,a.is)(t,x.SQL)){for(let e=0;e<t.queryChunks.length;e++){let i=t.queryChunks[e];(0,a.is)(i,u.PgColumn)&&(t.queryChunks[e]=x.sql.identifier(i.name))}e.push(x.sql`${t}`)}else e.push(x.sql`${t}`);l=x.sql` order by ${x.sql.join(e,x.sql`, `)} `}let p="object"==typeof s||"number"==typeof s&&s>=0?x.sql` limit ${s}`:void 0,m=x.sql.raw(`${t} ${i?"all ":""}`),h=o?x.sql` offset ${o}`:void 0;return x.sql`${d}${m}${c}${l}${p}${h}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:s,withList:n,select:o,overridingSystemValue_:l}){let d=[],u=Object.entries(e[i.Table.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),c=u.map(([,e])=>x.sql.identifier(this.casing.getColumnCasing(e)));if(o)(0,a.is)(t,x.SQL)?d.push(t):d.push(t.getSQL());else for(let[e,i]of(d.push(x.sql.raw("values ")),t.entries())){let r=[];for(let[e,t]of u){let s=i[e];if(void 0===s||(0,a.is)(s,x.Param)&&void 0===s.value)if(void 0!==t.defaultFn){let e=t.defaultFn(),i=(0,a.is)(e,x.SQL)?e:x.sql.param(e,t);r.push(i)}else if(t.default||void 0===t.onUpdateFn)r.push(x.sql`default`);else{let e=t.onUpdateFn(),i=(0,a.is)(e,x.SQL)?e:x.sql.param(e,t);r.push(i)}else r.push(s)}d.push(r),e<t.length-1&&d.push(x.sql`, `)}let p=this.buildWithCTE(n),m=x.sql.join(d),h=s?x.sql` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,f=r?x.sql` on conflict ${r}`:void 0,_=!0===l?x.sql`overriding system value `:void 0;return x.sql`${p}insert into ${e} ${c} ${_}${m}${f}${h}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:a}){let i=t?x.sql` concurrently`:void 0,r=a?x.sql` with no data`:void 0;return x.sql`refresh materialized view${i} ${e}${r}`}prepareTyping(e){if((0,a.is)(e,m.PgJsonb)||(0,a.is)(e,p.PgJson))return"json";if((0,a.is)(e,h.PgNumeric))return"decimal";if((0,a.is)(e,f.PgTime))return"time";if((0,a.is)(e,_.PgTimestamp)||(0,a.is)(e,_.PgTimestampString))return"timestamp";if((0,a.is)(e,c.PgDate)||(0,a.is)(e,c.PgDateString))return"date";else if((0,a.is)(e,g.PgUUID))return"uuid";else return"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:s,table:n,tableConfig:o,queryConfig:u,tableAlias:c,nestedQueryRelation:p,joinOn:m}){let h,f=[],_,g,w=[],I,T=[];if(!0===u)f=Object.entries(o.columns).map(([e,a])=>({dbKey:a.name,tsKey:e,field:(0,t.aliasedTableColumn)(a,c),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let n=Object.fromEntries(Object.entries(o.columns).map(([e,a])=>[e,(0,t.aliasedTableColumn)(a,c)]));if(u.where){let e="function"==typeof u.where?u.where(n,(0,v.getOperators)()):u.where;I=e&&(0,t.mapColumnsInSQLToAlias)(e,c)}let d=[],p=[];if(u.columns){let e=!1;for(let[t,a]of Object.entries(u.columns))void 0!==a&&t in o.columns&&(e||!0!==a||(e=!0),p.push(t));p.length>0&&(p=e?p.filter(e=>u.columns?.[e]===!0):Object.keys(o.columns).filter(e=>!p.includes(e)))}else p=Object.keys(o.columns);for(let e of p){let t=o.columns[e];d.push({tsKey:e,value:t})}let m=[];if(u.with&&(m=Object.entries(u.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:o.relations[e]}))),u.extras)for(let[e,a]of Object.entries("function"==typeof u.extras?u.extras(n,{sql:x.sql}):u.extras))d.push({tsKey:e,value:(0,t.mapColumnsInAliasedSQLToAlias)(a,c)});for(let{tsKey:e,value:i}of d)f.push({dbKey:(0,a.is)(i,x.SQL.Aliased)?i.fieldAlias:o.columns[e].name,tsKey:e,field:(0,a.is)(i,l.Column)?(0,t.aliasedTableColumn)(i,c):i,relationTableTsKey:void 0,isJson:!1,selection:[]});let h="function"==typeof u.orderBy?u.orderBy(n,(0,v.getOrderByOperators)()):u.orderBy??[];for(let{tsKey:n,queryConfig:o,relation:d}of(Array.isArray(h)||(h=[h]),w=h.map(e=>(0,a.is)(e,l.Column)?(0,t.aliasedTableColumn)(e,c):(0,t.mapColumnsInSQLToAlias)(e,c)),_=u.limit,g=u.offset,m)){let l=(0,v.normalizeRelation)(r,s,d),u=s[(0,i.getTableUniqueName)(d.referencedTable)],p=`${c}_${n}`,m=(0,b.and)(...l.fields.map((e,a)=>(0,b.eq)((0,t.aliasedTableColumn)(l.references[a],p),(0,t.aliasedTableColumn)(e,c)))),h=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:s,table:e[u],tableConfig:r[u],queryConfig:(0,a.is)(d,v.One)?!0===o?{limit:1}:{...o,limit:1}:o,tableAlias:p,joinOn:m,nestedQueryRelation:d}),_=x.sql`${x.sql.identifier(p)}.${x.sql.identifier("data")}`.as(n);T.push({on:x.sql`true`,table:new N.Subquery(h.sql,{},p),alias:p,joinType:"left",lateral:!0}),f.push({dbKey:n,tsKey:n,field:_,relationTableTsKey:u,isJson:!0,selection:h.selection})}}if(0===f.length)throw new d.DrizzleError({message:`No fields selected for table "${o.tsName}" ("${c}")`});if(I=(0,b.and)(m,I),p){let e=x.sql`json_build_array(${x.sql.join(f.map(({field:e,tsKey:t,isJson:i})=>i?x.sql`${x.sql.identifier(`${c}_${t}`)}.${x.sql.identifier("data")}`:(0,a.is)(e,x.SQL.Aliased)?e.sql:e),x.sql`, `)})`;(0,a.is)(p,v.Many)&&(e=x.sql`coalesce(json_agg(${e}${w.length>0?x.sql` order by ${x.sql.join(w,x.sql`, `)}`:void 0}), '[]'::json)`);let i=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:o.tsName,selection:f}];void 0!==_||void 0!==g||w.length>0?(h=this.buildSelectQuery({table:(0,t.aliasedTable)(n,c),fields:{},fieldsFlat:[{path:[],field:x.sql.raw("*")}],where:I,limit:_,offset:g,orderBy:w,setOperators:[]}),I=void 0,_=void 0,g=void 0,w=[]):h=(0,t.aliasedTable)(n,c),h=this.buildSelectQuery({table:(0,a.is)(h,y.PgTable)?h:new N.Subquery(h,{},c),fields:{},fieldsFlat:i.map(({field:e})=>({path:[],field:(0,a.is)(e,l.Column)?(0,t.aliasedTableColumn)(e,c):e})),joins:T,where:I,limit:_,offset:g,orderBy:w,setOperators:[]})}else h=this.buildSelectQuery({table:(0,t.aliasedTable)(n,c),fields:{},fieldsFlat:f.map(({field:e})=>({path:[],field:(0,a.is)(e,l.Column)?(0,t.aliasedTableColumn)(e,c):e})),joins:T,where:I,limit:_,offset:g,orderBy:w,setOperators:[]});return{tableTsKey:o.tsName,sql:h,selection:f}}}e.s(["PgDialect",()=>S],15428)},44482,e=>{"use strict";var t=e.i(44988),a=e.i(98020),i=e.i(5672),r=e.i(56325),s=e.i(18899),n=e.i(92352),o=e.i(88274);class l{static [t.entityKind]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,a){if("_"===a)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(a===o.ViewBaseConfig)return{...e[o.ViewBaseConfig],selectedFields:new Proxy(e[o.ViewBaseConfig].selectedFields,this)};if("symbol"==typeof a)return e[a];let d=((0,t.is)(e,n.Subquery)?e._.selectedFields:(0,t.is)(e,s.View)?e[o.ViewBaseConfig].selectedFields:e)[a];if((0,t.is)(d,s.SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!d.isSelectionField)return d.sql;let e=d.clone();return e.isSelectionField=!0,e}if((0,t.is)(d,s.SQL)){if("sql"===this.config.sqlBehavior)return d;throw Error(`You tried to reference "${a}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,t.is)(d,r.Column)?this.config.alias?new Proxy(d,new i.ColumnAliasProxyHandler(new Proxy(d.table,new i.TableAliasProxyHandler(this.config.alias,this.config.replaceOriginalName??!1)))):d:"object"!=typeof d||null===d?d:new Proxy(d,new l(this.config))}}var d=e.i(69e3),u=e.i(22360),c=e.i(4313);class p extends a.QueryPromise{constructor(e,t,a,i){super(),this.session=t,this.dialect=a,this.config={table:e,withList:i}}static [t.entityKind]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[d.Table.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=(0,c.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return u.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>u.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new l({alias:(0,d.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var m=a,h=e.i(15428),f=e.i(11909);class _{static [t.entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class g{static [t.entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let a,i=!!this.fields;return a=this.fields?this.fields:(0,t.is)(e,n.Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,t.is)(e,f.PgViewBase)?e[o.ViewBaseConfig].selectedFields:(0,t.is)(e,s.SQL)?{}:(0,c.getTableColumns)(e),new v({table:e,fields:a,isPartialSelect:i,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class y extends _{static [t.entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:a,session:i,dialect:r,withList:s,distinct:n}){super(),this.config={withList:s,table:e,fields:{...t},distinct:n,setOperators:[]},this.isPartialSelect=a,this.session=i,this.dialect=r,this._={selectedFields:t},this.tableName=(0,c.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(a,i)=>{let r=this.tableName,u=(0,c.getTableLikeName)(a);if("string"==typeof u&&this.config.joins?.some(e=>e.alias===u))throw Error(`Alias "${u}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof r&&(this.config.fields={[r]:this.config.fields}),"string"==typeof u&&!(0,t.is)(a,s.SQL))){let e=(0,t.is)(a,n.Subquery)?a._.selectedFields:(0,t.is)(a,s.View)?a[o.ViewBaseConfig].selectedFields:a[d.Table.Symbol.Columns];this.config.fields[u]=e}if("function"==typeof i&&(i=i(new Proxy(this.config.fields,new l({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:a,joinType:e,alias:u}),"string"==typeof u)switch(e){case"left":this.joinsNotNullableMap[u]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[u]=!0;break;case"inner":this.joinsNotNullableMap[u]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[u]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return a=>{let i="function"==typeof a?a(x()):a;if(!(0,c.haveSameKeys)(this.getSelectedFields(),i.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new l({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new l({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new l({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new l({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),a=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new n.Subquery(this.getSQL(),this.config.fields,e),new l({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new l({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class v extends y{static [t.entityKind]="PgSelect";_prepare(e){let{session:t,config:a,dialect:i,joinsNotNullableMap:r,authToken:s}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return u.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let n=(0,c.orderSelectedFields)(a.fields),o=t.prepareQuery(i.sqlToQuery(this.getSQL()),n,e,!0);return o.joinsNotNullableMap=r,o.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>u.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}function b(e,t){return(a,i,...r)=>{let s=[i,...r].map(a=>({type:e,isAll:t,rightSelect:a}));for(let e of s)if(!(0,c.haveSameKeys)(a.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return a.addSetOperators(s)}}(0,c.applyMixins)(v,[a.QueryPromise]);let x=()=>({union:N,unionAll:w,intersect:I,intersectAll:T,except:A,exceptAll:S}),N=b("union",!1),w=b("union",!0),I=b("intersect",!1),T=b("intersect",!0),A=b("except",!1),S=b("except",!0);class k{static [t.entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,t.is)(e,h.PgDialect)?e:void 0,this.dialectConfig=(0,t.is)(e,h.PgDialect)?void 0:e}$with=(e,t)=>{let a=this;return{as:i=>("function"==typeof i&&(i=i(a)),new Proxy(new n.WithSubquery(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new l({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;return{select:function(a){return new g({fields:a??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new g({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,a){return new g({fields:a??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new g({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new g({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new g({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new h.PgDialect(this.dialectConfig)),this.dialect}}class q{constructor(e,t,a,i,r){this.table=e,this.session=t,this.dialect=a,this.withList=i,this.overridingSystemValue_=r}static [t.entityKind]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let a=e.map(e=>{let a={},i=this.table[d.Table.Symbol.Columns];for(let r of Object.keys(e)){let n=e[r];a[r]=(0,t.is)(n,s.SQL)?n:new s.Param(n,i[r])}return a});return new C(this.table,a,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let a="function"==typeof e?e(new k):e;if(!(0,t.is)(a,s.SQL)&&!(0,c.haveSameKeys)(this.table[d.Columns],a._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new C(this.table,a,this.session,this.dialect,this.withList,!0)}}class C extends m.QueryPromise{constructor(e,t,a,i,r,s,n){super(),this.session=a,this.dialect=i,this.config={table:e,values:t,withList:r,select:s,overridingSystemValue_:n}}static [t.entityKind]="PgInsert";config;returning(e=this.config.table[d.Table.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=(0,c.orderSelectedFields)(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=s.sql`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let a=e.where?s.sql` where ${e.where}`:void 0;this.config.onConflict=s.sql`(${s.sql.raw(t)})${a} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?s.sql` where ${e.where}`:void 0,a=e.targetWhere?s.sql` where ${e.targetWhere}`:void 0,i=e.setWhere?s.sql` where ${e.setWhere}`:void 0,r=this.dialect.buildUpdateSet(this.config.table,(0,c.mapUpdateSet)(this.config.table,e.set)),n="";return n=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=s.sql`(${s.sql.raw(n)})${a} do update set ${r}${t}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return u.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>u.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new l({alias:(0,d.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var j=e.i(94093),P=a;class ${constructor(e,t,a,i){this.table=e,this.session=t,this.dialect=a,this.withList=i}static [t.entityKind]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new E(this.table,(0,c.mapUpdateSet)(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}}class E extends P.QueryPromise{constructor(e,t,a,i,r){super(),this.session=a,this.dialect=i,this.config={set:t,table:e,withList:r,joins:[]},this.tableName=(0,c.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [t.entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let t=(0,c.getTableLikeName)(e);return"string"==typeof t&&(this.joinsNotNullableMap[t]=!0),this.config.from=e,this}getTableLikeFields(e){return(0,t.is)(e,j.PgTable)?e[d.Table.Symbol.Columns]:(0,t.is)(e,n.Subquery)?e._.selectedFields:e[o.ViewBaseConfig].selectedFields}createJoin(e){return(a,i)=>{let r=(0,c.getTableLikeName)(a);if("string"==typeof r&&this.config.joins.some(e=>e.alias===r))throw Error(`Alias "${r}" is already used in this query`);if("function"==typeof i){let e=this.config.from&&!(0,t.is)(this.config.from,s.SQL)?this.getTableLikeFields(this.config.from):void 0;i=i(new Proxy(this.config.table[d.Table.Symbol.Columns],new l({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),e&&new Proxy(e,new l({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:i,table:a,joinType:e,alias:r}),"string"==typeof r)switch(e){case"left":this.joinsNotNullableMap[r]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[r]=!0;break;case"inner":this.joinsNotNullableMap[r]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[r]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[d.Table.Symbol.Columns]),this.config.from)){let a=(0,c.getTableLikeName)(this.config.from);if("string"==typeof a&&this.config.from&&!(0,t.is)(this.config.from,s.SQL)){let t=this.getTableLikeFields(this.config.from);e[a]=t}for(let a of this.config.joins){let i=(0,c.getTableLikeName)(a.table);if("string"==typeof i&&!(0,t.is)(a.table,s.SQL)){let t=this.getTableLikeFields(a.table);e[i]=t}}}return this.config.returningFields=e,this.config.returning=(0,c.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new l({alias:(0,d.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var R=s;class O extends R.SQL{constructor(e){super(O.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=O.buildCount(e.source,e.filters)}sql;token;static [t.entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return R.sql`(select count(*) from ${e}${R.sql.raw(" where ").if(t)}${t})`}static buildCount(e,t){return R.sql`select count(*) as count from ${e}${R.sql.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}var M=a,D=e.i(79822);class L{constructor(e,t,a,i,r,s,n){this.fullSchema=e,this.schema=t,this.tableNamesMap=a,this.table=i,this.tableConfig=r,this.dialect=s,this.session=n}static [t.entityKind]="PgRelationalQueryBuilder";findMany(e){return new Z(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Z(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class Z extends M.QueryPromise{constructor(e,t,a,i,r,s,n,o,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=a,this.table=i,this.tableConfig=r,this.dialect=s,this.session=n,this.config=o,this.mode=l}static [t.entityKind]="PgRelationalQuery";_prepare(e){return u.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:a}=this._toSQL();return this.session.prepareQuery(a,void 0,e,!0,(e,a)=>{let i=e.map(e=>(0,D.mapRelationalRow)(this.schema,this.tableConfig,e,t.selection,a));return"first"===this.mode?i[0]:i})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return u.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}var K=a;class B extends K.QueryPromise{constructor(e,t,a,i){super(),this.execute=e,this.sql=t,this.query=a,this.mapBatchResult=i}static [t.entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}var F=a;class Q extends F.QueryPromise{constructor(e,t,a){super(),this.session=t,this.dialect=a,this.config={view:e}}static [t.entityKind]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return u.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>u.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}class z{constructor(e,t,a){if(this.dialect=e,this.session=t,this._=a?{schema:a.schema,fullSchema:a.fullSchema,tableNamesMap:a.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(const[i,r]of Object.entries(this._.schema))this.query[i]=new L(a.fullSchema,this._.schema,this._.tableNamesMap,a.fullSchema[i],r,e,t)}static [t.entityKind]="PgDatabase";query;$with=(e,t)=>{let a=this;return{as:i=>("function"==typeof i&&(i=i(new k(a.dialect))),new Proxy(new n.WithSubquery(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new l({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new O({source:e,filters:t,session:this.session})}with(...e){let t=this;return{select:function(a){return new g({fields:a??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(a){return new g({fields:a??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(a,i){return new g({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:a}})},update:function(a){return new $(a,t.session,t.dialect,e)},insert:function(a){return new q(a,t.session,t.dialect,e)},delete:function(a){return new p(a,t.session,t.dialect,e)}}}select(e){return new g({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new g({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new g({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new $(e,this.session,this.dialect)}insert(e){return new q(e,this.session,this.dialect)}delete(e){return new p(e,this.session,this.dialect)}refreshMaterializedView(e){return new Q(e,this.session,this.dialect)}authToken;execute(e){let t="string"==typeof e?s.sql.raw(e):e.getSQL(),a=this.dialect.sqlToQuery(t),i=this.session.prepareQuery(a,void 0,void 0,!1);return new B(()=>i.execute(void 0,this.authToken),t,a,e=>i.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}e.s(["PgDatabase",()=>z],44482)},68581,e=>{"use strict";var t=e.i(44988),a=e.i(71783),i=e.i(18899),r=e.i(22360),s=e.i(44482);class n{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static [t.entityKind]="PgPreparedQuery";joinsNotNullableMap}class o{constructor(e){this.dialect=e}static [t.entityKind]="PgSession";execute(e,t){return r.tracer.startActiveSpan("drizzle.operation",()=>r.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){return Number((await this.execute(e,t))[0].count)}}class l extends s.PgDatabase{constructor(e,t,a,i=0){super(e,t,a),this.schema=a,this.nestedIndex=i}static [t.entityKind]="PgTransaction";rollback(){throw new a.TransactionRollbackError}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),i.sql.raw(t.join(" "))}setTransaction(e){return this.session.execute(i.sql`set transaction ${this.getTransactionConfigSQL(e)}`)}}e.s(["PgPreparedQuery",()=>n,"PgSession",()=>o,"PgTransaction",()=>l])},29529,e=>e.a(async(t,a)=>{try{var i=e.i(30056),r=e.i(44988),s=e.i(7932),n=e.i(68581),o=e.i(18899),l=e.i(22360),d=e.i(4313),u=t([i]);[i]=u.then?(await u)():u;let{Pool:c,types:p}=i.default;class m extends n.PgPreparedQuery{constructor(e,t,a,i,r,s,n,o){super({sql:t,params:a}),this.client=e,this.params=a,this.logger=i,this.fields=r,this._isResponseInArrayMode=n,this.customResultMapper=o,this.rawQueryConfig={name:s,text:t,types:{getTypeParser:(e,t)=>e===p.builtins.TIMESTAMPTZ||e===p.builtins.TIMESTAMP||e===p.builtins.DATE||e===p.builtins.INTERVAL?e=>e:p.getTypeParser(e,t)}},this.queryConfig={name:s,text:t,rowMode:"array",types:{getTypeParser:(e,t)=>e===p.builtins.TIMESTAMPTZ||e===p.builtins.TIMESTAMP||e===p.builtins.DATE||e===p.builtins.INTERVAL?e=>e:p.getTypeParser(e,t)}}}static [r.entityKind]="NodePgPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){return l.tracer.startActiveSpan("drizzle.execute",async()=>{let t=(0,o.fillPlaceholders)(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,t);let{fields:a,rawQueryConfig:i,client:r,queryConfig:s,joinsNotNullableMap:n,customResultMapper:u}=this;if(!a&&!u)return l.tracer.startActiveSpan("drizzle.driver.execute",async e=>(e?.setAttributes({"drizzle.query.name":i.name,"drizzle.query.text":i.text,"drizzle.query.params":JSON.stringify(t)}),r.query(i,t)));let c=await l.tracer.startActiveSpan("drizzle.driver.execute",e=>(e?.setAttributes({"drizzle.query.name":s.name,"drizzle.query.text":s.text,"drizzle.query.params":JSON.stringify(t)}),r.query(s,t)));return l.tracer.startActiveSpan("drizzle.mapResponse",()=>u?u(c.rows):c.rows.map(e=>(0,d.mapResultRow)(a,e,n)))})}all(e={}){return l.tracer.startActiveSpan("drizzle.execute",()=>{let t=(0,o.fillPlaceholders)(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),l.tracer.startActiveSpan("drizzle.driver.execute",e=>(e?.setAttributes({"drizzle.query.name":this.rawQueryConfig.name,"drizzle.query.text":this.rawQueryConfig.text,"drizzle.query.params":JSON.stringify(t)}),this.client.query(this.rawQueryConfig,t).then(e=>e.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class h extends n.PgSession{constructor(e,t,a,i={}){super(t),this.client=e,this.schema=a,this.options=i,this.logger=i.logger??new s.NoopLogger}static [r.entityKind]="NodePgSession";logger;prepareQuery(e,t,a,i,r){return new m(this.client,e.sql,e.params,this.logger,t,a,i,r)}async transaction(e,t){let a=this.client instanceof c?new h(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new f(this.dialect,a,this.schema);await i.execute(o.sql`begin${t?o.sql` ${i.getTransactionConfigSQL(t)}`:void 0}`);try{let t=await e(i);return await i.execute(o.sql`commit`),t}catch(e){throw await i.execute(o.sql`rollback`),e}finally{this.client instanceof c&&a.client.release()}}async count(e){let t=await this.execute(e);return Number(t.rows[0].count)}}class f extends n.PgTransaction{static [r.entityKind]="NodePgTransaction";async transaction(e){let t=`sp${this.nestedIndex+1}`,a=new f(this.dialect,this.session,this.schema,this.nestedIndex+1);await a.execute(o.sql.raw(`savepoint ${t}`));try{let i=await e(a);return await a.execute(o.sql.raw(`release savepoint ${t}`)),i}catch(e){throw await a.execute(o.sql.raw(`rollback to savepoint ${t}`)),e}}}e.s(["NodePgSession",()=>h]),a()}catch(e){a(e)}},!1),51103,e=>e.a(async(t,a)=>{try{var i=e.i(30056),r=e.i(44988),s=e.i(7932),n=e.i(44482),o=e.i(15428),l=e.i(79822),d=e.i(4313),u=e.i(29529),c=t([i,u]);[i,u]=c.then?(await c)():c;class h{constructor(e,t,a={}){this.client=e,this.dialect=t,this.options=a}static [r.entityKind]="NodePgDriver";createSession(e){return new u.NodePgSession(this.client,this.dialect,e,{logger:this.options.logger})}}class f extends n.PgDatabase{static [r.entityKind]="NodePgDatabase"}function p(e,t={}){let a,i,r=new o.PgDialect({casing:t.casing});if(!0===t.logger?a=new s.DefaultLogger:!1!==t.logger&&(a=t.logger),t.schema){let e=(0,l.extractTablesRelationalConfig)(t.schema,l.createTableRelationsHelpers);i={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let n=new h(e,r,{logger:a}).createSession(i),d=new f(r,n,i);return d.$client=e,d}function m(...e){if("string"==typeof e[0]){let t=new i.default.Pool({connectionString:e[0]});return p(t,e[1])}if((0,d.isConfig)(e[0])){let{connection:t,client:a,...r}=e[0];if(a)return p(a,r);let s=new i.default.Pool("string"==typeof t?{connectionString:t}:t);return p(s,r)}return p(e[0],e[1])}(m||(m={})).mock=function(e){return p({},e)},e.s(["drizzle",()=>m]),a()}catch(e){a(e)}},!1),90337,e=>{"use strict";let t;var a,i,r,s,n,o,l,d,u,c=e.i(18899),p=e.i(94093),m=e.i(84259),h=e.i(23624),f=e.i(70988),_=e.i(3090),g=e.i(2847),y=e.i(44988),v=e.i(4775);class b{constructor(e,t){this.unique=e,this.name=t}static [y.entityKind]="PgIndexBuilderOn";on(...e){return new x(e.map(e=>{if((0,y.is)(e,c.SQL))return e;let t=new v.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!1,this.name)}onOnly(...e){return new x(e.map(e=>{if((0,y.is)(e,c.SQL))return e;let t=new v.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=e.defaultConfig,t}),this.unique,!0,this.name)}using(e,...t){return new x(t.map(e=>{if((0,y.is)(e,c.SQL))return e;let t=new v.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!0,this.name,e)}}class x{static [y.entityKind]="PgIndexBuilder";config;constructor(e,t,a,i,r="btree"){this.config={name:i,columns:e,unique:t,only:a,method:r}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new N(this.config,e)}}class N{static [y.entityKind]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}}function w(e){return new b(!1,e)}function I(e){return new b(!0,e)}var T=e.i(38257),A=e.i(1727);class S{constructor(e,t){this.name=e,this.value=t}static [y.entityKind]="PgCheckBuilder";brand;build(e){return new k(e,this)}}class k{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}static [y.entityKind]="PgCheck";name;value}var q=e.i(48209),C=e.i(5694),j=e.i(56923),P=e.i(69e3),$=e.i(4313),E=e.i(56325);(a=s||(s={})).assertEqual=e=>e,a.assertIs=function(e){},a.assertNever=function(e){throw Error()},a.arrayToEnum=e=>{let t={};for(let a of e)t[a]=a;return t},a.getValidEnumValues=e=>{let t=a.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),i={};for(let a of t)i[a]=e[a];return a.objectValues(i)},a.objectValues=e=>a.objectKeys(e).map(function(t){return e[t]}),a.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t},a.find=(e,t)=>{for(let a of e)if(t(a))return a},a.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,a.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},a.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(n||(n={})).mergeShapes=(e,t)=>({...e,...t});let R=s.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),O=e=>{switch(typeof e){case"undefined":return R.undefined;case"string":return R.string;case"number":return isNaN(e)?R.nan:R.number;case"boolean":return R.boolean;case"function":return R.function;case"bigint":return R.bigint;case"symbol":return R.symbol;case"object":if(Array.isArray(e))return R.array;if(null===e)return R.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return R.promise;if("undefined"!=typeof Map&&e instanceof Map)return R.map;if("undefined"!=typeof Set&&e instanceof Set)return R.set;if("undefined"!=typeof Date&&e instanceof Date)return R.date;return R.object;default:return R.unknown}},M=s.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class D extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},a={_errors:[]},i=e=>{for(let r of e.issues)if("invalid_union"===r.code)r.unionErrors.map(i);else if("invalid_return_type"===r.code)i(r.returnTypeError);else if("invalid_arguments"===r.code)i(r.argumentsError);else if(0===r.path.length)a._errors.push(t(r));else{let e=a,i=0;for(;i<r.path.length;){let a=r.path[i];i===r.path.length-1?(e[a]=e[a]||{_errors:[]},e[a]._errors.push(t(r))):e[a]=e[a]||{_errors:[]},e=e[a],i++}}};return i(this),a}static assert(e){if(!(e instanceof D))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,s.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},a=[];for(let i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):a.push(e(i));return{formErrors:a,fieldErrors:t}}get formErrors(){return this.flatten()}}D.create=e=>new D(e);let L=(e,t)=>{let a;switch(e.code){case M.invalid_type:a=e.received===R.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case M.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(e.expected,s.jsonStringifyReplacer)}`;break;case M.unrecognized_keys:a=`Unrecognized key(s) in object: ${s.joinValues(e.keys,", ")}`;break;case M.invalid_union:a="Invalid input";break;case M.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${s.joinValues(e.options)}`;break;case M.invalid_enum_value:a=`Invalid enum value. Expected ${s.joinValues(e.options)}, received '${e.received}'`;break;case M.invalid_arguments:a="Invalid function arguments";break;case M.invalid_return_type:a="Invalid function return type";break;case M.invalid_date:a="Invalid date";break;case M.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(a=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(a=`${a} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?a=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?a=`Invalid input: must end with "${e.validation.endsWith}"`:s.assertNever(e.validation):a="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case M.too_small:a="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case M.too_big:a="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case M.custom:a="Invalid input";break;case M.invalid_intersection_types:a="Intersection results could not be merged";break;case M.not_multiple_of:a=`Number must be a multiple of ${e.multipleOf}`;break;case M.not_finite:a="Number must be finite";break;default:a=t.defaultError,s.assertNever(e)}return{message:a}},Z=L;function K(){return Z}let B=e=>{let{data:t,path:a,errorMaps:i,issueData:r}=e,s=[...a,...r.path||[]],n={...r,path:s};if(void 0!==r.message)return{...r,path:s,message:r.message};let o="";for(let e of i.filter(e=>!!e).slice().reverse())o=e(n,{data:t,defaultError:o}).message;return{...r,path:s,message:o}};function F(e,t){let a=K(),i=B({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,a,a===L?void 0:L].filter(e=>!!e)});e.common.issues.push(i)}class Q{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let a=[];for(let i of t){if("aborted"===i.status)return z;"dirty"===i.status&&e.dirty(),a.push(i.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,t){let a=[];for(let e of t){let t=await e.key,i=await e.value;a.push({key:t,value:i})}return Q.mergeObjectSync(e,a)}static mergeObjectSync(e,t){let a={};for(let i of t){let{key:t,value:r}=i;if("aborted"===t.status||"aborted"===r.status)return z;"dirty"===t.status&&e.dirty(),"dirty"===r.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==r.value||i.alwaysSet)&&(a[t.value]=r.value)}return{status:e.value,value:a}}}let z=Object.freeze({status:"aborted"}),U=e=>({status:"dirty",value:e}),V=e=>({status:"valid",value:e}),W=e=>"aborted"===e.status,J=e=>"dirty"===e.status,X=e=>"valid"===e.status,G=e=>"undefined"!=typeof Promise&&e instanceof Promise;function H(e,t,a,i){if("a"===a&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?i:"a"===a?i.call(e):i?i.value:t.get(e)}function Y(e,t,a,i,r){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!r)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,a):r?r.value=a:t.set(e,a),a}"function"==typeof SuppressedError&&SuppressedError,(i=o||(o={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},i.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class ee{constructor(e,t,a,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=a,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let et=(e,t)=>{if(X(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new D(e.common.issues);return this._error=t,this._error}}};function ea(e){if(!e)return{};let{errorMap:t,invalid_type_error:a,required_error:i,description:r}=e;if(t&&(a||i))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:r}:{errorMap:(t,r)=>{var s,n;let{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:r.defaultError}:void 0===r.data?{message:null!=(s=null!=o?o:i)?s:r.defaultError}:"invalid_type"!==t.code?{message:r.defaultError}:{message:null!=(n=null!=o?o:a)?n:r.defaultError}},description:r}}class ei{get description(){return this._def.description}_getType(e){return O(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:O(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Q,ctx:{common:e.parent.common,data:e.data,parsedType:O(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(G(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let a=this.safeParse(e,t);if(a.success)return a.data;throw a.error}safeParse(e,t){var a;let i={common:{issues:[],async:null!=(a=null==t?void 0:t.async)&&a,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:O(e)},r=this._parseSync({data:e,path:i.path,parent:i});return et(i,r)}"~validate"(e){var t,a;let i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:O(e)};if(!this["~standard"].async)try{let t=this._parseSync({data:e,path:[],parent:i});return X(t)?{value:t.value}:{issues:i.common.issues}}catch(e){(null==(a=null==(t=null==e?void 0:e.message)?void 0:t.toLowerCase())?void 0:a.includes("encountered"))&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(e=>X(e)?{value:e.value}:{issues:i.common.issues})}async parseAsync(e,t){let a=await this.safeParseAsync(e,t);if(a.success)return a.data;throw a.error}async safeParseAsync(e,t){let a={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:O(e)},i=this._parse({data:e,path:a.path,parent:a});return et(a,await (G(i)?i:Promise.resolve(i)))}refine(e,t){return this._refinement((a,i)=>{let r=e(a),s=()=>i.addIssue({code:M.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(a):t});return"undefined"!=typeof Promise&&r instanceof Promise?r.then(e=>!!e||(s(),!1)):!!r||(s(),!1)})}refinement(e,t){return this._refinement((a,i)=>!!e(a)||(i.addIssue("function"==typeof t?t(a,i):t),!1))}_refinement(e){return new eG({schema:this,typeName:u.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return eH.create(this,this._def)}nullable(){return eY.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return eE.create(this)}promise(){return eX.create(this,this._def)}or(e){return eO.create([this,e],this._def)}and(e){return eL.create(this,e,this._def)}transform(e){return new eG({...ea(this._def),schema:this,typeName:u.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new e0({...ea(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:u.ZodDefault})}brand(){return new e4({typeName:u.ZodBranded,type:this,...ea(this._def)})}catch(e){return new e1({...ea(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:u.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return e5.create(this,e)}readonly(){return e3.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let er=/^c[^\s-]{8,}$/i,es=/^[0-9a-z]+$/,en=/^[0-9A-HJKMNP-TV-Z]{26}$/i,eo=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,el=/^[a-z0-9_-]{21}$/i,ed=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,eu=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ec=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ep=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,em=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,eh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ef=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,e_=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eg=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ey="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ev=RegExp(`^${ey}$`);function eb(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function ex(e){let t=`${ey}T${eb(e)}`,a=[];return a.push(e.local?"Z?":"Z"),e.offset&&a.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${a.join("|")})`,RegExp(`^${t}$`)}class eN extends ei{_parse(e){var a,i,r,n;let o;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==R.string){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.string,received:t.parsedType}),z}let l=new Q;for(let d of this._def.checks)if("min"===d.kind)e.data.length<d.value&&(F(o=this._getOrReturnCtx(e,o),{code:M.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),l.dirty());else if("max"===d.kind)e.data.length>d.value&&(F(o=this._getOrReturnCtx(e,o),{code:M.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),l.dirty());else if("length"===d.kind){let t=e.data.length>d.value,a=e.data.length<d.value;(t||a)&&(o=this._getOrReturnCtx(e,o),t?F(o,{code:M.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}):a&&F(o,{code:M.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}),l.dirty())}else if("email"===d.kind)ec.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"email",code:M.invalid_string,message:d.message}),l.dirty());else if("emoji"===d.kind)t||(t=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),t.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"emoji",code:M.invalid_string,message:d.message}),l.dirty());else if("uuid"===d.kind)eo.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"uuid",code:M.invalid_string,message:d.message}),l.dirty());else if("nanoid"===d.kind)el.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"nanoid",code:M.invalid_string,message:d.message}),l.dirty());else if("cuid"===d.kind)er.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"cuid",code:M.invalid_string,message:d.message}),l.dirty());else if("cuid2"===d.kind)es.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"cuid2",code:M.invalid_string,message:d.message}),l.dirty());else if("ulid"===d.kind)en.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"ulid",code:M.invalid_string,message:d.message}),l.dirty());else if("url"===d.kind)try{new URL(e.data)}catch(t){F(o=this._getOrReturnCtx(e,o),{validation:"url",code:M.invalid_string,message:d.message}),l.dirty()}else"regex"===d.kind?(d.regex.lastIndex=0,d.regex.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"regex",code:M.invalid_string,message:d.message}),l.dirty())):"trim"===d.kind?e.data=e.data.trim():"includes"===d.kind?e.data.includes(d.value,d.position)||(F(o=this._getOrReturnCtx(e,o),{code:M.invalid_string,validation:{includes:d.value,position:d.position},message:d.message}),l.dirty()):"toLowerCase"===d.kind?e.data=e.data.toLowerCase():"toUpperCase"===d.kind?e.data=e.data.toUpperCase():"startsWith"===d.kind?e.data.startsWith(d.value)||(F(o=this._getOrReturnCtx(e,o),{code:M.invalid_string,validation:{startsWith:d.value},message:d.message}),l.dirty()):"endsWith"===d.kind?e.data.endsWith(d.value)||(F(o=this._getOrReturnCtx(e,o),{code:M.invalid_string,validation:{endsWith:d.value},message:d.message}),l.dirty()):"datetime"===d.kind?ex(d).test(e.data)||(F(o=this._getOrReturnCtx(e,o),{code:M.invalid_string,validation:"datetime",message:d.message}),l.dirty()):"date"===d.kind?ev.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{code:M.invalid_string,validation:"date",message:d.message}),l.dirty()):"time"===d.kind?RegExp(`^${eb(d)}$`).test(e.data)||(F(o=this._getOrReturnCtx(e,o),{code:M.invalid_string,validation:"time",message:d.message}),l.dirty()):"duration"===d.kind?eu.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"duration",code:M.invalid_string,message:d.message}),l.dirty()):"ip"===d.kind?(a=e.data,!(("v4"===(i=d.version)||!i)&&ep.test(a)||("v6"===i||!i)&&eh.test(a))&&1&&(F(o=this._getOrReturnCtx(e,o),{validation:"ip",code:M.invalid_string,message:d.message}),l.dirty())):"jwt"===d.kind?!function(e,t){if(!ed.test(e))return!1;try{let[a]=e.split("."),i=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(i));if("object"!=typeof r||null===r||!r.typ||!r.alg||t&&r.alg!==t)return!1;return!0}catch(e){return!1}}(e.data,d.alg)&&(F(o=this._getOrReturnCtx(e,o),{validation:"jwt",code:M.invalid_string,message:d.message}),l.dirty()):"cidr"===d.kind?(r=e.data,!(("v4"===(n=d.version)||!n)&&em.test(r)||("v6"===n||!n)&&ef.test(r))&&1&&(F(o=this._getOrReturnCtx(e,o),{validation:"cidr",code:M.invalid_string,message:d.message}),l.dirty())):"base64"===d.kind?e_.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"base64",code:M.invalid_string,message:d.message}),l.dirty()):"base64url"===d.kind?eg.test(e.data)||(F(o=this._getOrReturnCtx(e,o),{validation:"base64url",code:M.invalid_string,message:d.message}),l.dirty()):s.assertNever(d);return{status:l.value,value:e.data}}_regex(e,t,a){return this.refinement(t=>e.test(t),{validation:t,code:M.invalid_string,...o.errToObj(a)})}_addCheck(e){return new eN({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...o.errToObj(e)})}url(e){return this._addCheck({kind:"url",...o.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...o.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...o.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...o.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...o.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...o.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...o.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...o.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...o.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...o.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...o.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...o.errToObj(e)})}datetime(e){var t,a;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!=(t=null==e?void 0:e.offset)&&t,local:null!=(a=null==e?void 0:e.local)&&a,...o.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...o.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...o.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...o.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...o.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...o.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...o.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...o.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...o.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...o.errToObj(t)})}nonempty(e){return this.min(1,o.errToObj(e))}trim(){return new eN({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new eN({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new eN({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}eN.create=e=>{var t;return new eN({checks:[],typeName:u.ZodString,coerce:null!=(t=null==e?void 0:e.coerce)&&t,...ea(e)})};class ew extends ei{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==R.number){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.number,received:t.parsedType}),z}let a=new Q;for(let i of this._def.checks)"int"===i.kind?s.isInteger(e.data)||(F(t=this._getOrReturnCtx(e,t),{code:M.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(F(t=this._getOrReturnCtx(e,t),{code:M.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(F(t=this._getOrReturnCtx(e,t),{code:M.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):"multipleOf"===i.kind?0!==function(e,t){let a=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,r=a>i?a:i;return parseInt(e.toFixed(r).replace(".",""))%parseInt(t.toFixed(r).replace(".",""))/Math.pow(10,r)}(e.data,i.value)&&(F(t=this._getOrReturnCtx(e,t),{code:M.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(F(t=this._getOrReturnCtx(e,t),{code:M.not_finite,message:i.message}),a.dirty()):s.assertNever(i);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,o.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.toString(t))}setLimit(e,t,a,i){return new ew({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:o.toString(i)}]})}_addCheck(e){return new ew({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:o.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:o.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:o.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:o.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:o.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:o.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:o.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:o.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&s.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let a of this._def.checks)if("finite"===a.kind||"int"===a.kind||"multipleOf"===a.kind)return!0;else"min"===a.kind?(null===t||a.value>t)&&(t=a.value):"max"===a.kind&&(null===e||a.value<e)&&(e=a.value);return Number.isFinite(t)&&Number.isFinite(e)}}ew.create=e=>new ew({checks:[],typeName:u.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...ea(e)});class eI extends ei{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch(t){return this._getInvalidInput(e)}if(this._getType(e)!==R.bigint)return this._getInvalidInput(e);let a=new Q;for(let i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(F(t=this._getOrReturnCtx(e,t),{code:M.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(F(t=this._getOrReturnCtx(e,t),{code:M.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(F(t=this._getOrReturnCtx(e,t),{code:M.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):s.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.bigint,received:t.parsedType}),z}gte(e,t){return this.setLimit("min",e,!0,o.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.toString(t))}setLimit(e,t,a,i){return new eI({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:o.toString(i)}]})}_addCheck(e){return new eI({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:o.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:o.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:o.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:o.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}eI.create=e=>{var t;return new eI({checks:[],typeName:u.ZodBigInt,coerce:null!=(t=null==e?void 0:e.coerce)&&t,...ea(e)})};class eT extends ei{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==R.boolean){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.boolean,received:t.parsedType}),z}return V(e.data)}}eT.create=e=>new eT({typeName:u.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...ea(e)});class eA extends ei{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==R.date){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.date,received:t.parsedType}),z}if(isNaN(e.data.getTime()))return F(this._getOrReturnCtx(e),{code:M.invalid_date}),z;let a=new Q;for(let i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(F(t=this._getOrReturnCtx(e,t),{code:M.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),a.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(F(t=this._getOrReturnCtx(e,t),{code:M.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),a.dirty()):s.assertNever(i);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new eA({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:o.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:o.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}eA.create=e=>new eA({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:u.ZodDate,...ea(e)});class eS extends ei{_parse(e){if(this._getType(e)!==R.symbol){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.symbol,received:t.parsedType}),z}return V(e.data)}}eS.create=e=>new eS({typeName:u.ZodSymbol,...ea(e)});class ek extends ei{_parse(e){if(this._getType(e)!==R.undefined){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.undefined,received:t.parsedType}),z}return V(e.data)}}ek.create=e=>new ek({typeName:u.ZodUndefined,...ea(e)});class eq extends ei{_parse(e){if(this._getType(e)!==R.null){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.null,received:t.parsedType}),z}return V(e.data)}}eq.create=e=>new eq({typeName:u.ZodNull,...ea(e)});class eC extends ei{constructor(){super(...arguments),this._any=!0}_parse(e){return V(e.data)}}eC.create=e=>new eC({typeName:u.ZodAny,...ea(e)});class ej extends ei{constructor(){super(...arguments),this._unknown=!0}_parse(e){return V(e.data)}}ej.create=e=>new ej({typeName:u.ZodUnknown,...ea(e)});class eP extends ei{_parse(e){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.never,received:t.parsedType}),z}}eP.create=e=>new eP({typeName:u.ZodNever,...ea(e)});class e$ extends ei{_parse(e){if(this._getType(e)!==R.undefined){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.void,received:t.parsedType}),z}return V(e.data)}}e$.create=e=>new e$({typeName:u.ZodVoid,...ea(e)});class eE extends ei{_parse(e){let{ctx:t,status:a}=this._processInputParams(e),i=this._def;if(t.parsedType!==R.array)return F(t,{code:M.invalid_type,expected:R.array,received:t.parsedType}),z;if(null!==i.exactLength){let e=t.data.length>i.exactLength.value,r=t.data.length<i.exactLength.value;(e||r)&&(F(t,{code:e?M.too_big:M.too_small,minimum:r?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),a.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(F(t,{code:M.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),a.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(F(t,{code:M.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),a.dirty()),t.common.async)return Promise.all([...t.data].map((e,a)=>i.type._parseAsync(new ee(t,e,t.path,a)))).then(e=>Q.mergeArray(a,e));let r=[...t.data].map((e,a)=>i.type._parseSync(new ee(t,e,t.path,a)));return Q.mergeArray(a,r)}get element(){return this._def.type}min(e,t){return new eE({...this._def,minLength:{value:e,message:o.toString(t)}})}max(e,t){return new eE({...this._def,maxLength:{value:e,message:o.toString(t)}})}length(e,t){return new eE({...this._def,exactLength:{value:e,message:o.toString(t)}})}nonempty(e){return this.min(1,e)}}eE.create=(e,t)=>new eE({type:e,minLength:null,maxLength:null,exactLength:null,typeName:u.ZodArray,...ea(t)});class eR extends ei{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=s.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==R.object){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.object,received:t.parsedType}),z}let{status:t,ctx:a}=this._processInputParams(e),{shape:i,keys:r}=this._getCached(),s=[];if(!(this._def.catchall instanceof eP&&"strip"===this._def.unknownKeys))for(let e in a.data)r.includes(e)||s.push(e);let n=[];for(let e of r){let t=i[e],r=a.data[e];n.push({key:{status:"valid",value:e},value:t._parse(new ee(a,r,a.path,e)),alwaysSet:e in a.data})}if(this._def.catchall instanceof eP){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)n.push({key:{status:"valid",value:e},value:{status:"valid",value:a.data[e]}});else if("strict"===e)s.length>0&&(F(a,{code:M.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let i=a.data[t];n.push({key:{status:"valid",value:t},value:e._parse(new ee(a,i,a.path,t)),alwaysSet:t in a.data})}}return a.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of n){let a=await t.key,i=await t.value;e.push({key:a,value:i,alwaysSet:t.alwaysSet})}return e}).then(e=>Q.mergeObjectSync(t,e)):Q.mergeObjectSync(t,n)}get shape(){return this._def.shape()}strict(e){return o.errToObj,new eR({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,a)=>{var i,r,s,n;let l=null!=(s=null==(r=(i=this._def).errorMap)?void 0:r.call(i,t,a).message)?s:a.defaultError;return"unrecognized_keys"===t.code?{message:null!=(n=o.errToObj(e).message)?n:l}:{message:l}}}:{}})}strip(){return new eR({...this._def,unknownKeys:"strip"})}passthrough(){return new eR({...this._def,unknownKeys:"passthrough"})}extend(e){return new eR({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new eR({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:u.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new eR({...this._def,catchall:e})}pick(e){let t={};return s.objectKeys(e).forEach(a=>{e[a]&&this.shape[a]&&(t[a]=this.shape[a])}),new eR({...this._def,shape:()=>t})}omit(e){let t={};return s.objectKeys(this.shape).forEach(a=>{e[a]||(t[a]=this.shape[a])}),new eR({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof eR){let a={};for(let i in t.shape){let r=t.shape[i];a[i]=eH.create(e(r))}return new eR({...t._def,shape:()=>a})}if(t instanceof eE)return new eE({...t._def,type:e(t.element)});if(t instanceof eH)return eH.create(e(t.unwrap()));if(t instanceof eY)return eY.create(e(t.unwrap()));if(t instanceof eZ)return eZ.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};return s.objectKeys(this.shape).forEach(a=>{let i=this.shape[a];e&&!e[a]?t[a]=i:t[a]=i.optional()}),new eR({...this._def,shape:()=>t})}required(e){let t={};return s.objectKeys(this.shape).forEach(a=>{if(e&&!e[a])t[a]=this.shape[a];else{let e=this.shape[a];for(;e instanceof eH;)e=e._def.innerType;t[a]=e}}),new eR({...this._def,shape:()=>t})}keyof(){return eV(s.objectKeys(this.shape))}}eR.create=(e,t)=>new eR({shape:()=>e,unknownKeys:"strip",catchall:eP.create(),typeName:u.ZodObject,...ea(t)}),eR.strictCreate=(e,t)=>new eR({shape:()=>e,unknownKeys:"strict",catchall:eP.create(),typeName:u.ZodObject,...ea(t)}),eR.lazycreate=(e,t)=>new eR({shape:e,unknownKeys:"strip",catchall:eP.create(),typeName:u.ZodObject,...ea(t)});class eO extends ei{_parse(e){let{ctx:t}=this._processInputParams(e),a=this._def.options;if(t.common.async)return Promise.all(a.map(async e=>{let a={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let a of e)if("dirty"===a.result.status)return t.common.issues.push(...a.ctx.common.issues),a.result;let a=e.map(e=>new D(e.ctx.common.issues));return F(t,{code:M.invalid_union,unionErrors:a}),z});{let e,i=[];for(let r of a){let a={...t,common:{...t.common,issues:[]},parent:null},s=r._parseSync({data:t.data,path:t.path,parent:a});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:a}),a.common.issues.length&&i.push(a.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let r=i.map(e=>new D(e));return F(t,{code:M.invalid_union,unionErrors:r}),z}}get options(){return this._def.options}}eO.create=(e,t)=>new eO({options:e,typeName:u.ZodUnion,...ea(t)});let eM=e=>{if(e instanceof ez)return eM(e.schema);if(e instanceof eG)return eM(e.innerType());if(e instanceof eU)return[e.value];if(e instanceof eW)return e.options;if(e instanceof eJ)return s.objectValues(e.enum);else if(e instanceof e0)return eM(e._def.innerType);else if(e instanceof ek)return[void 0];else if(e instanceof eq)return[null];else if(e instanceof eH)return[void 0,...eM(e.unwrap())];else if(e instanceof eY)return[null,...eM(e.unwrap())];else if(e instanceof e4)return eM(e.unwrap());else if(e instanceof e3)return eM(e.unwrap());else if(e instanceof e1)return eM(e._def.innerType);else return[]};class eD extends ei{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==R.object)return F(t,{code:M.invalid_type,expected:R.object,received:t.parsedType}),z;let a=this.discriminator,i=t.data[a],r=this.optionsMap.get(i);return r?t.common.async?r._parseAsync({data:t.data,path:t.path,parent:t}):r._parseSync({data:t.data,path:t.path,parent:t}):(F(t,{code:M.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),z)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,a){let i=new Map;for(let a of t){let t=eM(a.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let r of t){if(i.has(r))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(r)}`);i.set(r,a)}}return new eD({typeName:u.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...ea(a)})}}class eL extends ei{_parse(e){let{status:t,ctx:a}=this._processInputParams(e),i=(e,i)=>{if(W(e)||W(i))return z;let r=function e(t,a){let i=O(t),r=O(a);if(t===a)return{valid:!0,data:t};if(i===R.object&&r===R.object){let i=s.objectKeys(a),r=s.objectKeys(t).filter(e=>-1!==i.indexOf(e)),n={...t,...a};for(let i of r){let r=e(t[i],a[i]);if(!r.valid)return{valid:!1};n[i]=r.data}return{valid:!0,data:n}}if(i===R.array&&r===R.array){if(t.length!==a.length)return{valid:!1};let i=[];for(let r=0;r<t.length;r++){let s=e(t[r],a[r]);if(!s.valid)return{valid:!1};i.push(s.data)}return{valid:!0,data:i}}if(i===R.date&&r===R.date&&+t==+a)return{valid:!0,data:t};return{valid:!1}}(e.value,i.value);return r.valid?((J(e)||J(i))&&t.dirty(),{status:t.value,value:r.data}):(F(a,{code:M.invalid_intersection_types}),z)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([e,t])=>i(e,t)):i(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}eL.create=(e,t,a)=>new eL({left:e,right:t,typeName:u.ZodIntersection,...ea(a)});class eZ extends ei{_parse(e){let{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==R.array)return F(a,{code:M.invalid_type,expected:R.array,received:a.parsedType}),z;if(a.data.length<this._def.items.length)return F(a,{code:M.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),z;!this._def.rest&&a.data.length>this._def.items.length&&(F(a,{code:M.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...a.data].map((e,t)=>{let i=this._def.items[t]||this._def.rest;return i?i._parse(new ee(a,e,a.path,t)):null}).filter(e=>!!e);return a.common.async?Promise.all(i).then(e=>Q.mergeArray(t,e)):Q.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new eZ({...this._def,rest:e})}}eZ.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new eZ({items:e,typeName:u.ZodTuple,rest:null,...ea(t)})};class eK extends ei{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==R.object)return F(a,{code:M.invalid_type,expected:R.object,received:a.parsedType}),z;let i=[],r=this._def.keyType,s=this._def.valueType;for(let e in a.data)i.push({key:r._parse(new ee(a,e,a.path,e)),value:s._parse(new ee(a,a.data[e],a.path,e)),alwaysSet:e in a.data});return a.common.async?Q.mergeObjectAsync(t,i):Q.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,a){return new eK(t instanceof ei?{keyType:e,valueType:t,typeName:u.ZodRecord,...ea(a)}:{keyType:eN.create(),valueType:e,typeName:u.ZodRecord,...ea(t)})}}class eB extends ei{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==R.map)return F(a,{code:M.invalid_type,expected:R.map,received:a.parsedType}),z;let i=this._def.keyType,r=this._def.valueType,s=[...a.data.entries()].map(([e,t],s)=>({key:i._parse(new ee(a,e,a.path,[s,"key"])),value:r._parse(new ee(a,t,a.path,[s,"value"]))}));if(a.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let a of s){let i=await a.key,r=await a.value;if("aborted"===i.status||"aborted"===r.status)return z;("dirty"===i.status||"dirty"===r.status)&&t.dirty(),e.set(i.value,r.value)}return{status:t.value,value:e}})}{let e=new Map;for(let a of s){let i=a.key,r=a.value;if("aborted"===i.status||"aborted"===r.status)return z;("dirty"===i.status||"dirty"===r.status)&&t.dirty(),e.set(i.value,r.value)}return{status:t.value,value:e}}}}eB.create=(e,t,a)=>new eB({valueType:t,keyType:e,typeName:u.ZodMap,...ea(a)});class eF extends ei{_parse(e){let{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==R.set)return F(a,{code:M.invalid_type,expected:R.set,received:a.parsedType}),z;let i=this._def;null!==i.minSize&&a.data.size<i.minSize.value&&(F(a,{code:M.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&a.data.size>i.maxSize.value&&(F(a,{code:M.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let r=this._def.valueType;function s(e){let a=new Set;for(let i of e){if("aborted"===i.status)return z;"dirty"===i.status&&t.dirty(),a.add(i.value)}return{status:t.value,value:a}}let n=[...a.data.values()].map((e,t)=>r._parse(new ee(a,e,a.path,t)));return a.common.async?Promise.all(n).then(e=>s(e)):s(n)}min(e,t){return new eF({...this._def,minSize:{value:e,message:o.toString(t)}})}max(e,t){return new eF({...this._def,maxSize:{value:e,message:o.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}eF.create=(e,t)=>new eF({valueType:e,minSize:null,maxSize:null,typeName:u.ZodSet,...ea(t)});class eQ extends ei{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==R.function)return F(t,{code:M.invalid_type,expected:R.function,received:t.parsedType}),z;function a(e,a){return B({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,K(),L].filter(e=>!!e),issueData:{code:M.invalid_arguments,argumentsError:a}})}function i(e,a){return B({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,K(),L].filter(e=>!!e),issueData:{code:M.invalid_return_type,returnTypeError:a}})}let r={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof eX){let e=this;return V(async function(...t){let n=new D([]),o=await e._def.args.parseAsync(t,r).catch(e=>{throw n.addIssue(a(t,e)),n}),l=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(l,r).catch(e=>{throw n.addIssue(i(l,e)),n})})}{let e=this;return V(function(...t){let n=e._def.args.safeParse(t,r);if(!n.success)throw new D([a(t,n.error)]);let o=Reflect.apply(s,this,n.data),l=e._def.returns.safeParse(o,r);if(!l.success)throw new D([i(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new eQ({...this._def,args:eZ.create(e).rest(ej.create())})}returns(e){return new eQ({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,a){return new eQ({args:e||eZ.create([]).rest(ej.create()),returns:t||ej.create(),typeName:u.ZodFunction,...ea(a)})}}class ez extends ei{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ez.create=(e,t)=>new ez({getter:e,typeName:u.ZodLazy,...ea(t)});class eU extends ei{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return F(t,{received:t.data,code:M.invalid_literal,expected:this._def.value}),z}return{status:"valid",value:e.data}}get value(){return this._def.value}}function eV(e,t){return new eW({values:e,typeName:u.ZodEnum,...ea(t)})}eU.create=(e,t)=>new eU({value:e,typeName:u.ZodLiteral,...ea(t)});class eW extends ei{constructor(){super(...arguments),l.set(this,void 0)}_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),a=this._def.values;return F(t,{expected:s.joinValues(a),received:t.parsedType,code:M.invalid_type}),z}if(H(this,l,"f")||Y(this,l,new Set(this._def.values),"f"),!H(this,l,"f").has(e.data)){let t=this._getOrReturnCtx(e),a=this._def.values;return F(t,{received:t.data,code:M.invalid_enum_value,options:a}),z}return V(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return eW.create(e,{...this._def,...t})}exclude(e,t=this._def){return eW.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}l=new WeakMap,eW.create=eV;class eJ extends ei{constructor(){super(...arguments),d.set(this,void 0)}_parse(e){let t=s.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==R.string&&a.parsedType!==R.number){let e=s.objectValues(t);return F(a,{expected:s.joinValues(e),received:a.parsedType,code:M.invalid_type}),z}if(H(this,d,"f")||Y(this,d,new Set(s.getValidEnumValues(this._def.values)),"f"),!H(this,d,"f").has(e.data)){let e=s.objectValues(t);return F(a,{received:a.data,code:M.invalid_enum_value,options:e}),z}return V(e.data)}get enum(){return this._def.values}}d=new WeakMap,eJ.create=(e,t)=>new eJ({values:e,typeName:u.ZodNativeEnum,...ea(t)});class eX extends ei{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==R.promise&&!1===t.common.async?(F(t,{code:M.invalid_type,expected:R.promise,received:t.parsedType}),z):V((t.parsedType===R.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}eX.create=(e,t)=>new eX({type:e,typeName:u.ZodPromise,...ea(t)});class eG extends ei{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===u.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:a}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:e=>{F(a,e),e.fatal?t.abort():t.dirty()},get path(){return a.path}};if(r.addIssue=r.addIssue.bind(r),"preprocess"===i.type){let e=i.transform(a.data,r);if(a.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return z;let i=await this._def.schema._parseAsync({data:e,path:a.path,parent:a});return"aborted"===i.status?z:"dirty"===i.status||"dirty"===t.value?U(i.value):i});{if("aborted"===t.value)return z;let i=this._def.schema._parseSync({data:e,path:a.path,parent:a});return"aborted"===i.status?z:"dirty"===i.status||"dirty"===t.value?U(i.value):i}}if("refinement"===i.type){let e=e=>{let t=i.refinement(e,r);if(a.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==a.common.async)return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(a=>"aborted"===a.status?z:("dirty"===a.status&&t.dirty(),e(a.value).then(()=>({status:t.value,value:a.value}))));{let i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===i.status?z:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}}if("transform"===i.type)if(!1!==a.common.async)return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(e=>X(e)?Promise.resolve(i.transform(e.value,r)).then(e=>({status:t.value,value:e})):e);else{let e=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!X(e))return e;let s=i.transform(e.value,r);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}s.assertNever(i)}}eG.create=(e,t,a)=>new eG({schema:e,typeName:u.ZodEffects,effect:t,...ea(a)}),eG.createWithPreprocess=(e,t,a)=>new eG({schema:t,effect:{type:"preprocess",transform:e},typeName:u.ZodEffects,...ea(a)});class eH extends ei{_parse(e){return this._getType(e)===R.undefined?V(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eH.create=(e,t)=>new eH({innerType:e,typeName:u.ZodOptional,...ea(t)});class eY extends ei{_parse(e){return this._getType(e)===R.null?V(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eY.create=(e,t)=>new eY({innerType:e,typeName:u.ZodNullable,...ea(t)});class e0 extends ei{_parse(e){let{ctx:t}=this._processInputParams(e),a=t.data;return t.parsedType===R.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}e0.create=(e,t)=>new e0({innerType:e,typeName:u.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...ea(t)});class e1 extends ei{_parse(e){let{ctx:t}=this._processInputParams(e),a={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return G(i)?i.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new D(a.common.issues)},input:a.data})})):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new D(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}e1.create=(e,t)=>new e1({innerType:e,typeName:u.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...ea(t)});class e2 extends ei{_parse(e){if(this._getType(e)!==R.nan){let t=this._getOrReturnCtx(e);return F(t,{code:M.invalid_type,expected:R.nan,received:t.parsedType}),z}return{status:"valid",value:e.data}}}e2.create=e=>new e2({typeName:u.ZodNaN,...ea(e)});let e9=Symbol("zod_brand");class e4 extends ei{_parse(e){let{ctx:t}=this._processInputParams(e),a=t.data;return this._def.type._parse({data:a,path:t.path,parent:t})}unwrap(){return this._def.type}}class e5 extends ei{_parse(e){let{status:t,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return"aborted"===e.status?z:"dirty"===e.status?(t.dirty(),U(e.value)):this._def.out._parseAsync({data:e.value,path:a.path,parent:a})})();{let e=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===e.status?z:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:a.path,parent:a})}}static create(e,t){return new e5({in:e,out:t,typeName:u.ZodPipeline})}}class e3 extends ei{_parse(e){let t=this._def.innerType._parse(e),a=e=>(X(e)&&(e.value=Object.freeze(e.value)),e);return G(t)?t.then(e=>a(e)):a(t)}unwrap(){return this._def.innerType}}function e8(e,t){let a="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof a?{message:a}:a}function e6(e,t={},a){return e?eC.create().superRefine((i,r)=>{var s,n;let o=e(i);if(o instanceof Promise)return o.then(e=>{var s,n;if(!e){let e=e8(t,i),o=null==(n=null!=(s=e.fatal)?s:a)||n;r.addIssue({code:"custom",...e,fatal:o})}});if(!o){let e=e8(t,i),o=null==(n=null!=(s=e.fatal)?s:a)||n;r.addIssue({code:"custom",...e,fatal:o})}}):eC.create()}e3.create=(e,t)=>new e3({innerType:e,typeName:u.ZodReadonly,...ea(t)});let e7={object:eR.lazycreate};(r=u||(u={})).ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly";let te=eN.create,tt=ew.create,ta=e2.create,ti=eI.create,tr=eT.create,ts=eA.create,tn=eS.create,to=ek.create,tl=eq.create,td=eC.create,tu=ej.create,tc=eP.create,tp=e$.create,tm=eE.create,th=eR.create,tf=eR.strictCreate,t_=eO.create,tg=eD.create,ty=eL.create,tv=eZ.create,tb=eK.create,tx=eB.create,tN=eF.create,tw=eQ.create,tI=ez.create,tT=eU.create,tA=eW.create,tS=eJ.create,tk=eX.create,tq=eG.create,tC=eH.create,tj=eY.create,tP=eG.createWithPreprocess,t$=e5.create;var tE=Object.freeze({__proto__:null,defaultErrorMap:L,setErrorMap:function(e){Z=e},getErrorMap:K,makeIssue:B,EMPTY_PATH:[],addIssueToContext:F,ParseStatus:Q,INVALID:z,DIRTY:U,OK:V,isAborted:W,isDirty:J,isValid:X,isAsync:G,get util(){return s},get objectUtil(){return n},ZodParsedType:R,getParsedType:O,ZodType:ei,datetimeRegex:ex,ZodString:eN,ZodNumber:ew,ZodBigInt:eI,ZodBoolean:eT,ZodDate:eA,ZodSymbol:eS,ZodUndefined:ek,ZodNull:eq,ZodAny:eC,ZodUnknown:ej,ZodNever:eP,ZodVoid:e$,ZodArray:eE,ZodObject:eR,ZodUnion:eO,ZodDiscriminatedUnion:eD,ZodIntersection:eL,ZodTuple:eZ,ZodRecord:eK,ZodMap:eB,ZodSet:eF,ZodFunction:eQ,ZodLazy:ez,ZodLiteral:eU,ZodEnum:eW,ZodNativeEnum:eJ,ZodPromise:eX,ZodEffects:eG,ZodTransformer:eG,ZodOptional:eH,ZodNullable:eY,ZodDefault:e0,ZodCatch:e1,ZodNaN:e2,BRAND:e9,ZodBranded:e4,ZodPipeline:e5,ZodReadonly:e3,custom:e6,Schema:ei,ZodSchema:ei,late:e7,get ZodFirstPartyTypeKind(){return u},coerce:{string:e=>eN.create({...e,coerce:!0}),number:e=>ew.create({...e,coerce:!0}),boolean:e=>eT.create({...e,coerce:!0}),bigint:e=>eI.create({...e,coerce:!0}),date:e=>eA.create({...e,coerce:!0})},any:td,array:tm,bigint:ti,boolean:tr,date:ts,discriminatedUnion:tg,effect:tq,enum:tA,function:tw,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>e6(t=>t instanceof e,t),intersection:ty,lazy:tI,literal:tT,map:tx,nan:ta,nativeEnum:tS,never:tc,null:tl,nullable:tj,number:tt,object:th,oboolean:()=>tr().optional(),onumber:()=>tt().optional(),optional:tC,ostring:()=>te().optional(),pipeline:t$,preprocess:tP,promise:tk,record:tb,set:tN,strictObject:tf,string:te,symbol:tn,transformer:tq,tuple:tv,undefined:to,union:t_,unknown:tu,void:tp,NEVER:z,ZodIssueCode:M,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:D});let tR={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:0xffffff,INT32_MIN:-0x80000000,INT32_MAX:0x7fffffff,INT32_UNSIGNED_MAX:0xffffffff,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-0x8000000000000000n,INT64_MAX:0x7fffffffffffffffn,INT64_UNSIGNED_MAX:0xffffffffffffffffn};function tO(e,t){return t.includes(e.columnType)}let tM=tE.union([tE.string(),tE.number(),tE.boolean(),tE.null()]),tD=tE.union([tM,tE.record(tE.any()),tE.array(tE.any())]),tL=tE.custom(e=>e instanceof Buffer);function tZ(e){return(0,P.isTable)(e)?(0,$.getTableColumns)(e):(0,$.getViewSelectedFields)(e)}let tK={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},tB=(e,t)=>(function e(t,a,i,r){let s={};for(let[n,o]of Object.entries(t)){if(!(0,y.is)(o,E.Column)&&!(0,y.is)(o,c.SQL)&&!(0,y.is)(o,c.SQL.Aliased)&&"object"==typeof o){let t=(0,P.isTable)(o)||(0,c.isView)(o)?tZ(o):o;s[n]=e(t,a[n]??{},i,r);continue}let t=a[n];if(void 0!==t&&"function"!=typeof t){s[n]=t;continue}let l=(0,y.is)(o,E.Column)?o:void 0,d=l?function e(t,a){let i,r=a?.zodInstance??tE,s=a?.coerce??{};return"enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0&&(i=t.enumValues.length?r.enum(t.enumValues):r.string()),i||(tO(t,["PgGeometry","PgPointTuple"])?i=r.tuple([r.number(),r.number()]):tO(t,["PgGeometryObject","PgPointObject"])?i=r.object({x:r.number(),y:r.number()}):tO(t,["PgHalfVector","PgVector"])?(i=r.array(r.number()),i=t.dimensions?i.length(t.dimensions):i):tO(t,["PgLine"])?i=r.tuple([r.number(),r.number(),r.number()]):tO(t,["PgLineABC"])?i=r.object({a:r.number(),b:r.number(),c:r.number()}):tO(t,["PgArray"])?(i=r.array(e(t.baseColumn,r)),i=t.size?i.length(t.size):i):"array"===t.dataType?i=r.array(r.any()):"number"===t.dataType?i=function(e,t,a){let i,r,s=e.getSQLType().includes("unsigned"),n=!1;tO(e,["MySqlTinyInt","SingleStoreTinyInt"])?(i=s?0:tR.INT8_MIN,r=s?tR.INT8_UNSIGNED_MAX:tR.INT8_MAX,n=!0):tO(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(i=s?0:tR.INT16_MIN,r=s?tR.INT16_UNSIGNED_MAX:tR.INT16_MAX,n=!0):tO(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(i=s?0:tR.INT24_MIN,r=s?tR.INT24_UNSIGNED_MAX:tR.INT24_MAX,n=tO(e,["MySqlMediumInt","SingleStoreMediumInt"])):tO(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(i=s?0:tR.INT32_MIN,r=s?tR.INT32_UNSIGNED_MAX:tR.INT32_MAX,n=!0):tO(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(i=s?0:tR.INT48_MIN,r=s?tR.INT48_UNSIGNED_MAX:tR.INT48_MAX):tO(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=(s=s||tO(e,["MySqlSerial","SingleStoreSerial"]))?0:Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,n=!0):tO(e,["MySqlYear","SingleStoreYear"])?(i=1901,r=2155,n=!0):(i=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER);let o=!0===a||a?.number?t.coerce.number():t.number();return o=o.min(i).max(r),n?o.int():o}(t,r,s):"bigint"===t.dataType?i=function(e,t,a){let i=e.getSQLType().includes("unsigned"),r=i?0n:tR.INT64_MIN,s=i?tR.INT64_UNSIGNED_MAX:tR.INT64_MAX;return(!0===a||a?.bigint?t.coerce.bigint():t.bigint()).min(r).max(s)}(t,r,s):"boolean"===t.dataType?i=!0===s||s.boolean?r.coerce.boolean():r.boolean():"date"===t.dataType?i=!0===s||s.date?r.coerce.date():r.date():"string"===t.dataType?i=function(e,t,a){let i,r;if(tO(e,["PgUUID"]))return t.string().uuid();let s=!1;tO(e,["PgVarchar","SQLiteText"])?i=e.length:tO(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??tR.INT16_UNSIGNED_MAX:tO(e,["MySqlText","SingleStoreText"])&&(i="longtext"===e.textType?tR.INT32_UNSIGNED_MAX:"mediumtext"===e.textType?tR.INT24_UNSIGNED_MAX:"text"===e.textType?tR.INT16_UNSIGNED_MAX:tR.INT8_UNSIGNED_MAX),tO(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),tO(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let n=!0===a||a?.string?t.coerce.string():t.string();return n=r?n.regex(r):n,i&&s?n.length(i):i?n.max(i):n}(t,r,s):"json"===t.dataType?i=tD:"custom"===t.dataType?i=r.any():"buffer"===t.dataType&&(i=tL)),i||(i=r.any()),i}(l,r):tE.any(),u="function"==typeof t?t(d):d;!i.never(l)&&(s[n]=u,l&&(i.nullable(l)&&(s[n]=s[n].nullable()),i.optional(l)&&(s[n]=s[n].optional())))}return tE.object(s)})(tZ(e),t??{},tK),tF=(0,p.pgTable)("sessions",{sid:(0,h.varchar)("sid").primaryKey(),sess:(0,T.jsonb)("sess").notNull(),expire:(0,_.timestamp)("expire").notNull()},e=>({expireIdx:w("IDX_session_expire").on(e.expire)})),tQ=(0,p.pgTable)("users",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),username:(0,m.text)("username").notNull().unique(),password:(0,m.text)("password"),email:(0,h.varchar)("email").unique(),firstName:(0,h.varchar)("first_name"),lastName:(0,h.varchar)("last_name"),profileImageUrl:(0,h.varchar)("profile_image_url"),location:(0,h.varchar)("location",{length:100}),totalCoins:(0,f.integer)("total_coins").notNull().default(0),weeklyEarned:(0,f.integer)("weekly_earned").notNull().default(0),rank:(0,f.integer)("rank"),youtubeUrl:(0,m.text)("youtube_url"),instagramHandle:(0,m.text)("instagram_handle"),telegramHandle:(0,m.text)("telegram_handle"),myfxbookLink:(0,m.text)("myfxbook_link"),investorId:(0,m.text)("investor_id"),investorPassword:(0,m.text)("investor_password"),isVerifiedTrader:(0,g.boolean)("is_verified_trader").notNull().default(!1),emailNotifications:(0,g.boolean)("email_notifications").notNull().default(!0),hasYoutubeReward:(0,g.boolean)("has_youtube_reward").notNull().default(!1),hasMyfxbookReward:(0,g.boolean)("has_myfxbook_reward").notNull().default(!1),hasInvestorReward:(0,g.boolean)("has_investor_reward").notNull().default(!1),badges:(0,m.text)("badges").array().default(c.sql`'{}'::text[]`),onboardingCompleted:(0,g.boolean)("onboarding_completed").default(!1),onboardingDismissed:(0,g.boolean)("onboarding_dismissed").default(!1),onboardingProgress:(0,A.json)("onboarding_progress").default({profilePicture:!1,firstReply:!1,twoReviews:!1,firstThread:!1,firstPublish:!1,fiftyFollowers:!1}),reputationScore:(0,f.integer)("reputation_score").notNull().default(0),lastReputationUpdate:(0,_.timestamp)("last_reputation_update"),lastJournalPost:(0,j.date)("last_journal_post"),level:(0,f.integer)("level").default(0).notNull(),role:(0,h.varchar)("role",{length:20}).notNull().default("member"),status:(0,h.varchar)("status",{length:20}).notNull().default("active"),suspendedUntil:(0,_.timestamp)("suspended_until"),bannedAt:(0,_.timestamp)("banned_at"),bannedBy:(0,h.varchar)("banned_by"),lastActive:(0,_.timestamp)("last_active").defaultNow(),createdAt:(0,_.timestamp)("created_at").defaultNow(),updatedAt:(0,_.timestamp)("updated_at").defaultNow()},e=>({usernameIdx:w("idx_users_username").on(e.username),emailIdx:w("idx_users_email").on(e.email),reputationIdx:w("idx_users_reputation").on(e.reputationScore),levelIdx:w("idx_users_level").on(e.level),coinsIdx:w("idx_users_coins").on(e.totalCoins),roleIdx:w("idx_users_role").on(e.role),statusIdx:w("idx_users_status").on(e.status),lastActiveIdx:w("idx_users_last_active").on(e.lastActive),coinsCheck:new S("chk_user_coins_nonnegative",c.sql`${e.totalCoins} >= 0`)})),tz=(0,p.pgTable)("user_activity",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),date:(0,j.date)("date").notNull(),activeMinutes:(0,f.integer)("active_minutes").notNull().default(0),coinsEarned:(0,f.integer)("coins_earned").notNull().default(0),lastActivityAt:(0,_.timestamp)("last_activity_at").defaultNow(),createdAt:(0,_.timestamp)("created_at").defaultNow()},e=>({userDateIdx:I("idx_user_activity_user_date").on(e.userId,e.date)})),tU=(0,p.pgTable)("coin_transactions",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),type:(0,m.text)("type").notNull().$type(),amount:(0,f.integer)("amount").notNull(),description:(0,m.text)("description").notNull(),status:(0,m.text)("status").notNull().$type().default("completed"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_coin_transactions_user_id").on(e.userId)})),tV=(0,p.pgTable)("recharge_orders",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),coinAmount:(0,f.integer)("coin_amount").notNull(),priceUsd:(0,f.integer)("price_usd").notNull(),paymentMethod:(0,m.text)("payment_method").notNull().$type(),paymentId:(0,m.text)("payment_id"),status:(0,m.text)("status").notNull().$type().default("pending"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),completedAt:(0,_.timestamp)("completed_at")},e=>({userIdIdx:w("idx_recharge_orders_user_id").on(e.userId)})),tW=(0,p.pgTable)("subscriptions",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),plan:(0,m.text)("plan").notNull().$type(),priceUsd:(0,f.integer)("price_usd").notNull(),paymentMethod:(0,m.text)("payment_method").notNull().$type(),paymentId:(0,m.text)("payment_id"),status:(0,m.text)("status").notNull().$type(),startDate:(0,_.timestamp)("start_date").notNull(),endDate:(0,_.timestamp)("end_date").notNull(),autoRenew:(0,g.boolean)("auto_renew").notNull().default(!0),cancelledAt:(0,_.timestamp)("cancelled_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_subscriptions_user_id").on(e.userId),statusIdx:w("idx_subscriptions_status").on(e.status),statusEndDateIdx:w("idx_subscriptions_status_end_date").on(e.status,e.endDate)})),tJ=(0,p.pgTable)("withdrawal_requests",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),amount:(0,f.integer)("amount").notNull(),method:(0,m.text)("method").$type().default("crypto"),paymentReference:(0,m.text)("payment_reference"),cryptoType:(0,m.text)("crypto_type").$type(),walletAddress:(0,m.text)("wallet_address").notNull(),exchangeRate:(0,q.numeric)("exchange_rate",{precision:20,scale:8}),cryptoAmount:(0,q.numeric)("crypto_amount",{precision:20,scale:8}),status:(0,m.text)("status").notNull().$type().default("pending"),processingFee:(0,f.integer)("processing_fee").notNull(),transactionHash:(0,m.text)("transaction_hash"),adminNotes:(0,m.text)("admin_notes"),approvedBy:(0,h.varchar)("approved_by").references(()=>tQ.id),approvedAt:(0,_.timestamp)("approved_at"),rejectedBy:(0,h.varchar)("rejected_by").references(()=>tQ.id),rejectedAt:(0,_.timestamp)("rejected_at"),rejectionReason:(0,m.text)("rejection_reason"),completedBy:(0,h.varchar)("completed_by").references(()=>tQ.id),amountUsd:(0,q.numeric)("amount_usd",{precision:10,scale:2}),requestedAt:(0,_.timestamp)("requested_at").notNull().defaultNow(),processedAt:(0,_.timestamp)("processed_at"),completedAt:(0,_.timestamp)("completed_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_withdrawal_requests_user_id").on(e.userId),statusIdx:w("idx_withdrawal_requests_status").on(e.status),methodIdx:w("idx_withdrawal_requests_method").on(e.method),approvedByIdx:w("idx_withdrawal_requests_approved_by").on(e.approvedBy),statusMethodIdx:w("idx_withdrawal_requests_status_method").on(e.status,e.method),amountCheck:new S("chk_withdrawal_amount_min",c.sql`${e.amount} >= 1000`)})),tX=(0,p.pgTable)("feedback",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").references(()=>tQ.id),type:(0,m.text)("type").notNull().$type(),subject:(0,m.text)("subject").notNull(),message:(0,m.text)("message").notNull(),email:(0,m.text)("email"),status:(0,m.text)("status").notNull().$type().default("new"),priority:(0,m.text)("priority").$type().default("medium"),adminNotes:(0,m.text)("admin_notes"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_feedback_user_id").on(e.userId),statusIdx:w("idx_feedback_status").on(e.status),typeIdx:w("idx_feedback_type").on(e.type)})),tG=(0,p.pgTable)("content",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),authorId:(0,h.varchar)("author_id").notNull().references(()=>tQ.id),type:(0,m.text)("type").notNull().$type(),title:(0,m.text)("title").notNull(),description:(0,m.text)("description").notNull(),priceCoins:(0,f.integer)("price_coins").notNull().default(0),isFree:(0,g.boolean)("is_free").notNull().default(!0),category:(0,m.text)("category").notNull(),platform:(0,m.text)("platform").$type(),version:(0,m.text)("version"),tags:(0,m.text)("tags").array(),files:(0,T.jsonb)("files").$type(),images:(0,T.jsonb)("images").$type(),brokerCompat:(0,m.text)("broker_compat").array(),minDeposit:(0,f.integer)("min_deposit"),hedging:(0,g.boolean)("hedging"),changelog:(0,m.text)("changelog"),license:(0,m.text)("license"),equityCurveImage:(0,m.text)("equity_curve_image"),profitFactor:(0,f.integer)("profit_factor"),drawdownPercent:(0,f.integer)("drawdown_percent"),winPercent:(0,f.integer)("win_percent"),broker:(0,m.text)("broker"),monthsTested:(0,f.integer)("months_tested"),fileUrl:(0,m.text)("file_url"),imageUrl:(0,m.text)("image_url"),imageUrls:(0,m.text)("image_urls").array(),postLogoUrl:(0,m.text)("post_logo_url"),views:(0,f.integer)("views").notNull().default(0),downloads:(0,f.integer)("downloads").notNull().default(0),likes:(0,f.integer)("likes").notNull().default(0),isFeatured:(0,g.boolean)("is_featured").notNull().default(!1),averageRating:(0,f.integer)("average_rating"),reviewCount:(0,f.integer)("review_count").notNull().default(0),status:(0,m.text)("status").notNull().$type().default("pending"),slug:(0,m.text)("slug").notNull().unique(),focusKeyword:(0,m.text)("focus_keyword"),autoMetaDescription:(0,m.text)("auto_meta_description"),autoImageAltTexts:(0,m.text)("auto_image_alt_texts").array(),metaTitle:(0,m.text)("meta_title"),metaKeywords:(0,m.text)("meta_keywords"),salesScore:(0,f.integer)("sales_score").notNull().default(0),lastSalesUpdate:(0,_.timestamp)("last_sales_update"),approvedBy:(0,h.varchar)("approved_by").references(()=>tQ.id),approvedAt:(0,_.timestamp)("approved_at"),rejectedBy:(0,h.varchar)("rejected_by").references(()=>tQ.id),rejectedAt:(0,_.timestamp)("rejected_at"),rejectionReason:(0,m.text)("rejection_reason"),featured:(0,g.boolean)("featured").notNull().default(!1),featuredUntil:(0,_.timestamp)("featured_until"),deletedAt:(0,_.timestamp)("deleted_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({authorIdIdx:w("idx_content_author_id").on(e.authorId),statusIdx:w("idx_content_status").on(e.status),categoryIdx:w("idx_content_category").on(e.category),slugIdx:w("idx_content_slug").on(e.slug),salesScoreIdx:w("idx_content_sales_score").on(e.salesScore),featuredIdx:w("idx_content_featured").on(e.featured),deletedAtIdx:w("idx_content_deleted_at").on(e.deletedAt)})),tH=(0,p.pgTable)("content_purchases",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),contentId:(0,h.varchar)("content_id").notNull().references(()=>tG.id),buyerId:(0,h.varchar)("buyer_id").notNull().references(()=>tQ.id),sellerId:(0,h.varchar)("seller_id").notNull().references(()=>tQ.id),priceCoins:(0,f.integer)("price_coins").notNull(),transactionId:(0,h.varchar)("transaction_id").notNull().references(()=>tU.id),purchasedAt:(0,_.timestamp)("purchased_at").notNull().defaultNow()},e=>({buyerIdIdx:w("idx_content_purchases_user_id").on(e.buyerId),contentIdIdx:w("idx_content_purchases_content_id").on(e.contentId)})),tY=(0,p.pgTable)("content_reviews",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),contentId:(0,h.varchar)("content_id").notNull().references(()=>tG.id),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),rating:(0,f.integer)("rating").notNull(),review:(0,m.text)("review").notNull(),status:(0,m.text)("status").notNull().$type().default("pending"),rewardGiven:(0,g.boolean)("reward_given").notNull().default(!1),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({uniqueContentUserReview:I("idx_content_reviews_unique_content_user").on(e.contentId,e.userId)})),t0=(0,p.pgTable)("content_likes",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),contentId:(0,h.varchar)("content_id").notNull().references(()=>tG.id),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_content_likes_user_id").on(e.userId),uniqueContentUserLike:I("idx_content_likes_unique_content_user").on(e.contentId,e.userId)})),t1=(0,p.pgTable)("content_replies",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),contentId:(0,h.varchar)("content_id").notNull().references(()=>tG.id),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),parentId:(0,h.varchar)("parent_id").references(()=>t1.id),body:(0,m.text)("body").notNull(),rating:(0,f.integer)("rating"),imageUrls:(0,m.text)("image_urls").array(),helpful:(0,f.integer)("helpful").notNull().default(0),isVerified:(0,g.boolean)("is_verified").notNull().default(!1),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()}),t2=(0,p.pgTable)("brokers",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),name:(0,m.text)("name").notNull(),slug:(0,m.text)("slug").notNull().unique(),websiteUrl:(0,m.text)("website_url"),logoUrl:(0,m.text)("logo_url"),yearFounded:(0,f.integer)("year_founded"),regulation:(0,m.text)("regulation"),regulationSummary:(0,m.text)("regulation_summary"),platform:(0,m.text)("platform"),spreadType:(0,m.text)("spread_type"),minSpread:(0,q.numeric)("min_spread",{precision:10,scale:2}),overallRating:(0,f.integer)("overall_rating").default(0),reviewCount:(0,f.integer)("review_count").notNull().default(0),scamReportCount:(0,f.integer)("scam_report_count").notNull().default(0),isVerified:(0,g.boolean)("is_verified").notNull().default(!1),status:(0,m.text)("status").notNull().$type().default("pending"),verifiedBy:(0,h.varchar)("verified_by").references(()=>tQ.id),verifiedAt:(0,_.timestamp)("verified_at"),rejectedBy:(0,h.varchar)("rejected_by").references(()=>tQ.id),rejectedAt:(0,_.timestamp)("rejected_at"),rejectionReason:(0,m.text)("rejection_reason"),scamWarning:(0,g.boolean)("scam_warning").notNull().default(!1),scamWarningReason:(0,m.text)("scam_warning_reason"),deletedAt:(0,_.timestamp)("deleted_at"),country:(0,m.text)("country"),minDeposit:(0,m.text)("min_deposit"),leverage:(0,m.text)("leverage"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({slugIdx:w("idx_brokers_slug").on(e.slug),statusIdx:w("idx_brokers_status").on(e.status),regulationIdx:w("idx_brokers_regulation").on(e.regulation),platformIdx:w("idx_brokers_platform").on(e.platform),verifiedIdx:w("idx_brokers_verified").on(e.isVerified),scamWarningIdx:w("idx_brokers_scam_warning").on(e.scamWarning),deletedAtIdx:w("idx_brokers_deleted_at").on(e.deletedAt),countryIdx:w("idx_brokers_country").on(e.country)})),t9=(0,p.pgTable)("broker_reviews",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),brokerId:(0,h.varchar)("broker_id").notNull().references(()=>t2.id),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),rating:(0,f.integer)("rating").notNull(),reviewTitle:(0,m.text)("review_title").notNull(),reviewBody:(0,m.text)("review_body").notNull(),isScamReport:(0,g.boolean)("is_scam_report").notNull().default(!1),status:(0,m.text)("status").notNull().$type().default("pending"),approvedBy:(0,h.varchar)("approved_by").references(()=>tQ.id),approvedAt:(0,_.timestamp)("approved_at"),rejectedBy:(0,h.varchar)("rejected_by").references(()=>tQ.id),rejectedAt:(0,_.timestamp)("rejected_at"),rejectionReason:(0,m.text)("rejection_reason"),scamSeverity:(0,m.text)("scam_severity").$type(),datePosted:(0,_.timestamp)("date_posted").notNull().defaultNow()},e=>({brokerIdIdx:w("idx_broker_reviews_broker_id").on(e.brokerId),uniqueBrokerUserReview:I("idx_broker_reviews_unique_broker_user").on(e.brokerId,e.userId),severityIdx:w("idx_broker_reviews_severity").on(e.scamSeverity)})),t4=(0,p.pgTable)("user_follows",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),followerId:(0,h.varchar)("follower_id").notNull().references(()=>tQ.id),followingId:(0,h.varchar)("following_id").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({followerIdIdx:w("idx_user_follows_follower_id").on(e.followerId),uniqueFollowerFollowing:I("idx_user_follows_unique_follower_following").on(e.followerId,e.followingId)})),t5=(0,p.pgTable)("conversations",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),participant1Id:(0,h.varchar)("participant1_id").notNull().references(()=>tQ.id),participant2Id:(0,h.varchar)("participant2_id").notNull().references(()=>tQ.id),lastMessageAt:(0,_.timestamp)("last_message_at").notNull().defaultNow(),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()}),t3=(0,p.pgTable)("messages",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),conversationId:(0,h.varchar)("conversation_id").notNull().references(()=>t5.id),senderId:(0,h.varchar)("sender_id").notNull().references(()=>tQ.id),recipientId:(0,h.varchar)("recipient_id").notNull().references(()=>tQ.id),body:(0,m.text)("body").notNull(),isRead:(0,g.boolean)("is_read").notNull().default(!1),deliveredAt:(0,_.timestamp)("delivered_at"),readAt:(0,_.timestamp)("read_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({conversationIdIdx:w("idx_messages_conversation_id").on(e.conversationId),senderIdIdx:w("idx_messages_sender_id").on(e.senderId),recipientIdIdx:w("idx_messages_recipient_id").on(e.recipientId),createdAtIdx:w("idx_messages_created_at").on(e.createdAt),isReadIdx:w("idx_messages_is_read").on(e.isRead)})),t8=(0,p.pgTable)("message_reactions",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),messageId:(0,h.varchar)("message_id").notNull().references(()=>t3.id,{onDelete:"cascade"}),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),emoji:(0,h.varchar)("emoji",{length:10}).notNull(),createdAt:(0,_.timestamp)("created_at").defaultNow().notNull()},e=>({messageUserIdx:w("message_reactions_msg_user_idx").on(e.messageId,e.userId)})),t6=(0,p.pgTable)("notifications",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),type:(0,m.text)("type").notNull().$type(),title:(0,m.text)("title").notNull(),message:(0,m.text)("message").notNull(),actionUrl:(0,m.text)("action_url"),isRead:(0,g.boolean)("is_read").notNull().default(!1),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_notifications_user_id").on(e.userId),isReadIdx:w("idx_notifications_is_read").on(e.isRead),createdAtIdx:w("idx_notifications_created_at").on(e.createdAt)})),t7=(0,p.pgTable)("forum_threads",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),authorId:(0,h.varchar)("author_id").notNull().references(()=>tQ.id),categorySlug:(0,m.text)("category_slug").notNull(),subcategorySlug:(0,m.text)("subcategory_slug"),title:(0,m.text)("title").notNull(),body:(0,m.text)("body").notNull(),slug:(0,m.text)("slug").notNull().unique(),focusKeyword:(0,m.text)("focus_keyword"),metaDescription:(0,m.text)("meta_description"),metaTitle:(0,m.text)("meta_title"),metaKeywords:(0,m.text)("meta_keywords"),threadType:(0,m.text)("thread_type").notNull().$type().default("discussion"),seoExcerpt:(0,m.text)("seo_excerpt"),primaryKeyword:(0,m.text)("primary_keyword"),language:(0,m.text)("language").notNull().default("en"),instruments:(0,m.text)("instruments").array().default(c.sql`'{}'::text[]`),timeframes:(0,m.text)("timeframes").array().default(c.sql`'{}'::text[]`),strategies:(0,m.text)("strategies").array().default(c.sql`'{}'::text[]`),platform:(0,m.text)("platform"),broker:(0,m.text)("broker"),riskNote:(0,m.text)("risk_note"),hashtags:(0,m.text)("hashtags").array().default(c.sql`'{}'::text[]`),reviewTarget:(0,m.text)("review_target"),reviewVersion:(0,m.text)("review_version"),reviewRating:(0,f.integer)("review_rating"),reviewPros:(0,m.text)("review_pros").array(),reviewCons:(0,m.text)("review_cons").array(),questionSummary:(0,m.text)("question_summary"),acceptedAnswerId:(0,h.varchar)("accepted_answer_id"),attachmentUrls:(0,m.text)("attachment_urls").array().default(c.sql`'{}'::text[]`),isPinned:(0,g.boolean)("is_pinned").notNull().default(!1),isLocked:(0,g.boolean)("is_locked").notNull().default(!1),isSolved:(0,g.boolean)("is_solved").notNull().default(!1),views:(0,f.integer)("views").notNull().default(0),replyCount:(0,f.integer)("reply_count").notNull().default(0),likeCount:(0,f.integer)("like_count").notNull().default(0),bookmarkCount:(0,f.integer)("bookmark_count").notNull().default(0),shareCount:(0,f.integer)("share_count").notNull().default(0),lastActivityAt:(0,_.timestamp)("last_activity_at").notNull().defaultNow(),status:(0,m.text)("status").notNull().$type().default("approved"),engagementScore:(0,f.integer)("engagement_score").notNull().default(0),lastScoreUpdate:(0,_.timestamp)("last_score_update"),helpfulVotes:(0,f.integer)("helpful_votes").notNull().default(0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({categorySlugIdx:w("idx_forum_threads_category").on(e.categorySlug),subcategorySlugIdx:w("idx_forum_threads_subcategory").on(e.subcategorySlug),threadTypeIdx:w("idx_forum_threads_type").on(e.threadType),statusIdx:w("idx_forum_threads_status").on(e.status),isPinnedIdx:w("idx_forum_threads_pinned").on(e.isPinned),engagementScoreIdx:w("idx_forum_threads_engagement").on(e.engagementScore),lastActivityAtIdx:w("idx_forum_threads_last_activity").on(e.lastActivityAt),slugIdx:w("idx_forum_threads_slug").on(e.slug),helpfulVotesIdx:w("idx_forum_threads_helpful_votes").on(e.helpfulVotes)})),ae=(0,p.pgTable)("forum_replies",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),threadId:(0,h.varchar)("thread_id").notNull().references(()=>t7.id),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),parentId:(0,h.varchar)("parent_id").references(()=>ae.id),body:(0,m.text)("body").notNull(),slug:(0,m.text)("slug").notNull().unique(),metaDescription:(0,m.text)("meta_description"),imageUrls:(0,m.text)("image_urls").array(),helpful:(0,f.integer)("helpful").notNull().default(0),helpfulVotes:(0,f.integer)("helpful_votes").notNull().default(0),isAccepted:(0,g.boolean)("is_accepted").notNull().default(!1),isVerified:(0,g.boolean)("is_verified").notNull().default(!1),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow(),status:(0,m.text)("status").notNull().$type().default("approved"),approvedBy:(0,h.varchar)("approved_by").references(()=>tQ.id),rejectedBy:(0,h.varchar)("rejected_by").references(()=>tQ.id),approvedAt:(0,_.timestamp)("approved_at"),rejectedAt:(0,_.timestamp)("rejected_at")},e=>({threadIdIdx:w("idx_forum_replies_thread_id").on(e.threadId),createdAtIdx:w("idx_forum_replies_created_at").on(e.createdAt),slugIdx:w("idx_forum_replies_slug").on(e.slug),helpfulVotesIdx:w("idx_forum_replies_helpful_votes").on(e.helpfulVotes),statusIdx:w("idx_forum_replies_status").on(e.status)})),at=(0,p.pgTable)("forum_categories",{slug:(0,m.text)("slug").primaryKey(),name:(0,m.text)("name").notNull(),description:(0,m.text)("description").notNull(),icon:(0,m.text)("icon").notNull(),color:(0,m.text)("color").notNull().default("bg-primary"),parentSlug:(0,m.text)("parent_slug"),threadCount:(0,f.integer)("thread_count").notNull().default(0),postCount:(0,f.integer)("post_count").notNull().default(0),sortOrder:(0,f.integer)("sort_order").notNull().default(0),isActive:(0,g.boolean)("is_active").notNull().default(!0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({parentSlugIdx:w("idx_forum_categories_parent_slug").on(e.parentSlug)})),aa=(0,p.pgTable)("seo_categories",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),slug:(0,m.text)("slug").notNull().unique(),name:(0,m.text)("name").notNull(),urlPath:(0,m.text)("url_path").notNull().unique(),parentId:(0,h.varchar)("parent_id").references(()=>aa.id),categoryType:(0,m.text)("category_type").notNull().$type().default("main"),oldSlug:(0,m.text)("old_slug"),metaTitle:(0,m.text)("meta_title"),metaDescription:(0,m.text)("meta_description"),metaKeywords:(0,m.text)("meta_keywords"),h1Title:(0,m.text)("h1_title"),icon:(0,m.text)("icon").notNull().default("Folder"),color:(0,m.text)("color").notNull().default("bg-primary"),sortOrder:(0,f.integer)("sort_order").notNull().default(0),showInMenu:(0,g.boolean)("show_in_menu").notNull().default(!0),showInSidebar:(0,g.boolean)("show_in_sidebar").notNull().default(!0),contentCount:(0,f.integer)("content_count").notNull().default(0),viewCount:(0,f.integer)("view_count").notNull().default(0),isActive:(0,g.boolean)("is_active").notNull().default(!0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({slugIdx:w("idx_seo_categories_slug").on(e.slug),urlPathIdx:w("idx_seo_categories_url_path").on(e.urlPath),parentIdIdx:w("idx_seo_categories_parent_id").on(e.parentId),oldSlugIdx:w("idx_seo_categories_old_slug").on(e.oldSlug)})),ai=(0,p.pgTable)("category_redirects",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),oldUrl:(0,m.text)("old_url").notNull().unique(),newUrl:(0,m.text)("new_url").notNull(),redirectType:(0,f.integer)("redirect_type").notNull().default(301),hitCount:(0,f.integer)("hit_count").notNull().default(0),lastUsed:(0,_.timestamp)("last_used"),isActive:(0,g.boolean)("is_active").notNull().default(!0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({oldUrlIdx:w("idx_category_redirects_old_url").on(e.oldUrl),isActiveIdx:w("idx_category_redirects_active").on(e.isActive)})),ar=(0,p.pgTable)("user_badges",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),badgeType:(0,m.text)("badge_type").notNull().$type(),awardedAt:(0,_.timestamp)("awarded_at").notNull().defaultNow()}),as=(0,p.pgTable)("activity_feed",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),activityType:(0,m.text)("activity_type").notNull().$type(),entityType:(0,m.text)("entity_type").notNull().$type(),entityId:(0,h.varchar)("entity_id").notNull(),title:(0,m.text)("title").notNull(),description:(0,m.text)("description"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_activity_feed_user_id").on(e.userId)})),an=(0,p.pgTable)("user_wallet",{walletId:(0,h.varchar)("wallet_id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),balance:(0,f.integer)("balance").notNull().default(0),availableBalance:(0,f.integer)("available_balance").notNull().default(0),status:(0,m.text)("status").notNull().default("active"),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:I("idx_user_wallet_user_id").on(e.userId),statusIdx:w("idx_user_wallet_status").on(e.status)})),ao=(0,p.pgTable)("coin_ledger_transactions",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),type:(0,m.text)("type").notNull(),context:(0,A.json)("context").$type(),externalRef:(0,m.text)("external_ref"),initiatorUserId:(0,h.varchar)("initiator_user_id").references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),closedAt:(0,_.timestamp)("closed_at"),status:(0,m.text)("status").notNull().default("pending")},e=>({typeIdx:w("idx_ledger_tx_type").on(e.type),statusIdx:w("idx_ledger_tx_status").on(e.status),initiatorIdx:w("idx_ledger_tx_initiator").on(e.initiatorUserId)})),al=(0,p.pgTable)("coin_journal_entries",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),ledgerTransactionId:(0,h.varchar)("ledger_transaction_id").notNull().references(()=>ao.id),walletId:(0,h.varchar)("wallet_id").notNull().references(()=>an.walletId),direction:(0,m.text)("direction").notNull(),amount:(0,f.integer)("amount").notNull(),balanceBefore:(0,f.integer)("balance_before").notNull(),balanceAfter:(0,f.integer)("balance_after").notNull(),memo:(0,m.text)("memo"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({ledgerTxIdx:w("idx_journal_ledger_tx").on(e.ledgerTransactionId),walletIdx:w("idx_journal_wallet").on(e.walletId),createdAtIdx:w("idx_journal_created_at").on(e.createdAt),amountCheck:new S("chk_amount_positive",c.sql`${e.amount} > 0`)})),ad=(0,p.pgTable)("ledger_reconciliation_runs",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),status:(0,m.text)("status").notNull(),driftCount:(0,f.integer)("drift_count").notNull().default(0),maxDelta:(0,f.integer)("max_delta").notNull().default(0),report:(0,A.json)("report").$type(),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),completedAt:(0,_.timestamp)("completed_at")}),au=(0,p.pgTable)("dashboard_preferences",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id).unique(),widgetOrder:(0,m.text)("widget_order").array().notNull(),enabledWidgets:(0,m.text)("enabled_widgets").array().notNull(),layoutType:(0,m.text)("layout_type").notNull().$type().default("default"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_dashboard_preferences_user_id").on(e.userId)})),ac=(0,p.pgTable)("daily_activity_limits",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),activityDate:(0,_.timestamp)("activity_date").notNull().defaultNow(),repliesCount:(0,f.integer)("replies_count").notNull().default(0),reportsCount:(0,f.integer)("reports_count").notNull().default(0),backtestsCount:(0,f.integer)("backtests_count").notNull().default(0),lastCheckinAt:(0,_.timestamp)("last_checkin_at"),consecutiveDays:(0,f.integer)("consecutive_days").notNull().default(0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userDateIdx:I("idx_daily_activity_user_date").on(e.userId,e.activityDate),userIdIdx:w("idx_daily_activity_user_id").on(e.userId)})),ap=(0,p.pgTable)("referrals",{id:(0,C.serial)("id").primaryKey(),referrerId:(0,h.varchar)("referrer_id").notNull().references(()=>tQ.id),referredUserId:(0,h.varchar)("referred_user_id").notNull().references(()=>tQ.id),referralCode:(0,h.varchar)("referral_code",{length:50}).notNull().unique(),status:(0,h.varchar)("status",{length:20}).notNull().default("active"),totalEarnings:(0,f.integer)("total_earnings").notNull().default(0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({referrerIdx:w("idx_referrals_referrer_id").on(e.referrerId),referredIdx:I("idx_referrals_referred_user_id").on(e.referredUserId),referralCodeIdx:w("idx_referrals_code").on(e.referralCode)})),am=(0,p.pgTable)("goals",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),goalType:(0,h.varchar)("goal_type",{length:50}).notNull(),targetValue:(0,f.integer)("target_value").notNull(),currentValue:(0,f.integer)("current_value").notNull().default(0),startDate:(0,_.timestamp)("start_date").notNull(),endDate:(0,_.timestamp)("end_date").notNull(),status:(0,h.varchar)("status",{length:20}).notNull().default("active"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_goals_user_id").on(e.userId)})),ah=(0,p.pgTable)("achievements",{id:(0,C.serial)("id").primaryKey(),slug:(0,h.varchar)("slug",{length:100}).notNull().unique(),name:(0,h.varchar)("name",{length:200}).notNull(),description:(0,m.text)("description").notNull(),icon:(0,h.varchar)("icon",{length:50}).notNull(),requirement:(0,f.integer)("requirement").notNull(),category:(0,h.varchar)("category",{length:50}).notNull(),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({slugIdx:w("idx_achievements_slug").on(e.slug)})),af=(0,p.pgTable)("user_achievements",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),achievementId:(0,f.integer)("achievement_id").notNull().references(()=>ah.id),progress:(0,f.integer)("progress").notNull().default(0),unlockedAt:(0,_.timestamp)("unlocked_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_user_achievements_user_id").on(e.userId),achievementIdIdx:w("idx_user_achievements_achievement_id").on(e.achievementId)})),a_=(0,p.pgTable)("campaigns",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),name:(0,h.varchar)("name",{length:200}).notNull(),description:(0,m.text)("description"),type:(0,h.varchar)("type",{length:50}).default("marketing"),status:(0,h.varchar)("status",{length:20}).notNull().default("active"),budget:(0,f.integer)("budget"),discountPercent:(0,f.integer)("discount_percent"),discountCode:(0,h.varchar)("discount_code",{length:50}).unique(),startDate:(0,_.timestamp)("start_date").notNull(),endDate:(0,_.timestamp)("end_date").notNull(),uses:(0,f.integer)("uses").notNull().default(0),revenue:(0,f.integer)("revenue").notNull().default(0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_campaigns_user_id").on(e.userId),discountCodeIdx:w("idx_campaigns_discount_code").on(e.discountCode)})),ag=(0,p.pgTable)("dashboard_settings",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id).unique(),layout:(0,A.json)("layout"),theme:(0,h.varchar)("theme",{length:20}).default("light"),autoRefresh:(0,g.boolean)("auto_refresh").default(!0),refreshInterval:(0,f.integer)("refresh_interval").default(30),favorites:(0,A.json)("favorites"),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:I("idx_dashboard_settings_user_id").on(e.userId)})),ay=(0,p.pgTable)("profiles",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id).unique(),coverPhoto:(0,m.text)("cover_photo"),bio:(0,m.text)("bio"),tradingLevel:(0,h.varchar)("trading_level",{length:50}),tradingStyle:(0,A.json)("trading_style"),tradingPlatform:(0,A.json)("trading_platform"),tradingSince:(0,j.date)("trading_since"),specialties:(0,A.json)("specialties"),telegram:(0,h.varchar)("telegram",{length:100}),discord:(0,h.varchar)("discord",{length:100}),twitter:(0,h.varchar)("twitter",{length:100}),youtube:(0,h.varchar)("youtube",{length:200}),tradingview:(0,h.varchar)("tradingview",{length:200}),website:(0,h.varchar)("website",{length:200}),profileLayout:(0,h.varchar)("profile_layout",{length:20}).default("professional"),customSlug:(0,h.varchar)("custom_slug",{length:100}).unique(),isPublic:(0,g.boolean)("is_public").default(!0),isPremium:(0,g.boolean)("is_premium").default(!1),brandColors:(0,A.json)("brand_colors"),showRevenue:(0,g.boolean)("show_revenue").default(!0),showSales:(0,g.boolean)("show_sales").default(!0),showFollowers:(0,g.boolean)("show_followers").default(!0),showActivity:(0,g.boolean)("show_activity").default(!0),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:I("idx_profiles_user_id").on(e.userId),customSlugIdx:w("idx_profiles_custom_slug").on(e.customSlug)})),av=(0,p.pgTable)("user_settings",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id).unique(),notificationPreferences:(0,A.json)("notification_preferences"),privacySettings:(0,A.json)("privacy_settings"),displaySettings:(0,A.json)("display_settings"),communicationSettings:(0,A.json)("communication_settings"),publishingDefaults:(0,A.json)("publishing_defaults"),advancedSettings:(0,A.json)("advanced_settings"),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:I("idx_user_settings_user_id").on(e.userId)})),ab=(0,p.pgTable)("admin_actions",{id:(0,C.serial)("id").primaryKey(),adminId:(0,h.varchar)("admin_id").notNull().references(()=>tQ.id),actionType:(0,h.varchar)("action_type").notNull(),targetType:(0,h.varchar)("target_type").notNull(),targetId:(0,h.varchar)("target_id"),details:(0,T.jsonb)("details"),ipAddress:(0,h.varchar)("ip_address"),userAgent:(0,h.varchar)("user_agent"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({adminIdIdx:w("idx_admin_actions_admin_id").on(e.adminId),actionTypeIdx:w("idx_admin_actions_action_type").on(e.actionType),targetTypeIdx:w("idx_admin_actions_target_type").on(e.targetType),createdAtIdx:w("idx_admin_actions_created_at").on(e.createdAt)})),ax=(0,p.pgTable)("moderation_queue",{id:(0,C.serial)("id").primaryKey(),contentType:(0,h.varchar)("content_type").notNull(),contentId:(0,h.varchar)("content_id").notNull(),authorId:(0,h.varchar)("author_id").notNull().references(()=>tQ.id),status:(0,h.varchar)("status").notNull().default("pending"),priorityScore:(0,f.integer)("priority_score").notNull().default(0),spamScore:(0,q.numeric)("spam_score",{precision:3,scale:2}),sentimentScore:(0,q.numeric)("sentiment_score",{precision:3,scale:2}),flaggedReasons:(0,m.text)("flagged_reasons").array().default(c.sql`'{}'::text[]`),reviewedBy:(0,h.varchar)("reviewed_by").references(()=>tQ.id),reviewedAt:(0,_.timestamp)("reviewed_at"),reviewNotes:(0,m.text)("review_notes"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({statusIdx:w("idx_moderation_queue_status").on(e.status),priorityScoreIdx:w("idx_moderation_queue_priority_score").on(e.priorityScore),createdAtIdx:w("idx_moderation_queue_created_at").on(e.createdAt)})),aN=(0,p.pgTable)("reported_content",{id:(0,C.serial)("id").primaryKey(),reporterId:(0,h.varchar)("reporter_id").notNull().references(()=>tQ.id),contentType:(0,h.varchar)("content_type").notNull(),contentId:(0,h.varchar)("content_id").notNull(),reportReason:(0,h.varchar)("report_reason").notNull(),description:(0,m.text)("description").notNull(),status:(0,h.varchar)("status").notNull().default("pending"),assignedTo:(0,h.varchar)("assigned_to").references(()=>tQ.id),resolution:(0,m.text)("resolution"),actionTaken:(0,h.varchar)("action_taken"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),resolvedAt:(0,_.timestamp)("resolved_at")},e=>({statusIdx:w("idx_reported_content_status").on(e.status),contentTypeIdx:w("idx_reported_content_content_type").on(e.contentType),reporterIdIdx:w("idx_reported_content_reporter_id").on(e.reporterId),createdAtIdx:w("idx_reported_content_created_at").on(e.createdAt)})),aw=(0,p.pgTable)("system_settings",{id:(0,C.serial)("id").primaryKey(),settingKey:(0,h.varchar)("setting_key").notNull().unique(),settingValue:(0,T.jsonb)("setting_value").notNull(),category:(0,h.varchar)("category").notNull(),description:(0,m.text)("description"),updatedBy:(0,h.varchar)("updated_by").references(()=>tQ.id),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({settingKeyIdx:w("idx_system_settings_setting_key").on(e.settingKey),categoryIdx:w("idx_system_settings_category").on(e.category)})),aI=(0,p.pgTable)("support_tickets",{id:(0,C.serial)("id").primaryKey(),ticketNumber:(0,h.varchar)("ticket_number").notNull().unique(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),subject:(0,h.varchar)("subject").notNull(),description:(0,m.text)("description").notNull(),status:(0,h.varchar)("status").notNull().default("open"),priority:(0,h.varchar)("priority").notNull().default("medium"),category:(0,h.varchar)("category").notNull(),assignedTo:(0,h.varchar)("assigned_to").references(()=>tQ.id),replies:(0,T.jsonb)("replies").array().default(c.sql`'{}'::jsonb[]`),tags:(0,m.text)("tags").array().default(c.sql`'{}'::text[]`),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow(),resolvedAt:(0,_.timestamp)("resolved_at")},e=>({statusIdx:w("idx_support_tickets_status").on(e.status),priorityIdx:w("idx_support_tickets_priority").on(e.priority),userIdIdx:w("idx_support_tickets_user_id").on(e.userId),assignedToIdx:w("idx_support_tickets_assigned_to").on(e.assignedTo),createdAtIdx:w("idx_support_tickets_created_at").on(e.createdAt)})),aT=(0,p.pgTable)("announcements",{id:(0,C.serial)("id").primaryKey(),title:(0,h.varchar)("title").notNull(),content:(0,m.text)("content").notNull(),type:(0,h.varchar)("type").notNull().default("info"),targetAudience:(0,h.varchar)("target_audience").notNull().default("all"),segmentId:(0,f.integer)("segment_id"),displayType:(0,h.varchar)("display_type").notNull().default("banner"),isActive:(0,g.boolean)("is_active").notNull().default(!0),startDate:(0,_.timestamp)("start_date").notNull(),endDate:(0,_.timestamp)("end_date"),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),views:(0,f.integer)("views").notNull().default(0),clicks:(0,f.integer)("clicks").notNull().default(0)},e=>({isActiveIdx:w("idx_announcements_is_active").on(e.isActive),targetAudienceIdx:w("idx_announcements_target_audience").on(e.targetAudience),startDateIdx:w("idx_announcements_start_date").on(e.startDate),endDateIdx:w("idx_announcements_end_date").on(e.endDate)})),aA=(0,p.pgTable)("ip_bans",{id:(0,C.serial)("id").primaryKey(),ipAddress:(0,h.varchar)("ip_address").notNull().unique(),reason:(0,m.text)("reason").notNull(),banType:(0,h.varchar)("ban_type").notNull().default("permanent"),expiresAt:(0,_.timestamp)("expires_at"),bannedBy:(0,h.varchar)("banned_by").notNull().references(()=>tQ.id),bannedAt:(0,_.timestamp)("banned_at").notNull().defaultNow(),isActive:(0,g.boolean)("is_active").notNull().default(!0)},e=>({ipAddressIdx:w("idx_ip_bans_ip_address").on(e.ipAddress),isActiveIdx:w("idx_ip_bans_is_active").on(e.isActive),expiresAtIdx:w("idx_ip_bans_expires_at").on(e.expiresAt)})),aS=(0,p.pgTable)("email_templates",{id:(0,C.serial)("id").primaryKey(),templateKey:(0,h.varchar)("template_key").notNull().unique(),subject:(0,h.varchar)("subject").notNull(),htmlBody:(0,m.text)("html_body").notNull(),textBody:(0,m.text)("text_body").notNull(),variables:(0,m.text)("variables").array().default(c.sql`'{}'::text[]`),category:(0,h.varchar)("category").notNull(),isActive:(0,g.boolean)("is_active").notNull().default(!0),updatedBy:(0,h.varchar)("updated_by").references(()=>tQ.id),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({templateKeyIdx:w("idx_email_templates_template_key").on(e.templateKey),categoryIdx:w("idx_email_templates_category").on(e.category),isActiveIdx:w("idx_email_templates_is_active").on(e.isActive)})),ak=(0,p.pgTable)("admin_roles",{id:(0,C.serial)("id").primaryKey(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id).unique(),role:(0,h.varchar)("role").notNull(),permissions:(0,T.jsonb)("permissions").notNull(),grantedBy:(0,h.varchar)("granted_by").notNull().references(()=>tQ.id),grantedAt:(0,_.timestamp)("granted_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_admin_roles_user_id").on(e.userId),roleIdx:w("idx_admin_roles_role").on(e.role)})),aq=(0,p.pgTable)("user_segments",{id:(0,C.serial)("id").primaryKey(),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description").notNull(),rules:(0,T.jsonb)("rules").notNull(),userCount:(0,f.integer)("user_count").notNull().default(0),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({nameIdx:w("idx_user_segments_name").on(e.name),createdAtIdx:w("idx_user_segments_created_at").on(e.createdAt)})),aC=(0,p.pgTable)("automation_rules",{id:(0,C.serial)("id").primaryKey(),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description").notNull(),triggerType:(0,h.varchar)("trigger_type").notNull(),triggerConfig:(0,T.jsonb)("trigger_config").notNull(),actionType:(0,h.varchar)("action_type").notNull(),actionConfig:(0,T.jsonb)("action_config").notNull(),isActive:(0,g.boolean)("is_active").notNull().default(!0),executionCount:(0,f.integer)("execution_count").notNull().default(0),lastExecuted:(0,_.timestamp)("last_executed"),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({triggerTypeIdx:w("idx_automation_rules_trigger_type").on(e.triggerType),isActiveIdx:w("idx_automation_rules_is_active").on(e.isActive),createdAtIdx:w("idx_automation_rules_created_at").on(e.createdAt)})),aj=(0,p.pgTable)("ab_tests",{id:(0,C.serial)("id").primaryKey(),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description").notNull(),variants:(0,T.jsonb)("variants").array().default(c.sql`'{}'::jsonb[]`),trafficAllocation:(0,T.jsonb)("traffic_allocation").notNull(),status:(0,h.varchar)("status").notNull().default("draft"),startDate:(0,_.timestamp)("start_date"),endDate:(0,_.timestamp)("end_date"),winnerVariant:(0,h.varchar)("winner_variant"),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({statusIdx:w("idx_ab_tests_status").on(e.status),startDateIdx:w("idx_ab_tests_start_date").on(e.startDate),endDateIdx:w("idx_ab_tests_end_date").on(e.endDate)})),aP=(0,p.pgTable)("feature_flags",{id:(0,C.serial)("id").primaryKey(),flagKey:(0,h.varchar)("flag_key").notNull().unique(),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description").notNull(),isEnabled:(0,g.boolean)("is_enabled").notNull().default(!1),rolloutPercentage:(0,f.integer)("rollout_percentage").notNull().default(0),targetUsers:(0,m.text)("target_users").array().default(c.sql`'{}'::text[]`),targetSegments:(0,f.integer)("target_segments").array().default(c.sql`'{}'::integer[]`),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({flagKeyIdx:w("idx_feature_flags_flag_key").on(e.flagKey),isEnabledIdx:w("idx_feature_flags_is_enabled").on(e.isEnabled)})),a$=(0,p.pgTable)("api_keys",{id:(0,C.serial)("id").primaryKey(),key:(0,h.varchar)("key").notNull().unique(),name:(0,h.varchar)("name").notNull(),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id),permissions:(0,m.text)("permissions").array().default(c.sql`'{}'::text[]`),rateLimit:(0,f.integer)("rate_limit").notNull().default(60),isActive:(0,g.boolean)("is_active").notNull().default(!0),lastUsed:(0,_.timestamp)("last_used"),expiresAt:(0,_.timestamp)("expires_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({keyIdx:w("idx_api_keys_key").on(e.key),userIdIdx:w("idx_api_keys_user_id").on(e.userId),isActiveIdx:w("idx_api_keys_is_active").on(e.isActive)})),aE=(0,p.pgTable)("webhooks",{id:(0,C.serial)("id").primaryKey(),url:(0,h.varchar)("url").notNull(),events:(0,m.text)("events").array().default(c.sql`'{}'::text[]`),secret:(0,h.varchar)("secret").notNull(),isActive:(0,g.boolean)("is_active").notNull().default(!0),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),lastTriggered:(0,_.timestamp)("last_triggered"),successCount:(0,f.integer)("success_count").notNull().default(0),failureCount:(0,f.integer)("failure_count").notNull().default(0)},e=>({isActiveIdx:w("idx_webhooks_is_active").on(e.isActive),createdAtIdx:w("idx_webhooks_created_at").on(e.createdAt)})),aR=(0,p.pgTable)("scheduled_jobs",{id:(0,C.serial)("id").primaryKey(),jobKey:(0,h.varchar)("job_key").notNull().unique(),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description").notNull(),schedule:(0,h.varchar)("schedule").notNull(),isActive:(0,g.boolean)("is_active").notNull().default(!0),lastRun:(0,_.timestamp)("last_run"),nextRun:(0,_.timestamp)("next_run"),lastStatus:(0,h.varchar)("last_status"),lastError:(0,m.text)("last_error"),executionCount:(0,f.integer)("execution_count").notNull().default(0)},e=>({jobKeyIdx:w("idx_scheduled_jobs_job_key").on(e.jobKey),isActiveIdx:w("idx_scheduled_jobs_is_active").on(e.isActive),nextRunIdx:w("idx_scheduled_jobs_next_run").on(e.nextRun)})),aO=(0,p.pgTable)("performance_metrics",{id:(0,C.serial)("id").primaryKey(),metricType:(0,h.varchar)("metric_type").notNull(),metricName:(0,h.varchar)("metric_name").notNull(),value:(0,q.numeric)("value",{precision:10,scale:2}).notNull(),unit:(0,h.varchar)("unit").notNull(),metadata:(0,T.jsonb)("metadata"),recordedAt:(0,_.timestamp)("recorded_at").notNull().defaultNow()},e=>({metricTypeIdx:w("idx_performance_metrics_metric_type").on(e.metricType),metricNameIdx:w("idx_performance_metrics_metric_name").on(e.metricName),recordedAtIdx:w("idx_performance_metrics_recorded_at").on(e.recordedAt)})),aM=(0,p.pgTable)("security_events",{id:(0,C.serial)("id").primaryKey(),eventType:(0,h.varchar)("event_type").notNull(),severity:(0,h.varchar)("severity").notNull(),userId:(0,h.varchar)("user_id").references(()=>tQ.id),ipAddress:(0,h.varchar)("ip_address").notNull(),details:(0,T.jsonb)("details").notNull(),isResolved:(0,g.boolean)("is_resolved").notNull().default(!1),resolvedBy:(0,h.varchar)("resolved_by").references(()=>tQ.id),resolvedAt:(0,_.timestamp)("resolved_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({eventTypeIdx:w("idx_security_events_event_type").on(e.eventType),severityIdx:w("idx_security_events_severity").on(e.severity),isResolvedIdx:w("idx_security_events_is_resolved").on(e.isResolved),createdAtIdx:w("idx_security_events_created_at").on(e.createdAt)})),aD=(0,p.pgTable)("media_library",{id:(0,C.serial)("id").primaryKey(),filename:(0,h.varchar)("filename").notNull(),originalFilename:(0,h.varchar)("original_filename").notNull(),filePath:(0,h.varchar)("file_path").notNull(),fileSize:(0,f.integer)("file_size").notNull(),mimeType:(0,h.varchar)("mime_type").notNull(),width:(0,f.integer)("width"),height:(0,f.integer)("height"),altText:(0,h.varchar)("alt_text"),tags:(0,m.text)("tags").array().default(c.sql`'{}'::text[]`),uploadedBy:(0,h.varchar)("uploaded_by").notNull().references(()=>tQ.id),uploadedAt:(0,_.timestamp)("uploaded_at").notNull().defaultNow(),usageCount:(0,f.integer)("usage_count").notNull().default(0)},e=>({uploadedByIdx:w("idx_media_library_uploaded_by").on(e.uploadedBy),mimeTypeIdx:w("idx_media_library_mime_type").on(e.mimeType),uploadedAtIdx:w("idx_media_library_uploaded_at").on(e.uploadedAt)})),aL=(0,p.pgTable)("content_revisions",{id:(0,C.serial)("id").primaryKey(),contentType:(0,h.varchar)("content_type").notNull(),contentId:(0,h.varchar)("content_id").notNull(),revisionNumber:(0,f.integer)("revision_number").notNull(),data:(0,T.jsonb)("data").notNull(),changedFields:(0,m.text)("changed_fields").array().default(c.sql`'{}'::text[]`),changedBy:(0,h.varchar)("changed_by").notNull().references(()=>tQ.id),changeReason:(0,m.text)("change_reason"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({contentTypeIdx:w("idx_content_revisions_content_type").on(e.contentType),contentIdIdx:w("idx_content_revisions_content_id").on(e.contentId),revisionNumberIdx:w("idx_content_revisions_revision_number").on(e.revisionNumber),createdAtIdx:w("idx_content_revisions_created_at").on(e.createdAt)})),aZ=(0,p.pgTable)("trading_journal_entries",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),tradingPair:(0,h.varchar)("trading_pair").notNull(),entryPrice:(0,q.decimal)("entry_price",{precision:20,scale:8}).notNull(),exitPrice:(0,q.decimal)("exit_price",{precision:20,scale:8}),positionSize:(0,q.decimal)("position_size",{precision:20,scale:8}).notNull(),positionType:(0,h.varchar)("position_type").notNull().$type(),entryDate:(0,_.timestamp)("entry_date").notNull(),exitDate:(0,_.timestamp)("exit_date"),profitLoss:(0,q.decimal)("profit_loss",{precision:20,scale:8}),profitLossPercent:(0,q.decimal)("profit_loss_percent",{precision:10,scale:4}),strategy:(0,h.varchar)("strategy"),notes:(0,m.text)("notes"),tags:(0,m.text)("tags").array().default(c.sql`'{}'::text[]`),screenshotUrls:(0,m.text)("screenshot_urls").array().default(c.sql`'{}'::text[]`),broker:(0,h.varchar)("broker"),status:(0,h.varchar)("status").notNull().default("open").$type(),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_trading_journal_user_id").on(e.userId),statusIdx:w("idx_trading_journal_status").on(e.status),entryDateIdx:w("idx_trading_journal_entry_date").on(e.entryDate),tradingPairIdx:w("idx_trading_journal_trading_pair").on(e.tradingPair)})),aK=(0,p.pgTable)("watchlists",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description"),symbols:(0,m.text)("symbols").array().default(c.sql`'{}'::text[]`),isDefault:(0,g.boolean)("is_default").notNull().default(!1),color:(0,h.varchar)("color"),sortOrder:(0,f.integer)("sort_order").notNull().default(0),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_watchlists_user_id").on(e.userId),isDefaultIdx:w("idx_watchlists_is_default").on(e.isDefault)})),aB=(0,p.pgTable)("price_alerts",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),symbol:(0,h.varchar)("symbol").notNull(),targetPrice:(0,q.decimal)("target_price",{precision:20,scale:8}).notNull(),condition:(0,h.varchar)("condition").notNull().$type(),isActive:(0,g.boolean)("is_active").notNull().default(!0),isTriggered:(0,g.boolean)("is_triggered").notNull().default(!1),triggeredAt:(0,_.timestamp)("triggered_at"),notificationMethod:(0,h.varchar)("notification_method").notNull().default("in_app").$type(),note:(0,m.text)("note"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_price_alerts_user_id").on(e.userId),symbolIdx:w("idx_price_alerts_symbol").on(e.symbol),isActiveIdx:w("idx_price_alerts_is_active").on(e.isActive),isTriggeredIdx:w("idx_price_alerts_is_triggered").on(e.isTriggered)})),aF=(0,p.pgTable)("saved_searches",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),name:(0,h.varchar)("name").notNull(),query:(0,m.text)("query").notNull(),filters:(0,T.jsonb)("filters"),category:(0,h.varchar)("category").$type(),useCount:(0,f.integer)("use_count").notNull().default(0),lastUsedAt:(0,_.timestamp)("last_used_at"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_saved_searches_user_id").on(e.userId),categoryIdx:w("idx_saved_searches_category").on(e.category)})),aQ=(0,p.pgTable)("user_habits",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),habitType:(0,h.varchar)("habit_type").notNull().$type(),currentStreak:(0,f.integer)("current_streak").notNull().default(0),longestStreak:(0,f.integer)("longest_streak").notNull().default(0),lastCompletedAt:(0,_.timestamp)("last_completed_at"),totalCompletions:(0,f.integer)("total_completions").notNull().default(0),streakData:(0,T.jsonb)("streak_data"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_user_habits_user_id").on(e.userId),habitTypeIdx:w("idx_user_habits_habit_type").on(e.habitType),currentStreakIdx:w("idx_user_habits_current_streak").on(e.currentStreak)})),az=(0,p.pgTable)("chat_rooms",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),name:(0,h.varchar)("name").notNull(),description:(0,m.text)("description"),roomType:(0,h.varchar)("room_type").notNull().$type(),category:(0,h.varchar)("category"),memberCount:(0,f.integer)("member_count").notNull().default(0),messageCount:(0,f.integer)("message_count").notNull().default(0),lastMessageAt:(0,_.timestamp)("last_message_at"),createdBy:(0,h.varchar)("created_by").notNull().references(()=>tQ.id),isActive:(0,g.boolean)("is_active").notNull().default(!0),settings:(0,T.jsonb)("settings"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({roomTypeIdx:w("idx_chat_rooms_room_type").on(e.roomType),categoryIdx:w("idx_chat_rooms_category").on(e.category),isActiveIdx:w("idx_chat_rooms_is_active").on(e.isActive),lastMessageAtIdx:w("idx_chat_rooms_last_message_at").on(e.lastMessageAt)})),aU=(0,p.pgTable)("chat_room_members",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),roomId:(0,h.varchar)("room_id").notNull().references(()=>az.id,{onDelete:"cascade"}),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),role:(0,h.varchar)("role").notNull().default("member").$type(),joinedAt:(0,_.timestamp)("joined_at").notNull().defaultNow(),lastReadAt:(0,_.timestamp)("last_read_at"),isMuted:(0,g.boolean)("is_muted").notNull().default(!1)},e=>({roomIdIdx:w("idx_chat_room_members_room_id").on(e.roomId),userIdIdx:w("idx_chat_room_members_user_id").on(e.userId),roomUserIdx:w("idx_chat_room_members_room_user").on(e.roomId,e.userId)})),aV=(0,p.pgTable)("chat_room_messages",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),roomId:(0,h.varchar)("room_id").notNull().references(()=>az.id,{onDelete:"cascade"}),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),content:(0,m.text)("content").notNull(),messageType:(0,h.varchar)("message_type").notNull().default("text").$type(),attachmentUrl:(0,m.text)("attachment_url"),replyToId:(0,h.varchar)("reply_to_id"),editedAt:(0,_.timestamp)("edited_at"),deletedAt:(0,_.timestamp)("deleted_at"),reactions:(0,T.jsonb)("reactions"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow()},e=>({roomIdIdx:w("idx_chat_room_messages_room_id").on(e.roomId),userIdIdx:w("idx_chat_room_messages_user_id").on(e.userId),createdAtIdx:w("idx_chat_room_messages_created_at").on(e.createdAt)})),aW=(0,p.pgTable)("dashboard_widgets",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),widgetType:(0,h.varchar)("widget_type").notNull().$type(),position:(0,T.jsonb)("position").notNull(),size:(0,T.jsonb)("size").notNull(),settings:(0,T.jsonb)("settings"),isVisible:(0,g.boolean)("is_visible").notNull().default(!0),layoutName:(0,h.varchar)("layout_name").notNull().default("default"),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_dashboard_widgets_user_id").on(e.userId),layoutNameIdx:w("idx_dashboard_widgets_layout_name").on(e.layoutName),widgetTypeIdx:w("idx_dashboard_widgets_widget_type").on(e.widgetType)})),aJ=(0,p.pgTable)("dashboard_layouts",{id:(0,h.varchar)("id").primaryKey().default(c.sql`gen_random_uuid()`),userId:(0,h.varchar)("user_id").notNull().references(()=>tQ.id,{onDelete:"cascade"}),name:(0,h.varchar)("name").notNull(),isDefault:(0,g.boolean)("is_default").notNull().default(!1),layoutType:(0,h.varchar)("layout_type").notNull().default("trader").$type(),createdAt:(0,_.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,_.timestamp)("updated_at").notNull().defaultNow()},e=>({userIdIdx:w("idx_dashboard_layouts_user_id").on(e.userId),isDefaultIdx:w("idx_dashboard_layouts_is_default").on(e.isDefault)})),aX=tB(tQ).pick({id:!0,email:!0,username:!0,firstName:!0,lastName:!0,profileImageUrl:!0}),aG=tB(tQ).omit({id:!0,totalCoins:!0,weeklyEarned:!0,rank:!0,youtubeUrl:!0,instagramHandle:!0,telegramHandle:!0,myfxbookLink:!0,investorId:!0,investorPassword:!0,isVerifiedTrader:!0,emailNotifications:!0,hasYoutubeReward:!0,hasMyfxbookReward:!0,hasInvestorReward:!0,createdAt:!0,updatedAt:!0}).extend({username:tE.string().min(3).max(50),password:tE.string().min(8)}),aH=tB(tU).omit({id:!0,createdAt:!0}),aY=tB(tV).omit({id:!0,createdAt:!0,completedAt:!0}),a0=tB(tW).omit({id:!0,createdAt:!0,updatedAt:!0}),a1=tB(tJ).omit({id:!0,requestedAt:!0,processedAt:!0,completedAt:!0,createdAt:!0,updatedAt:!0,approvedAt:!0,rejectedAt:!0}).extend({amount:tE.number().min(1e3,"Minimum withdrawal is 1000 coins"),method:tE.enum(["crypto","paypal","bank","other"]).optional(),cryptoType:tE.enum(["BTC","ETH"]).optional(),walletAddress:tE.string().min(26,"Invalid wallet address").max(100,"Invalid wallet address")}),a2=tB(tX).omit({id:!0,createdAt:!0,updatedAt:!0,status:!0,priority:!0,adminNotes:!0}).extend({type:tE.enum(["bug","feature","improvement","other"]),subject:tE.string().min(10,"Subject must be at least 10 characters").max(200,"Subject must be at most 200 characters"),message:tE.string().min(50,"Message must be at least 50 characters").max(5e3,"Message must be at most 5000 characters"),email:tE.string().email("Invalid email format").optional()}),a9=tB(tG).omit({id:!0,createdAt:!0,updatedAt:!0,views:!0,downloads:!0,likes:!0,status:!0}).extend({title:tE.string().min(10).max(120),description:tE.string().min(300),priceCoins:tE.number().min(0).max(1e4),platform:tE.enum(["MT4","MT5","Both"]).optional(),version:tE.string().optional(),tags:tE.array(tE.string()).max(8).optional(),files:tE.array(tE.object({name:tE.string(),size:tE.number(),url:tE.string(),checksum:tE.string()})).min(1,"At least 1 file is required").optional(),images:tE.array(tE.object({url:tE.string(),isCover:tE.boolean(),order:tE.number()})).min(1,"At least 1 image is required").optional(),brokerCompat:tE.array(tE.string()).optional(),minDeposit:tE.number().optional(),hedging:tE.boolean().optional(),changelog:tE.string().optional(),license:tE.string().optional(),equityCurveImage:tE.string().optional(),profitFactor:tE.number().optional(),drawdownPercent:tE.number().optional(),winPercent:tE.number().optional(),broker:tE.string().optional(),monthsTested:tE.number().optional(),slug:tE.string().optional(),focusKeyword:tE.string().optional(),autoMetaDescription:tE.string().optional(),autoImageAltTexts:tE.array(tE.string()).optional()}),a4=tB(tH).omit({id:!0,purchasedAt:!0,sellerId:!0,transactionId:!0,priceCoins:!0}),a5=tB(tY).omit({id:!0,createdAt:!0,status:!0,rewardGiven:!0}).extend({rating:tE.number().min(1,"Rating must be between 1 and 5").max(5,"Rating must be between 1 and 5"),review:tE.string().min(100,"Review must be at least 100 characters").max(1e3,"Review must be at most 1000 characters")}),a3=tB(t0).omit({id:!0,createdAt:!0}),a8=tB(t1).omit({id:!0,createdAt:!0,helpful:!0,isVerified:!0}).extend({body:tE.string().min(10).max(5e3),rating:tE.number().min(1).max(5).optional()}),a6=tB(t2).omit({id:!0,createdAt:!0,updatedAt:!0,overallRating:!0,reviewCount:!0,scamReportCount:!0,status:!0,isVerified:!0}),a7=tB(t9).omit({id:!0,datePosted:!0,status:!0}).extend({rating:tE.number().min(1).max(5),reviewTitle:tE.string().min(10).max(200),reviewBody:tE.string().min(100).max(2e3)}),ie=tB(t4).omit({id:!0,createdAt:!0}),it=tB(t5).omit({id:!0,createdAt:!0,lastMessageAt:!0}),ia=tB(t3).omit({id:!0,createdAt:!0}).extend({body:tE.string().min(1).max(5e3)}),ii=tB(t6).omit({id:!0,createdAt:!0,isRead:!0}).extend({title:tE.string().min(1).max(200),message:tE.string().min(1).max(500)}),ir=tE.object({displayName:tE.string().min(2).max(50).optional(),email:tE.string().email().optional(),bio:tE.string().max(500).optional().or(tE.literal("")),location:tE.string().max(100).optional().or(tE.literal("")),website:tE.string().url().optional().or(tE.literal("")),youtubeUrl:tE.string().url().optional().or(tE.literal("")),instagramHandle:tE.string().min(1).max(50).optional().or(tE.literal("")),telegramHandle:tE.string().min(1).max(50).optional().or(tE.literal("")),myfxbookLink:tE.string().url().optional().or(tE.literal("")),investorId:tE.string().optional().or(tE.literal("")),investorPassword:tE.string().optional().or(tE.literal("")),emailNotifications:tE.boolean().optional()}),is=tB(t8).omit({id:!0,createdAt:!0}),io=tB(t7).omit({id:!0,authorId:!0,createdAt:!0,updatedAt:!0,views:!0,replyCount:!0,likeCount:!0,bookmarkCount:!0,shareCount:!0,lastActivityAt:!0,status:!0,lastScoreUpdate:!0,acceptedAnswerId:!0}).extend({title:tE.string().min(15,"Title must be at least 15 characters").max(90,"Title must not exceed 90 characters").refine(e=>{let t=(e.match(/[A-Z]/g)||[]).length,a=(e.match(/[a-zA-Z]/g)||[]).length;return 0===a||t/a<.5},{message:"Let's tone this down a bit so more folks read it"}),body:tE.string().min(150,"A little more context helps people reply. Two more sentences?").max(5e4,"Body is too long"),categorySlug:tE.string().min(1),subcategorySlug:tE.string().optional(),threadType:tE.enum(["question","discussion","review","journal","guide","program_sharing"]).default("discussion"),language:tE.string().default("en"),seoExcerpt:tE.string().optional().or(tE.literal("")),primaryKeyword:tE.string().optional().or(tE.literal("")),instruments:tE.array(tE.string()).optional().default([]),timeframes:tE.array(tE.string()).optional().default([]),strategies:tE.array(tE.string()).optional().default([]),platform:tE.string().optional(),broker:tE.string().max(40).optional(),riskNote:tE.string().max(500).optional(),hashtags:tE.array(tE.string()).max(10,"Maximum 10 hashtags").optional().default([]),reviewTarget:tE.string().optional(),reviewVersion:tE.string().optional(),reviewRating:tE.number().int().min(1).max(5).optional(),reviewPros:tE.array(tE.string()).optional().default([]),reviewCons:tE.array(tE.string()).optional().default([]),questionSummary:tE.string().max(200).optional(),attachmentUrls:tE.array(tE.string()).optional().default([]),isPinned:tE.boolean().optional().default(!1),isLocked:tE.boolean().optional().default(!1),isSolved:tE.boolean().optional().default(!1),slug:tE.string().optional(),focusKeyword:tE.string().optional(),metaDescription:tE.string().optional(),engagementScore:tE.number().optional()}),il=tB(ae).omit({id:!0,createdAt:!0,updatedAt:!0,helpful:!0,isAccepted:!0,isVerified:!0,slug:!0,metaDescription:!0}).extend({body:tE.string().min(10).max(1e4)}),id=tB(at).omit({threadCount:!0,postCount:!0,createdAt:!0,updatedAt:!0}).extend({name:tE.string().min(3).max(100),description:tE.string().min(10).max(500)}),iu=tB(aa).omit({id:!0,contentCount:!0,viewCount:!0,createdAt:!0,updatedAt:!0}).extend({slug:tE.string().min(1).max(100),name:tE.string().min(1).max(100),urlPath:tE.string().min(1).max(255)}),ic=tB(ai).omit({id:!0,hitCount:!0,lastUsed:!0,createdAt:!0}),ip=tB(ar).omit({id:!0,awardedAt:!0}),im=tB(as).omit({id:!0,createdAt:!0}).extend({title:tE.string().min(1).max(300),description:tE.string().max(500).optional()}),ih=tB(an).omit({walletId:!0,updatedAt:!0}),i_=tB(ao).omit({id:!0,createdAt:!0,closedAt:!0}),ig=tB(al).omit({id:!0,createdAt:!0}),iy=tB(ad).omit({id:!0,createdAt:!0,completedAt:!0}),iv=tB(au).omit({id:!0,createdAt:!0,updatedAt:!0}),ib=a9.superRefine((e,t)=>(e.tags?.includes("Performance Report")&&(e.equityCurveImage||t.addIssue({code:tE.ZodIssueCode.custom,message:"Equity curve image is required for Performance Reports",path:["equityCurveImage"]}),e.profitFactor||t.addIssue({code:tE.ZodIssueCode.custom,message:"Profit Factor is required for Performance Reports",path:["profitFactor"]}),e.drawdownPercent||t.addIssue({code:tE.ZodIssueCode.custom,message:"Drawdown % is required for Performance Reports",path:["drawdownPercent"]}),e.winPercent||t.addIssue({code:tE.ZodIssueCode.custom,message:"Win % is required for Performance Reports",path:["winPercent"]}),e.broker||t.addIssue({code:tE.ZodIssueCode.custom,message:"Broker name is required for Performance Reports",path:["broker"]}),e.monthsTested||t.addIssue({code:tE.ZodIssueCode.custom,message:"Months Tested is required for Performance Reports",path:["monthsTested"]})),e)),ix={VERIFIED_TRADER:"verified_trader",TOP_CONTRIBUTOR:"top_contributor",EA_EXPERT:"ea_expert",HELPFUL_MEMBER:"helpful_member",EARLY_ADOPTER:"early_adopter"},iN={[ix.VERIFIED_TRADER]:{name:"Verified Trader",description:"Linked and verified trading account",icon:"ShieldCheck",color:"text-blue-500"},[ix.TOP_CONTRIBUTOR]:{name:"Top Contributor",description:"Top 10 on contributor leaderboard",icon:"Star",color:"text-yellow-500"},[ix.EA_EXPERT]:{name:"EA Expert",description:"Published 5+ Expert Advisors",icon:"Award",color:"text-purple-500"},[ix.HELPFUL_MEMBER]:{name:"Helpful Member",description:"50+ helpful replies",icon:"Heart",color:"text-red-500"},[ix.EARLY_ADOPTER]:{name:"Early Adopter",description:"Joined in the first month",icon:"Zap",color:"text-orange-500"}},iw=tB(ap).omit({id:!0,createdAt:!0}),iI=tB(am).omit({id:!0,createdAt:!0}),iT=tB(ab).omit({id:!0,createdAt:!0}),iA=tB(ax).omit({id:!0,createdAt:!0}),iS=tB(aN).omit({id:!0,createdAt:!0}),ik=tB(aw).omit({id:!0,updatedAt:!0}),iq=tB(aI).omit({id:!0,createdAt:!0,updatedAt:!0}),iC=tB(aT).omit({id:!0,createdAt:!0,views:!0,clicks:!0}),ij=tB(aA).omit({id:!0,bannedAt:!0}),iP=tB(aS).omit({id:!0,updatedAt:!0}),i$=tB(ak).omit({id:!0,grantedAt:!0}),iE=tB(aq).omit({id:!0,createdAt:!0,updatedAt:!0,userCount:!0}),iR=tB(aC).omit({id:!0,createdAt:!0,executionCount:!0,lastExecuted:!0}),iO=tB(aj).omit({id:!0,createdAt:!0}),iM=tB(aP).omit({id:!0,createdAt:!0,updatedAt:!0}),iD=tB(a$).omit({id:!0,createdAt:!0,lastUsed:!0}),iL=tB(aE).omit({id:!0,createdAt:!0,lastTriggered:!0,successCount:!0,failureCount:!0}),iZ=tB(aR).omit({id:!0,lastRun:!0,nextRun:!0,lastStatus:!0,lastError:!0,executionCount:!0}),iK=tB(aO).omit({id:!0,recordedAt:!0}),iB=tB(aM).omit({id:!0,createdAt:!0}),iF=tB(aD).omit({id:!0,uploadedAt:!0,usageCount:!0}),iQ=tB(aL).omit({id:!0,createdAt:!0}),iz=tB(tz).omit({id:!0,createdAt:!0}),iU=(0,p.pgTable)("sitemap_logs",{id:(0,C.serial)("id").primaryKey(),action:(0,h.varchar)("action",{length:50}).notNull(),status:(0,h.varchar)("status",{length:20}).notNull(),urlCount:(0,f.integer)("url_count"),submittedTo:(0,h.varchar)("submitted_to",{length:100}),errorMessage:(0,m.text)("error_message"),metadata:(0,T.jsonb)("metadata"),createdAt:(0,_.timestamp)("created_at").defaultNow().notNull()}),iV=tB(iU).omit({id:!0,createdAt:!0}),iW=tB(aZ).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({tradingPair:tE.string().min(1,"Trading pair is required"),entryPrice:tE.string().min(1,"Entry price is required"),positionSize:tE.string().min(1,"Position size is required"),positionType:tE.enum(["long","short"]),entryDate:tE.date().or(tE.string()),exitDate:tE.date().or(tE.string()).optional()}),iJ=tB(aK).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({name:tE.string().min(1,"Watchlist name is required").max(100),symbols:tE.array(tE.string()).default([])}),iX=tB(aB).omit({id:!0,createdAt:!0,updatedAt:!0,isTriggered:!0,triggeredAt:!0}).extend({symbol:tE.string().min(1,"Symbol is required"),targetPrice:tE.string().min(1,"Target price is required"),condition:tE.enum(["above","below","equals"])}),iG=tB(aF).omit({id:!0,createdAt:!0,useCount:!0,lastUsedAt:!0}).extend({name:tE.string().min(1,"Search name is required").max(100),query:tE.string().min(1,"Search query is required")}),iH=tB(aQ).omit({id:!0,createdAt:!0,updatedAt:!0,currentStreak:!0,longestStreak:!0,totalCompletions:!0}),iY=tB(az).omit({id:!0,createdAt:!0,updatedAt:!0,memberCount:!0,messageCount:!0,lastMessageAt:!0}).extend({name:tE.string().min(1,"Room name is required").max(100),roomType:tE.enum(["public","private","trading_pair","strategy"])}),i0=tB(aU).omit({id:!0,joinedAt:!0}),i1=tB(aV).omit({id:!0,createdAt:!0,editedAt:!0,deletedAt:!0}).extend({content:tE.string().min(1,"Message content is required").max(2e3)}),i2=tB(aW).omit({id:!0,createdAt:!0,updatedAt:!0}),i9=tB(aJ).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({name:tE.string().min(1,"Layout name is required").max(100)});e.s(["BADGE_METADATA",0,iN,"BADGE_TYPES",0,ix,"abTests",0,aj,"achievements",0,ah,"activityFeed",0,as,"adminActions",0,ab,"adminRoles",0,ak,"announcements",0,aT,"apiKeys",0,a$,"automationRules",0,aC,"brokerReviews",0,t9,"brokers",0,t2,"campaigns",0,a_,"categoryRedirects",0,ai,"chatRoomMembers",0,aU,"chatRoomMessages",0,aV,"chatRooms",0,az,"coinJournalEntries",0,al,"coinLedgerTransactions",0,ao,"coinTransactions",0,tU,"content",0,tG,"contentLikes",0,t0,"contentPurchases",0,tH,"contentReplies",0,t1,"contentReviews",0,tY,"contentRevisions",0,aL,"conversations",0,t5,"dailyActivityLimits",0,ac,"dashboardLayouts",0,aJ,"dashboardPreferences",0,au,"dashboardSettings",0,ag,"dashboardWidgets",0,aW,"emailTemplates",0,aS,"featureFlags",0,aP,"feedback",0,tX,"forumCategories",0,at,"forumReplies",0,ae,"forumThreads",0,t7,"goals",0,am,"insertAbTestSchema",0,iO,"insertActivityFeedSchema",0,im,"insertAdminActionSchema",0,iT,"insertAdminRoleSchema",0,i$,"insertAnnouncementSchema",0,iC,"insertApiKeySchema",0,iD,"insertAutomationRuleSchema",0,iR,"insertBrokerReviewSchema",0,a7,"insertBrokerSchema",0,a6,"insertCategoryRedirectSchema",0,ic,"insertChatRoomMemberSchema",0,i0,"insertChatRoomMessageSchema",0,i1,"insertChatRoomSchema",0,iY,"insertCoinJournalEntrySchema",0,ig,"insertCoinLedgerTransactionSchema",0,i_,"insertCoinTransactionSchema",0,aH,"insertContentLikeSchema",0,a3,"insertContentPurchaseSchema",0,a4,"insertContentReplySchema",0,a8,"insertContentReviewSchema",0,a5,"insertContentRevisionSchema",0,iQ,"insertContentSchema",0,a9,"insertConversationSchema",0,it,"insertDashboardLayoutSchema",0,i9,"insertDashboardPreferencesSchema",0,iv,"insertDashboardWidgetSchema",0,i2,"insertEmailTemplateSchema",0,iP,"insertFeatureFlagSchema",0,iM,"insertFeedbackSchema",0,a2,"insertForumCategorySchema",0,id,"insertForumReplySchema",0,il,"insertForumThreadSchema",0,io,"insertGoalSchema",0,iI,"insertIpBanSchema",0,ij,"insertLedgerReconciliationRunSchema",0,iy,"insertMediaLibrarySchema",0,iF,"insertMessageReactionSchema",0,is,"insertMessageSchema",0,ia,"insertModerationQueueSchema",0,iA,"insertNotificationSchema",0,ii,"insertPerformanceMetricSchema",0,iK,"insertPriceAlertSchema",0,iX,"insertRechargeOrderSchema",0,aY,"insertReferralSchema",0,iw,"insertReportedContentSchema",0,iS,"insertSavedSearchSchema",0,iG,"insertScheduledJobSchema",0,iZ,"insertSecurityEventSchema",0,iB,"insertSeoCategorySchema",0,iu,"insertSitemapLogSchema",0,iV,"insertSubscriptionSchema",0,a0,"insertSupportTicketSchema",0,iq,"insertSystemSettingSchema",0,ik,"insertTradingJournalEntrySchema",0,iW,"insertUserActivitySchema",0,iz,"insertUserBadgeSchema",0,ip,"insertUserFollowSchema",0,ie,"insertUserHabitSchema",0,iH,"insertUserSchema",0,aG,"insertUserSegmentSchema",0,iE,"insertUserWalletSchema",0,ih,"insertWatchlistSchema",0,iJ,"insertWebhookSchema",0,iL,"insertWithdrawalRequestSchema",0,a1,"ipBans",0,aA,"ledgerReconciliationRuns",0,ad,"mediaLibrary",0,aD,"messageReactions",0,t8,"messages",0,t3,"moderationQueue",0,ax,"notifications",0,t6,"performanceMetrics",0,aO,"priceAlerts",0,aB,"profiles",0,ay,"publishContentSchema",0,ib,"rechargeOrders",0,tV,"referrals",0,ap,"reportedContent",0,aN,"savedSearches",0,aF,"scheduledJobs",0,aR,"securityEvents",0,aM,"seoCategories",0,aa,"sessions",0,tF,"sitemapLogs",0,iU,"subscriptions",0,tW,"supportTickets",0,aI,"systemSettings",0,aw,"tradingJournalEntries",0,aZ,"updateUserProfileSchema",0,ir,"upsertUserSchema",0,aX,"userAchievements",0,af,"userActivity",0,tz,"userBadges",0,ar,"userFollows",0,t4,"userHabits",0,aQ,"userSegments",0,aq,"userSettings",0,av,"userWallet",0,an,"users",0,tQ,"watchlists",0,aK,"webhooks",0,aE,"withdrawalRequests",0,tJ],90337)},57420,e=>e.a(async(t,a)=>{try{var i=e.i(30056),r=e.i(51103),s=e.i(90337),n=t([i,r]);[i,r]=n.then?(await n)():n;let o=()=>{if(!process.env.DATABASE_URL)throw Error("DATABASE_URL must be set. Did you forget to provision a database?");return{connectionString:process.env.DATABASE_URL,max:parseInt(process.env.DB_POOL_MAX||"20"),min:parseInt(process.env.DB_POOL_MIN||"2"),idleTimeoutMillis:parseInt(process.env.DB_IDLE_TIMEOUT||"30000"),connectionTimeoutMillis:parseInt(process.env.DB_CONNECTION_TIMEOUT||"5000"),ssl:{rejectUnauthorized:"false"!==process.env.DB_SSL_REJECT_UNAUTHORIZED,ca:process.env.DB_SSL_CA,cert:process.env.DB_SSL_CERT,key:process.env.DB_SSL_KEY},allowExitOnIdle:!1,statement_timeout:parseInt(process.env.DB_STATEMENT_TIMEOUT||"30000"),query_timeout:parseInt(process.env.DB_QUERY_TIMEOUT||"30000"),application_name:process.env.APP_NAME||"yoforex-api"}},l=null,d=0,u=async()=>{if(l)return l;for(;d<5;)try{console.log(`Initializing database connection pool (attempt ${d+1}/5)...`);let e=new i.Pool(o()),t=await e.connect();return await t.query("SELECT 1"),t.release(),console.log("✅ Database connection pool initialized successfully"),e.on("error",(e,t)=>{console.error("Unexpected error on idle database client:",e)}),e.on("connect",()=>{console.log("New client connected to database pool")}),e.on("acquire",()=>{let t={total:e.totalCount,idle:e.idleCount,waiting:e.waitingCount};console.log("Client acquired from pool:",t)}),e.on("remove",()=>{console.log("Client removed from database pool")}),l=e,d=0,l}catch(e){if(d++,console.error(`Failed to initialize database pool (attempt ${d}/5):`,e),d>=5)throw Error(`Failed to establish database connection after 5 attempts: ${e}`);console.log("Retrying in 2000ms..."),await new Promise(e=>setTimeout(e,2e3))}throw Error("Failed to initialize database pool")},c=null,p=null;(async()=>{try{c=await u(),p=(0,r.drizzle)(c,{schema:s})}catch(e){console.error("Failed to initialize database on startup:",e)}})();let m=new Proxy({},{get:(e,t)=>{if(!p){console.error("Database not initialized. Attempting to initialize now...");let e=new i.Pool(o());p=(0,r.drizzle)(e,{schema:s}),c=e}return p[t]}}),h=!1,f=async()=>{if(h)return void console.log("Database pool already closed, skipping...");if(console.log("Gracefully shutting down database connections..."),l)try{h=!0,await l.end(),console.log("Database pool closed successfully"),l=null}catch(e){console.error("Error closing database pool:",e)}};process.once("SIGTERM",f),process.once("SIGINT",f),process.once("beforeExit",f),e.s(["db",0,m]),a()}catch(e){a(e)}},!1)];

//# sourceMappingURL=_8943c30a._.js.map