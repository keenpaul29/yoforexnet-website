module.exports=[665470,a=>{"use strict";var b=a.i(907997);a.i(570396);var c=a.i(673727),d=a.i(489139),e=a.i(476414);function f({path:a}){let c={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:a.map((a,b)=>({"@type":"ListItem",position:b+1,name:a.name,item:a.url}))};return(0,b.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(c)}})}var g=a.i(842447),h=a.i(978569),i=a.i(44492),j=a.i(546767),k=a.i(901060),l=a.i(68540);let m=(0,l.relations)(k.users,({many:a})=>({threads:a(k.forumThreads),replies:a(k.forumReplies),content:a(k.content),reviews:a(k.contentReviews),brokerReviews:a(k.brokerReviews),purchases:a(k.contentPurchases,{relationName:"buyer"}),sales:a(k.contentPurchases,{relationName:"seller"})})),n=(0,l.relations)(k.forumThreads,({one:a,many:b})=>({author:a(k.users,{fields:[k.forumThreads.authorId],references:[k.users.id]}),replies:b(k.forumReplies)})),o=(0,l.relations)(k.forumReplies,({one:a})=>({thread:a(k.forumThreads,{fields:[k.forumReplies.threadId],references:[k.forumThreads.id]}),author:a(k.users,{fields:[k.forumReplies.userId],references:[k.users.id]})})),p=(0,l.relations)(k.content,({one:a,many:b})=>({author:a(k.users,{fields:[k.content.authorId],references:[k.users.id]}),reviews:b(k.contentReviews),purchases:b(k.contentPurchases)})),q=(0,l.relations)(k.contentReviews,({one:a})=>({content:a(k.content,{fields:[k.contentReviews.contentId],references:[k.content.id]}),author:a(k.users,{fields:[k.contentReviews.userId],references:[k.users.id]})})),r=(0,l.relations)(k.brokers,({many:a})=>({reviews:a(k.brokerReviews)})),s=(0,l.relations)(k.brokerReviews,({one:a})=>({broker:a(k.brokers,{fields:[k.brokerReviews.brokerId],references:[k.brokers.id]}),author:a(k.users,{fields:[k.brokerReviews.userId],references:[k.users.id]})})),t=(0,l.relations)(k.contentPurchases,({one:a})=>({content:a(k.content,{fields:[k.contentPurchases.contentId],references:[k.content.id]}),buyer:a(k.users,{fields:[k.contentPurchases.buyerId],references:[k.users.id],relationName:"buyer"}),seller:a(k.users,{fields:[k.contentPurchases.sellerId],references:[k.users.id],relationName:"seller"})}));a.s(["brokerReviewsRelations",0,s,"brokersRelations",0,r,"contentPurchasesRelations",0,t,"contentRelations",0,p,"contentReviewsRelations",0,q,"forumRepliesRelations",0,o,"forumThreadsRelations",0,n,"usersRelations",0,m],304598);var u=a.i(304598);if(!process.env.DATABASE_URL)throw Error("DATABASE_URL environment variable is not set");let v=new j.Pool({connectionString:process.env.DATABASE_URL}),w=(0,i.drizzle)(v,{schema:{...k,...u}});var x=a.i(93321);async function y({params:a}){let{path:b}=await a,c=b[b.length-1],f=b.slice(0,-1).join("/");try{let a=(0,d.getInternalApiUrl)(),e=await fetch(`${a}/api/threads/by-slug/${c}`);if(e.ok){let a=await e.json();return{title:a.title,description:a.body?.substring(0,160)||`Discussion about ${a.title}`,keywords:["forex forum","trading discussion",a.title,...f.split("/")],openGraph:{title:a.title,description:a.body?.substring(0,160),url:`/category/${b.join("/")}`,type:"article"}}}}catch(a){}try{let a=(0,d.getInternalApiUrl)(),e=await fetch(`${a}/api/content/by-slug/${c}`);if(e.ok){let a=await e.json();return{title:`${a.title} | YoForex Marketplace`,description:a.description?.substring(0,160)||`Download ${a.title}`,keywords:["forex EA","trading indicator",a.title],openGraph:{title:a.title,description:a.description?.substring(0,160),url:`/category/${b.join("/")}`,type:"article"}}}}catch(a){}let g=b.join("/"),h=await (0,e.getCategoryByPath)(g);return h?{title:`${h.name} | YoForex Forum`,description:h.description||`Browse ${h.name} discussions and content`,keywords:["forex forum",h.name,...f.split("/")],openGraph:{title:h.name,description:h.description||`Browse ${h.name} discussions`,url:`/category/${g}`,type:"website"}}:{title:"Category Not Found | YoForex"}}async function z({params:i}){let{path:j}=await i,l=j[j.length-1];j.slice(0,-1).join("/");let m=null,n=[];try{let a=(0,d.getInternalApiUrl)(),b=await fetch(`${a}/api/threads/by-slug/${l}`);if(b.ok){m=await b.json();try{let b=await fetch(`${a}/api/threads/${m.id}/replies`);b.ok&&(n=await b.json())}catch(a){console.warn("Failed to fetch thread replies")}}}catch(a){}if(m){let c=function(a){let{thread:b,content:c,user:d,pathname:e,category:f}=a;if(d&&e?.includes("/user/"))return{schemaType:"Person",confidence:1,reasons:["User profile page with user data"]};if(c){let a;return a=[],"ea"===c.type||"indicator"===c.type||"source_code"===c.type||!c.isFree||void 0!==c.priceCoins&&c.priceCoins>0?(a.push(`Content type: ${c.type}, has pricing`),{schemaType:"Product",confidence:1,reasons:a}):"article"===c.type&&(f?.slug.includes("tutorial")||f?.slug.includes("guide")||c.title?.toLowerCase().includes("tutorial")||c.title?.toLowerCase().includes("guide"))?(a.push("Educational content type detected"),{schemaType:"BlogPosting",confidence:.9,reasons:a}):c.description?.toLowerCase().includes("youtube.com")||c.description?.toLowerCase().includes("vimeo.com")||c.description?.toLowerCase().includes("video")?(a.push("Content has video URL or video type"),{schemaType:"VideoObject",confidence:1,reasons:a}):(a.push("General article content"),{schemaType:"Article",confidence:.8,reasons:a})}if(b){let a=[];if(b.title.toLowerCase().match(/\?(.*)?$/))return a.push("Title contains question mark - FAQ pattern detected"),{schemaType:"FAQPage",confidence:.8,reasons:a};let c=new Date(b.createdAt);return(Date.now()-c.getTime())/864e5<=2&&(b.title.toLowerCase().includes("breaking")||b.title.toLowerCase().includes("news")||b.title.toLowerCase().includes("announcement"))?(a.push("Recent publication (< 2 days) with news keywords"),{schemaType:"NewsArticle",confidence:.9,reasons:a}):f?.slug.includes("blog")||f?.slug.includes("editorial")||b.title.toLowerCase().includes("guide")||b.title.toLowerCase().includes("tutorial")?(a.push("Category or title indicates blog/editorial content"),{schemaType:"BlogPosting",confidence:.85,reasons:a}):b.body?.toLowerCase().includes("youtube.com")||b.body?.toLowerCase().includes("vimeo.com")||b.body?.toLowerCase().includes("video")?(a.push("Content contains video links"),{schemaType:"VideoObject",confidence:.75,reasons:a}):(a.push("Standard forum discussion with replies"),{schemaType:"DiscussionForumPosting",confidence:1,reasons:a})}if(e){let a;return a=[],e.match(/^\/user\/[^/]+$/)?(a.push("User profile page pattern"),{schemaType:"Person",confidence:1,reasons:a}):"/"===e||"/home"===e?(a.push("Homepage"),{schemaType:"WebSite",confidence:1,reasons:a}):e.includes("/thread/")||e.match(/\/category\/.*\/[^/]+$/)?(a.push("Thread page pattern"),{schemaType:"DiscussionForumPosting",confidence:.9,reasons:a}):e.includes("/marketplace")||e.includes("/content/")?(a.push("Marketplace/content page pattern"),{schemaType:"Product",confidence:.85,reasons:a}):e.includes("/faq")||e.includes("/help")?(a.push("FAQ/help page pattern"),{schemaType:"FAQPage",confidence:.9,reasons:a}):(a.push("Generic page"),{schemaType:"Article",confidence:.5,reasons:a})}return{schemaType:"Article",confidence:.3,reasons:["Insufficient data for accurate detection"]}}({thread:m,pathname:`/category/${j.join("/")}`}),e=(0,d.getInternalApiUrl)(),f=null;try{let a=await fetch(`${e}/api/users/${m.authorId}`);a.ok&&(f=await a.json())}catch(a){console.warn("Author fetch failed, using anonymous author")}f||(f={id:"anonymous",username:"Anonymous",profileImageUrl:null});let i=null,k="http://localhost:3000";try{switch(c.schemaType){case"FAQPage":let a=[{question:m.title,answer:m.body||"See discussion for details",id:m.id}];n&&n.length>0&&n.slice(0,3).forEach(b=>{b.body&&a.push({question:`Reply: ${m.title}`,answer:b.body,id:b.id})}),i=(0,h.generateFAQPageSchema)({questions:a,baseUrl:k,pageUrl:`/category/${j.join("/")}`});break;case"NewsArticle":i=(0,h.generateNewsArticleSchema)({headline:m.title,description:m.body?.substring(0,160),content:m.body||"",author:f,publishDate:new Date(m.createdAt),modifiedDate:m.updatedAt?new Date(m.updatedAt):void 0,baseUrl:k,url:`/category/${j.join("/")}`,imageUrl:void 0,location:void 0,commentCount:n?.length||0});break;case"BlogPosting":i=(0,h.generateBlogPostingSchema)({title:m.title,description:m.body?.substring(0,160),content:m.body||"",author:f,publishDate:new Date(m.createdAt),modifiedDate:m.updatedAt?new Date(m.updatedAt):void 0,baseUrl:k,url:`/category/${j.join("/")}`,imageUrl:void 0,category:j[0],commentCount:n?.length||0});break;case"VideoObject":let b=m.body?.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]+)/),d=b?b[1]:null,e=d?`https://www.youtube.com/embed/${d}`:void 0;i=(0,h.generateVideoObjectSchema)({title:m.title,description:m.body?.substring(0,160)||m.title,thumbnailUrl:d?`https://img.youtube.com/vi/${d}/maxresdefault.jpg`:`${k}/default-video-thumbnail.jpg`,uploadDate:new Date(m.createdAt),videoUrl:void 0,embedUrl:e,durationSeconds:void 0,viewCount:m.viewCount||0,baseUrl:k,author:f});break;default:i=(0,h.generateDiscussionForumPostingSchema)({thread:m,author:f,baseUrl:k,viewCount:m.viewCount||0,replyCount:n?.length||0,upvoteCount:m.upvoteCount||0,replies:n?.slice(0,10).map(a=>({id:a.id,content:a.body,author:a.author||{username:"Anonymous"},createdAt:new Date(a.createdAt),upvotes:a.helpfulCount||0}))||[]})}}catch(a){console.error("[Schema Error]",a),i=null}let{default:l}=await a.A(685475);return(0,b.jsxs)(b.Fragment,{children:[i&&(0,b.jsx)(g.SchemaScript,{schema:i}),(0,b.jsx)(l,{initialThread:m,initialReplies:n})]})}let o=null,p=null,q=[],r=[],s=[];try{let a=(0,d.getInternalApiUrl)(),b=await fetch(`${a}/api/content/slug/${l}`);if(b.ok){o=await b.json();let[c,d,e,f]=await Promise.all([fetch(`${a}/api/users/${o.authorId}`).catch(()=>null),fetch(`${a}/api/content/${o.id}/reviews`).catch(()=>null),fetch(`${a}/api/content/${o.id}/similar`).catch(()=>null),fetch(`${a}/api/users/${o.authorId}/content`).catch(()=>null)]);c&&c.ok&&(p=await c.json()),d&&d.ok&&(q=await d.json()),e&&e.ok&&(r=await e.json()),f&&f.ok&&(s=await f.json())}}catch(a){}if(o){let c=null;if(p)try{let a=q?.length||0;c=(0,h.generateProductSchema)({product:o,baseUrl:"http://localhost:3000",author:p,averageRating:a>=5?o.averageRating:void 0,reviewCount:a,reviews:q?.slice(0,5).map(a=>({author:a.author||{username:"Anonymous"},rating:a.rating||5,comment:a.comment||"",createdAt:new Date(a.createdAt)}))||[]})}catch(a){console.error("[Schema Error]",a),c=null}let{default:d}=await a.A(229048);return(0,b.jsxs)(b.Fragment,{children:[c&&(0,b.jsx)(g.SchemaScript,{schema:c}),(0,b.jsx)(d,{slug:l,initialContent:o,initialAuthor:p,initialReviews:q,initialSimilarContent:r,initialAuthorReleases:s})]})}let t=j.join("/"),u=await (0,e.getCategoryByPath)(t);u||(0,c.notFound)();let v=[{name:"Home",url:"/"}],y=t.split("/");for(let a=0;a<y.length;a++){let b=y.slice(0,a+1).join("/"),c=y[a],[d]=await w.select().from(k.forumCategories).where((0,x.eq)(k.forumCategories.slug,c)).limit(1);d&&v.push({name:d.name,url:`/category/${b}`})}let z=[];try{let a=(0,d.getInternalApiUrl)(),b=await fetch(`${a}/api/categories/${u.slug}/threads`);b.ok&&(z=await b.json())}catch(a){console.error("Error fetching category threads:",a)}let{default:A}=await a.A(29421);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f,{path:v}),(0,b.jsx)(A,{slug:u.slug,initialCategory:u,initialThreads:z})]})}a.s(["default",()=>z,"generateMetadata",()=>y],665470)}];

//# sourceMappingURL=app_category_%5B___path%5D_page_tsx_0e5426a3._.js.map