module.exports=[839958,(a,b,c)=>{var d=a.r(522734),e=a.r(814747),f=a.r(446786),g="function"==typeof __webpack_require__?__non_webpack_require__:a.t,h=process.config&&process.config.variables||{},i=!!process.env.PREBUILDS_ONLY,j=process.versions.modules,k=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?"electron":process.versions&&process.versions.nw?"node-webkit":"node",l=process.env.npm_config_arch||f.arch(),m=process.env.npm_config_platform||f.platform(),n=process.env.LIBC||("linux"===m&&d.existsSync("/etc/alpine-release")?"musl":"glibc"),o=process.env.ARM_VERSION||("arm64"===l?"8":h.arm_version)||"",p=(process.versions.uv||"").split(".")[0];function q(a){return g(q.resolve(a))}function r(a){try{return d.readdirSync(a)}catch(a){return[]}}function s(a,b){var c=r(a).filter(b);return c[0]&&e.join(a,c[0])}function t(a){return/\.node$/.test(a)}function u(a){var b=a.split("-");if(2===b.length){var c=b[0],d=b[1].split("+");if(c&&d.length&&d.every(Boolean))return{name:a,platform:c,architectures:d}}}function v(a,b){return function(c){return null!=c&&c.platform===a&&c.architectures.includes(b)}}function w(a,b){return a.architectures.length-b.architectures.length}function x(a){var b=a.split("."),c=b.pop(),d={file:a,specificity:0};if("node"===c){for(var e=0;e<b.length;e++){var f=b[e];if("node"===f||"electron"===f||"node-webkit"===f)d.runtime=f;else if("napi"===f)d.napi=!0;else if("abi"===f.slice(0,3))d.abi=f.slice(3);else if("uv"===f.slice(0,2))d.uv=f.slice(2);else if("armv"===f.slice(0,4))d.armv=f.slice(4);else{if("glibc"!==f&&"musl"!==f)continue;d.libc=f}d.specificity++}return d}}function y(a,b){return function(c){var d;return null!=c&&(!c.runtime||c.runtime===a||!!("node"===(d=c).runtime&&d.napi))&&(!c.abi||c.abi===b||!!c.napi)&&(!c.uv||c.uv===p)&&(!c.armv||c.armv===o)&&(!c.libc||c.libc===n)&&!0}}function z(a){return function(b,c){return b.runtime!==c.runtime?b.runtime===a?-1:1:b.abi!==c.abi?b.abi?-1:1:b.specificity!==c.specificity?b.specificity>c.specificity?-1:1:0}}b.exports=q,q.resolve=q.path=function(a){a=e.resolve(a||".");try{var b=g(e.join(a,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[b+"_PREBUILD"]&&(a=process.env[b+"_PREBUILD"])}catch(a){}if(!i){var c=s(e.join(a,"build/Release"),t);if(c)return c;var d=s(e.join(a,"build/Debug"),t);if(d)return d}var f=q(a);if(f)return f;var h=q(e.dirname(process.execPath));if(h)return h;throw Error("No native build was found for "+["platform="+m,"arch="+l,"runtime="+k,"abi="+j,"uv="+p,o?"armv="+o:"","libc="+n,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","function"==typeof __webpack_require__?"webpack=true":""].filter(Boolean).join(" ")+"\n    loaded from: "+a+"\n");function q(a){var b=r(e.join(a,"prebuilds")).map(u).filter(v(m,l)).sort(w)[0];if(b){var c=e.join(a,"prebuilds",b.name),d=r(c).map(x).filter(y(k,j)).sort(z(k))[0];if(d)return e.join(c,d.file)}}},q.parseTags=x,q.matchTags=y,q.compareTags=z,q.parseTuple=u,q.matchTuple=v,q.compareTuples=w},983895,(a,b,c)=>{let d="function"==typeof __webpack_require__?__non_webpack_require__:a.t;"function"==typeof d.addon?b.exports=d.addon.bind(d):b.exports=a.r(839958)},729410,(a,b,c)=>{"use strict";b.exports={mask:(a,b,c,d,e)=>{for(var f=0;f<e;f++)c[d+f]=a[f]^b[3&f]},unmask:(a,b)=>{let c=a.length;for(var d=0;d<c;d++)a[d]^=b[3&d]}}},92391,(a,b,c)=>{"use strict";try{b.exports=a.r(983895)("/ROOT/node_modules/bufferutil")}catch(c){b.exports=a.r(729410)}},877379,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="undefined"!=typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},565167,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(877379),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let c=a.r(92391);b.exports.mask=function(a,b,d,e,g){g<48?f(a,b,d,e,g):c.mask(a,b,d,e,g)},b.exports.unmask=function(a,b){a.length<32?g(a,b):c.unmask(a,b)}}catch(a){}},295973,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},224191,(a,b,c)=>{"use strict";let d,e=a.r(406461),f=a.r(565167),g=a.r(295973),{kStatusCode:h}=a.r(877379),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[n].push(a):(this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset())}function r(a){(this[k]._inflate=null,this[o])?this[m](this[o]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},750308,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(500874),{hasBlob:e}=a.r(877379);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},923852,(a,b,c)=>{"use strict";let{Writable:d}=a.r(688947),e=a.r(224191),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(877379),{concat:j,toArrayBuffer:k,unmask:l}=a.r(565167),{isValidStatusCode:m,isValidUTF8:n}=a.r(750308),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},321819,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(688947),{randomFillSync:f}=a.r(254799),g=a.r(224191),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(877379),{isBlob:k,isValidStatusCode:l}=a.r(750308),{mask:m,toBuffer:n}=a.r(565167),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?s(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},553447,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(877379),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},82731,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(750308);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},73253,(a,b,c)=>{"use strict";let d=a.r(427699),e=a.r(524836),f=a.r(921517),g=a.r(504446),h=a.r(755004),{randomBytes:i,createHash:j}=a.r(254799),{Duplex:k,Readable:l}=a.r(688947),{URL:m}=a.r(792509),n=a.r(224191),o=a.r(923852),p=a.r(321819),{isBlob:q}=a.r(750308),{BINARY_TYPES:r,EMPTY_BUFFER:s,GUID:t,kForOnEventAttribute:u,kListener:v,kStatusCode:w,kWebSocket:x,NOOP:y}=a.r(877379),{EventTarget:{addEventListener:z,removeEventListener:A}}=a.r(553447),{format:B,parse:C}=a.r(82731),{toBuffer:D}=a.r(565167),E=Symbol("kAborted"),F=[8,13],G=["CONNECTING","OPEN","CLOSING","CLOSED"],H=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=s,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:F[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,!F.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${F.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void J(b,a);throw a}let s=q?443:80,u=i(16).toString("base64"),v=q?e.request:f.request,w=new Set;if(p.createConnection=p.createConnection||(q?L:K),p.defaultPort=p.defaultPort||s,p.port=h.port||s,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=B({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!H.test(a)||w.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=v(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=v(p);p.timeout&&o.on("timeout",()=>{M(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[E]||(o=b._req=null,J(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void M(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){J(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||M(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==I.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void M(b,c,"Invalid Upgrade header");let g=j("sha1").update(u+t).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void M(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?w.size?w.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":w.size&&(e="Server sent no subprotocol"),e)return void M(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void M(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=C(i)}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void M(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[x]=this,e[x]=this,a[x]=this,d.on("conclude",O),d.on("drain",P),d.on("error",Q),d.on("message",S),d.on("ping",T),d.on("pong",U),e.onerror=W,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Y),a.on("data",Z),a.on("end",$),a.on("error",_),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),X(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||s,b,c))}pong(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||s,b,c))}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||s,d,c)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function J(a,b){a._readyState=I.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function K(a){return a.path=a.socketPath,g.connect(a)}function L(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function M(a,b,c){a._readyState=I.CLOSING;let d=Error(c);Error.captureStackTrace(d,M),b.setHeader?(b[E]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(J,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function N(a,b,c){if(b){let c=q(b)?b.size:D(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${G[a.readyState]})`);process.nextTick(c,b)}}function O(a,b){let c=this[x];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[x]&&(c._socket.removeListener("data",Z),process.nextTick(V,c._socket),1005===a?c.close():c.close(a,b))}function P(){let a=this[x];a.isPaused||a._socket.resume()}function Q(a){let b=this[x];void 0!==b._socket[x]&&(b._socket.removeListener("data",Z),process.nextTick(V,b._socket),b.close(a[w])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function R(){this[x].emitClose()}function S(a,b){this[x].emit("message",a,b)}function T(a){let b=this[x];b._autoPong&&b.pong(a,!this._isServer,y),b.emit("ping",a)}function U(a){this[x].emit("pong",a)}function V(a){a.resume()}function W(a){let b=this[x];b.readyState!==I.CLOSED&&(b.readyState===I.OPEN&&(b._readyState=I.CLOSING,X(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function X(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Y(){let a,b=this[x];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",$),b._readyState=I.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[x]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",R),b._receiver.on("finish",R))}function Z(a){this[x]._receiver.write(a)||this.pause()}function $(){let a=this[x];a._readyState=I.CLOSING,a._receiver.end(),this.end()}function _(){let a=this[x];this.removeListener("error",_),this.on("error",y),a&&(a._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(I.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(I.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[u])return b[v];return null},set(b){for(let b of this.listeners(a))if(b[u]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[u]:!0})}})}),I.prototype.addEventListener=z,I.prototype.removeEventListener=A,b.exports=I},216816,(a,b,c)=>{"use strict";a.r(73253);let{Duplex:d}=a.r(688947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},535816,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(750308);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},272513,(a,b,c)=>{"use strict";let d=a.r(427699),e=a.r(921517),{Duplex:f}=a.r(688947),{createHash:g}=a.r(254799),h=a.r(82731),i=a.r(224191),j=a.r(535816),k=a.r(73253),{GUID:l,kWebSocket:m}=a.r(877379),n=/^[+/0-9A-Za-z]{22}==$/;function o(a){a._state=2,a.emit("close")}function p(){this.destroy()}function q(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function r(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,r),a.emit("wsClientError",d,c,b)}else q(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(o,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(o,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{o(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",p);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void r(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void r(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!n.test(e))return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void q(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){r(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],o={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),o[i.extensionName]=c)}catch(c){r(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return q(b,g||401,h,i);this.completeUpgrade(o,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return q(b,401)}this.completeUpgrade(o,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q(e,503);let k=g("sha1").update(b+l).digest("base64"),n=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],r=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(n.push(`Sec-WebSocket-Protocol: ${a}`),r._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});n.push(`Sec-WebSocket-Extensions: ${c}`),r._extensions=a}this.emit("headers",n,d),e.write(n.concat("\r\n").join("\r\n")),e.removeListener("error",p),r.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(o,this)})),j(r,d)}}},476414,546767,44492,901060,a=>{"use strict";let b;var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=Object.create,r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,u=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,w=(a,b)=>r(a,"name",{value:b,configurable:!0}),x=(a,b)=>()=>(a&&(b=a(a=0)),b),y=(a,b)=>()=>(b||a((b={exports:{}}).exports,b),b.exports),z=(a,b)=>{for(var c in b)r(a,c,{get:b[c],enumerable:!0})},A=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let e of t(b))v.call(a,e)||e===c||r(a,e,{get:()=>b[e],enumerable:!(d=s(b,e))||d.enumerable});return a},B=(a,b,c)=>(c=null!=a?q(u(a)):{},A(!b&&a&&a.__esModule?c:r(c,"default",{value:a,enumerable:!0}),a)),C=a=>A(r({},"__esModule",{value:!0}),a),D=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?r(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c},E=y(a=>{H(),a.byteLength=i,a.toByteArray=k,a.fromByteArray=n;var b,c,d=[],e=[],f="u">typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(b=0,c=g.length;b<c;++b)d[b]=g[b],e[g.charCodeAt(b)]=b;function h(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}function i(a){var b=h(a),c=b[0],d=b[1];return(c+d)*3/4-d}function j(a,b,c){return(b+c)*3/4-c}function k(a){var b,c,d=h(a),g=d[0],i=d[1],k=new f(j(a,g,i)),l=0,m=i>0?g-4:g;for(c=0;c<m;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],k[l++]=b>>16&255,k[l++]=b>>8&255,k[l++]=255&b;return 2===i&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,k[l++]=255&b),1===i&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,k[l++]=b>>8&255,k[l++]=255&b),k}function l(a){return d[a>>18&63]+d[a>>12&63]+d[a>>6&63]+d[63&a]}function m(a,b,c){for(var d=[],e=b;e<c;e+=3)d.push(l((a[e]<<16&0xff0000)+(a[e+1]<<8&65280)+(255&a[e+2])));return d.join("")}function n(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(m(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")}e[45]=62,e[95]=63,w(h,"getLens"),w(i,"byteLength"),w(j,"_byteLength"),w(k,"toByteArray"),w(l,"tripletToBase64"),w(m,"encodeChunk"),w(n,"fromByteArray")}),F=y(a=>{H(),a.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},a.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=5960464477539062e-23*(23===e),n=d?0:f-1,o=d?1:-1,p=+(b<0||0===b&&1/b<0);for(isNaN(b=Math.abs(b))||b===1/0?(h=+!!isNaN(b),g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?b+=m/i:b+=m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}}),G=y(a=>{H();var b=E(),c=F(),d="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function e(){try{let a=new Uint8Array(1),b={foo:w(function(){return 42},"foo")};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch{return!1}}function f(a){if(a>0x7fffffff)throw RangeError('The value "'+a+'" is invalid for option "size"');let b=new Uint8Array(a);return Object.setPrototypeOf(b,g.prototype),b}function g(a,b,c){if("number"==typeof a){if("string"==typeof b)throw TypeError('The "string" argument must be of type string. Received type number');return k(a)}return h(a,b,c)}function h(a,b,c){if("string"==typeof a)return l(a,b);if(ArrayBuffer.isView(a))return n(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(ag(a,ArrayBuffer)||a&&ag(a.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(ag(a,SharedArrayBuffer)||a&&ag(a.buffer,SharedArrayBuffer)))return o(a,b,c);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');let d=a.valueOf&&a.valueOf();if(null!=d&&d!==a)return g.from(d,b,c);let e=p(a);if(e)return e;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return g.from(a[Symbol.toPrimitive]("string"),b,c);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function i(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+a+'" is invalid for option "size"')}function j(a,b,c){return i(a),a<=0?f(a):void 0!==b?"string"==typeof c?f(a).fill(b,c):f(a).fill(b):f(a)}function k(a){return i(a),f(a<0?0:0|q(a))}function l(a,b){if(("string"!=typeof b||""===b)&&(b="utf8"),!g.isEncoding(b))throw TypeError("Unknown encoding: "+b);let c=0|s(a,b),d=f(c),e=d.write(a,b);return e!==c&&(d=d.slice(0,e)),d}function m(a){let b=a.length<0?0:0|q(a.length),c=f(b);for(let d=0;d<b;d+=1)c[d]=255&a[d];return c}function n(a){if(ag(a,Uint8Array)){let b=new Uint8Array(a);return o(b.buffer,b.byteOffset,b.byteLength)}return m(a)}function o(a,b,c){let d;if(b<0||a.byteLength<b)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<b+(c||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(d=void 0===b&&void 0===c?new Uint8Array(a):void 0===c?new Uint8Array(a,b):new Uint8Array(a,b,c),g.prototype),d}function p(a){if(g.isBuffer(a)){let b=0|q(a.length),c=f(b);return 0===c.length||a.copy(c,0,0,b),c}return void 0!==a.length?"number"!=typeof a.length||ah(a.length)?f(0):m(a):"Buffer"===a.type&&Array.isArray(a.data)?m(a.data):void 0}function q(a){if(a>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|a}function r(a){return+a!=a&&(a=0),g.alloc(+a)}function s(a,b){if(g.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||ag(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);let c=a.length,d=arguments.length>2&&!0===arguments[2];if(!d&&0===c)return 0;let e=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return ab(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return ae(a).length;default:if(e)return d?-1:ab(a).length;b=(""+b).toLowerCase(),e=!0}}function t(a,b,c){let d=!1;if((void 0===b||b<0)&&(b=0),b>this.length||((void 0===c||c>this.length)&&(c=this.length),c<=0)||(c>>>=0)<=(b>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return L(this,b,c);case"utf8":case"utf-8":return G(this,b,c);case"ascii":return J(this,b,c);case"latin1":case"binary":return K(this,b,c);case"base64":return D(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,b,c);default:if(d)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c){let d=a[b];a[b]=a[c],a[c]=d}function v(a,b,c,d,e){if(0===a.length)return -1;if("string"==typeof c?(d=c,c=0):c>0x7fffffff?c=0x7fffffff:c<-0x80000000&&(c=-0x80000000),ah(c*=1)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return -1;c=a.length-1}else if(c<0)if(!e)return -1;else c=0;if("string"==typeof b&&(b=g.from(b,d)),g.isBuffer(b))return 0===b.length?-1:x(a,b,c,d,e);if("number"==typeof b)return b&=255,"function"==typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):x(a,[b],c,d,e);throw TypeError("val must be string, number or Buffer")}function x(a,b,c,d,e){let f,g=1,h=a.length,i=b.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return -1;g=2,h/=2,i/=2,c/=2}function j(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}if(w(j,"read"),e){let d=-1;for(f=c;f<h;f++)if(j(a,f)===j(b,-1===d?0:f-d)){if(-1===d&&(d=f),f-d+1===i)return d*g}else -1!==d&&(f-=f-d),d=-1}else for(c+i>h&&(c=h-i),f=c;f>=0;f--){let c=!0;for(let d=0;d<i;d++)if(j(a,f+d)!==j(b,d)){c=!1;break}if(c)return f}return -1}function y(a,b,c,d){let e;c=Number(c)||0;let f=a.length-c;d?(d=Number(d))>f&&(d=f):d=f;let g=b.length;for(d>g/2&&(d=g/2),e=0;e<d;++e){let d=parseInt(b.substr(2*e,2),16);if(ah(d))break;a[c+e]=d}return e}function z(a,b,c,d){return af(ab(b,a.length-c),a,c,d)}function A(a,b,c,d){return af(ac(b),a,c,d)}function B(a,b,c,d){return af(ae(b),a,c,d)}function C(a,b,c,d){return af(ad(b,a.length-c),a,c,d)}function D(a,c,d){return 0===c&&d===a.length?b.fromByteArray(a):b.fromByteArray(a.slice(c,d))}function G(a,b,c){c=Math.min(a.length,c);let d=[],e=b;for(;e<c;){let b=a[e],f=null,g=b>239?4:b>223?3:b>191?2:1;if(e+g<=c){let c,d,h,i;switch(g){case 1:b<128&&(f=b);break;case 2:(192&(c=a[e+1]))==128&&(i=(31&b)<<6|63&c)>127&&(f=i);break;case 3:c=a[e+1],d=a[e+2],(192&c)==128&&(192&d)==128&&(i=(15&b)<<12|(63&c)<<6|63&d)>2047&&(i<55296||i>57343)&&(f=i);break;case 4:c=a[e+1],d=a[e+2],h=a[e+3],(192&c)==128&&(192&d)==128&&(192&h)==128&&(i=(15&b)<<18|(63&c)<<12|(63&d)<<6|63&h)>65535&&i<1114112&&(f=i)}}null===f?(f=65533,g=1):f>65535&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|1023&f),d.push(f),e+=g}return I(d)}function I(a){let b=a.length;if(b<=4096)return String.fromCharCode.apply(String,a);let c="",d=0;for(;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=4096));return c}function J(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function K(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function L(a,b,c){let d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);let e="";for(let d=b;d<c;++d)e+=ai[a[d]];return e}function M(a,b,c){let d=a.slice(b,c),e="";for(let a=0;a<d.length-1;a+=2)e+=String.fromCharCode(d[a]+256*d[a+1]);return e}function N(a,b,c){if(a%1!=0||a<0)throw RangeError("offset is not uint");if(a+b>c)throw RangeError("Trying to access beyond buffer length")}function O(a,b,c,d,e,f){if(!g.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw RangeError('"value" argument is out of bounds');if(c+d>a.length)throw RangeError("Index out of range")}function P(a,b,c,d,e){Y(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,c}function Q(a,b,c,d,e){Y(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c+7]=f,f>>=8,a[c+6]=f,f>>=8,a[c+5]=f,f>>=8,a[c+4]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c+3]=g,g>>=8,a[c+2]=g,g>>=8,a[c+1]=g,g>>=8,a[c]=g,c+8}function R(a,b,c,d,e,f){if(c+d>a.length||c<0)throw RangeError("Index out of range")}function S(a,b,d,e,f){return b*=1,d>>>=0,f||R(a,b,d,4,34028234663852886e22,-34028234663852886e22),c.write(a,b,d,e,23,4),d+4}function T(a,b,d,e,f){return b*=1,d>>>=0,f||R(a,b,d,8,17976931348623157e292,-17976931348623157e292),c.write(a,b,d,e,52,8),d+8}a.Buffer=g,a.SlowBuffer=r,a.INSPECT_MAX_BYTES=50,a.kMaxLength=0x7fffffff,g.TYPED_ARRAY_SUPPORT=e(),!g.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),w(e,"typedArraySupport"),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:w(function(){if(g.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:w(function(){if(g.isBuffer(this))return this.byteOffset},"get")}),w(f,"createBuffer"),w(g,"Buffer"),g.poolSize=8192,w(h,"from"),g.from=function(a,b,c){return h(a,b,c)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),w(i,"assertSize"),w(j,"alloc"),g.alloc=function(a,b,c){return j(a,b,c)},w(k,"allocUnsafe"),g.allocUnsafe=function(a){return k(a)},g.allocUnsafeSlow=function(a){return k(a)},w(l,"fromString"),w(m,"fromArrayLike"),w(n,"fromArrayView"),w(o,"fromArrayBuffer"),w(p,"fromObject"),w(q,"checked"),w(r,"SlowBuffer"),g.isBuffer=w(function(a){return null!=a&&!0===a._isBuffer&&a!==g.prototype},"isBuffer"),g.compare=w(function(a,b){if(ag(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),ag(b,Uint8Array)&&(b=g.from(b,b.offset,b.byteLength)),!g.isBuffer(a)||!g.isBuffer(b))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;let c=a.length,d=b.length;for(let e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:+(d<c)},"compare"),g.isEncoding=w(function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),g.concat=w(function(a,b){let c;if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);if(void 0===b)for(b=0,c=0;c<a.length;++c)b+=a[c].length;let d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){let b=a[c];if(ag(b,Uint8Array))e+b.length>d.length?(g.isBuffer(b)||(b=g.from(b)),b.copy(d,e)):Uint8Array.prototype.set.call(d,b,e);else if(g.isBuffer(b))b.copy(d,e);else throw TypeError('"list" argument must be an Array of Buffers');e+=b.length}return d},"concat"),w(s,"byteLength"),g.byteLength=s,w(t,"slowToString"),g.prototype._isBuffer=!0,w(u,"swap"),g.prototype.swap16=w(function(){let a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<a;b+=2)u(this,b,b+1);return this},"swap16"),g.prototype.swap32=w(function(){let a=this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<a;b+=4)u(this,b,b+3),u(this,b+1,b+2);return this},"swap32"),g.prototype.swap64=w(function(){let a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<a;b+=8)u(this,b,b+7),u(this,b+1,b+6),u(this,b+2,b+5),u(this,b+3,b+4);return this},"swap64"),g.prototype.toString=w(function(){let a=this.length;return 0===a?"":0==arguments.length?G(this,0,a):t.apply(this,arguments)},"toString"),g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=w(function(a){if(!g.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===g.compare(this,a)},"equals"),g.prototype.inspect=w(function(){let b="",c=a.INSPECT_MAX_BYTES;return b=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(b+=" ... "),"<Buffer "+b+">"},"inspect"),d&&(g.prototype[d]=g.prototype.inspect),g.prototype.compare=w(function(a,b,c,d,e){if(ag(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),!g.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return -1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;let f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c);for(let a=0;a<i;++a)if(j[a]!==k[a]){f=j[a],h=k[a];break}return f<h?-1:+(h<f)},"compare"),w(v,"bidirectionalIndexOf"),w(x,"arrayIndexOf"),g.prototype.includes=w(function(a,b,c){return -1!==this.indexOf(a,b,c)},"includes"),g.prototype.indexOf=w(function(a,b,c){return v(this,a,b,c,!0)},"indexOf"),g.prototype.lastIndexOf=w(function(a,b,c){return v(this,a,b,c,!1)},"lastIndexOf"),w(y,"hexWrite"),w(z,"utf8Write"),w(A,"asciiWrite"),w(B,"base64Write"),w(C,"ucs2Write"),g.prototype.write=w(function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let f=!1;for(;;)switch(d){case"hex":return y(this,a,b,c);case"utf8":case"utf-8":return z(this,a,b,c);case"ascii":case"latin1":case"binary":return A(this,a,b,c);case"base64":return B(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,a,b,c);default:if(f)throw TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},"write"),g.prototype.toJSON=w(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON"),w(D,"base64Slice"),w(G,"utf8Slice"),w(I,"decodeCodePointsArray"),w(J,"asciiSlice"),w(K,"latin1Slice"),w(L,"hexSlice"),w(M,"utf16leSlice"),g.prototype.slice=w(function(a,b){let c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);let d=this.subarray(a,b);return Object.setPrototypeOf(d,g.prototype),d},"slice"),w(N,"checkOffset"),g.prototype.readUintLE=g.prototype.readUIntLE=w(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d},"readUIntLE"),g.prototype.readUintBE=g.prototype.readUIntBE=w(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a+--b],e=1;for(;b>0&&(e*=256);)d+=this[a+--b]*e;return d},"readUIntBE"),g.prototype.readUint8=g.prototype.readUInt8=w(function(a,b){return a>>>=0,b||N(a,1,this.length),this[a]},"readUInt8"),g.prototype.readUint16LE=g.prototype.readUInt16LE=w(function(a,b){return a>>>=0,b||N(a,2,this.length),this[a]|this[a+1]<<8},"readUInt16LE"),g.prototype.readUint16BE=g.prototype.readUInt16BE=w(function(a,b){return a>>>=0,b||N(a,2,this.length),this[a]<<8|this[a+1]},"readUInt16BE"),g.prototype.readUint32LE=g.prototype.readUInt32LE=w(function(a,b){return a>>>=0,b||N(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+0x1000000*this[a+3]},"readUInt32LE"),g.prototype.readUint32BE=g.prototype.readUInt32BE=w(function(a,b){return a>>>=0,b||N(a,4,this.length),0x1000000*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},"readUInt32BE"),g.prototype.readBigUInt64LE=aj(w(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&$(a,this.length-8);let d=b+256*this[++a]+65536*this[++a]+0x1000000*this[++a],e=this[++a]+256*this[++a]+65536*this[++a]+0x1000000*c;return BigInt(d)+(BigInt(e)<<BigInt(32))},"readBigUInt64LE")),g.prototype.readBigUInt64BE=aj(w(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&$(a,this.length-8);let d=0x1000000*b+65536*this[++a]+256*this[++a]+this[++a],e=0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c;return(BigInt(d)<<BigInt(32))+BigInt(e)},"readBigUInt64BE")),g.prototype.readIntLE=w(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d>=(e*=128)&&(d-=Math.pow(2,8*b)),d},"readIntLE"),g.prototype.readIntBE=w(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=b,e=1,f=this[a+--d];for(;d>0&&(e*=256);)f+=this[a+--d]*e;return f>=(e*=128)&&(f-=Math.pow(2,8*b)),f},"readIntBE"),g.prototype.readInt8=w(function(a,b){return a>>>=0,b||N(a,1,this.length),128&this[a]?-((255-this[a]+1)*1):this[a]},"readInt8"),g.prototype.readInt16LE=w(function(a,b){a>>>=0,b||N(a,2,this.length);let c=this[a]|this[a+1]<<8;return 32768&c?0xffff0000|c:c},"readInt16LE"),g.prototype.readInt16BE=w(function(a,b){a>>>=0,b||N(a,2,this.length);let c=this[a+1]|this[a]<<8;return 32768&c?0xffff0000|c:c},"readInt16BE"),g.prototype.readInt32LE=w(function(a,b){return a>>>=0,b||N(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},"readInt32LE"),g.prototype.readInt32BE=w(function(a,b){return a>>>=0,b||N(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},"readInt32BE"),g.prototype.readBigInt64LE=aj(w(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&$(a,this.length-8),(BigInt(this[a+4]+256*this[a+5]+65536*this[a+6]+(c<<24))<<BigInt(32))+BigInt(b+256*this[++a]+65536*this[++a]+0x1000000*this[++a])},"readBigInt64LE")),g.prototype.readBigInt64BE=aj(w(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&$(a,this.length-8),(BigInt((b<<24)+65536*this[++a]+256*this[++a]+this[++a])<<BigInt(32))+BigInt(0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c)},"readBigInt64BE")),g.prototype.readFloatLE=w(function(a,b){return a>>>=0,b||N(a,4,this.length),c.read(this,a,!0,23,4)},"readFloatLE"),g.prototype.readFloatBE=w(function(a,b){return a>>>=0,b||N(a,4,this.length),c.read(this,a,!1,23,4)},"readFloatBE"),g.prototype.readDoubleLE=w(function(a,b){return a>>>=0,b||N(a,8,this.length),c.read(this,a,!0,52,8)},"readDoubleLE"),g.prototype.readDoubleBE=w(function(a,b){return a>>>=0,b||N(a,8,this.length),c.read(this,a,!1,52,8)},"readDoubleBE"),w(O,"checkInt"),g.prototype.writeUintLE=g.prototype.writeUIntLE=w(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;O(this,a,b,c,d,0)}let e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},"writeUIntLE"),g.prototype.writeUintBE=g.prototype.writeUIntBE=w(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;O(this,a,b,c,d,0)}let e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},"writeUIntBE"),g.prototype.writeUint8=g.prototype.writeUInt8=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,1,255,0),this[b]=255&a,b+1},"writeUInt8"),g.prototype.writeUint16LE=g.prototype.writeUInt16LE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeUInt16LE"),g.prototype.writeUint16BE=g.prototype.writeUInt16BE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeUInt16BE"),g.prototype.writeUint32LE=g.prototype.writeUInt32LE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0xffffffff,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},"writeUInt32LE"),g.prototype.writeUint32BE=g.prototype.writeUInt32BE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0xffffffff,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeUInt32BE"),w(P,"wrtBigUInt64LE"),w(Q,"wrtBigUInt64BE"),g.prototype.writeBigUInt64LE=aj(w(function(a,b=0){return P(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),g.prototype.writeBigUInt64BE=aj(w(function(a,b=0){return Q(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),g.prototype.writeIntLE=w(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);O(this,a,b,c,d-1,-d)}let e=0,f=1,g=0;for(this[b]=255&a;++e<c&&(f*=256);)a<0&&0===g&&0!==this[b+e-1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntLE"),g.prototype.writeIntBE=w(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);O(this,a,b,c,d-1,-d)}let e=c-1,f=1,g=0;for(this[b+e]=255&a;--e>=0&&(f*=256);)a<0&&0===g&&0!==this[b+e+1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntBE"),g.prototype.writeInt8=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},"writeInt8"),g.prototype.writeInt16LE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeInt16LE"),g.prototype.writeInt16BE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeInt16BE"),g.prototype.writeInt32LE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0x7fffffff,-0x80000000),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},"writeInt32LE"),g.prototype.writeInt32BE=w(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0x7fffffff,-0x80000000),a<0&&(a=0xffffffff+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeInt32BE"),g.prototype.writeBigInt64LE=aj(w(function(a,b=0){return P(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),g.prototype.writeBigInt64BE=aj(w(function(a,b=0){return Q(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE")),w(R,"checkIEEE754"),w(S,"writeFloat"),g.prototype.writeFloatLE=w(function(a,b,c){return S(this,a,b,!0,c)},"writeFloatLE"),g.prototype.writeFloatBE=w(function(a,b,c){return S(this,a,b,!1,c)},"writeFloatBE"),w(T,"writeDouble"),g.prototype.writeDoubleLE=w(function(a,b,c){return T(this,a,b,!0,c)},"writeDoubleLE"),g.prototype.writeDoubleBE=w(function(a,b,c){return T(this,a,b,!1,c)},"writeDoubleBE"),g.prototype.copy=w(function(a,b,c,d){if(!g.isBuffer(a))throw TypeError("argument should be a Buffer");if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c||0===a.length||0===this.length)return 0;if(b<0)throw RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw RangeError("Index out of range");if(d<0)throw RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);let e=d-c;return this===a&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(b,c,d):Uint8Array.prototype.set.call(a,this.subarray(c,d),b),e},"copy"),g.prototype.fill=w(function(a,b,c,d){let e;if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),void 0!==d&&"string"!=typeof d)throw TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw TypeError("Unknown encoding: "+d);if(1===a.length){let b=a.charCodeAt(0);("utf8"===d&&b<128||"latin1"===d)&&(a=b)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(b<0||this.length<b||this.length<c)throw RangeError("Out of range index");if(c<=b)return this;if(b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0),"number"==typeof a)for(e=b;e<c;++e)this[e]=a;else{let f=g.isBuffer(a)?a:g.from(a,d),h=f.length;if(0===h)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(e=0;e<c-b;++e)this[e+b]=f[e%h]}return this},"fill");var U={};function V(a,b,c){var d;U[a]=(w(d=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,this.stack,delete this.name}get code(){return a}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}},"NodeError"),d)}function W(a){let b="",c=a.length,d=+("-"===a[0]);for(;c>=d+4;c-=3)b=`_${a.slice(c-3,c)}${b}`;return`${a.slice(0,c)}${b}`}function X(a,b,c){Z(b,"offset"),(void 0===a[b]||void 0===a[b+c])&&$(b,a.length-(c+1))}function Y(a,b,c,d,e,f){if(a>c||a<b){let d="bigint"==typeof b?"n":"",e;throw e=f>3?0===b||b===BigInt(0)?`>= 0${d} and < 2${d} ** ${(f+1)*8}${d}`:`>= -(2${d} ** ${(f+1)*8-1}${d}) and \
< 2 ** ${(f+1)*8-1}${d}`:`>= ${b}${d} and <= ${c}${d}`,new U.ERR_OUT_OF_RANGE("value",e,a)}X(d,e,f)}function Z(a,b){if("number"!=typeof a)throw new U.ERR_INVALID_ARG_TYPE(b,"number",a)}function $(a,b,c){throw Math.floor(a)!==a?(Z(a,c),new U.ERR_OUT_OF_RANGE(c||"offset","an integer",a)):b<0?new U.ERR_BUFFER_OUT_OF_BOUNDS:new U.ERR_OUT_OF_RANGE(c||"offset",`>= ${+!!c} and <= ${b}`,a)}w(V,"E"),V("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(a,b){return`The "${a}" argum\
ent must be of type number. Received type ${typeof b}`},TypeError),V("ERR_OUT_OF_RANGE",function(a,b,c){let d=`The value of "${a}" is out of range.`,e=c;return Number.isInteger(c)&&Math.abs(c)>0x100000000?e=W(String(c)):"bigint"==typeof c&&(e=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(e=W(e)),e+="n"),d+=` It\
 must be ${b}. Received ${e}`},RangeError),w(W,"addNumericalSeparator"),w(X,"checkBounds"),w(Y,"checkIntBI"),w(Z,"validateNumber"),w($,"boundsError");var _=/[^+/0-9A-Za-z-_]/g;function aa(a){if((a=(a=a.split("=")[0]).trim().replace(_,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}function ab(a,b){b=b||1/0;let c,d=a.length,e=null,f=[];for(let g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319||g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else if(c<1114112){if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}else throw Error("Invalid code point")}return f}function ac(a){let b=[];for(let c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function ad(a,b){let c,d,e=[];for(let f=0;f<a.length&&!((b-=2)<0);++f)d=(c=a.charCodeAt(f))>>8,e.push(c%256),e.push(d);return e}function ae(a){return b.toByteArray(aa(a))}function af(a,b,c,d){let e;for(e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function ag(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function ah(a){return a!=a}w(aa,"base64clean"),w(ab,"utf8ToBytes"),w(ac,"asciiToBytes"),w(ad,"utf16leToBytes"),w(ae,"base64ToBytes"),w(af,"blitBuffer"),w(ag,"isInstance"),w(ah,"numberIsNaN");var ai=function(){let a="0123456789abcdef",b=Array(256);for(let c=0;c<16;++c){let d=16*c;for(let e=0;e<16;++e)b[d+e]=a[c]+a[e]}return b}();function aj(a){return typeof BigInt>"u"?ak:a}function ak(){throw Error("BigInt not supported")}w(aj,"defineBigIntMethod"),w(ak,"BufferBigIntNotDefined")}),H=x(()=>{l=globalThis,m=globalThis.setImmediate??(a=>setTimeout(a,0)),globalThis.clearImmediate??(a=>clearTimeout(a)),(n=globalThis.crypto??{}).subtle??(n.subtle={}),o="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:G().Buffer,(p=globalThis.process??{}).env??(p.env={});try{p.nextTick(()=>{})}catch{let a=Promise.resolve();p.nextTick=a.then.bind(a)}}),I=y((a,b)=>{H();var c,d="object"==typeof Reflect?Reflect:null,e=d&&"function"==typeof d.apply?d.apply:w(function(a,b,c){return Function.prototype.apply.call(a,b,c)},"ReflectApply");function f(a){console&&console.warn&&console.warn(a)}c=d&&"function"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?w(function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))},"ReflectOwnKeys"):w(function(a){return Object.getOwnPropertyNames(a)},"ReflectOwnKeys"),w(f,"ProcessEmitWarning");var g=Number.isNaN||w(function(a){return a!=a},"NumberIsNaN");function h(){h.init.call(this)}w(h,"EventEmitter"),b.exports=h,b.exports.once=t,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var i=10;function j(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function k(a){return void 0===a._maxListeners?h.defaultMaxListeners:a._maxListeners}function l(a,b,c,d){var e,g,h;if(j(c),void 0===(g=a._events)?(g=a._events=Object.create(null),a._eventsCount=0):(void 0!==g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]),void 0===h)h=g[b]=c,++a._eventsCount;else if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),(e=k(a))>0&&h.length>e&&!h.warned){h.warned=!0;var i=Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");i.name="MaxListenersExceededWarning",i.emitter=a,i.type=b,i.count=h.length,f(i)}return a}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function n(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=m.bind(d);return e.listener=c,d.wrapFn=e,e}function o(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?s(e):q(e,e.length)}function p(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function q(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function r(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}function s(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function t(a,b){return new Promise(function(c,d){function e(c){a.removeListener(b,f),d(c)}function f(){"function"==typeof a.removeListener&&a.removeListener("error",e),c([].slice.call(arguments))}w(e,"errorListener"),w(f,"resolver"),v(a,b,f,{once:!0}),"error"!==b&&u(a,e,{once:!0})})}function u(a,b,c){"function"==typeof a.on&&v(a,"error",b,c)}function v(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,w(function e(f){d.once&&a.removeEventListener(b,e),c(f)},"wrapListener"));else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}w(j,"checkListener"),Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:w(function(){return i},"get"),set:w(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");i=a},"set")}),h.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=w(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},"setMaxListeners"),w(k,"_getMaxListeners"),h.prototype.getMaxListeners=w(function(){return k(this)},"getMaxListeners"),h.prototype.emit=w(function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var d="error"===a,f=this._events;if(void 0!==f)d=d&&void 0===f.error;else if(!d)return!1;if(d){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)e(i,this,b);else for(var j=i.length,k=q(i,j),c=0;c<j;++c)e(k[c],this,b);return!0},"emit"),w(l,"_addListener"),h.prototype.addListener=w(function(a,b){return l(this,a,b,!1)},"addListener"),h.prototype.on=h.prototype.addListener,h.prototype.prependListener=w(function(a,b){return l(this,a,b,!0)},"prependListener"),w(m,"onceWrapper"),w(n,"_onceWrap"),h.prototype.once=w(function(a,b){return j(b),this.on(a,n(this,a,b)),this},"once"),h.prototype.prependOnceListener=w(function(a,b){return j(b),this.prependListener(a,n(this,a,b)),this},"prependOnceListener"),h.prototype.removeListener=w(function(a,b){var c,d,e,f,g;if(j(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():r(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,g||b)}return this},"removeListener"),h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=w(function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},"removeAllListeners"),w(o,"_listeners"),h.prototype.listeners=w(function(a){return o(this,a,!0)},"listeners"),h.prototype.rawListeners=w(function(a){return o(this,a,!1)},"rawListeners"),h.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):p.call(a,b)},h.prototype.listenerCount=p,w(p,"listenerCount"),h.prototype.eventNames=w(function(){return this._eventsCount>0?c(this._events):[]},"eventNames"),w(q,"arrayClone"),w(r,"spliceOne"),w(s,"unwrapListeners"),w(t,"once"),w(u,"addErrorHandlerIfEventEmitter"),w(v,"eventTargetAgnosticAddListener")}),J={};z(J,{default:()=>K});var K,L=x(()=>{H(),K={}});function M(a){let b=0x6a09e667,c=0xbb67ae85,d=0x3c6ef372,e=0xa54ff53a,f=0x510e527f,g=0x9b05688c,h=0x1f83d9ab,i=0x5be0cd19,j=0,k=0,l=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],m=w((a,b)=>a>>>b|a<<32-b,"rrot"),n=new Uint32Array(64),o=new Uint8Array(64),p=w(()=>{for(let a=0,b=0;a<16;a++,b+=4)n[a]=o[b]<<24|o[b+1]<<16|o[b+2]<<8|o[b+3];for(let a=16;a<64;a++){let b=m(n[a-15],7)^m(n[a-15],18)^n[a-15]>>>3,c=m(n[a-2],17)^m(n[a-2],19)^n[a-2]>>>10;n[a]=n[a-16]+b+n[a-7]+c|0}let a=b,j=c,p=d,q=e,r=f,s=g,t=h,u=i;for(let b=0;b<64;b++){let c=u+(m(r,6)^m(r,11)^m(r,25))+(r&s^~r&t)+l[b]+n[b]|0,d=(m(a,2)^m(a,13)^m(a,22))+(a&j^a&p^j&p)|0;u=t,t=s,s=r,r=q+c|0,q=p,p=j,j=a,a=c+d|0}b=b+a|0,c=c+j|0,d=d+p|0,e=e+q|0,f=f+r|0,g=g+s|0,h=h+t|0,i=i+u|0,k=0},"process"),q=w(a=>{"string"==typeof a&&(a=new TextEncoder().encode(a));for(let b=0;b<a.length;b++)o[k++]=a[b],64===k&&p();j+=a.length},"add"),r=w(()=>{if(o[k++]=128,64==k&&p(),k+8>64){for(;k<64;)o[k++]=0;p()}for(;k<58;)o[k++]=0;let a=8*j;o[k++]=a/0x10000000000&255,o[k++]=a/0x100000000&255,o[k++]=a>>>24,o[k++]=a>>>16&255,o[k++]=a>>>8&255,o[k++]=255&a,p();let l=new Uint8Array(32);return l[0]=b>>>24,l[1]=b>>>16&255,l[2]=b>>>8&255,l[3]=255&b,l[4]=c>>>24,l[5]=c>>>16&255,l[6]=c>>>8&255,l[7]=255&c,l[8]=d>>>24,l[9]=d>>>16&255,l[10]=d>>>8&255,l[11]=255&d,l[12]=e>>>24,l[13]=e>>>16&255,l[14]=e>>>8&255,l[15]=255&e,l[16]=f>>>24,l[17]=f>>>16&255,l[18]=f>>>8&255,l[19]=255&f,l[20]=g>>>24,l[21]=g>>>16&255,l[22]=g>>>8&255,l[23]=255&g,l[24]=h>>>24,l[25]=h>>>16&255,l[26]=h>>>8&255,l[27]=255&h,l[28]=i>>>24,l[29]=i>>>16&255,l[30]=i>>>8&255,l[31]=255&i,l},"digest");return void 0===a?{add:q,digest:r}:(q(a),r())}var N,O,P=x(()=>{H(),w(M,"sha256")}),Q=x(()=>{H(),w(N=class a{constructor(){D(this,"_dataLength",0),D(this,"_bufferLength",0),D(this,"_state",new Int32Array(4)),D(this,"_buffer",new ArrayBuffer(68)),D(this,"_buffer8"),D(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(a,b=!1){return this.onePassHasher.start().appendByteArray(a).end(b)}static hashStr(a,b=!1){return this.onePassHasher.start().appendStr(a).end(b)}static hashAsciiStr(a,b=!1){return this.onePassHasher.start().appendAsciiStr(a).end(b)}static _hex(b){let c=a.hexChars,d=a.hexOut,e,f,g,h;for(h=0;h<4;h+=1)for(f=8*h,e=b[h],g=0;g<8;g+=2)d[f+1+g]=c.charAt(15&e),e>>>=4,d[f+0+g]=c.charAt(15&e),e>>>=4;return d.join("")}static _md5cycle(a,b){let c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-0x28955b88|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[1]-0x173848aa|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[2]+0x242070db|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[3]-0x3e423112|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[4]-0xa83f051|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[5]+0x4787c62a|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[6]-0x57cfb9ed|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[7]-0x2b96aff|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[8]+0x698098d8|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[9]-0x74bb0851|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[10]-42063|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[11]-0x76a32842|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[12]+0x6b901122|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[13]-0x2678e6d|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[14]-0x5986bc72|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[15]+0x49b40821|0,c+=((d=(d<<22|d>>>10)+e|0)&f|e&~f)+b[1]-0x9e1da9e|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[6]-0x3fbf4cc0|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[11]+0x265e5a51|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[0]-0x16493856|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[5]-0x29d0efa3|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[10]+0x2441453|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[15]-0x275e197f|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[4]-0x182c0438|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[9]+0x21e1cde6|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[14]-0x3cc8f82a|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[3]-0xb2af279|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[8]+0x455a14ed|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[13]-0x561c16fb|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[2]-0x3105c08|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[7]+0x676f02d9|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[12]-0x72d5b376|0,c+=((d=(d<<20|d>>>12)+e|0)^e^f)+b[5]-378558|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[8]-0x788e097f|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[11]+0x6d9d6122|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[14]-0x21ac7f4|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[1]-0x5b4115bc|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[4]+0x4bdecfa9|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[7]-0x944b4a0|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[10]-0x41404390|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[13]+0x289b7ec6|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[0]-0x155ed806|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[3]-0x2b10cf7b|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[6]+0x4881d05|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[9]-0x262b2fc7|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[12]-0x1924661b|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[15]+0x1fa27cf8|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[2]-0x3b53a99b|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-0xbd6ddbc|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+0x432aff97|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-0x546bdc59|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-0x36c5fc7|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+0x655b59c3|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-0x70f3336e|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-0x7a7ba22f|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+0x6fa87e4f|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-0x1d31920|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-0x5cfebcec|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+0x4e0811a1|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-0x8ac817e|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-0x42c50dcb|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+0x2ad7d2bb|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-0x14792c6f|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(a.stateIdentity),this}appendStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g;for(g=0;g<b.length;g+=1){if((f=b.charCodeAt(g))<128)c[e++]=f;else if(f<2048)c[e++]=(f>>>6)+192,c[e++]=63&f|128;else if(f<55296||f>56319)c[e++]=(f>>>12)+224,c[e++]=f>>>6&63|128,c[e++]=63&f|128;else{if((f=(f-55296)*1024+(b.charCodeAt(++g)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");c[e++]=(f>>>18)+240,c[e++]=f>>>12&63|128,c[e++]=f>>>6&63|128,c[e++]=63&f|128}e>=64&&(this._dataLength+=64,a._md5cycle(this._state,d),e-=64,d[0]=d[16])}return this._bufferLength=e,this}appendAsciiStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b.charCodeAt(g++);if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}appendByteArray(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b[g++];if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}getState(){let a=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[a[0],a[1],a[2],a[3]]}}setState(a){let b=a.buffer,c=a.state,d=this._state,e;for(this._dataLength=a.length,this._bufferLength=a.buflen,d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],e=0;e<b.length;e+=1)this._buffer8[e]=b.charCodeAt(e)}end(b=!1){let c=this._bufferLength,d=this._buffer8,e=this._buffer32,f=(c>>2)+1;this._dataLength+=c;let g=8*this._dataLength;if(d[c]=128,d[c+1]=d[c+2]=d[c+3]=0,e.set(a.buffer32Identity.subarray(f),f),c>55&&(a._md5cycle(this._state,e),e.set(a.buffer32Identity)),g<=0xffffffff)e[14]=g;else{let a=g.toString(16).match(/(.*?)(.{0,8})$/);if(null===a)return;let b=parseInt(a[2],16),c=parseInt(a[1],16)||0;e[14]=b,e[15]=c}return a._md5cycle(this._state,e),b?this._state:a._hex(this._state)}},"Md5"),D(N,"stateIdentity",new Int32Array([0x67452301,-0x10325477,-0x67452302,0x10325476])),D(N,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),D(N,"hexChars","0123456789abcdef"),D(N,"hexOut",[]),D(N,"onePassHasher",new N),O=N}),R={};function S(a){return n.getRandomValues(o.alloc(a))}function T(a){if("sha256"===a)return{update:w(function(a){return{digest:w(function(){return o.from(M(a))},"digest")}},"update")};if("md5"===a)return{update:w(function(a){return{digest:w(function(){return"string"==typeof a?O.hashStr(a):O.hashByteArray(a)},"digest")}},"update")};throw Error(`Hash type '${a}' not supported`)}function U(a,b){if("sha256"!==a)throw Error(`Only sha256 is supported (requested: '${a}')`);return{update:w(function(a){return{digest:w(function(){"string"==typeof b&&(b=new TextEncoder().encode(b)),"string"==typeof a&&(a=new TextEncoder().encode(a));let c=b.length;if(c>64)b=M(b);else if(c<64){let a=new Uint8Array(64);a.set(b),b=a}let d=new Uint8Array(64),e=new Uint8Array(64);for(let a=0;a<64;a++)d[a]=54^b[a],e[a]=92^b[a];let f=new Uint8Array(a.length+64);f.set(d,0),f.set(a,64);let g=new Uint8Array(96);return g.set(e,0),g.set(M(f),64),o.from(M(g))},"digest")}},"update")}}z(R,{createHash:()=>T,createHmac:()=>U,randomBytes:()=>S});var V=x(()=>{H(),P(),Q(),w(S,"randomBytes"),w(T,"createHash"),w(U,"createHmac")}),W=y(a=>{H(),a.parse=function(a,b){return new c(a,b).parse()};var b=class a{constructor(a,b){this.source=a,this.transform=b||d,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var a=this.source[this.position++];return"\\"===a?{value:this.source[this.position++],escaped:!0}:{value:a,escaped:!1}}record(a){this.recorded.push(a)}newEntry(a){var b;(this.recorded.length>0||a)&&("NULL"!==(b=this.recorded.join(""))||a||(b=null),null!==b&&(b=this.transform(b)),this.entries.push(b),this.recorded=[])}consumeDimensions(){if("["===this.source[0])for(;!this.isEof()&&"="!==this.nextCharacter().value;);}parse(b){var c,d,e;for(this.consumeDimensions();!this.isEof();)if("{"!==(c=this.nextCharacter()).value||e){if("}"!==c.value||e)'"'!==c.value||c.escaped?","!==c.value||e?this.record(c.value):this.newEntry():(e&&this.newEntry(!0),e=!e);else if(this.dimension--,!this.dimension&&(this.newEntry(),b))return this.entries}else this.dimension++,this.dimension>1&&(d=new a(this.source.substr(this.position-1),this.transform),this.entries.push(d.parse(!0)),this.position+=d.position-2);if(0!==this.dimension)throw Error("array dimension not balanced");return this.entries}};w(b,"ArrayParser");var c=b;function d(a){return a}w(d,"identity")}),X=y((a,b)=>{H();var c=W();b.exports={create:w(function(a,b){return{parse:w(function(){return c.parse(a,b)},"parse")}},"create")}}),Y=y((a,b)=>{H();var c=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,d=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,e=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,f=/^-?infinity$/;function g(a){var b=d.exec(a);if(b){var c=parseInt(b[1],10);b[4]&&(c=i(c));var e=new Date(c,parseInt(b[2],10)-1,b[3]);return j(c)&&e.setFullYear(c),e}}function h(a){if(a.endsWith("+00"))return 0;var b=e.exec(a.split(" ")[1]);if(b){var c=b[1];return"Z"===c?0:(3600*parseInt(b[2],10)+60*parseInt(b[3]||0,10)+parseInt(b[4]||0,10))*("-"===c?-1:1)*1e3}}function i(a){return-(a-1)}function j(a){return a>=0&&a<100}b.exports=w(function(a){if(f.test(a))return Number(a.replace("i","I"));var b=c.exec(a);if(!b)return g(a)||null;var d=!!b[8],e=parseInt(b[1],10);d&&(e=i(e));var k=parseInt(b[2],10)-1,l=b[3],m=parseInt(b[4],10),n=parseInt(b[5],10),o=parseInt(b[6],10),p=b[7];p=p?1e3*parseFloat(p):0;var q,r=h(a);return null!=r?(q=new Date(Date.UTC(e,k,l,m,n,o,p)),j(e)&&q.setUTCFullYear(e),0!==r&&q.setTime(q.getTime()-r)):(q=new Date(e,k,l,m,n,o,p),j(e)&&q.setFullYear(e)),q},"parseDate"),w(g,"getDate"),w(h,"timeZoneOffset"),w(i,"bcYearToNegativeYear"),w(j,"is0To99")}),Z=y((a,b)=>{H(),b.exports=d;var c=Object.prototype.hasOwnProperty;function d(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)c.call(d,e)&&(a[e]=d[e])}return a}w(d,"extend")}),$=y((a,b)=>{H();var c=Z();function d(a){if(!(this instanceof d))return new d(a);c(this,n(a))}b.exports=d,w(d,"PostgresInterval");var e=["seconds","minutes","hours","days","months","years"];d.prototype.toPostgres=function(){var a=e.filter(this.hasOwnProperty,this);return this.milliseconds&&0>a.indexOf("seconds")&&a.push("seconds"),0===a.length?"0":a.map(function(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),b+" "+a},this).join(" ")};var f={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},g=["years","months","days"],h=["hours","minutes","seconds"];d.prototype.toISOString=d.prototype.toISO=function(){return"P"+g.map(a,this).join("")+"T"+h.map(a,this).join("");function a(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),b+f[a]}};var i="([+-]?\\d+)",j=new RegExp([i+"\\s+years?",i+"\\s+mons?",i+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map(function(a){return"("+a+")?"}).join("\\s*")),k={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},l=["hours","minutes","seconds","milliseconds"];function m(a){return parseInt(a+"000000".slice(a.length),10)/1e3}function n(a){if(!a)return{};var b=j.exec(a),c="-"===b[8];return Object.keys(k).reduce(function(a,d){var e=b[k[d]];return e&&(e="milliseconds"===d?m(e):parseInt(e,10))&&(c&&~l.indexOf(d)&&(e*=-1),a[d]=e),a},{})}w(m,"parseMilliseconds"),w(n,"parse")}),_=y((a,b)=>{H(),b.exports=w(function(a){if(/^\\x/.test(a))return new o(a.substr(2),"hex");for(var b="",c=0;c<a.length;)if("\\"!==a[c])b+=a[c],++c;else if(/[0-7]{3}/.test(a.substr(c+1,3)))b+=String.fromCharCode(parseInt(a.substr(c+1,3),8)),c+=4;else{for(var d=1;c+d<a.length&&"\\"===a[c+d];)d++;for(var e=0;e<Math.floor(d/2);++e)b+="\\";c+=2*Math.floor(d/2)}return new o(b,"binary")},"parseBytea")}),aa=y((a,b)=>{H();var c=W(),d=X(),e=Y(),f=$(),g=_();function h(a){return w(function(b){return null===b?b:a(b)},"nullAllowed")}function i(a){return null===a?a:"TRUE"===a||"t"===a||"true"===a||"y"===a||"yes"===a||"on"===a||"1"===a}function j(a){return a?c.parse(a,i):null}function k(a){return parseInt(a,10)}function l(a){return a?c.parse(a,h(k)):null}function m(a){return a?c.parse(a,h(function(a){return u(a).trim()})):null}w(h,"allowNull"),w(i,"parseBool"),w(j,"parseBoolArray"),w(k,"parseBaseTenInt"),w(l,"parseIntegerArray"),w(m,"parseBigIntegerArray");var n=w(function(a){return a?d.create(a,function(a){return null!==a&&(a=x(a)),a}).parse():null},"parsePointArray"),o=w(function(a){return a?d.create(a,function(a){return null!==a&&(a=parseFloat(a)),a}).parse():null},"parseFloatArray"),p=w(function(a){return a?d.create(a).parse():null},"parseStringArray"),q=w(function(a){return a?d.create(a,function(a){return null!==a&&(a=e(a)),a}).parse():null},"parseDateArray"),r=w(function(a){return a?d.create(a,function(a){return null!==a&&(a=f(a)),a}).parse():null},"parseIntervalArray"),s=w(function(a){return a?c.parse(a,h(g)):null},"parseByteAArray"),t=w(function(a){return parseInt(a,10)},"parseInteger"),u=w(function(a){var b=String(a);return/^\d+$/.test(b)?b:a},"parseBigInteger"),v=w(function(a){return a?c.parse(a,h(JSON.parse)):null},"parseJsonArray"),x=w(function(a){return"("!==a[0]?null:{x:parseFloat((a=a.substring(1,a.length-1).split(","))[0]),y:parseFloat(a[1])}},"parsePoint"),y=w(function(a){if("<"!==a[0]&&"("!==a[1])return null;for(var b="(",c="",d=!1,e=2;e<a.length-1;e++){if(d||(b+=a[e]),")"===a[e]){d=!0;continue}d&&","!==a[e]&&(c+=a[e])}var f=x(b);return f.radius=parseFloat(c),f},"parseCircle");b.exports={init:w(function(a){a(20,u),a(21,t),a(23,t),a(26,t),a(700,parseFloat),a(701,parseFloat),a(16,i),a(1082,e),a(1114,e),a(1184,e),a(600,x),a(651,p),a(718,y),a(1e3,j),a(1001,s),a(1005,l),a(1007,l),a(1028,l),a(1016,m),a(1017,n),a(1021,o),a(1022,o),a(1231,o),a(1014,p),a(1015,p),a(1008,p),a(1009,p),a(1040,p),a(1041,p),a(1115,q),a(1182,q),a(1185,q),a(1186,f),a(1187,r),a(17,g),a(114,JSON.parse.bind(JSON)),a(3802,JSON.parse.bind(JSON)),a(199,v),a(3807,v),a(3907,p),a(2951,p),a(791,p),a(1183,p),a(1270,p)},"init")}}),ab=y((a,b)=>{function c(a){var b=a.readInt32BE(0),c=a.readUInt32BE(4),d="";b<0&&(b=~b+(0===c),c=~c+1>>>0,d="-");var e,f,g,h,i,j,k="";if(e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";return k=h+g+k,d+(g=""+(f=0x100000000*(e=b%1e6)+c)%1e6)+k}H(),w(c,"readInt8"),b.exports=c}),ac=y((a,b)=>{H();var c=ab(),d=w(function(a,b,c,d,e){c=c||0,d=d||!1,e=e||function(a,b,c){return a*Math.pow(2,c)+b};var f=c>>3,g=w(function(a){return d?255&~a:a},"inv"),h=255,i=8-c%8;b<i&&(h=255<<8-b&255,i=b),c&&(h>>=c%8);var j=0;c%8+b>=8&&(j=e(0,g(a[f])&h,i));for(var k=b+c>>3,l=f+1;l<k;l++)j=e(j,g(a[l]),8);var m=(b+c)%8;return m>0&&(j=e(j,g(a[k])>>8-m,m)),j},"parseBits"),e=w(function(a,b,c){var e=Math.pow(2,c-1)-1,f=d(a,1),g=d(a,c,1);if(0===g)return 0;var h=1,i=d(a,b,c+1,!1,w(function(a,b,c){0===a&&(a=1);for(var d=1;d<=c;d++)h/=2,(b&1<<c-d)>0&&(a+=h);return a},"parsePrecisionBits"));return g==Math.pow(2,c+1)-1?0===i?0===f?1/0:-1/0:NaN:(0===f?1:-1)*Math.pow(2,g-e)*i},"parseFloatFromBits"),f=w(function(a){return 1==d(a,1)?-1*(d(a,15,1,!0)+1):d(a,15,1)},"parseInt16"),g=w(function(a){return 1==d(a,1)?-1*(d(a,31,1,!0)+1):d(a,31,1)},"parseInt32"),h=w(function(a){return e(a,23,8)},"parseFloat32"),i=w(function(a){return e(a,52,11)},"parseFloat64"),j=w(function(a){var b=d(a,16,32);if(49152==b)return NaN;for(var c=Math.pow(1e4,d(a,16,16)),e=0,f=d(a,16),g=0;g<f;g++)e+=d(a,16,64+16*g)*c,c/=1e4;var h=Math.pow(10,d(a,16,48));return(0===b?1:-1)*Math.round(e*h)/h},"parseNumeric"),k=w(function(a,b){var c=d(b,1),e=d(b,63,1),f=new Date((0===c?1:-1)*e/1e3+9466848e5);return a||f.setTime(f.getTime()+6e4*f.getTimezoneOffset()),f.usec=e%1e3,f.getMicroSeconds=function(){return this.usec},f.setMicroSeconds=function(a){this.usec=a},f.getUTCMicroSeconds=function(){return this.usec},f},"parseDate"),l=w(function(a){for(var b=d(a,32),c=(d(a,32,32),d(a,32,64)),e=96,f=[],g=0;g<b;g++)f[g]=d(a,32,e),e+=64;var h=w(function(b){var c,f=d(a,32,e);return(e+=32,0xffffffff==f)?null:23==b||20==b?(c=d(a,8*f,e),e+=8*f,c):25==b?a.toString(this.encoding,e>>3,(e+=f<<3)>>3):void console.log("ERROR: ElementType not implemented: "+b)},"parseElement"),i=w(function(a,b){var c,d=[];if(a.length>1){var e=a.shift();for(c=0;c<e;c++)d[c]=i(a,b);a.unshift(e)}else for(c=0;c<a[0];c++)d[c]=h(b);return d},"parse");return i(f,c)},"parseArray"),m=w(function(a){return a.toString("utf8")},"parseText"),n=w(function(a){return null===a?null:d(a,8)>0},"parseBool");b.exports={init:w(function(a){a(20,c),a(21,f),a(23,g),a(26,g),a(1700,j),a(700,h),a(701,i),a(16,n),a(1114,k.bind(null,!1)),a(1184,k.bind(null,!0)),a(1e3,l),a(1007,l),a(1016,l),a(1008,l),a(1009,l),a(25,m)},"init")}}),ad=y((a,b)=>{H(),b.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),ae=y(a=>{H();var b=aa(),c=ac(),d=X(),e=ad();a.getTypeParser=h,a.setTypeParser=i,a.arrayParser=d,a.builtins=e;var f={text:{},binary:{}};function g(a){return String(a)}function h(a,b){return f[b=b||"text"]&&f[b][a]||g}function i(a,b,c){"function"==typeof b&&(c=b,b="text"),f[b][a]=c}w(g,"noParse"),w(h,"getTypeParser"),w(i,"setTypeParser"),b.init(function(a,b){f.text[a]=b}),c.init(function(a,b){f.binary[a]=b})}),af=y((a,b)=>{H(),b.exports={host:"localhost",user:"win32"===p.platform?p.env.USERNAME:p.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var c=ae(),d=c.getTypeParser(20,"text"),e=c.getTypeParser(1016,"text");b.exports.__defineSetter__("parseInt8",function(a){c.setTypeParser(20,"text",a?c.getTypeParser(23,"text"):d),c.setTypeParser(1016,"text",a?c.getTypeParser(1007,"text"):e)})}),ag=y((a,b)=>{H();var c=(V(),C(R)),d=af();function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function f(a){for(var b="{",c=0;c<a.length;c++)c>0&&(b+=","),null===a[c]||typeof a[c]>"u"?b+="NULL":Array.isArray(a[c])?b+=f(a[c]):a[c]instanceof o?b+="\\\\x"+a[c].toString("hex"):b+=e(g(a[c]));return b+"}"}w(e,"escapeElement"),w(f,"arrayString");var g=w(function(a,b){if(null==a)return null;if(a instanceof o)return a;if(ArrayBuffer.isView(a)){var c=o.from(a.buffer,a.byteOffset,a.byteLength);return c.length===a.byteLength?c:c.slice(a.byteOffset,a.byteOffset+a.byteLength)}return a instanceof Date?d.parseInputDatesAsUTC?k(a):j(a):Array.isArray(a)?f(a):"object"==typeof a?h(a,b):a.toString()},"prepareValue");function h(a,b){if(a&&"function"==typeof a.toPostgres){if(-1!==(b=b||[]).indexOf(a))throw Error('circular reference detected while preparing "'+a+'" for query');return b.push(a),g(a.toPostgres(g),b)}return JSON.stringify(a)}function i(a,b){for(a=""+a;a.length<b;)a="0"+a;return a}function j(a){var b=-a.getTimezoneOffset(),c=a.getFullYear(),d=c<1;d&&(c=Math.abs(c)+1);var e=i(c,4)+"-"+i(a.getMonth()+1,2)+"-"+i(a.getDate(),2)+"T"+i(a.getHours(),2)+":"+i(a.getMinutes(),2)+":"+i(a.getSeconds(),2)+"."+i(a.getMilliseconds(),3);return b<0?(e+="-",b*=-1):e+="+",e+=i(Math.floor(b/60),2)+":"+i(b%60,2),d&&(e+=" BC"),e}function k(a){var b=a.getUTCFullYear(),c=b<1;c&&(b=Math.abs(b)+1);var d=i(b,4)+"-"+i(a.getUTCMonth()+1,2)+"-"+i(a.getUTCDate(),2)+"T"+i(a.getUTCHours(),2)+":"+i(a.getUTCMinutes(),2)+":"+i(a.getUTCSeconds(),2)+"."+i(a.getUTCMilliseconds(),3);return d+="+00:00",c&&(d+=" BC"),d}function l(a,b,c){return a="string"==typeof a?{text:a}:a,b&&("function"==typeof b?a.callback=b:a.values=b),c&&(a.callback=c),a}w(h,"prepareObject"),w(i,"pad"),w(j,"dateToString"),w(k,"dateToStringUTC"),w(l,"normalizeQueryConfig");var m=w(function(a){return c.createHash("md5").update(a,"utf-8").digest("hex")},"md5"),n=w(function(a,b,c){var d=m(b+a);return"md5"+m(o.concat([o.from(d),c]))},"postgresMd5PasswordHash");b.exports={prepareValue:w(function(a){return g(a)},"prepareValueWrapper"),normalizeQueryConfig:l,postgresMd5PasswordHash:n,md5:m}}),ah=y((a,b)=>{H();var c=(V(),C(R));function d(a){if(-1===a.indexOf("SCRAM-SHA-256"))throw Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let b=c.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:b,response:"n,,n=*,r="+b,message:"SASLInitialResponse"}}function e(a,b,c){if("SASLInitialResponse"!==a.message)throw Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if("string"!=typeof c)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let d=j(c);if(d.nonce.startsWith(a.clientNonce)){if(d.nonce.length===a.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var e=p(b,o.from(d.salt,"base64"),d.iteration),f=n(e,"Client Key"),g=m(f),h="n=*,r="+a.clientNonce,i="r="+d.nonce+",s="+d.salt+",i="+d.iteration,k="c=biws,r="+d.nonce,q=h+","+i+","+k,r=l(f,n(g,q)).toString("base64"),s=n(e,"Server Key"),t=n(s,q);a.message="SASLResponse",a.serverSignature=t.toString("base64"),a.response=k+",p="+r}function f(a,b){if("SASLResponse"!==a.message)throw Error("SASL: Last message was not SASLResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:c}=k(b);if(c!==a.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function g(a){if("string"!=typeof a)throw TypeError("SASL: text must be a string");return a.split("").map((b,c)=>a.charCodeAt(c)).every(a=>a>=33&&a<=43||a>=45&&a<=126)}function h(a){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(a)}function i(a){if("string"!=typeof a)throw TypeError("SASL: attribute pairs text must be a string");return new Map(a.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]}))}function j(a){let b=i(a),c=b.get("r");if(c){if(!g(c))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let d=b.get("s");if(d){if(!h(d))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let e=b.get("i");if(e){if(!/^[1-9][0-9]*$/.test(e))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");return{nonce:c,salt:d,iteration:parseInt(e,10)}}function k(a){let b=i(a).get("v");if(b){if(!h(b))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:b}}function l(a,b){if(!o.isBuffer(a))throw TypeError("first argument must be a Buffer");if(!o.isBuffer(b))throw TypeError("second argument must be a Buffer");if(a.length!==b.length)throw Error("Buffer lengths must match");if(0===a.length)throw Error("Buffers cannot be empty");return o.from(a.map((c,d)=>a[d]^b[d]))}function m(a){return c.createHash("sha256").update(a).digest()}function n(a,b){return c.createHmac("sha256",a).update(b).digest()}function p(a,b,c){for(var d=n(a,o.concat([b,o.from([0,0,0,1])])),e=d,f=0;f<c-1;f++)e=l(e,d=n(a,d));return e}w(d,"startSession"),w(e,"continueSession"),w(f,"finalizeSession"),w(g,"isPrintableChars"),w(h,"isBase64"),w(i,"parseAttributePairs"),w(j,"parseServerFirstMessage"),w(k,"parseServerFinalMessage"),w(l,"xorBuffers"),w(m,"sha256"),w(n,"hmacSha256"),w(p,"Hi"),b.exports={startSession:d,continueSession:e,finalizeSession:f}}),ai={};function aj(...a){return a.join("/")}z(ai,{join:()=>aj});var ak=x(()=>{H(),w(aj,"join")}),al={};function am(a,b){b(Error("No filesystem"))}z(al,{stat:()=>am});var an=x(()=>{H(),w(am,"stat")}),ao={};z(ao,{default:()=>ap});var ap,aq=x(()=>{H(),ap={}}),ar={};z(ar,{StringDecoder:()=>at});var as,at,au=x(()=>{H(),w(as=class{constructor(a){D(this,"td"),this.td=new TextDecoder(a)}write(a){return this.td.decode(a,{stream:!0})}end(a){return this.td.decode(a)}},"StringDecoder"),at=as}),av=y((a,b)=>{H();var{Transform:c}=(aq(),C(ao)),{StringDecoder:d}=(au(),C(ar)),e=Symbol("last"),f=Symbol("decoder");function g(a,b,c){let d;if(this.overflow){if(1===(d=this[f].write(a).split(this.matcher)).length)return c();d.shift(),this.overflow=!1}else this[e]+=this[f].write(a),d=this[e].split(this.matcher);this[e]=d.pop();for(let a=0;a<d.length;a++)try{i(this,this.mapper(d[a]))}catch(a){return c(a)}(this.overflow=this[e].length>this.maxLength,this.overflow&&!this.skipOverflow)?c(Error("maximum buffer reached")):c()}function h(a){if(this[e]+=this[f].end(),this[e])try{i(this,this.mapper(this[e]))}catch(b){return a(b)}a()}function i(a,b){void 0!==b&&a.push(b)}function j(a){return a}function k(a,b,i){switch(a=a||/\r?\n/,b=b||j,i=i||{},arguments.length){case 1:"function"==typeof a?(b=a,a=/\r?\n/):"object"!=typeof a||a instanceof RegExp||a[Symbol.split]||(i=a,a=/\r?\n/);break;case 2:"function"==typeof a?(i=b,b=a,a=/\r?\n/):"object"==typeof b&&(i=b,b=j)}(i=Object.assign({},i)).autoDestroy=!0,i.transform=g,i.flush=h,i.readableObjectMode=!0;let k=new c(i);return k[e]="",k[f]=new d("utf8"),k.matcher=a,k.mapper=b,k.maxLength=i.maxLength,k.skipOverflow=i.skipOverflow||!1,k.overflow=!1,k._destroy=function(a,b){this._writableState.errorEmitted=!1,b(a)},k}w(g,"transform"),w(h,"flush"),w(i,"push"),w(j,"noop"),w(k,"split"),b.exports=k}),aw=y((a,b)=>{H();var c=(ak(),C(ai)),d=(aq(),C(ao)).Stream,e=av(),f=(L(),C(J)),g="win32"===p.platform,h=p.stderr;function i(a){return(61440&a)==32768}w(i,"isRegFile");var j=["host","port","database","user","password"],k=j.length,l=j[k-1];function m(){if(h instanceof d&&!0===h.writable){var a=Array.prototype.slice.call(arguments).concat(`
`);h.write(f.format.apply(f,a))}}w(m,"warn"),Object.defineProperty(b.exports,"isWin",{get:w(function(){return g},"get"),set:w(function(a){g=a},"set")}),b.exports.warnTo=function(a){var b=h;return h=a,b},b.exports.getFileName=function(a){var b=a||p.env;return b.PGPASSFILE||(g?c.join(b.APPDATA||"./","postgresql","pgpass.conf"):c.join(b.HOME||"./",".pgpass"))},b.exports.usePgPass=function(a,b){return!Object.prototype.hasOwnProperty.call(p.env,"PGPASSWORD")&&(!!g||(b=b||"<unkn>",i(a.mode)?!(63&a.mode)||(m('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',b),!1):(m('WARNING: password file "%s" is not a plain file',b),!1)))};var n=b.exports.match=function(a,b){return j.slice(0,-1).reduce(function(c,d,e){return 1==e&&Number(a[d]||5432)===Number(b[d])?c&&!0:c&&("*"===b[d]||b[d]===a[d])},!0)};b.exports.getPassword=function(a,b,c){var d,f=b.pipe(e());function g(b){var c=o(b);c&&q(c)&&n(a,c)&&(d=c[l],f.end())}w(g,"onLine");var h=w(function(){b.destroy(),c(d)},"onEnd"),i=w(function(a){b.destroy(),m("WARNING: error on reading file: %s",a),c(void 0)},"onErr");b.on("error",i),f.on("data",g).on("end",h).on("error",i)};var o=b.exports.parseLine=function(a){if(a.length<11||a.match(/^\s+#/))return null;for(var b="",c="",d=0,e=0,f={},g=w(function(b,c,d){var e=a.substring(c,d);Object.hasOwnProperty.call(p.env,"PGPASS_NO_DEESCAPE")||(e=e.replace(/\\([:\\])/g,"$1")),f[j[b]]=e},"addToObj"),h=0;h<a.length-1;h+=1){if(b=a.charAt(h+1),c=a.charAt(h),d==k-1){g(d,e);break}h>=0&&":"==b&&"\\"!==c&&(g(d,e,h+1),e=h+2,d+=1)}return f=Object.keys(f).length===k?f:null},q=b.exports.isValidEntry=function(a){for(var b={0:function(a){return a.length>0},1:function(a){return"*"===a||isFinite(a=Number(a))&&a>0&&a<0x20000000000000&&Math.floor(a)===a},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},c=0;c<j.length;c+=1)if(!(0,b[c])(a[j[c]]||""))return!1;return!0}}),ax=y((a,b)=>{H(),ak(),C(ai);var c=(an(),C(al)),d=aw();b.exports=function(a,b){var e=d.getFileName();c.stat(e,function(f,g){if(f||!d.usePgPass(g,e))return b(void 0);var h=c.createReadStream(e);d.getPassword(a,h,b)})},b.exports.warnTo=d.warnTo}),ay=y((a,b)=>{H();var c=ae();function d(a){this._types=a||c,this.text={},this.binary={}}w(d,"TypeOverrides"),d.prototype.getOverrides=function(a){switch(a){case"text":return this.text;case"binary":return this.binary;default:return{}}},d.prototype.setTypeParser=function(a,b,c){"function"==typeof b&&(c=b,b="text"),this.getOverrides(b)[a]=c},d.prototype.getTypeParser=function(a,b){return b=b||"text",this.getOverrides(b)[a]||this._types.getTypeParser(a,b)},b.exports=d}),az={};z(az,{default:()=>aA});var aA,aB=x(()=>{H(),aA={}}),aC={};function aD(a,b=!1){let{protocol:c}=new URL(a),{username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,searchParams:k,hash:l}=new URL("http:"+a.substring(c.length));e=decodeURIComponent(e),d=decodeURIComponent(d),i=decodeURIComponent(i);let m=d+":"+e,n=b?Object.fromEntries(k.entries()):j;return{href:a,protocol:c,auth:m,username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,query:n,hash:l}}z(aC,{parse:()=>aD});var aE=x(()=>{H(),w(aD,"parse")}),aF=y((a,b)=>{H();var c=(aE(),C(aC)),d=(an(),C(al));function e(a){if("/"===a.charAt(0)){var b=a.split(" ");return{host:b[0],database:b[1]}}var e=c.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(a)?encodeURI(a).replace(/\%25(\d\d)/g,"%$1"):a,!0),b=e.query;for(var f in b)Array.isArray(b[f])&&(b[f]=b[f][b[f].length-1]);var g=(e.auth||":").split(":");if(b.user=g[0],b.password=g.splice(1).join(":"),b.port=e.port,"socket:"==e.protocol)return b.host=decodeURI(e.pathname),b.database=e.query.db,b.client_encoding=e.query.encoding,b;b.host||(b.host=e.hostname);var h=e.pathname;if(!b.host&&h&&/^%2f/i.test(h)){var i=h.split("/");b.host=decodeURIComponent(i[0]),h=i.splice(1).join("/")}switch(h&&"/"===h.charAt(0)&&(h=h.slice(1)||null),b.database=h&&decodeURI(h),("true"===b.ssl||"1"===b.ssl)&&(b.ssl=!0),"0"===b.ssl&&(b.ssl=!1),(b.sslcert||b.sslkey||b.sslrootcert||b.sslmode)&&(b.ssl={}),b.sslcert&&(b.ssl.cert=d.readFileSync(b.sslcert).toString()),b.sslkey&&(b.ssl.key=d.readFileSync(b.sslkey).toString()),b.sslrootcert&&(b.ssl.ca=d.readFileSync(b.sslrootcert).toString()),b.sslmode){case"disable":b.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":b.ssl.rejectUnauthorized=!1}return b}w(e,"parse"),b.exports=e,e.parse=e}),aG=y((a,b)=>{H();var c=(aB(),C(az)),d=af(),e=aF().parse,f=w(function(a,b,c){return void 0===c?c=p.env["PG"+a.toUpperCase()]:!1===c||(c=p.env[c]),b[a]||c||d[a]},"val"),g=w(function(){switch(p.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return d.ssl},"readSSLConfigFromEnvironment"),h=w(function(a){return"'"+(""+a).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),i=w(function(a,b,c){var d=b[c];null!=d&&a.push(c+"="+h(d))},"add"),j=class{constructor(a){(a="string"==typeof a?e(a):a||{}).connectionString&&(a=Object.assign({},a,e(a.connectionString))),this.user=f("user",a),this.database=f("database",a),void 0===this.database&&(this.database=this.user),this.port=parseInt(f("port",a),10),this.host=f("host",a),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:f("password",a)}),this.binary=f("binary",a),this.options=f("options",a),this.ssl=typeof a.ssl>"u"?g():a.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=f("client_encoding",a),this.replication=f("replication",a),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=f("application_name",a,"PGAPPNAME"),this.fallback_application_name=f("fallback_application_name",a,!1),this.statement_timeout=f("statement_timeout",a,!1),this.lock_timeout=f("lock_timeout",a,!1),this.idle_in_transaction_session_timeout=f("idle_in_transaction_session_timeout",a,!1),this.query_timeout=f("query_timeout",a,!1),void 0===a.connectionTimeoutMillis?this.connect_timeout=p.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(a.connectionTimeoutMillis/1e3),!1===a.keepAlive?this.keepalives=0:!0===a.keepAlive&&(this.keepalives=1),"number"==typeof a.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(a.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(a){var b=[];i(b,this,"user"),i(b,this,"password"),i(b,this,"port"),i(b,this,"application_name"),i(b,this,"fallback_application_name"),i(b,this,"connect_timeout"),i(b,this,"options");var d="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(i(b,d,"sslmode"),i(b,d,"sslca"),i(b,d,"sslkey"),i(b,d,"sslcert"),i(b,d,"sslrootcert"),this.database&&b.push("dbname="+h(this.database)),this.replication&&b.push("replication="+h(this.replication)),this.host&&b.push("host="+h(this.host)),this.isDomainSocket)return a(null,b.join(" "));this.client_encoding&&b.push("client_encoding="+h(this.client_encoding)),c.lookup(this.host,function(c,d){return c?a(c,null):(b.push("hostaddr="+h(d)),a(null,b.join(" ")))})}};w(j,"ConnectionParameters"),b.exports=j}),aH=y((a,b)=>{H();var c=ae(),d=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,e=class{constructor(a,b){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=b,this.RowCtor=null,this.rowAsArray="array"===a,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var b;(b=a.text?d.exec(a.text):d.exec(a.command))&&(this.command=b[1],b[3]?(this.oid=parseInt(b[2],10),this.rowCount=parseInt(b[3],10)):b[2]&&(this.rowCount=parseInt(b[2],10)))}_parseRowAsArray(a){for(var b=Array(a.length),c=0,d=a.length;c<d;c++){var e=a[c];null!==e?b[c]=this._parsers[c](e):b[c]=null}return b}parseRow(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c],f=this.fields[c].name;null!==e?b[f]=this._parsers[c](e):b[f]=null}return b}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=Array(a.length));for(var b=0;b<a.length;b++){var d=a[b];this._types?this._parsers[b]=this._types.getTypeParser(d.dataTypeID,d.format||"text"):this._parsers[b]=c.getTypeParser(d.dataTypeID,d.format||"text")}}};w(e,"Result"),b.exports=e}),aI=y((a,b)=>{H();var{EventEmitter:c}=I(),d=aH(),e=ag(),f=class extends c{constructor(a,b,c){super(),a=e.normalizeQueryConfig(a,b,c),this.text=a.text,this.values=a.values,this.rows=a.rows,this.types=a.types,this.name=a.name,this.binary=a.binary,this.portal=a.portal||"",this.callback=a.callback,this._rowMode=a.rowMode,p.domain&&a.callback&&(this.callback=p.domain.bind(a.callback)),this._result=new d(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return!!this.name||!!this.rows||!!this.text&&!!this.values&&this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new d(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(a){this._checkForMultirow(),this._result.addFields(a.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(a){let b;if(!this._canceledDueToError){try{b=this._result.parseRow(a.fields)}catch(a){this._canceledDueToError=a;return}this.emit("row",b,this._result),this._accumulateRows&&this._result.addRow(b)}}handleCommandComplete(a,b){this._checkForMultirow(),this._result.addCommandComplete(a),this.rows&&b.sync()}handleEmptyQuery(a){this.rows&&a.sync()}handleError(a,b){if(this._canceledDueToError&&(a=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(a);this.emit("error",a)}handleReadyForQuery(a){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,a);if(this.callback)try{this.callback(null,this._results)}catch(a){p.nextTick(()=>{throw a})}this.emit("end",this._results)}submit(a){if("string"!=typeof this.text&&"string"!=typeof this.name)return Error("A query must have either text or a name. Supplying neither is unsupported.");let b=a.parsedStatements[this.name];return this.text&&b&&this.text!==b?Error(`Prepared statements must be \
unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(a):a.query(this.text),null)}hasBeenParsed(a){return this.name&&a.parsedStatements[this.name]}handlePortalSuspended(a){this._getRows(a,this.rows)}_getRows(a,b){a.execute({portal:this.portal,rows:b}),b?a.flush():a.sync()}prepare(a){this.isPreparedStatement=!0,this.hasBeenParsed(a)||a.parse({text:this.text,name:this.name,types:this.types});try{a.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:e.prepareValue})}catch(b){this.handleError(b,a);return}a.describe({type:"P",name:this.portal||""}),this._getRows(a,this.rows)}handleCopyInResponse(a){a.sendCopyFail("No source stream defined")}handleCopyData(a,b){}};w(f,"Query"),b.exports=f}),aJ={};function aK(a){return 0}z(aJ,{Socket:()=>aO,isIP:()=>aK});var aL,aM,aN,aO,aP=x(()=>{H(),aL=B(I(),1),w(aK,"isIP"),aM=/^[^.]+\./,aN=class a extends aL.EventEmitter{constructor(){super(...arguments),D(this,"opts",{}),D(this,"connecting",!1),D(this,"pending",!0),D(this,"writable",!0),D(this,"encrypted",!1),D(this,"authorized",!1),D(this,"destroyed",!1),D(this,"ws",null),D(this,"writeBuffer"),D(this,"tlsState",0),D(this,"tlsRead"),D(this,"tlsWrite")}static get poolQueryViaFetch(){return a.opts.poolQueryViaFetch??a.defaults.poolQueryViaFetch}static set poolQueryViaFetch(b){a.opts.poolQueryViaFetch=b}static get fetchEndpoint(){return a.opts.fetchEndpoint??a.defaults.fetchEndpoint}static set fetchEndpoint(b){a.opts.fetchEndpoint=b}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(a){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return a.opts.fetchFunction??a.defaults.fetchFunction}static set fetchFunction(b){a.opts.fetchFunction=b}static get webSocketConstructor(){return a.opts.webSocketConstructor??a.defaults.webSocketConstructor}static set webSocketConstructor(b){a.opts.webSocketConstructor=b}get webSocketConstructor(){return this.opts.webSocketConstructor??a.webSocketConstructor}set webSocketConstructor(a){this.opts.webSocketConstructor=a}static get wsProxy(){return a.opts.wsProxy??a.defaults.wsProxy}static set wsProxy(b){a.opts.wsProxy=b}get wsProxy(){return this.opts.wsProxy??a.wsProxy}set wsProxy(a){this.opts.wsProxy=a}static get coalesceWrites(){return a.opts.coalesceWrites??a.defaults.coalesceWrites}static set coalesceWrites(b){a.opts.coalesceWrites=b}get coalesceWrites(){return this.opts.coalesceWrites??a.coalesceWrites}set coalesceWrites(a){this.opts.coalesceWrites=a}static get useSecureWebSocket(){return a.opts.useSecureWebSocket??a.defaults.useSecureWebSocket}static set useSecureWebSocket(b){a.opts.useSecureWebSocket=b}get useSecureWebSocket(){return this.opts.useSecureWebSocket??a.useSecureWebSocket}set useSecureWebSocket(a){this.opts.useSecureWebSocket=a}static get forceDisablePgSSL(){return a.opts.forceDisablePgSSL??a.defaults.forceDisablePgSSL}static set forceDisablePgSSL(b){a.opts.forceDisablePgSSL=b}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??a.forceDisablePgSSL}set forceDisablePgSSL(a){this.opts.forceDisablePgSSL=a}static get disableSNI(){return a.opts.disableSNI??a.defaults.disableSNI}static set disableSNI(b){a.opts.disableSNI=b}get disableSNI(){return this.opts.disableSNI??a.disableSNI}set disableSNI(a){this.opts.disableSNI=a}static get pipelineConnect(){return a.opts.pipelineConnect??a.defaults.pipelineConnect}static set pipelineConnect(b){a.opts.pipelineConnect=b}get pipelineConnect(){return this.opts.pipelineConnect??a.pipelineConnect}set pipelineConnect(a){this.opts.pipelineConnect=a}static get subtls(){return a.opts.subtls??a.defaults.subtls}static set subtls(b){a.opts.subtls=b}get subtls(){return this.opts.subtls??a.subtls}set subtls(a){this.opts.subtls=a}static get pipelineTLS(){return a.opts.pipelineTLS??a.defaults.pipelineTLS}static set pipelineTLS(b){a.opts.pipelineTLS=b}get pipelineTLS(){return this.opts.pipelineTLS??a.pipelineTLS}set pipelineTLS(a){this.opts.pipelineTLS=a}static get rootCerts(){return a.opts.rootCerts??a.defaults.rootCerts}static set rootCerts(b){a.opts.rootCerts=b}get rootCerts(){return this.opts.rootCerts??a.rootCerts}set rootCerts(a){this.opts.rootCerts=a}wsProxyAddrForHost(a,b){let c=this.wsProxy;if(void 0===c)throw Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return"function"==typeof c?c(a,b):`${c}?address=${a}:${b}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(a,b,c){this.connecting=!0,c&&this.once("connect",c);let d=w(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),e=w((a,b=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",a=>{this.emit("error",a),this.emit("close")}),a.addEventListener("message",a=>{if(0===this.tlsState){let b=o.from(a.data);this.emit("data",b)}}),a.addEventListener("close",()=>{this.emit("close")}),b?d():a.addEventListener("open",d)},"configureWebSocket"),f;try{f=this.wsProxyAddrForHost(b,"string"==typeof a?parseInt(a,10):a)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+f;if(void 0!==this.webSocketConstructor)this.ws=new this.webSocketConstructor(a),e(this.ws);else try{this.ws=new WebSocket(a),e(this.ws)}catch{this.ws=new __unstable_WebSocket(a),e(this.ws)}}catch(a){fetch((this.useSecureWebSocket?"https:":"http:")+"//"+f,{headers:{Upgrade:"websocket"}}).then(b=>{if(this.ws=b.webSocket,null==this.ws)throw a;this.ws.accept(),e(this.ws,!0)}).catch(a=>{this.emit("error",Error(`All attempts to open a WebSocket to\
 connect to the database failed. Please refer to https://github.com/neondatabase\
/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined\
. Details: ${a.message}`)),this.emit("close")})}}async startTls(a){if(void 0===this.subtls)throw Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let b=this.subtls.TrustedCert.fromPEM(this.rootCerts),c=new this.subtls.WebSocketReadQueue(this.ws),d=c.read.bind(c),e=this.rawWrite.bind(this),[f,g]=await this.subtls.startTls(a,b,d,e,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=f,this.tlsWrite=g,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let a=await this.tlsRead();if(void 0===a)break;{let b=o.from(a);this.emit("data",b)}}}rawWrite(a){if(!this.coalesceWrites)return void this.ws.send(a);if(void 0===this.writeBuffer)this.writeBuffer=a,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let b=new Uint8Array(this.writeBuffer.length+a.length);b.set(this.writeBuffer),b.set(a,this.writeBuffer.length),this.writeBuffer=b}}write(a,b="utf8",c=a=>{}){return 0===a.length?c():("string"==typeof a&&(a=o.from(a,b)),0===this.tlsState?(this.rawWrite(a),c()):1===this.tlsState?this.once("secureConnection",()=>{this.write(a,b,c)}):(this.tlsWrite(a),c())),!0}end(a=o.alloc(0),b="utf8",c=()=>{}){return this.write(a,b,()=>{this.ws.close(),c()}),this}destroy(){return this.destroyed=!0,this.end()}},w(aN,"Socket"),D(aN,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:w((a,b,c)=>"https://"+(c?.jwtAuth?a.replace(aM,"apiauth."):a.replace(aM,"api."))+"/sql","fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:w(a=>a+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),D(aN,"opts",{}),aO=aN}),aQ=y(a=>{H(),Object.defineProperty(a,"__esModule",{value:!0}),a.NoticeMessage=a.DataRowMessage=a.CommandCompleteMessage=a.ReadyForQueryMessage=a.NotificationResponseMessage=a.BackendKeyDataMessage=a.AuthenticationMD5Password=a.ParameterStatusMessage=a.ParameterDescriptionMessage=a.RowDescriptionMessage=a.Field=a.CopyResponse=a.CopyDataMessage=a.DatabaseError=a.copyDone=a.emptyQuery=a.replicationStart=a.portalSuspended=a.noData=a.closeComplete=a.bindComplete=a.parseComplete=void 0,a.parseComplete={name:"parseComplete",length:5},a.bindComplete={name:"bindComplete",length:5},a.closeComplete={name:"closeComplete",length:5},a.noData={name:"noData",length:5},a.portalSuspended={name:"portalSuspended",length:5},a.replicationStart={name:"replicationStart",length:4},a.emptyQuery={name:"emptyQuery",length:4},a.copyDone={name:"copyDone",length:4};var b=class extends Error{constructor(a,b,c){super(a),this.length=b,this.name=c}};w(b,"DatabaseError"),a.DatabaseError=b;var c=class{constructor(a,b){this.length=a,this.chunk=b,this.name="copyData"}};w(c,"CopyDataMessage"),a.CopyDataMessage=c;var d=class{constructor(a,b,c,d){this.length=a,this.name=b,this.binary=c,this.columnTypes=Array(d)}};w(d,"CopyResponse"),a.CopyResponse=d;var e=class{constructor(a,b,c,d,e,f,g){this.name=a,this.tableID=b,this.columnID=c,this.dataTypeID=d,this.dataTypeSize=e,this.dataTypeModifier=f,this.format=g}};w(e,"Field"),a.Field=e;var f=class{constructor(a,b){this.length=a,this.fieldCount=b,this.name="rowDescription",this.fields=Array(this.fieldCount)}};w(f,"RowDescriptionMessage"),a.RowDescriptionMessage=f;var g=class{constructor(a,b){this.length=a,this.parameterCount=b,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}};w(g,"ParameterDescriptionMessage"),a.ParameterDescriptionMessage=g;var h=class{constructor(a,b,c){this.length=a,this.parameterName=b,this.parameterValue=c,this.name="parameterStatus"}};w(h,"ParameterStatusMessage"),a.ParameterStatusMessage=h;var i=class{constructor(a,b){this.length=a,this.salt=b,this.name="authenticationMD5Password"}};w(i,"AuthenticationMD5Password"),a.AuthenticationMD5Password=i;var j=class{constructor(a,b,c){this.length=a,this.processID=b,this.secretKey=c,this.name="backendKeyData"}};w(j,"BackendKeyDataMessage"),a.BackendKeyDataMessage=j;var k=class{constructor(a,b,c,d){this.length=a,this.processId=b,this.channel=c,this.payload=d,this.name="notification"}};w(k,"NotificationResponseMessage"),a.NotificationResponseMessage=k;var l=class{constructor(a,b){this.length=a,this.status=b,this.name="readyForQuery"}};w(l,"ReadyForQueryMessage"),a.ReadyForQueryMessage=l;var m=class{constructor(a,b){this.length=a,this.text=b,this.name="commandComplete"}};w(m,"CommandCompleteMessage"),a.CommandCompleteMessage=m;var n=class{constructor(a,b){this.length=a,this.fields=b,this.name="dataRow",this.fieldCount=b.length}};w(n,"DataRowMessage"),a.DataRowMessage=n;var o=class{constructor(a,b){this.length=a,this.message=b,this.name="notice"}};w(o,"NoticeMessage"),a.NoticeMessage=o}),aR=y(a=>{H(),Object.defineProperty(a,"__esModule",{value:!0}),a.Writer=void 0;var b=class{constructor(a=256){this.size=a,this.offset=5,this.headerPosition=0,this.buffer=o.allocUnsafe(a)}ensure(a){if(this.buffer.length-this.offset<a){var b=this.buffer,c=b.length+(b.length>>1)+a;this.buffer=o.allocUnsafe(c),b.copy(this.buffer)}}addInt32(a){return this.ensure(4),this.buffer[this.offset++]=a>>>24&255,this.buffer[this.offset++]=a>>>16&255,this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addInt16(a){return this.ensure(2),this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addCString(a){if(a){var b=o.byteLength(a);this.ensure(b+1),this.buffer.write(a,this.offset,"utf-8"),this.offset+=b}else this.ensure(1);return this.buffer[this.offset++]=0,this}addString(a=""){var b=o.byteLength(a);return this.ensure(b),this.buffer.write(a,this.offset),this.offset+=b,this}add(a){return this.ensure(a.length),a.copy(this.buffer,this.offset),this.offset+=a.length,this}join(a){if(a){this.buffer[this.headerPosition]=a;let b=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(b,this.headerPosition+1)}return this.buffer.slice(5*!a,this.offset)}flush(a){var b=this.join(a);return this.offset=5,this.headerPosition=0,this.buffer=o.allocUnsafe(this.size),b}};w(b,"Writer"),a.Writer=b}),aS=y(a=>{H(),Object.defineProperty(a,"__esModule",{value:!0}),a.serialize=void 0;var b=aR(),c=new b.Writer,d=w(a=>{for(let b of(c.addInt16(3).addInt16(0),Object.keys(a)))c.addCString(b).addCString(a[b]);c.addCString("client_encoding").addCString("UTF8");var d=c.addCString("").flush(),e=d.length+4;return new b.Writer().addInt32(e).add(d).flush()},"startup"),e=w(()=>{let a=o.allocUnsafe(8);return a.writeInt32BE(8,0),a.writeInt32BE(0x4d2162f,4),a},"requestSsl"),f=w(a=>c.addCString(a).flush(112),"password"),g=w(function(a,b){return c.addCString(a).addInt32(o.byteLength(b)).addString(b),c.flush(112)},"sendSASLInitialResponseMessage"),h=w(function(a){return c.addString(a).flush(112)},"sendSCRAMClientFinalMessage"),i=w(a=>c.addCString(a).flush(81),"query"),j=[],k=w(a=>{let b=a.name||"";b.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",b,b.length),console.error("This can cause conflicts and silent errors executing queries"));let d=a.types||j;for(var e=d.length,f=c.addCString(b).addCString(a.text).addInt16(e),g=0;g<e;g++)f.addInt32(d[g]);return c.flush(80)},"parse"),l=new b.Writer,m=w(function(a,b){for(let d=0;d<a.length;d++){let e=b?b(a[d],d):a[d];null==e?(c.addInt16(0),l.addInt32(-1)):e instanceof o?(c.addInt16(1),l.addInt32(e.length),l.add(e)):(c.addInt16(0),l.addInt32(o.byteLength(e)),l.addString(e))}},"writeValues"),n=w((a={})=>{let b=a.portal||"",d=a.statement||"",e=a.binary||!1,f=a.values||j,g=f.length;return c.addCString(b).addCString(d),c.addInt16(g),m(f,a.valueMapper),c.addInt16(g),c.add(l.flush()),c.addInt16(+!!e),c.flush(66)},"bind"),p=o.from([69,0,0,0,9,0,0,0,0,0]),q=w(a=>{if(!a||!a.portal&&!a.rows)return p;let b=a.portal||"",c=a.rows||0,d=o.byteLength(b),e=4+d+1+4,f=o.allocUnsafe(1+e);return f[0]=69,f.writeInt32BE(e,1),f.write(b,5,"utf-8"),f[d+5]=0,f.writeUInt32BE(c,f.length-4),f},"execute"),r=w((a,b)=>{let c=o.allocUnsafe(16);return c.writeInt32BE(16,0),c.writeInt16BE(1234,4),c.writeInt16BE(5678,6),c.writeInt32BE(a,8),c.writeInt32BE(b,12),c},"cancel"),s=w((a,b)=>{let c=4+o.byteLength(b)+1,d=o.allocUnsafe(1+c);return d[0]=a,d.writeInt32BE(c,1),d.write(b,5,"utf-8"),d[c]=0,d},"cstringMessage"),t=c.addCString("P").flush(68),u=c.addCString("S").flush(68),v=w(a=>a.name?s(68,`${a.type}${a.name||""}`):"P"===a.type?t:u,"describe"),x=w(a=>s(67,`${a.type}${a.name||""}`),"close"),y=w(a=>c.add(a).flush(100),"copyData"),z=w(a=>s(102,a),"copyFail"),A=w(a=>o.from([a,0,0,0,4]),"codeOnlyBuffer"),B=A(72),C=A(83),D=A(88),E=A(99);a.serialize={startup:d,password:f,requestSsl:e,sendSASLInitialResponseMessage:g,sendSCRAMClientFinalMessage:h,query:i,parse:k,bind:n,execute:q,describe:v,close:x,flush:w(()=>B,"flush"),sync:w(()=>C,"sync"),end:w(()=>D,"end"),copyData:y,copyDone:w(()=>E,"copyDone"),copyFail:z,cancel:r}}),aT=y(a=>{H(),Object.defineProperty(a,"__esModule",{value:!0}),a.BufferReader=void 0;var b=o.allocUnsafe(0),c=class{constructor(a=0){this.offset=a,this.buffer=b,this.encoding="utf-8"}setBuffer(a,b){this.offset=a,this.buffer=b}int16(){let a=this.buffer.readInt16BE(this.offset);return this.offset+=2,a}byte(){let a=this.buffer[this.offset];return this.offset++,a}int32(){let a=this.buffer.readInt32BE(this.offset);return this.offset+=4,a}string(a){let b=this.buffer.toString(this.encoding,this.offset,this.offset+a);return this.offset+=a,b}cstring(){let a=this.offset,b=a;for(;0!==this.buffer[b++];);return this.offset=b,this.buffer.toString(this.encoding,a,b-1)}bytes(a){let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}};w(c,"BufferReader"),a.BufferReader=c}),aU=y(a=>{H(),Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;var b=aQ(),c=aT(),d=o.allocUnsafe(0),e=class{constructor(a){if(this.buffer=d,this.bufferLength=0,this.bufferOffset=0,this.reader=new c.BufferReader,a?.mode==="binary")throw Error("Binary mode not supported yet");this.mode=a?.mode||"text"}parse(a,b){this.mergeBuffer(a);let c=this.bufferOffset+this.bufferLength,e=this.bufferOffset;for(;e+5<=c;){let a=this.buffer[e],d=this.buffer.readUInt32BE(e+1),f=1+d;if(f+e<=c)b(this.handlePacket(e+5,a,d,this.buffer)),e+=f;else break}e===c?(this.buffer=d,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=c-e,this.bufferOffset=e)}mergeBuffer(a){if(this.bufferLength>0){let b=this.bufferLength+a.byteLength;if(b+this.bufferOffset>this.buffer.byteLength){let a;if(b<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)a=this.buffer;else{let c=2*this.buffer.byteLength;for(;b>=c;)c*=2;a=o.allocUnsafe(c)}this.buffer.copy(a,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=a,this.bufferOffset=0}a.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=b}else this.buffer=a,this.bufferOffset=0,this.bufferLength=a.byteLength}handlePacket(a,c,d,e){switch(c){case 50:return b.bindComplete;case 49:return b.parseComplete;case 51:return b.closeComplete;case 110:return b.noData;case 115:return b.portalSuspended;case 99:return b.copyDone;case 87:return b.replicationStart;case 73:return b.emptyQuery;case 68:return this.parseDataRowMessage(a,d,e);case 67:return this.parseCommandCompleteMessage(a,d,e);case 90:return this.parseReadyForQueryMessage(a,d,e);case 65:return this.parseNotificationMessage(a,d,e);case 82:return this.parseAuthenticationResponse(a,d,e);case 83:return this.parseParameterStatusMessage(a,d,e);case 75:return this.parseBackendKeyData(a,d,e);case 69:return this.parseErrorMessage(a,d,e,"error");case 78:return this.parseErrorMessage(a,d,e,"notice");case 84:return this.parseRowDescriptionMessage(a,d,e);case 116:return this.parseParameterDescriptionMessage(a,d,e);case 71:return this.parseCopyInMessage(a,d,e);case 72:return this.parseCopyOutMessage(a,d,e);case 100:return this.parseCopyData(a,d,e);default:return new b.DatabaseError("received invalid response: "+c.toString(16),d,"error")}}parseReadyForQueryMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.string(1);return new b.ReadyForQueryMessage(c,e)}parseCommandCompleteMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring();return new b.CommandCompleteMessage(c,e)}parseCopyData(a,c,d){let e=d.slice(a,a+(c-4));return new b.CopyDataMessage(c,e)}parseCopyInMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyInResponse")}parseCopyOutMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyOutResponse")}parseCopyMessage(a,c,d,e){this.reader.setBuffer(a,d);let f=0!==this.reader.byte(),g=this.reader.int16(),h=new b.CopyResponse(c,e,f,g);for(let a=0;a<g;a++)h.columnTypes[a]=this.reader.int16();return h}parseNotificationMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.cstring(),g=this.reader.cstring();return new b.NotificationResponseMessage(c,e,f,g)}parseRowDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.RowDescriptionMessage(c,e);for(let a=0;a<e;a++)f.fields[a]=this.parseField();return f}parseField(){let a=this.reader.cstring(),c=this.reader.int32(),d=this.reader.int16(),e=this.reader.int32(),f=this.reader.int16(),g=this.reader.int32(),h=0===this.reader.int16()?"text":"binary";return new b.Field(a,c,d,e,f,g,h)}parseParameterDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.ParameterDescriptionMessage(c,e);for(let a=0;a<e;a++)f.dataTypeIDs[a]=this.reader.int32();return f}parseDataRowMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=Array(e);for(let a=0;a<e;a++){let b=this.reader.int32();f[a]=-1===b?null:this.reader.string(b)}return new b.DataRowMessage(c,f)}parseParameterStatusMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring(),f=this.reader.cstring();return new b.ParameterStatusMessage(c,e,f)}parseBackendKeyData(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.int32();return new b.BackendKeyDataMessage(c,e,f)}parseAuthenticationResponse(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f={name:"authenticationOk",length:c};switch(e){case 0:break;case 3:8===f.length&&(f.name="authenticationCleartextPassword");break;case 5:if(12===f.length){f.name="authenticationMD5Password";let a=this.reader.bytes(4);return new b.AuthenticationMD5Password(c,a)}break;case 10:let g;f.name="authenticationSASL",f.mechanisms=[];do(g=this.reader.cstring())&&f.mechanisms.push(g);while(g)break;case 11:f.name="authenticationSASLContinue",f.data=this.reader.string(c-8);break;case 12:f.name="authenticationSASLFinal",f.data=this.reader.string(c-8);break;default:throw Error("Unknown authenticationOk message type "+e)}return f}parseErrorMessage(a,c,d,e){this.reader.setBuffer(a,d);let f={},g=this.reader.string(1);for(;"\0"!==g;)f[g]=this.reader.cstring(),g=this.reader.string(1);let h=f.M,i="notice"===e?new b.NoticeMessage(c,h):new b.DatabaseError(h,c,e);return i.severity=f.S,i.code=f.C,i.detail=f.D,i.hint=f.H,i.position=f.P,i.internalPosition=f.p,i.internalQuery=f.q,i.where=f.W,i.schema=f.s,i.table=f.t,i.column=f.c,i.dataType=f.d,i.constraint=f.n,i.file=f.F,i.line=f.L,i.routine=f.R,i}};w(e,"Parser"),a.Parser=e}),aV=y(a=>{H(),Object.defineProperty(a,"__esModule",{value:!0}),a.DatabaseError=a.serialize=a.parse=void 0;var b=aQ();Object.defineProperty(a,"DatabaseError",{enumerable:!0,get:w(function(){return b.DatabaseError},"get")});var c=aS();Object.defineProperty(a,"serialize",{enumerable:!0,get:w(function(){return c.serialize},"get")});var d=aU();function e(a,b){let c=new d.Parser;return a.on("data",a=>c.parse(a,b)),new Promise(b=>a.on("end",()=>b()))}w(e,"parse"),a.parse=e}),aW={};function aX({socket:a,servername:b}){return a.startTls(b),a}z(aW,{connect:()=>aX});var aY=x(()=>{H(),w(aX,"connect")}),aZ=y((a,b)=>{H();var c=(aP(),C(aJ)),d=I().EventEmitter,{parse:e,serialize:f}=aV(),g=f.flush(),h=f.sync(),i=f.end(),j=class extends d{constructor(a){super(),a=a||{},this.stream=a.stream||new c.Socket,this._keepAlive=a.keepAlive,this._keepAliveInitialDelayMillis=a.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=a.ssl||!1,this._ending=!1,this._emitMessage=!1;var b=this;this.on("newListener",function(a){"message"===a&&(b._emitMessage=!0)})}connect(a,b){var d=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(a,b),this.stream.once("connect",function(){d._keepAlive&&d.stream.setKeepAlive(!0,d._keepAliveInitialDelayMillis),d.emit("connect")});let e=w(function(a){d._ending&&("ECONNRESET"===a.code||"EPIPE"===a.code)||d.emit("error",a)},"reportStreamError");if(this.stream.on("error",e),this.stream.on("close",function(){d.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(a){switch(a.toString("utf8")){case"S":break;case"N":return d.stream.end(),d.emit("error",Error("The server does not support SSL connections"));default:return d.stream.end(),d.emit("error",Error("There was an error establishing an SSL connection"))}var f=(aY(),C(aW));let g={socket:d.stream};!0!==d.ssl&&(Object.assign(g,d.ssl),"key"in d.ssl&&(g.key=d.ssl.key)),0===c.isIP(b)&&(g.servername=b);try{d.stream=f.connect(g)}catch(a){return d.emit("error",a)}d.attachListeners(d.stream),d.stream.on("error",e),d.emit("sslconnect")})}attachListeners(a){a.on("end",()=>{this.emit("end")}),e(a,a=>{var b="error"===a.name?"errorMessage":a.name;this._emitMessage&&this.emit("message",a),this.emit(b,a)})}requestSsl(){this.stream.write(f.requestSsl())}startup(a){this.stream.write(f.startup(a))}cancel(a,b){this._send(f.cancel(a,b))}password(a){this._send(f.password(a))}sendSASLInitialResponseMessage(a,b){this._send(f.sendSASLInitialResponseMessage(a,b))}sendSCRAMClientFinalMessage(a){this._send(f.sendSCRAMClientFinalMessage(a))}_send(a){return!!this.stream.writable&&this.stream.write(a)}query(a){this._send(f.query(a))}parse(a){this._send(f.parse(a))}bind(a){this._send(f.bind(a))}execute(a){this._send(f.execute(a))}flush(){this.stream.writable&&this.stream.write(g)}sync(){this._ending=!0,this._send(g),this._send(h)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){return(this._ending=!0,this._connecting&&this.stream.writable)?this.stream.write(i,()=>{this.stream.end()}):void this.stream.end()}close(a){this._send(f.close(a))}describe(a){this._send(f.describe(a))}sendCopyFromChunk(a){this._send(f.copyData(a))}endCopyFrom(){this._send(f.copyDone())}sendCopyFail(a){this._send(f.copyFail(a))}};w(j,"Connection"),b.exports=j}),a$=y((a,b)=>{H();var c=I().EventEmitter,d=(L(),C(J),ag()),e=ah(),f=ax(),g=ay(),h=aG(),i=aI(),j=af(),k=aZ(),m=class extends c{constructor(a){super(),this.connectionParameters=new h(a),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var b=a||{};this._Promise=b.Promise||l.Promise,this._types=new g(b.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=b.connection||new k({stream:b.stream,ssl:this.connectionParameters.ssl,keepAlive:b.keepAlive||!1,keepAliveInitialDelayMillis:b.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=b.binary||j.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=b.connectionTimeoutMillis||0}_errorAllQueries(a){let b=w(b=>{p.nextTick(()=>{b.handleError(a,this.connection)})},"enqueueError");this.activeQuery&&(b(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(b),this.queryQueue.length=0}_connect(a){var b=this,c=this.connection;if(this._connectionCallback=a,this._connecting||this._connected){let b=Error("Client has already been connected. You cannot reuse a client.");p.nextTick(()=>{a(b)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{c._ending=!0,c.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){b.ssl?c.requestSsl():c.startup(b.getStartupConf())}),c.on("sslconnect",function(){c.startup(b.getStartupConf())}),this._attachListeners(c),c.once("end",()=>{let a=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(a),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(a):this._handleErrorEvent(a):this._connectionError||this._handleErrorEvent(a)),p.nextTick(()=>{this.emit("end")})})}connect(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})}_attachListeners(a){a.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),a.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),a.on("authenticationSASL",this._handleAuthSASL.bind(this)),a.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),a.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),a.on("backendKeyData",this._handleBackendKeyData.bind(this)),a.on("error",this._handleErrorEvent.bind(this)),a.on("errorMessage",this._handleErrorMessage.bind(this)),a.on("readyForQuery",this._handleReadyForQuery.bind(this)),a.on("notice",this._handleNotice.bind(this)),a.on("rowDescription",this._handleRowDescription.bind(this)),a.on("dataRow",this._handleDataRow.bind(this)),a.on("portalSuspended",this._handlePortalSuspended.bind(this)),a.on("emptyQuery",this._handleEmptyQuery.bind(this)),a.on("commandComplete",this._handleCommandComplete.bind(this)),a.on("parseComplete",this._handleParseComplete.bind(this)),a.on("copyInResponse",this._handleCopyInResponse.bind(this)),a.on("copyData",this._handleCopyData.bind(this)),a.on("notification",this._handleNotification.bind(this))}_checkPgPass(a){let b=this.connection;"function"==typeof this.password?this._Promise.resolve().then(()=>this.password()).then(c=>{if(void 0!==c){if("string"!=typeof c)return void b.emit("error",TypeError("Password must be a string"));this.connectionParameters.password=this.password=c}else this.connectionParameters.password=this.password=null;a()}).catch(a=>{b.emit("error",a)}):null!==this.password?a():f(this.connectionParameters,b=>{void 0!==b&&(this.connectionParameters.password=this.password=b),a()})}_handleAuthCleartextPassword(a){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(a){this._checkPgPass(()=>{let b=d.postgresMd5PasswordHash(this.user,this.password,a.salt);this.connection.password(b)})}_handleAuthSASL(a){this._checkPgPass(()=>{this.saslSession=e.startSession(a.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(a){e.continueSession(this.saslSession,this.password,a.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(a){e.finalizeSession(this.saslSession,a.data),this.saslSession=null}_handleBackendKeyData(a){this.processID=a.processID,this.secretKey=a.secretKey}_handleReadyForQuery(a){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:b}=this;this.activeQuery=null,this.readyForQuery=!0,b&&b.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(a){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(a);this.emit("error",a)}}_handleErrorEvent(a){if(this._connecting)return this._handleErrorWhileConnecting(a);this._queryable=!1,this._errorAllQueries(a),this.emit("error",a)}_handleErrorMessage(a){if(this._connecting)return this._handleErrorWhileConnecting(a);let b=this.activeQuery;b?(this.activeQuery=null,b.handleError(a,this.connection)):this._handleErrorEvent(a)}_handleRowDescription(a){this.activeQuery.handleRowDescription(a)}_handleDataRow(a){this.activeQuery.handleDataRow(a)}_handlePortalSuspended(a){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(a){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(a){this.activeQuery.handleCommandComplete(a,this.connection)}_handleParseComplete(a){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(a){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(a){this.activeQuery.handleCopyData(a,this.connection)}_handleNotification(a){this.emit("notification",a)}_handleNotice(a){this.emit("notice",a)}getStartupConf(){var a=this.connectionParameters,b={user:a.user,database:a.database},c=a.application_name||a.fallback_application_name;return c&&(b.application_name=c),a.replication&&(b.replication=""+a.replication),a.statement_timeout&&(b.statement_timeout=String(parseInt(a.statement_timeout,10))),a.lock_timeout&&(b.lock_timeout=String(parseInt(a.lock_timeout,10))),a.idle_in_transaction_session_timeout&&(b.idle_in_transaction_session_timeout=String(parseInt(a.idle_in_transaction_session_timeout,10))),a.options&&(b.options=a.options),b}cancel(a,b){if(a.activeQuery===b){var c=this.connection;this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){c.cancel(a.processID,a.secretKey)})}else -1!==a.queryQueue.indexOf(b)&&a.queryQueue.splice(a.queryQueue.indexOf(b),1)}setTypeParser(a,b,c){return this._types.setTypeParser(a,b,c)}getTypeParser(a,b){return this._types.getTypeParser(a,b)}escapeIdentifier(a){return'"'+a.replace(/"/g,'""')+'"'}escapeLiteral(a){for(var b=!1,c="'",d=0;d<a.length;d++){var e=a[d];"'"===e?c+=e+e:"\\"===e?(c+=e+e,b=!0):c+=e}return c+="'",!0===b&&(c=" E"+c),c}_pulseQueryQueue(){if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let a=this.activeQuery.submit(this.connection);a&&p.nextTick(()=>{this.activeQuery.handleError(a,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(a,b,c){var d,e,f,g,h;if(null==a)throw TypeError("Client was passed a null or undefined query");return"function"==typeof a.submit?(f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(d.callback=d.callback||b)):(f=this.connectionParameters.query_timeout,(d=new i(a,b,c)).callback||(e=new this._Promise((a,b)=>{d.callback=(c,d)=>c?b(c):a(d)}))),f&&(h=d.callback,g=setTimeout(()=>{var a=Error("Query read timeout");p.nextTick(()=>{d.handleError(a,this.connection)}),h(a),d.callback=()=>{};var b=this.queryQueue.indexOf(d);b>-1&&this.queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(g),h(a,b)}),this.binary&&!d.binary&&(d.binary=!0),d._result&&!d._result._types&&(d._result._types=this._types),this._queryable?this._ending?p.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"),this.connection)}):(this.queryQueue.push(d),this._pulseQueryQueue()):p.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),e}ref(){this.connection.ref()}unref(){this.connection.unref()}end(a){if(this._ending=!0,!this.connection._connecting)if(!a)return this._Promise.resolve();else a();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!a)return new this._Promise(a=>{this.connection.once("end",a)});this.connection.once("end",a)}};w(m,"Client"),m.Query=i,b.exports=m}),a_=y((a,b)=>{H();var c=I().EventEmitter,d=w(function(){},"NOOP"),e=w((a,b)=>{let c=a.findIndex(b);return -1===c?void 0:a.splice(c,1)[0]},"removeWhere"),f=class{constructor(a,b,c){this.client=a,this.idleListener=b,this.timeoutId=c}};w(f,"IdleItem");var g=class{constructor(a){this.callback=a}};function h(){throw Error("Release called on client which has already been released to the pool.")}function i(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:w(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b}).catch(a=>{throw Error.captureStackTrace(a),a})}}function j(a,b){return w(function c(d){d.client=b,b.removeListener("error",c),b.on("error",()=>{a.log("additional client error after disconnection due to error",d)}),a._remove(b),a.emit("error",d,b)},"idleListener")}w(g,"PendingItem"),w(h,"throwOnDoubleRelease"),w(i,"promisify"),w(j,"makeIdleListener");var k=class extends c{constructor(a,b){super(),this.options=Object.assign({},a),null!=a&&"password"in a&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:a.password}),null!=a&&a.ssl&&a.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||b||a7().Client,this.Promise=this.options.Promise||l.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended)return void this.log("pulse queue ended");if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length)return void this.log("no queued requests");if(!this._idle.length&&this._isFull())return;let a=this._pendingQueue.shift();if(this._idle.length){let b=this._idle.pop();clearTimeout(b.timeoutId);let c=b.client;c.ref&&c.ref();let d=b.idleListener;return this._acquireClient(c,a,d,!1)}if(!this._isFull())return this.newClient(a);throw Error("unexpected condition")}_remove(a){let b=e(this._idle,b=>b.client===a);void 0!==b&&clearTimeout(b.timeoutId),this._clients=this._clients.filter(b=>b!==a),a.end(),this.emit("remove",a)}connect(a){if(this.ending){let b=Error("Cannot use a pool after calling end on the pool");return a?a(b):this.Promise.reject(b)}let b=i(this.Promise,a),c=b.result;if(this._isFull()||this._idle.length){if(this._idle.length&&p.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new g(b.callback)),c;let a=w((a,c,d)=>{clearTimeout(f),b.callback(a,c,d)},"queueCallback"),d=new g(a),f=setTimeout(()=>{e(this._pendingQueue,b=>b.callback===a),d.timedOut=!0,b.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(d),c}return this.newClient(new g(b.callback)),c}newClient(a){let b=new this.Client(this.options);this._clients.push(b);let c=j(this,b);this.log("checking client timeout");let e,f=!1;this.options.connectionTimeoutMillis&&(e=setTimeout(()=>{this.log("ending client due to timeout"),f=!0,b.connection?b.connection.stream.destroy():b.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),b.connect(h=>{if(e&&clearTimeout(e),b.on("error",c),h)this.log("client failed to connect",h),this._clients=this._clients.filter(a=>a!==b),f&&(h.message="Connection terminated due to connection timeout"),this._pulseQueue(),a.timedOut||a.callback(h,void 0,d);else{if(this.log("new client connected"),0!==this.options.maxLifetimeSeconds){let a=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(b),-1!==this._idle.findIndex(a=>a.client===b)&&this._acquireClient(b,new g((a,b,c)=>c()),c,!1)},1e3*this.options.maxLifetimeSeconds);a.unref(),b.once("end",()=>clearTimeout(a))}return this._acquireClient(b,a,c,!0)}})}_acquireClient(a,b,c,e){e&&this.emit("connect",a),this.emit("acquire",a),a.release=this._releaseOnce(a,c),a.removeListener("error",c),b.timedOut?e&&this.options.verify?this.options.verify(a,a.release):a.release():e&&this.options.verify?this.options.verify(a,c=>{if(c)return a.release(c),b.callback(c,void 0,d);b.callback(void 0,a,a.release)}):b.callback(void 0,a,a.release)}_releaseOnce(a,b){let c=!1;return d=>{c&&h(),c=!0,this._release(a,b,d)}}_release(a,b,c){let d;if(a.on("error",b),a._poolUseCount=(a._poolUseCount||0)+1,this.emit("release",c,a),c||this.ending||!a._queryable||a._ending||a._poolUseCount>=this.options.maxUses){a._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(a),this._pulseQueue();return}if(this._expired.has(a)){this.log("remove expired client"),this._expired.delete(a),this._remove(a),this._pulseQueue();return}this.options.idleTimeoutMillis&&(d=setTimeout(()=>{this.log("remove idle client"),this._remove(a)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&d.unref()),this.options.allowExitOnIdle&&a.unref(),this._idle.push(new f(a,b,d)),this._pulseQueue()}query(a,b,c){if("function"==typeof a){let b=i(this.Promise,a);return m(function(){return b.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),b.result}"function"==typeof b&&(c=b,b=void 0);let d=i(this.Promise,c);return c=d.callback,this.connect((d,e)=>{if(d)return c(d);let f=!1,g=w(a=>{f||(f=!0,e.release(a),c(a))},"onError");e.once("error",g),this.log("dispatching query");try{e.query(a,b,(a,b)=>{if(this.log("query dispatched"),e.removeListener("error",g),!f)return f=!0,e.release(a),a?c(a):c(void 0,b)})}catch(a){return e.release(a),c(a)}}),d.result}end(a){if(this.log("ending"),this.ending){let b=Error("Called end on pool more than once");return a?a(b):this.Promise.reject(b)}this.ending=!0;let b=i(this.Promise,a);return this._endCallback=b.callback,this._pulseQueue(),b.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((a,b)=>a+ +!!this._expired.has(b),0)}get totalCount(){return this._clients.length}};w(k,"Pool"),b.exports=k}),a0={};z(a0,{default:()=>a1});var a1,a2=x(()=>{H(),a1={}}),a3=y((a,b)=>{b.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),a4=y((a,b)=>{H();var c=I().EventEmitter,d=(L(),C(J)),e=ag(),f=b.exports=function(a,b,d){c.call(this),a=e.normalizeQueryConfig(a,b,d),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode="array"===a.rowMode,this._emitRowEvents=!1,this.on("newListener",(function(a){"row"===a&&(this._emitRowEvents=!0)}).bind(this))};d.inherits(f,c);var g={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};f.prototype.handleError=function(a){var b=this.native.pq.resultErrorFields();if(b)for(var c in b)a[g[c]||c]=b[c];this.callback?this.callback(a):this.emit("error",a),this.state="error"},f.prototype.then=function(a,b){return this._getPromise().then(a,b)},f.prototype.catch=function(a){return this._getPromise().catch(a)},f.prototype._getPromise=function(){return this._promise||(this._promise=new Promise((function(a,b){this._once("end",a),this._once("error",b)}).bind(this))),this._promise},f.prototype.submit=function(a){this.state="running";var b=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var c=w(function(c,d,e){if(a.native.arrayMode=!1,m(function(){b.emit("_done")}),c)return b.handleError(c);b._emitRowEvents&&(e.length>1?d.forEach((a,c)=>{a.forEach(a=>{b.emit("row",a,e[c])})}):d.forEach(function(a){b.emit("row",a,e)})),b.state="end",b.emit("end",e),b.callback&&b.callback(null,e)},"after");if(p.domain&&(c=p.domain.bind(c)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var d=(this.values||[]).map(e.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let a=Error(`Pre\
pared statements must be unique - '${this.name}' was used for a different statem\
ent`);return c(a)}return a.native.execute(this.name,d,c)}return a.native.prepare(this.name,this.text,d.length,function(e){return e?c(e):(a.namedQueries[b.name]=b.text,b.native.execute(b.name,d,c))})}if(this.values){if(!Array.isArray(this.values)){let a=Error("Query values must be an array");return c(a)}var f=this.values.map(e.prepareValue);a.native.query(this.text,f,c)}else a.native.query(this.text,c)}}),a5=y((a,b)=>{H();var c=(a2(),C(a0)),d=ay(),e=(a3(),I().EventEmitter),f=(L(),C(J)),g=aG(),h=a4(),i=b.exports=function(a){e.call(this),a=a||{},this._Promise=a.Promise||l.Promise,this._types=new d(a.types),this.native=new c({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var b=this.connectionParameters=new g(a);this.user=b.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:b.password}),this.database=b.database,this.host=b.host,this.port=b.port,this.namedQueries={}};i.Query=h,f.inherits(i,e),i.prototype._errorAllQueries=function(a){let b=w(b=>{p.nextTick(()=>{b.native=this.native,b.handleError(a)})},"enqueueError");this._hasActiveQuery()&&(b(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(b),this._queryQueue.length=0},i.prototype._connect=function(a){var b=this;this._connecting?p.nextTick(()=>a(Error("Client has already been connected. You cannot reuse a client."))):(this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(c,d){if(c)return a(c);b.native.connect(d,function(c){if(c)return b.native.end(),a(c);b._connected=!0,b.native.on("error",function(a){b._queryable=!1,b._errorAllQueries(a),b.emit("error",a)}),b.native.on("notification",function(a){b.emit("notification",{channel:a.relname,payload:a.extra})}),b.emit("connect"),b._pulseQueryQueue(!0),a()})}))},i.prototype.connect=function(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})},i.prototype.query=function(a,b,c){var d,e,f,g,i;if(null==a)throw TypeError("Client was passed a null or undefined query");if("function"==typeof a.submit)f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(a.callback=b);else if(f=this.connectionParameters.query_timeout,!(d=new h(a,b,c)).callback){let a,b;e=new this._Promise((c,d)=>{a=c,b=d}),d.callback=(c,d)=>c?b(c):a(d)}return f&&(i=d.callback,g=setTimeout(()=>{var a=Error("Query read timeout");p.nextTick(()=>{d.handleError(a,this.connection)}),i(a),d.callback=()=>{};var b=this._queryQueue.indexOf(d);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(g),i(a,b)}),this._queryable?this._ending?(d.native=this.native,p.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"))})):(this._queryQueue.push(d),this._pulseQueryQueue()):(d.native=this.native,p.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"))})),e},i.prototype.end=function(a){var b,c=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,a)),a||(b=new this._Promise(function(b,c){a=w(a=>a?c(a):b(),"cb")})),this.native.end(function(){c._errorAllQueries(Error("Connection terminated")),p.nextTick(()=>{c.emit("end"),a&&a()})}),b},i.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},i.prototype._pulseQueryQueue=function(a){if(this._connected&&!this._hasActiveQuery()){var b=this._queryQueue.shift();if(!b){a||this.emit("drain");return}this._activeQuery=b,b.submit(this);var c=this;b.once("_done",function(){c._pulseQueryQueue()})}},i.prototype.cancel=function(a){this._activeQuery===a?this.native.cancel(function(){}):-1!==this._queryQueue.indexOf(a)&&this._queryQueue.splice(this._queryQueue.indexOf(a),1)},i.prototype.ref=function(){},i.prototype.unref=function(){},i.prototype.setTypeParser=function(a,b,c){return this._types.setTypeParser(a,b,c)},i.prototype.getTypeParser=function(a,b){return this._types.getTypeParser(a,b)}}),a6=y((a,b)=>{H(),b.exports=a5()}),a7=y((a,b)=>{H();var c=a$(),d=af(),e=aZ(),f=a_(),{DatabaseError:g}=aV(),h=w(a=>{var b;return w(b=class extends f{constructor(b){super(b,a)}},"BoundPool"),b},"poolFactory"),i=w(function(a){this.defaults=d,this.Client=a,this.Query=this.Client.Query,this.Pool=h(this.Client),this._pools=[],this.Connection=e,this.types=ae(),this.DatabaseError=g},"PG");"u">typeof p.env.NODE_PG_FORCE_NATIVE?b.exports=new i(a6()):(b.exports=new i(c),Object.defineProperty(b.exports,"native",{configurable:!0,enumerable:!1,get(){var a=null;try{a=new i(a6())}catch(a){if("MODULE_NOT_FOUND"!==a.code)throw a}return Object.defineProperty(b.exports,"native",{value:a}),a}}))});H();var a8=B(a7());aP(),H(),aP(),aE();var a9=B(ag()),ba=B(ay());function bb(a){return a instanceof o?"\\x"+a.toString("hex"):a}w(bb,"encodeBuffersAsBytea");var bc=class a extends Error{constructor(b){super(b),D(this,"name","NeonDbError"),D(this,"severity"),D(this,"code"),D(this,"detail"),D(this,"hint"),D(this,"position"),D(this,"internalPosition"),D(this,"internalQuery"),D(this,"where"),D(this,"schema"),D(this,"table"),D(this,"column"),D(this,"dataType"),D(this,"constraint"),D(this,"file"),D(this,"line"),D(this,"routine"),D(this,"sourceError"),"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}};w(bc,"NeonDbError");var bd="transaction() expects an array of queries, or a function returning an array of queries",be=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function bf(a,{arrayMode:b,fullResults:c,fetchOptions:d,isolationLevel:e,readOnly:f,deferrable:g,queryCallback:h,resultCallback:i,authToken:j}={}){let k;if(!a)throw Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");try{k=aD(a)}catch{throw Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(a))}let{protocol:l,username:m,hostname:n,port:o,pathname:p}=k;if("postgres:"!==l&&"postgresql:"!==l||!m||!n||!p)throw Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function q(a,...b){let c,d;if("string"==typeof a)c=a,d=b[1],b=b[0]??[];else{c="";for(let d=0;d<a.length;d++)c+=a[d],d<b.length&&(c+="$"+(d+1))}let e={query:c,params:b=b.map(a=>bb((0,a9.prepareValue)(a)))};return h&&h(e),bg(r,e,d)}async function r(h,k,l){let m,{fetchEndpoint:p,fetchFunction:q}=aO,r=Array.isArray(h)?{queries:h}:h,s=d??{},t=b??!1,u=c??!1,v=e,w=f,x=g;void 0!==l&&(void 0!==l.fetchOptions&&(s={...s,...l.fetchOptions}),void 0!==l.arrayMode&&(t=l.arrayMode),void 0!==l.fullResults&&(u=l.fullResults),void 0!==l.isolationLevel&&(v=l.isolationLevel),void 0!==l.readOnly&&(w=l.readOnly),void 0!==l.deferrable&&(x=l.deferrable)),void 0===k||Array.isArray(k)||void 0===k.fetchOptions||(s={...s,...k.fetchOptions});let y=j;Array.isArray(k)||k?.authToken===void 0||(y=k.authToken);let z="function"==typeof p?p(n,o,{jwtAuth:void 0!==y}):p,A={"Neon-Connection-String":a,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},B=await bi(y);B&&(A.Authorization=`Bearer ${B}`),Array.isArray(h)&&(void 0!==v&&(A["Neon-Batch-Isolation-Level"]=v),void 0!==w&&(A["Neon-Batch-Read-Only"]=String(w)),void 0!==x&&(A["Neon-Batch-Deferrable"]=String(x)));try{m=await (q??fetch)(z,{method:"POST",body:JSON.stringify(r),headers:A,...s})}catch(b){let a=new bc(`Error connecting to database: ${b.message}`);throw a.sourceError=b,a}if(m.ok){let a=await m.json();if(Array.isArray(h)){let b=a.results;if(!Array.isArray(b))throw new bc("Neon internal error: unexpected result format");return b.map((a,b)=>{let c=k[b]??{};return bh(a,{arrayMode:c.arrayMode??t,fullResults:c.fullResults??u,parameterizedQuery:h[b],resultCallback:i,types:c.types})})}{let b=k??{};return bh(a,{arrayMode:b.arrayMode??t,fullResults:b.fullResults??u,parameterizedQuery:h,resultCallback:i,types:b.types})}}{let{status:a}=m;if(400===a){let a=await m.json(),b=new bc(a.message);for(let c of be)b[c]=a[c]??void 0;throw b}{let b=await m.text();throw new bc(`Server er\
ror (HTTP status ${a}): ${b}`)}}}return w(q,"resolve"),q.transaction=async(a,b)=>{if("function"==typeof a&&(a=a(q)),!Array.isArray(a))throw Error(bd);return a.forEach(a=>{if("NeonQueryPromise"!==a[Symbol.toStringTag])throw Error(bd)}),r(a.map(a=>a.parameterizedQuery),a.map(a=>a.opts??{}),b)},w(r,"execute"),q}function bg(a,b,c){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:b,opts:c,then:w((d,e)=>a(b,c).then(d,e),"then"),catch:w(d=>a(b,c).catch(d),"catch"),finally:w(d=>a(b,c).finally(d),"finally")}}function bh(a,{arrayMode:b,fullResults:c,parameterizedQuery:d,resultCallback:e,types:f}){let g=new ba.default(f),h=a.fields.map(a=>a.name),i=a.fields.map(a=>g.getTypeParser(a.dataTypeID)),j=!0===b?a.rows.map(a=>a.map((a,b)=>null===a?null:i[b](a))):a.rows.map(a=>Object.fromEntries(a.map((a,b)=>[h[b],null===a?null:i[b](a)])));return e&&e(d,a,j,{arrayMode:b,fullResults:c}),c?(a.viaNeonFetch=!0,a.rowAsArray=b,a.rows=j,a._parsers=i,a._types=g,a):j}async function bi(a){if("string"==typeof a)return a;if("function"==typeof a)try{return await Promise.resolve(a())}catch(b){let a=new bc("Error getting auth token.");throw b instanceof Error&&(a=new bc(`Error getting auth toke\
n: ${b.message}`)),a}}w(bf,"neon"),w(bg,"createNeonQueryPromise"),w(bh,"processQueryResult"),w(bi,"getAuthToken");var bj=B(aG()),bk=B(a7()),bl=class extends a8.Client{constructor(a){super(a),this.config=a}get neonConfig(){return this.connection.stream}connect(a){let{neonConfig:b}=this;b.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&b.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let c=this.config?.host!==void 0||this.config?.connectionString!==void 0||void 0!==p.env.PGHOST,d=p.env.USER??p.env.USERNAME;if(!c&&"localhost"===this.host&&this.user===d&&this.database===d&&null===this.password)throw Error(`No datab\
ase host or connection string was set, and key parameters have default values (h\
ost: localhost, user: ${d}, db: ${d}, password: null). Is an environment variabl\
e missing? Alternatively, if you intended to connect with these parameters, plea\
se set the host to 'localhost' explicitly.`);let e=super.connect(a),f=b.pipelineTLS&&this.ssl,g="password"===b.pipelineConnect;if(!f&&!b.pipelineConnect)return e;let h=this.connection;if(f&&h.on("connect",()=>h.stream.emit("data","S")),g){h.removeAllListeners("authenticationCleartextPassword"),h.removeAllListeners("readyForQuery"),h.once("readyForQuery",()=>h.on("readyForQuery",this._handleReadyForQuery.bind(this)));let a=this.ssl?"sslconnect":"connect";h.on(a,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return e}async _handleAuthSASLContinue(a){let b=this.saslSession,c=this.password,d=a.data;if("SASLInitialResponse"!==b.message||"string"!=typeof c||"string"!=typeof d)throw Error("SASL: protocol error");let e=Object.fromEntries(d.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]})),f=e.r,g=e.s,h=e.i;if(!f||!/^[!-+--~]+$/.test(f))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!g||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(g))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!h||!/^[1-9][0-9]*$/.test(h))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!f.startsWith(b.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(f.length===b.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let i=parseInt(h,10),j=o.from(g,"base64"),k=new TextEncoder,l=k.encode(c),m=await n.subtle.importKey("raw",l,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),p=new Uint8Array(await n.subtle.sign("HMAC",m,o.concat([j,o.from([0,0,0,1])]))),q=p;for(var r=0;r<i-1;r++)p=new Uint8Array(await n.subtle.sign("HMAC",m,p)),q=o.from(q.map((a,b)=>q[b]^p[b]));let s=q,t=await n.subtle.importKey("raw",s,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),u=new Uint8Array(await n.subtle.sign("HMAC",t,k.encode("Client Key"))),v=await n.subtle.digest("SHA-256",u),w="n=*,r="+b.clientNonce,x="r="+f+",s="+g+",i="+i,y="c=biws,r="+f,z=w+","+x+","+y,A=await n.subtle.importKey("raw",v,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var B=new Uint8Array(await n.subtle.sign("HMAC",A,k.encode(z))),C=o.from(u.map((a,b)=>u[b]^B[b])).toString("base64");let D=await n.subtle.importKey("raw",s,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),E=await n.subtle.sign("HMAC",D,k.encode("Server Key")),F=await n.subtle.importKey("raw",E,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var G=o.from(await n.subtle.sign("HMAC",F,k.encode(z)));b.message="SASLResponse",b.serverSignature=G.toString("base64"),b.response=y+",p="+C,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};function bm(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:w(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b})}}w(bl,"NeonClient"),w(bm,"promisify");var bn=class extends a8.Pool{constructor(){super(...arguments),D(this,"Client",bl),D(this,"hasFetchUnsupportedListeners",!1)}on(a,b){return"error"!==a&&(this.hasFetchUnsupportedListeners=!0),super.on(a,b)}query(a,b,c){if(!aO.poolQueryViaFetch||this.hasFetchUnsupportedListeners||"function"==typeof a)return super.query(a,b,c);"function"==typeof b&&(c=b,b=void 0);let d=bm(this.Promise,c);c=d.callback;try{let d=new bj.default(this.options),e=encodeURIComponent,f=encodeURI,g=`postgresql://${e(d.user)}:${e(d.password)}@${e(d.host)}/${f(d.database)}`,h="string"==typeof a?a:a.text,i=b??a.values??[];bf(g,{fullResults:!0,arrayMode:"array"===a.rowMode})(h,i,{types:a.types??this.options?.types}).then(a=>c(void 0,a)).catch(a=>c(a))}catch(a){c(a)}return d.result}};w(bn,"NeonPool"),bk.ClientBase,bk.Connection,bk.DatabaseError,bk.Query,bk.defaults;var bo=bk.types;a.s(["Pool",()=>bn,"neonConfig",()=>aO,"types",()=>bo],546767);var bp=a.i(163227),bq=a.i(417981),br=a.i(907484),bs=a.i(777001),bt=a.i(494415),bu=a.i(351674),bv=a.i(704501),bw=a.i(355280);class bx{static [bp.entityKind]="SelectionProxyHandler";config;constructor(a){this.config={...a}}get(a,b){if("_"===b)return{...a._,selectedFields:new Proxy(a._.selectedFields,this)};if(b===bw.ViewBaseConfig)return{...a[bw.ViewBaseConfig],selectedFields:new Proxy(a[bw.ViewBaseConfig].selectedFields,this)};if("symbol"==typeof b)return a[b];let c=((0,bp.is)(a,bv.Subquery)?a._.selectedFields:(0,bp.is)(a,bu.View)?a[bw.ViewBaseConfig].selectedFields:a)[b];if((0,bp.is)(c,bu.SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!c.isSelectionField)return c.sql;let a=c.clone();return a.isSelectionField=!0,a}if((0,bp.is)(c,bu.SQL)){if("sql"===this.config.sqlBehavior)return c;throw Error(`You tried to reference "${b}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,bp.is)(c,bt.Column)?this.config.alias?new Proxy(c,new bs.ColumnAliasProxyHandler(new Proxy(c.table,new bs.TableAliasProxyHandler(this.config.alias,this.config.replaceOriginalName??!1)))):c:"object"!=typeof c||null===c?c:new Proxy(c,new bx(this.config))}}var by=a.i(420713),bz=a.i(84113),bA=a.i(844551);class bB extends br.QueryPromise{constructor(a,b,c,d){super(),this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [bp.entityKind]="PgDelete";config;where(a){return this.config.where=a,this}returning(a=this.config.table[by.Table.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=(0,bA.orderSelectedFields)(a),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return bz.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bz.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new bx({alias:(0,by.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var bC=br;function bD(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(a=>a.toLowerCase()).join("_")}function bE(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((a,b,c)=>a+(0===c?b.toLowerCase():`${b[0].toUpperCase()}${b.slice(1)}`),"")}function bF(a){return a}class bG{static [bp.entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(a){this.convert="snake_case"===a?bD:"camelCase"===a?bE:bF}getColumnCasing(a){if(!a.keyAsName)return a.name;let b=a.table[by.Table.Symbol.Schema]??"public",c=a.table[by.Table.Symbol.OriginalName],d=`${b}.${c}.${a.name}`;return this.cache[d]||this.cacheTable(a.table),this.cache[d]}cacheTable(a){let b=a[by.Table.Symbol.Schema]??"public",c=a[by.Table.Symbol.OriginalName],d=`${b}.${c}`;if(!this.cachedTables[d]){for(let b of Object.values(a[by.Table.Symbol.Columns])){let a=`${d}.${b.name}`;this.cache[a]=this.convert(b.name)}this.cachedTables[d]=!0}}clearCache(){this.cache={},this.cachedTables={}}}var bH=a.i(911832),bI=a.i(905302),bJ=a.i(97122),bK=a.i(356564),bL=a.i(383217),bM=a.i(890714),bN=a.i(800952),bO=a.i(99450),bP=a.i(731793),bQ=a.i(657833),bR=a.i(68540),bS=a.i(93321),bT=bu;class bU extends bT.View{static [bp.entityKind]="PgViewBase"}class bV{static [bp.entityKind]="PgDialect";casing;constructor(a){this.casing=new bG(a?.casing)}async migrate(a,b,c){let d="string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",e="string"==typeof c?"drizzle":c.migrationsSchema??"drizzle",f=bu.sql`
			CREATE TABLE IF NOT EXISTS ${bu.sql.identifier(e)}.${bu.sql.identifier(d)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await b.execute(bu.sql`CREATE SCHEMA IF NOT EXISTS ${bu.sql.identifier(e)}`),await b.execute(f);let g=(await b.all(bu.sql`select id, hash, created_at from ${bu.sql.identifier(e)}.${bu.sql.identifier(d)} order by created_at desc limit 1`))[0];await b.transaction(async b=>{for await(let c of a)if(!g||Number(g.created_at)<c.folderMillis){for(let a of c.sql)await b.execute(bu.sql.raw(a));await b.execute(bu.sql`insert into ${bu.sql.identifier(e)}.${bu.sql.identifier(d)} ("hash", "created_at") values(${c.hash}, ${c.folderMillis})`)}})}escapeName(a){return`"${a}"`}escapeParam(a){return`$${a+1}`}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[bu.sql`with `];for(let[c,d]of a.entries())b.push(bu.sql`${bu.sql.identifier(d._.alias)} as (${d._.sql})`),c<a.length-1&&b.push(bu.sql`, `);return b.push(bu.sql` `),bu.sql.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:d}){let e=this.buildWithCTE(d),f=c?bu.sql` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,g=b?bu.sql` where ${b}`:void 0;return bu.sql`${e}delete from ${a}${g}${f}`}buildUpdateSet(a,b){let c=a[by.Table.Symbol.Columns],d=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),e=d.length;return bu.sql.join(d.flatMap((a,d)=>{let f=c[a],g=b[a]??bu.sql.param(f.onUpdateFn(),f),h=bu.sql`${bu.sql.identifier(this.casing.getColumnCasing(f))} = ${g}`;return d<e-1?[h,bu.sql.raw(", ")]:[h]}))}buildUpdateQuery({table:a,set:b,where:c,returning:d,withList:e,from:f,joins:g}){let h=this.buildWithCTE(e),i=a[bQ.PgTable.Symbol.Name],j=a[bQ.PgTable.Symbol.Schema],k=a[bQ.PgTable.Symbol.OriginalName],l=i===k?void 0:i,m=bu.sql`${j?bu.sql`${bu.sql.identifier(j)}.`:void 0}${bu.sql.identifier(k)}${l&&bu.sql` ${bu.sql.identifier(l)}`}`,n=this.buildUpdateSet(a,b),o=f&&bu.sql.join([bu.sql.raw(" from "),this.buildFromTable(f)]),p=this.buildJoins(g),q=d?bu.sql` returning ${this.buildSelection(d,{isSingleTable:!f})}`:void 0,r=c?bu.sql` where ${c}`:void 0;return bu.sql`${h}update ${m} set ${n}${o}${p}${r}${q}`}buildSelection(a,{isSingleTable:b=!1}={}){let c=a.length,d=a.flatMap(({field:a},d)=>{let e=[];if((0,bp.is)(a,bu.SQL.Aliased)&&a.isSelectionField)e.push(bu.sql.identifier(a.fieldAlias));else if((0,bp.is)(a,bu.SQL.Aliased)||(0,bp.is)(a,bu.SQL)){let c=(0,bp.is)(a,bu.SQL.Aliased)?a.sql:a;b?e.push(new bu.SQL(c.queryChunks.map(a=>(0,bp.is)(a,bI.PgColumn)?bu.sql.identifier(this.casing.getColumnCasing(a)):a))):e.push(c),(0,bp.is)(a,bu.SQL.Aliased)&&e.push(bu.sql` as ${bu.sql.identifier(a.fieldAlias)}`)}else(0,bp.is)(a,bt.Column)&&(b?e.push(bu.sql.identifier(this.casing.getColumnCasing(a))):e.push(a));return d<c-1&&e.push(bu.sql`, `),e});return bu.sql.join(d)}buildJoins(a){if(!a||0===a.length)return;let b=[];for(let[c,d]of a.entries()){0===c&&b.push(bu.sql` `);let e=d.table,f=d.lateral?bu.sql` lateral`:void 0;if((0,bp.is)(e,bQ.PgTable)){let a=e[bQ.PgTable.Symbol.Name],c=e[bQ.PgTable.Symbol.Schema],g=e[bQ.PgTable.Symbol.OriginalName],h=a===g?void 0:d.alias;b.push(bu.sql`${bu.sql.raw(d.joinType)} join${f} ${c?bu.sql`${bu.sql.identifier(c)}.`:void 0}${bu.sql.identifier(g)}${h&&bu.sql` ${bu.sql.identifier(h)}`} on ${d.on}`)}else if((0,bp.is)(e,bu.View)){let a=e[bw.ViewBaseConfig].name,c=e[bw.ViewBaseConfig].schema,g=e[bw.ViewBaseConfig].originalName,h=a===g?void 0:d.alias;b.push(bu.sql`${bu.sql.raw(d.joinType)} join${f} ${c?bu.sql`${bu.sql.identifier(c)}.`:void 0}${bu.sql.identifier(g)}${h&&bu.sql` ${bu.sql.identifier(h)}`} on ${d.on}`)}else b.push(bu.sql`${bu.sql.raw(d.joinType)} join${f} ${e} on ${d.on}`);c<a.length-1&&b.push(bu.sql` `)}return bu.sql.join(b)}buildFromTable(a){if((0,bp.is)(a,by.Table)&&a[by.Table.Symbol.OriginalName]!==a[by.Table.Symbol.Name]){let b=bu.sql`${bu.sql.identifier(a[by.Table.Symbol.OriginalName])}`;return a[by.Table.Symbol.Schema]&&(b=bu.sql`${bu.sql.identifier(a[by.Table.Symbol.Schema])}.${b}`),bu.sql`${b} ${bu.sql.identifier(a[by.Table.Symbol.Name])}`}return a}buildSelectQuery({withList:a,fields:b,fieldsFlat:c,where:d,having:e,table:f,joins:g,orderBy:h,groupBy:i,limit:j,offset:k,lockingClause:l,distinct:m,setOperators:n}){let o,p,q,r=c??(0,bA.orderSelectedFields)(b);for(let a of r){let b;if((0,bp.is)(a.field,bt.Column)&&(0,by.getTableName)(a.field.table)!==((0,bp.is)(f,bv.Subquery)?f._.alias:(0,bp.is)(f,bU)?f[bw.ViewBaseConfig].name:(0,bp.is)(f,bu.SQL)?void 0:(0,by.getTableName)(f))&&(b=a.field.table,!g?.some(({alias:a})=>a===(b[by.Table.Symbol.IsAlias]?(0,by.getTableName)(b):b[by.Table.Symbol.BaseName])))){let b=(0,by.getTableName)(a.field.table);throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let s=!g||0===g.length,t=this.buildWithCTE(a);m&&(o=!0===m?bu.sql` distinct`:bu.sql` distinct on (${bu.sql.join(m.on,bu.sql`, `)})`);let u=this.buildSelection(r,{isSingleTable:s}),v=this.buildFromTable(f),w=this.buildJoins(g),x=d?bu.sql` where ${d}`:void 0,y=e?bu.sql` having ${e}`:void 0;h&&h.length>0&&(p=bu.sql` order by ${bu.sql.join(h,bu.sql`, `)}`),i&&i.length>0&&(q=bu.sql` group by ${bu.sql.join(i,bu.sql`, `)}`);let z="object"==typeof j||"number"==typeof j&&j>=0?bu.sql` limit ${j}`:void 0,A=k?bu.sql` offset ${k}`:void 0,B=bu.sql.empty();if(l){let a=bu.sql` for ${bu.sql.raw(l.strength)}`;l.config.of&&a.append(bu.sql` of ${bu.sql.join(Array.isArray(l.config.of)?l.config.of:[l.config.of],bu.sql`, `)}`),l.config.noWait?a.append(bu.sql` no wait`):l.config.skipLocked&&a.append(bu.sql` skip locked`),B.append(a)}let C=bu.sql`${t}select${o} ${u} from ${v}${w}${x}${q}${y}${p}${z}${A}${B}`;return n.length>0?this.buildSetOperations(C,n):C}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:b,isAll:c,rightSelect:d,limit:e,orderBy:f,offset:g}}){let h,i=bu.sql`(${a.getSQL()}) `,j=bu.sql`(${d.getSQL()})`;if(f&&f.length>0){let a=[];for(let b of f)if((0,bp.is)(b,bI.PgColumn))a.push(bu.sql.identifier(b.name));else if((0,bp.is)(b,bu.SQL)){for(let a=0;a<b.queryChunks.length;a++){let c=b.queryChunks[a];(0,bp.is)(c,bI.PgColumn)&&(b.queryChunks[a]=bu.sql.identifier(c.name))}a.push(bu.sql`${b}`)}else a.push(bu.sql`${b}`);h=bu.sql` order by ${bu.sql.join(a,bu.sql`, `)} `}let k="object"==typeof e||"number"==typeof e&&e>=0?bu.sql` limit ${e}`:void 0,l=bu.sql.raw(`${b} ${c?"all ":""}`),m=g?bu.sql` offset ${g}`:void 0;return bu.sql`${i}${l}${j}${h}${k}${m}`}buildInsertQuery({table:a,values:b,onConflict:c,returning:d,withList:e,select:f,overridingSystemValue_:g}){let h=[],i=Object.entries(a[by.Table.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),j=i.map(([,a])=>bu.sql.identifier(this.casing.getColumnCasing(a)));if(f)(0,bp.is)(b,bu.SQL)?h.push(b):h.push(b.getSQL());else for(let[a,c]of(h.push(bu.sql.raw("values ")),b.entries())){let d=[];for(let[a,b]of i){let e=c[a];if(void 0===e||(0,bp.is)(e,bu.Param)&&void 0===e.value)if(void 0!==b.defaultFn){let a=b.defaultFn(),c=(0,bp.is)(a,bu.SQL)?a:bu.sql.param(a,b);d.push(c)}else if(b.default||void 0===b.onUpdateFn)d.push(bu.sql`default`);else{let a=b.onUpdateFn(),c=(0,bp.is)(a,bu.SQL)?a:bu.sql.param(a,b);d.push(c)}else d.push(e)}h.push(d),a<b.length-1&&h.push(bu.sql`, `)}let k=this.buildWithCTE(e),l=bu.sql.join(h),m=d?bu.sql` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,n=c?bu.sql` on conflict ${c}`:void 0,o=!0===g?bu.sql`overriding system value `:void 0;return bu.sql`${k}insert into ${a} ${j} ${o}${l}${n}${m}`}buildRefreshMaterializedViewQuery({view:a,concurrently:b,withNoData:c}){let d=b?bu.sql` concurrently`:void 0,e=c?bu.sql` with no data`:void 0;return bu.sql`refresh materialized view${d} ${a}${e}`}prepareTyping(a){if((0,bp.is)(a,bL.PgJsonb)||(0,bp.is)(a,bK.PgJson))return"json";if((0,bp.is)(a,bM.PgNumeric))return"decimal";if((0,bp.is)(a,bN.PgTime))return"time";if((0,bp.is)(a,bO.PgTimestamp)||(0,bp.is)(a,bO.PgTimestampString))return"timestamp";if((0,bp.is)(a,bJ.PgDate)||(0,bp.is)(a,bJ.PgDateString))return"date";else if((0,bp.is)(a,bP.PgUUID))return"uuid";else return"none"}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:b})}buildRelationalQueryWithoutPK({fullSchema:a,schema:b,tableNamesMap:c,table:d,tableConfig:e,queryConfig:f,tableAlias:g,nestedQueryRelation:h,joinOn:i}){let j,k=[],l,m,n=[],o,p=[];if(!0===f)k=Object.entries(e.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:(0,bs.aliasedTableColumn)(b,g),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let d=Object.fromEntries(Object.entries(e.columns).map(([a,b])=>[a,(0,bs.aliasedTableColumn)(b,g)]));if(f.where){let a="function"==typeof f.where?f.where(d,(0,bR.getOperators)()):f.where;o=a&&(0,bs.mapColumnsInSQLToAlias)(a,g)}let h=[],i=[];if(f.columns){let a=!1;for(let[b,c]of Object.entries(f.columns))void 0!==c&&b in e.columns&&(a||!0!==c||(a=!0),i.push(b));i.length>0&&(i=a?i.filter(a=>f.columns?.[a]===!0):Object.keys(e.columns).filter(a=>!i.includes(a)))}else i=Object.keys(e.columns);for(let a of i){let b=e.columns[a];h.push({tsKey:a,value:b})}let j=[];if(f.with&&(j=Object.entries(f.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:e.relations[a]}))),f.extras)for(let[a,b]of Object.entries("function"==typeof f.extras?f.extras(d,{sql:bu.sql}):f.extras))h.push({tsKey:a,value:(0,bs.mapColumnsInAliasedSQLToAlias)(b,g)});for(let{tsKey:a,value:b}of h)k.push({dbKey:(0,bp.is)(b,bu.SQL.Aliased)?b.fieldAlias:e.columns[a].name,tsKey:a,field:(0,bp.is)(b,bt.Column)?(0,bs.aliasedTableColumn)(b,g):b,relationTableTsKey:void 0,isJson:!1,selection:[]});let q="function"==typeof f.orderBy?f.orderBy(d,(0,bR.getOrderByOperators)()):f.orderBy??[];for(let{tsKey:d,queryConfig:e,relation:h}of(Array.isArray(q)||(q=[q]),n=q.map(a=>(0,bp.is)(a,bt.Column)?(0,bs.aliasedTableColumn)(a,g):(0,bs.mapColumnsInSQLToAlias)(a,g)),l=f.limit,m=f.offset,j)){let f=(0,bR.normalizeRelation)(b,c,h),i=c[(0,by.getTableUniqueName)(h.referencedTable)],j=`${g}_${d}`,l=(0,bS.and)(...f.fields.map((a,b)=>(0,bS.eq)((0,bs.aliasedTableColumn)(f.references[b],j),(0,bs.aliasedTableColumn)(a,g)))),m=this.buildRelationalQueryWithoutPK({fullSchema:a,schema:b,tableNamesMap:c,table:a[i],tableConfig:b[i],queryConfig:(0,bp.is)(h,bR.One)?!0===e?{limit:1}:{...e,limit:1}:e,tableAlias:j,joinOn:l,nestedQueryRelation:h}),n=bu.sql`${bu.sql.identifier(j)}.${bu.sql.identifier("data")}`.as(d);p.push({on:bu.sql`true`,table:new bv.Subquery(m.sql,{},j),alias:j,joinType:"left",lateral:!0}),k.push({dbKey:d,tsKey:d,field:n,relationTableTsKey:i,isJson:!0,selection:m.selection})}}if(0===k.length)throw new bH.DrizzleError({message:`No fields selected for table "${e.tsName}" ("${g}")`});if(o=(0,bS.and)(i,o),h){let a=bu.sql`json_build_array(${bu.sql.join(k.map(({field:a,tsKey:b,isJson:c})=>c?bu.sql`${bu.sql.identifier(`${g}_${b}`)}.${bu.sql.identifier("data")}`:(0,bp.is)(a,bu.SQL.Aliased)?a.sql:a),bu.sql`, `)})`;(0,bp.is)(h,bR.Many)&&(a=bu.sql`coalesce(json_agg(${a}${n.length>0?bu.sql` order by ${bu.sql.join(n,bu.sql`, `)}`:void 0}), '[]'::json)`);let b=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:e.tsName,selection:k}];void 0!==l||void 0!==m||n.length>0?(j=this.buildSelectQuery({table:(0,bs.aliasedTable)(d,g),fields:{},fieldsFlat:[{path:[],field:bu.sql.raw("*")}],where:o,limit:l,offset:m,orderBy:n,setOperators:[]}),o=void 0,l=void 0,m=void 0,n=[]):j=(0,bs.aliasedTable)(d,g),j=this.buildSelectQuery({table:(0,bp.is)(j,bQ.PgTable)?j:new bv.Subquery(j,{},g),fields:{},fieldsFlat:b.map(({field:a})=>({path:[],field:(0,bp.is)(a,bt.Column)?(0,bs.aliasedTableColumn)(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]})}else j=this.buildSelectQuery({table:(0,bs.aliasedTable)(d,g),fields:{},fieldsFlat:k.map(({field:a})=>({path:[],field:(0,bp.is)(a,bt.Column)?(0,bs.aliasedTableColumn)(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]});return{tableTsKey:e.tsName,sql:j,selection:k}}}class bW{static [bp.entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class bX{static [bp.entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,a.withList&&(this.withList=a.withList),this.distinct=a.distinct}authToken;setToken(a){return this.authToken=a,this}from(a){let b,c=!!this.fields;return b=this.fields?this.fields:(0,bp.is)(a,bv.Subquery)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):(0,bp.is)(a,bU)?a[bw.ViewBaseConfig].selectedFields:(0,bp.is)(a,bu.SQL)?{}:(0,bA.getTableColumns)(a),new bZ({table:a,fields:b,isPartialSelect:c,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class bY extends bW{static [bp.entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g}){super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[]},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b},this.tableName=(0,bA.getTableLikeName)(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(a){return(b,c)=>{let d=this.tableName,e=(0,bA.getTableLikeName)(b);if("string"==typeof e&&this.config.joins?.some(a=>a.alias===e))throw Error(`Alias "${e}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof d&&(this.config.fields={[d]:this.config.fields}),"string"==typeof e&&!(0,bp.is)(b,bu.SQL))){let a=(0,bp.is)(b,bv.Subquery)?b._.selectedFields:(0,bp.is)(b,bu.View)?b[bw.ViewBaseConfig].selectedFields:b[by.Table.Symbol.Columns];this.config.fields[e]=a}if("function"==typeof c&&(c=c(new Proxy(this.config.fields,new bx({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:c,table:b,joinType:a,alias:e}),"string"==typeof e)switch(a){case"left":this.joinsNotNullableMap[e]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[e]=!0;break;case"inner":this.joinsNotNullableMap[e]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[e]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(a,b){return c=>{let d="function"==typeof c?c(b_()):c;if(!(0,bA.haveSameKeys)(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bx({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bx({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bx({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bx({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=c:this.config.orderBy=c}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}for(a,b={}){return this.config.lockingClause={strength:a,config:b},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){return new Proxy(new bv.Subquery(this.getSQL(),this.config.fields,a),new bx({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new bx({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class bZ extends bY{static [bp.entityKind]="PgSelect";_prepare(a){let{session:b,config:c,dialect:d,joinsNotNullableMap:e,authToken:f}=this;if(!b)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return bz.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let g=(0,bA.orderSelectedFields)(c.fields),h=b.prepareQuery(d.sqlToQuery(this.getSQL()),g,a,!0);return h.joinsNotNullableMap=e,h.setToken(f)})}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bz.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}function b$(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!(0,bA.haveSameKeys)(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}(0,bA.applyMixins)(bZ,[br.QueryPromise]);let b_=()=>({union:b0,unionAll:b1,intersect:b2,intersectAll:b3,except:b4,exceptAll:b5}),b0=b$("union",!1),b1=b$("union",!0),b2=b$("intersect",!1),b3=b$("intersect",!0),b4=b$("except",!1),b5=b$("except",!0);class b6{static [bp.entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=(0,bp.is)(a,bV)?a:void 0,this.dialectConfig=(0,bp.is)(a,bV)?void 0:a}$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(c)),new Proxy(new bv.WithSubquery(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bx({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new bX({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(a){return new bX({fields:a??void 0,session:void 0,dialect:b.getDialect(),distinct:!0})},selectDistinctOn:function(a,c){return new bX({fields:c??void 0,session:void 0,dialect:b.getDialect(),distinct:{on:a}})}}}select(a){return new bX({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new bX({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(a,b){return new bX({fields:b??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:a}})}getDialect(){return this.dialect||(this.dialect=new bV(this.dialectConfig)),this.dialect}}class b7{constructor(a,b,c,d,e){this.table=a,this.session=b,this.dialect=c,this.withList=d,this.overridingSystemValue_=e}static [bp.entityKind]="PgInsertBuilder";authToken;setToken(a){return this.authToken=a,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let b=a.map(a=>{let b={},c=this.table[by.Table.Symbol.Columns];for(let d of Object.keys(a)){let e=a[d];b[d]=(0,bp.is)(e,bu.SQL)?e:new bu.Param(e,c[d])}return b});return new b8(this.table,b,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(a){let b="function"==typeof a?a(new b6):a;if(!(0,bp.is)(b,bu.SQL)&&!(0,bA.haveSameKeys)(this.table[by.Columns],b._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new b8(this.table,b,this.session,this.dialect,this.withList,!0)}}class b8 extends bC.QueryPromise{constructor(a,b,c,d,e,f,g){super(),this.session=c,this.dialect=d,this.config={table:a,values:b,withList:e,select:f,overridingSystemValue_:g}}static [bp.entityKind]="PgInsert";config;returning(a=this.config.table[by.Table.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=(0,bA.orderSelectedFields)(a),this}onConflictDoNothing(a={}){if(void 0===a.target)this.config.onConflict=bu.sql`do nothing`;else{let b="";b=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target));let c=a.where?bu.sql` where ${a.where}`:void 0;this.config.onConflict=bu.sql`(${bu.sql.raw(b)})${c} do nothing`}return this}onConflictDoUpdate(a){if(a.where&&(a.targetWhere||a.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let b=a.where?bu.sql` where ${a.where}`:void 0,c=a.targetWhere?bu.sql` where ${a.targetWhere}`:void 0,d=a.setWhere?bu.sql` where ${a.setWhere}`:void 0,e=this.dialect.buildUpdateSet(this.config.table,(0,bA.mapUpdateSet)(this.config.table,a.set)),f="";return f=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target)),this.config.onConflict=bu.sql`(${bu.sql.raw(f)})${c} do update set ${e}${b}${d}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return bz.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bz.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new bx({alias:(0,by.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var b9=br;class ca{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [bp.entityKind]="PgUpdateBuilder";authToken;setToken(a){return this.authToken=a,this}set(a){return new cb(this.table,(0,bA.mapUpdateSet)(this.table,a),this.session,this.dialect,this.withList).setToken(this.authToken)}}class cb extends b9.QueryPromise{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e,joins:[]},this.tableName=(0,bA.getTableLikeName)(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [bp.entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;from(a){let b=(0,bA.getTableLikeName)(a);return"string"==typeof b&&(this.joinsNotNullableMap[b]=!0),this.config.from=a,this}getTableLikeFields(a){return(0,bp.is)(a,bQ.PgTable)?a[by.Table.Symbol.Columns]:(0,bp.is)(a,bv.Subquery)?a._.selectedFields:a[bw.ViewBaseConfig].selectedFields}createJoin(a){return(b,c)=>{let d=(0,bA.getTableLikeName)(b);if("string"==typeof d&&this.config.joins.some(a=>a.alias===d))throw Error(`Alias "${d}" is already used in this query`);if("function"==typeof c){let a=this.config.from&&!(0,bp.is)(this.config.from,bu.SQL)?this.getTableLikeFields(this.config.from):void 0;c=c(new Proxy(this.config.table[by.Table.Symbol.Columns],new bx({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new bx({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:c,table:b,joinType:a,alias:d}),"string"==typeof d)switch(a){case"left":this.joinsNotNullableMap[d]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[d]=!0;break;case"inner":this.joinsNotNullableMap[d]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[d]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(a){return this.config.where=a,this}returning(a){if(!a&&(a=Object.assign({},this.config.table[by.Table.Symbol.Columns]),this.config.from)){let b=(0,bA.getTableLikeName)(this.config.from);if("string"==typeof b&&this.config.from&&!(0,bp.is)(this.config.from,bu.SQL)){let c=this.getTableLikeFields(this.config.from);a[b]=c}for(let b of this.config.joins){let c=(0,bA.getTableLikeName)(b.table);if("string"==typeof c&&!(0,bp.is)(b.table,bu.SQL)){let d=this.getTableLikeFields(b.table);a[c]=d}}}return this.config.returningFields=a,this.config.returning=(0,bA.orderSelectedFields)(a),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){let b=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0);return b.joinsNotNullableMap=this.joinsNotNullableMap,b}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>this._prepare().execute(a,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new bx({alias:(0,by.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var cc=bu;class cd extends cc.SQL{constructor(a){super(cd.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.mapWith(Number),this.session=a.session,this.sql=cd.buildCount(a.source,a.filters)}sql;token;static [bp.entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(a,b){return cc.sql`(select count(*) from ${a}${cc.sql.raw(" where ").if(b)}${b})`}static buildCount(a,b){return cc.sql`select count(*) as count from ${a}${cc.sql.raw(" where ").if(b)}${b};`}setToken(a){return this.token=a,this}then(a,b){return Promise.resolve(this.session.count(this.sql,this.token)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}var ce=br;class cf{constructor(a,b,c,d,e,f,g){this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g}static [bp.entityKind]="PgRelationalQueryBuilder";findMany(a){return new cg(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many")}findFirst(a){return new cg(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first")}}class cg extends ce.QueryPromise{constructor(a,b,c,d,e,f,g,h,i){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.mode=i}static [bp.entityKind]="PgRelationalQuery";_prepare(a){return bz.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query:b,builtQuery:c}=this._toSQL();return this.session.prepareQuery(c,void 0,a,!0,(a,c)=>{let d=a.map(a=>(0,bR.mapRelationalRow)(this.schema,this.tableConfig,a,b.selection,c));return"first"===this.mode?d[0]:d})})}prepare(a){return this._prepare(a)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let a=this._getQuery(),b=this.dialect.sqlToQuery(a.sql);return{query:a,builtQuery:b}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(a){return this.authToken=a,this}execute(){return bz.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}var ch=br;class ci extends ch.QueryPromise{constructor(a,b,c,d){super(),this.execute=a,this.sql=b,this.query=c,this.mapBatchResult=d}static [bp.entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(a,b){return b?this.mapBatchResult(a):a}_prepare(){return this}isResponseInArrayMode(){return!1}}var cj=br;class ck extends cj.QueryPromise{constructor(a,b,c){super(),this.session=b,this.dialect=c,this.config={view:a}}static [bp.entityKind]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return bz.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bz.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}class cl{constructor(a,b,c){if(this.dialect=a,this.session=b,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap,session:b}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:b},this.query={},this._.schema)for(const[d,e]of Object.entries(this._.schema))this.query[d]=new cf(c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[d],e,a,b)}static [bp.entityKind]="PgDatabase";query;$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(new b6(c.dialect))),new Proxy(new bv.WithSubquery(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bx({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new cd({source:a,filters:b,session:this.session})}with(...a){let b=this;return{select:function(c){return new bX({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new bX({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},selectDistinctOn:function(c,d){return new bX({fields:d??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:{on:c}})},update:function(c){return new ca(c,b.session,b.dialect,a)},insert:function(c){return new b7(c,b.session,b.dialect,a)},delete:function(c){return new bB(c,b.session,b.dialect,a)}}}select(a){return new bX({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new bX({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(a,b){return new bX({fields:b??void 0,session:this.session,dialect:this.dialect,distinct:{on:a}})}update(a){return new ca(a,this.session,this.dialect)}insert(a){return new b7(a,this.session,this.dialect)}delete(a){return new bB(a,this.session,this.dialect)}refreshMaterializedView(a){return new ck(a,this.session,this.dialect)}authToken;execute(a){let b="string"==typeof a?bu.sql.raw(a):a.getSQL(),c=this.dialect.sqlToQuery(b),d=this.session.prepareQuery(c,void 0,void 0,!1);return new ci(()=>d.execute(void 0,this.authToken),b,c,a=>d.mapResult(a,!0))}transaction(a,b){return this.session.transaction(a,b)}}class cm{constructor(a){this.query=a}authToken;getQuery(){return this.query}mapResult(a,b){return a}setToken(a){return this.authToken=a,this}static [bp.entityKind]="PgPreparedQuery";joinsNotNullableMap}class cn{constructor(a){this.dialect=a}static [bp.entityKind]="PgSession";execute(a,b){return bz.tracer.startActiveSpan("drizzle.operation",()=>bz.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1)).setToken(b).execute(void 0,b))}all(a){return this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1).all()}async count(a,b){return Number((await this.execute(a,b))[0].count)}}class co extends cl{constructor(a,b,c,d=0){super(a,b,c),this.schema=c,this.nestedIndex=d}static [bp.entityKind]="PgTransaction";rollback(){throw new bH.TransactionRollbackError}getTransactionConfigSQL(a){let b=[];return a.isolationLevel&&b.push(`isolation level ${a.isolationLevel}`),a.accessMode&&b.push(a.accessMode),"boolean"==typeof a.deferrable&&b.push(a.deferrable?"deferrable":"not deferrable"),bu.sql.raw(b.join(" "))}setTransaction(a){return this.session.execute(bu.sql`set transaction ${this.getTransactionConfigSQL(a)}`)}}class cp extends cm{constructor(a,b,c,d,e,f,g,h){super({sql:b,params:c}),this.client=a,this.params=c,this.logger=d,this.fields=e,this._isResponseInArrayMode=g,this.customResultMapper=h,this.rawQueryConfig={name:f,text:b,types:{getTypeParser:(a,b)=>a===bo.builtins.TIMESTAMPTZ||a===bo.builtins.TIMESTAMP||a===bo.builtins.DATE||a===bo.builtins.INTERVAL?a=>a:bo.getTypeParser(a,b)}},this.queryConfig={name:f,text:b,rowMode:"array",types:{getTypeParser:(a,b)=>a===bo.builtins.TIMESTAMPTZ||a===bo.builtins.TIMESTAMP||a===bo.builtins.DATE||a===bo.builtins.INTERVAL?a=>a:bo.getTypeParser(a,b)}}}static [bp.entityKind]="NeonPreparedQuery";rawQueryConfig;queryConfig;async execute(a={}){let b=(0,bu.fillPlaceholders)(this.params,a);this.logger.logQuery(this.rawQueryConfig.text,b);let{fields:c,client:d,rawQueryConfig:e,queryConfig:f,joinsNotNullableMap:g,customResultMapper:h}=this;if(!c&&!h)return d.query(e,b);let i=await d.query(f,b);return h?h(i.rows):i.rows.map(a=>(0,bA.mapResultRow)(c,a,g))}all(a={}){let b=(0,bu.fillPlaceholders)(this.params,a);return this.logger.logQuery(this.rawQueryConfig.text,b),this.client.query(this.rawQueryConfig,b).then(a=>a.rows)}values(a={}){let b=(0,bu.fillPlaceholders)(this.params,a);return this.logger.logQuery(this.rawQueryConfig.text,b),this.client.query(this.queryConfig,b).then(a=>a.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}class cq extends cn{constructor(a,b,c,d={}){super(b),this.client=a,this.schema=c,this.options=d,this.logger=d.logger??new bq.NoopLogger}static [bp.entityKind]="NeonSession";logger;prepareQuery(a,b,c,d,e){return new cp(this.client,a.sql,a.params,this.logger,b,c,d,e)}async query(a,b){return this.logger.logQuery(a,b),await this.client.query({rowMode:"array",text:a,values:b})}async queryObjects(a,b){return this.client.query(a,b)}async count(a){return Number((await this.execute(a)).rows[0].count)}async transaction(a,b={}){let c=this.client instanceof bn?new cq(await this.client.connect(),this.dialect,this.schema,this.options):this,d=new cr(this.dialect,c,this.schema);await d.execute(bu.sql`begin ${d.getTransactionConfigSQL(b)}`);try{let b=await a(d);return await d.execute(bu.sql`commit`),b}catch(a){throw await d.execute(bu.sql`rollback`),a}finally{this.client instanceof bn&&c.client.release()}}}class cr extends co{static [bp.entityKind]="NeonTransaction";async transaction(a){let b=`sp${this.nestedIndex+1}`,c=new cr(this.dialect,this.session,this.schema,this.nestedIndex+1);await c.execute(bu.sql.raw(`savepoint ${b}`));try{let d=await a(c);return await c.execute(bu.sql.raw(`release savepoint ${b}`)),d}catch(a){throw await c.execute(bu.sql.raw(`rollback to savepoint ${b}`)),a}}}class cs{constructor(a,b,c={}){this.client=a,this.dialect=b,this.options=c}static [bp.entityKind]="NeonDriver";createSession(a){return new cq(this.client,this.dialect,a,{logger:this.options.logger})}}class ct extends cl{static [bp.entityKind]="NeonServerlessDatabase"}function cu(a,b={}){let c,d,e=new bV({casing:b.casing});if(!0===b.logger?c=new bq.DefaultLogger:!1!==b.logger&&(c=b.logger),b.schema){let a=(0,bR.extractTablesRelationalConfig)(b.schema,bR.createTableRelationsHelpers);d={fullSchema:b.schema,schema:a.tables,tableNamesMap:a.tableNamesMap}}let f=new cs(a,e,{logger:c}).createSession(d),g=new ct(e,f,d);return g.$client=a,g}function cv(...a){if("string"==typeof a[0])return cu(new bn({connectionString:a[0]}),a[1]);if((0,bA.isConfig)(a[0])){let{connection:b,client:c,ws:d,...e}=a[0];return(d&&(aO.webSocketConstructor=d),c)?cu(c,e):cu(new bn("string"==typeof b?{connectionString:b}:b),e)}return cu(a[0],a[1])}(cv||(cv={})).mock=function(a){return cu({},a)},a.s(["drizzle",()=>cv],44492),a.i(216816),a.i(923852),a.i(321819);var cw=a.i(73253);a.i(272513);let cx=cw.default;var cy=a.i(665105),cz=a.i(318830),cA=a.i(986096),cB=a.i(13552);class cC{constructor(a,b){this.unique=a,this.name=b}static [bp.entityKind]="PgIndexBuilderOn";on(...a){return new cD(a.map(a=>{if((0,bp.is)(a,bu.SQL))return a;let b=new bI.IndexedColumn(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),b}),this.unique,!1,this.name)}onOnly(...a){return new cD(a.map(a=>{if((0,bp.is)(a,bu.SQL))return a;let b=new bI.IndexedColumn(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=a.defaultConfig,b}),this.unique,!0,this.name)}using(a,...b){return new cD(b.map(a=>{if((0,bp.is)(a,bu.SQL))return a;let b=new bI.IndexedColumn(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),b}),this.unique,!0,this.name,a)}}class cD{static [bp.entityKind]="PgIndexBuilder";config;constructor(a,b,c,d,e="btree"){this.config={name:d,columns:a,unique:b,only:c,method:e}}concurrently(){return this.config.concurrently=!0,this}with(a){return this.config.with=a,this}where(a){return this.config.where=a,this}build(a){return new cE(this.config,a)}}class cE{static [bp.entityKind]="PgIndex";config;constructor(a,b){this.config={...a,table:b}}}function cF(a){return new cC(!1,a)}function cG(a){return new cC(!0,a)}class cH{constructor(a,b){this.name=a,this.value=b}static [bp.entityKind]="PgCheckBuilder";brand;build(a){return new cI(a,this)}}class cI{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [bp.entityKind]="PgCheck";name;value}var cJ=a.i(602);(c=f||(f={})).assertEqual=a=>a,c.assertIs=function(a){},c.assertNever=function(a){throw Error()},c.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},c.getValidEnumValues=a=>{let b=c.objectKeys(a).filter(b=>"number"!=typeof a[a[b]]),d={};for(let c of b)d[c]=a[c];return c.objectValues(d)},c.objectValues=a=>c.objectKeys(a).map(function(b){return a[b]}),c.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},c.find=(a,b)=>{for(let c of a)if(b(c))return c},c.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&isFinite(a)&&Math.floor(a)===a,c.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},c.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b,(g||(g={})).mergeShapes=(a,b)=>({...a,...b});let cK=f.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),cL=a=>{switch(typeof a){case"undefined":return cK.undefined;case"string":return cK.string;case"number":return isNaN(a)?cK.nan:cK.number;case"boolean":return cK.boolean;case"function":return cK.function;case"bigint":return cK.bigint;case"symbol":return cK.symbol;case"object":if(Array.isArray(a))return cK.array;if(null===a)return cK.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return cK.promise;if("undefined"!=typeof Map&&a instanceof Map)return cK.map;if("undefined"!=typeof Set&&a instanceof Set)return cK.set;if("undefined"!=typeof Date&&a instanceof Date)return cK.date;return cK.object;default:return cK.unknown}},cM=f.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class cN extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof cN))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,f.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)d.path.length>0?(b[d.path[0]]=b[d.path[0]]||[],b[d.path[0]].push(a(d))):c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}cN.create=a=>new cN(a);let cO=(a,b)=>{let c;switch(a.code){case cM.invalid_type:c=a.received===cK.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case cM.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,f.jsonStringifyReplacer)}`;break;case cM.unrecognized_keys:c=`Unrecognized key(s) in object: ${f.joinValues(a.keys,", ")}`;break;case cM.invalid_union:c="Invalid input";break;case cM.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${f.joinValues(a.options)}`;break;case cM.invalid_enum_value:c=`Invalid enum value. Expected ${f.joinValues(a.options)}, received '${a.received}'`;break;case cM.invalid_arguments:c="Invalid function arguments";break;case cM.invalid_return_type:c="Invalid function return type";break;case cM.invalid_date:c="Invalid date";break;case cM.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:f.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case cM.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case cM.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case cM.custom:c="Invalid input";break;case cM.invalid_intersection_types:c="Intersection results could not be merged";break;case cM.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case cM.not_finite:c="Number must be finite";break;default:c=b.defaultError,f.assertNever(a)}return{message:c}},cP=cO;function cQ(){return cP}let cR=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function cS(a,b){let c=cQ(),d=cR({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,c,c===cO?void 0:cO].filter(a=>!!a)});a.common.issues.push(d)}class cT{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return cU;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return cT.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return cU;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let cU=Object.freeze({status:"aborted"}),cV=a=>({status:"dirty",value:a}),cW=a=>({status:"valid",value:a}),cX=a=>"aborted"===a.status,cY=a=>"dirty"===a.status,cZ=a=>"valid"===a.status,c$=a=>"undefined"!=typeof Promise&&a instanceof Promise;function c_(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)}function c0(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c}"function"==typeof SuppressedError&&SuppressedError,(d=h||(h={})).errToObj=a=>"string"==typeof a?{message:a}:a||{},d.toString=a=>"string"==typeof a?a:null==a?void 0:a.message;class c1{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let c2=(a,b)=>{if(cZ(b))return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new cN(a.common.issues);return this._error=b,this._error}}};function c3(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{var f,g;let{message:h}=a;return"invalid_enum_value"===b.code?{message:null!=h?h:e.defaultError}:void 0===e.data?{message:null!=(f=null!=h?h:d)?f:e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:null!=(g=null!=h?h:c)?g:e.defaultError}},description:e}}class c4{get description(){return this._def.description}_getType(a){return cL(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:cL(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new cT,ctx:{common:a.parent.common,data:a.data,parsedType:cL(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(c$(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){var c;let d={common:{issues:[],async:null!=(c=null==b?void 0:b.async)&&c,contextualErrorMap:null==b?void 0:b.errorMap},path:(null==b?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:cL(a)},e=this._parseSync({data:a,path:d.path,parent:d});return c2(d,e)}"~validate"(a){var b,c;let d={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:cL(a)};if(!this["~standard"].async)try{let b=this._parseSync({data:a,path:[],parent:d});return cZ(b)?{value:b.value}:{issues:d.common.issues}}catch(a){(null==(c=null==(b=null==a?void 0:a.message)?void 0:b.toLowerCase())?void 0:c.includes("encountered"))&&(this["~standard"].async=!0),d.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:d}).then(a=>cZ(a)?{value:a.value}:{issues:d.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:null==b?void 0:b.errorMap,async:!0},path:(null==b?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:cL(a)},d=this._parse({data:a,path:c.path,parent:c});return c2(c,await (c$(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:cM.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new dR({schema:this,typeName:k.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return dS.create(this,this._def)}nullable(){return dT.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return dA.create(this)}promise(){return dQ.create(this,this._def)}or(a){return dC.create([this,a],this._def)}and(a){return dF.create(this,a,this._def)}transform(a){return new dR({...c3(this._def),schema:this,typeName:k.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new dU({...c3(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:k.ZodDefault})}brand(){return new dY({typeName:k.ZodBranded,type:this,...c3(this._def)})}catch(a){return new dV({...c3(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:k.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return dZ.create(this,a)}readonly(){return d$.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let c5=/^c[^\s-]{8,}$/i,c6=/^[0-9a-z]+$/,c7=/^[0-9A-HJKMNP-TV-Z]{26}$/i,c8=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,c9=/^[a-z0-9_-]{21}$/i,da=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,db=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,dc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,dd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,de=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,df=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,dg=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,dh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,di=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dj="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dk=RegExp(`^${dj}$`);function dl(a){let b="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`),b}function dm(a){let b=`${dj}T${dl(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)}class dn extends c4{_parse(a){var c,d,e,g;let h;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==cK.string){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.string,received:b.parsedType}),cU}let i=new cT;for(let j of this._def.checks)if("min"===j.kind)a.data.length<j.value&&(cS(h=this._getOrReturnCtx(a,h),{code:cM.too_small,minimum:j.value,type:"string",inclusive:!0,exact:!1,message:j.message}),i.dirty());else if("max"===j.kind)a.data.length>j.value&&(cS(h=this._getOrReturnCtx(a,h),{code:cM.too_big,maximum:j.value,type:"string",inclusive:!0,exact:!1,message:j.message}),i.dirty());else if("length"===j.kind){let b=a.data.length>j.value,c=a.data.length<j.value;(b||c)&&(h=this._getOrReturnCtx(a,h),b?cS(h,{code:cM.too_big,maximum:j.value,type:"string",inclusive:!0,exact:!0,message:j.message}):c&&cS(h,{code:cM.too_small,minimum:j.value,type:"string",inclusive:!0,exact:!0,message:j.message}),i.dirty())}else if("email"===j.kind)dc.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"email",code:cM.invalid_string,message:j.message}),i.dirty());else if("emoji"===j.kind)b||(b=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),b.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"emoji",code:cM.invalid_string,message:j.message}),i.dirty());else if("uuid"===j.kind)c8.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"uuid",code:cM.invalid_string,message:j.message}),i.dirty());else if("nanoid"===j.kind)c9.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"nanoid",code:cM.invalid_string,message:j.message}),i.dirty());else if("cuid"===j.kind)c5.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"cuid",code:cM.invalid_string,message:j.message}),i.dirty());else if("cuid2"===j.kind)c6.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"cuid2",code:cM.invalid_string,message:j.message}),i.dirty());else if("ulid"===j.kind)c7.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"ulid",code:cM.invalid_string,message:j.message}),i.dirty());else if("url"===j.kind)try{new URL(a.data)}catch(b){cS(h=this._getOrReturnCtx(a,h),{validation:"url",code:cM.invalid_string,message:j.message}),i.dirty()}else"regex"===j.kind?(j.regex.lastIndex=0,j.regex.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"regex",code:cM.invalid_string,message:j.message}),i.dirty())):"trim"===j.kind?a.data=a.data.trim():"includes"===j.kind?a.data.includes(j.value,j.position)||(cS(h=this._getOrReturnCtx(a,h),{code:cM.invalid_string,validation:{includes:j.value,position:j.position},message:j.message}),i.dirty()):"toLowerCase"===j.kind?a.data=a.data.toLowerCase():"toUpperCase"===j.kind?a.data=a.data.toUpperCase():"startsWith"===j.kind?a.data.startsWith(j.value)||(cS(h=this._getOrReturnCtx(a,h),{code:cM.invalid_string,validation:{startsWith:j.value},message:j.message}),i.dirty()):"endsWith"===j.kind?a.data.endsWith(j.value)||(cS(h=this._getOrReturnCtx(a,h),{code:cM.invalid_string,validation:{endsWith:j.value},message:j.message}),i.dirty()):"datetime"===j.kind?dm(j).test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{code:cM.invalid_string,validation:"datetime",message:j.message}),i.dirty()):"date"===j.kind?dk.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{code:cM.invalid_string,validation:"date",message:j.message}),i.dirty()):"time"===j.kind?RegExp(`^${dl(j)}$`).test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{code:cM.invalid_string,validation:"time",message:j.message}),i.dirty()):"duration"===j.kind?db.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"duration",code:cM.invalid_string,message:j.message}),i.dirty()):"ip"===j.kind?(c=a.data,!(("v4"===(d=j.version)||!d)&&dd.test(c)||("v6"===d||!d)&&df.test(c))&&1&&(cS(h=this._getOrReturnCtx(a,h),{validation:"ip",code:cM.invalid_string,message:j.message}),i.dirty())):"jwt"===j.kind?!function(a,b){if(!da.test(a))return!1;try{let[c]=a.split("."),d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||!e.typ||!e.alg||b&&e.alg!==b)return!1;return!0}catch(a){return!1}}(a.data,j.alg)&&(cS(h=this._getOrReturnCtx(a,h),{validation:"jwt",code:cM.invalid_string,message:j.message}),i.dirty()):"cidr"===j.kind?(e=a.data,!(("v4"===(g=j.version)||!g)&&de.test(e)||("v6"===g||!g)&&dg.test(e))&&1&&(cS(h=this._getOrReturnCtx(a,h),{validation:"cidr",code:cM.invalid_string,message:j.message}),i.dirty())):"base64"===j.kind?dh.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"base64",code:cM.invalid_string,message:j.message}),i.dirty()):"base64url"===j.kind?di.test(a.data)||(cS(h=this._getOrReturnCtx(a,h),{validation:"base64url",code:cM.invalid_string,message:j.message}),i.dirty()):f.assertNever(j);return{status:i.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:cM.invalid_string,...h.errToObj(c)})}_addCheck(a){return new dn({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...h.errToObj(a)})}url(a){return this._addCheck({kind:"url",...h.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...h.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...h.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...h.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...h.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...h.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...h.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...h.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...h.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...h.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...h.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...h.errToObj(a)})}datetime(a){var b,c;return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===(null==a?void 0:a.precision)?null:null==a?void 0:a.precision,offset:null!=(b=null==a?void 0:a.offset)&&b,local:null!=(c=null==a?void 0:a.local)&&c,...h.errToObj(null==a?void 0:a.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===(null==a?void 0:a.precision)?null:null==a?void 0:a.precision,...h.errToObj(null==a?void 0:a.message)})}duration(a){return this._addCheck({kind:"duration",...h.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...h.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:null==b?void 0:b.position,...h.errToObj(null==b?void 0:b.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...h.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...h.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...h.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...h.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...h.errToObj(b)})}nonempty(a){return this.min(1,h.errToObj(a))}trim(){return new dn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new dn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new dn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}dn.create=a=>{var b;return new dn({checks:[],typeName:k.ZodString,coerce:null!=(b=null==a?void 0:a.coerce)&&b,...c3(a)})};class dp extends c4{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==cK.number){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.number,received:b.parsedType}),cU}let c=new cT;for(let d of this._def.checks)"int"===d.kind?f.isInteger(a.data)||(cS(b=this._getOrReturnCtx(a,b),{code:cM.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return parseInt(a.toFixed(e).replace(".",""))%parseInt(b.toFixed(e).replace(".",""))/Math.pow(10,e)}(a.data,d.value)&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(cS(b=this._getOrReturnCtx(a,b),{code:cM.not_finite,message:d.message}),c.dirty()):f.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,h.toString(b))}gt(a,b){return this.setLimit("min",a,!1,h.toString(b))}lte(a,b){return this.setLimit("max",a,!0,h.toString(b))}lt(a,b){return this.setLimit("max",a,!1,h.toString(b))}setLimit(a,b,c,d){return new dp({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:h.toString(d)}]})}_addCheck(a){return new dp({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:h.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:h.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:h.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:h.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:h.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:h.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:h.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:h.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:h.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&f.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}dp.create=a=>new dp({checks:[],typeName:k.ZodNumber,coerce:(null==a?void 0:a.coerce)||!1,...c3(a)});class dq extends c4{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch(b){return this._getInvalidInput(a)}if(this._getType(a)!==cK.bigint)return this._getInvalidInput(a);let c=new cT;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):f.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.bigint,received:b.parsedType}),cU}gte(a,b){return this.setLimit("min",a,!0,h.toString(b))}gt(a,b){return this.setLimit("min",a,!1,h.toString(b))}lte(a,b){return this.setLimit("max",a,!0,h.toString(b))}lt(a,b){return this.setLimit("max",a,!1,h.toString(b))}setLimit(a,b,c,d){return new dq({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:h.toString(d)}]})}_addCheck(a){return new dq({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:h.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:h.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:h.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:h.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:h.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}dq.create=a=>{var b;return new dq({checks:[],typeName:k.ZodBigInt,coerce:null!=(b=null==a?void 0:a.coerce)&&b,...c3(a)})};class dr extends c4{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==cK.boolean){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.boolean,received:b.parsedType}),cU}return cW(a.data)}}dr.create=a=>new dr({typeName:k.ZodBoolean,coerce:(null==a?void 0:a.coerce)||!1,...c3(a)});class ds extends c4{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==cK.date){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.date,received:b.parsedType}),cU}if(isNaN(a.data.getTime()))return cS(this._getOrReturnCtx(a),{code:cM.invalid_date}),cU;let c=new cT;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(cS(b=this._getOrReturnCtx(a,b),{code:cM.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):f.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new ds({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:h.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:h.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}ds.create=a=>new ds({checks:[],coerce:(null==a?void 0:a.coerce)||!1,typeName:k.ZodDate,...c3(a)});class dt extends c4{_parse(a){if(this._getType(a)!==cK.symbol){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.symbol,received:b.parsedType}),cU}return cW(a.data)}}dt.create=a=>new dt({typeName:k.ZodSymbol,...c3(a)});class du extends c4{_parse(a){if(this._getType(a)!==cK.undefined){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.undefined,received:b.parsedType}),cU}return cW(a.data)}}du.create=a=>new du({typeName:k.ZodUndefined,...c3(a)});class dv extends c4{_parse(a){if(this._getType(a)!==cK.null){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.null,received:b.parsedType}),cU}return cW(a.data)}}dv.create=a=>new dv({typeName:k.ZodNull,...c3(a)});class dw extends c4{constructor(){super(...arguments),this._any=!0}_parse(a){return cW(a.data)}}dw.create=a=>new dw({typeName:k.ZodAny,...c3(a)});class dx extends c4{constructor(){super(...arguments),this._unknown=!0}_parse(a){return cW(a.data)}}dx.create=a=>new dx({typeName:k.ZodUnknown,...c3(a)});class dy extends c4{_parse(a){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.never,received:b.parsedType}),cU}}dy.create=a=>new dy({typeName:k.ZodNever,...c3(a)});class dz extends c4{_parse(a){if(this._getType(a)!==cK.undefined){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.void,received:b.parsedType}),cU}return cW(a.data)}}dz.create=a=>new dz({typeName:k.ZodVoid,...c3(a)});class dA extends c4{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==cK.array)return cS(b,{code:cM.invalid_type,expected:cK.array,received:b.parsedType}),cU;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(cS(b,{code:a?cM.too_big:cM.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(cS(b,{code:cM.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(cS(b,{code:cM.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new c1(b,a,b.path,c)))).then(a=>cT.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new c1(b,a,b.path,c)));return cT.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new dA({...this._def,minLength:{value:a,message:h.toString(b)}})}max(a,b){return new dA({...this._def,maxLength:{value:a,message:h.toString(b)}})}length(a,b){return new dA({...this._def,exactLength:{value:a,message:h.toString(b)}})}nonempty(a){return this.min(1,a)}}dA.create=(a,b)=>new dA({type:a,minLength:null,maxLength:null,exactLength:null,typeName:k.ZodArray,...c3(b)});class dB extends c4{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=f.objectKeys(a);return this._cached={shape:a,keys:b}}_parse(a){if(this._getType(a)!==cK.object){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.object,received:b.parsedType}),cU}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof dy&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new c1(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof dy){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(cS(c,{code:cM.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new c1(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>cT.mergeObjectSync(b,a)):cT.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return h.errToObj,new dB({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{var d,e,f,g;let i=null!=(f=null==(e=(d=this._def).errorMap)?void 0:e.call(d,b,c).message)?f:c.defaultError;return"unrecognized_keys"===b.code?{message:null!=(g=h.errToObj(a).message)?g:i}:{message:i}}}:{}})}strip(){return new dB({...this._def,unknownKeys:"strip"})}passthrough(){return new dB({...this._def,unknownKeys:"passthrough"})}extend(a){return new dB({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new dB({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:k.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new dB({...this._def,catchall:a})}pick(a){let b={};return f.objectKeys(a).forEach(c=>{a[c]&&this.shape[c]&&(b[c]=this.shape[c])}),new dB({...this._def,shape:()=>b})}omit(a){let b={};return f.objectKeys(this.shape).forEach(c=>{a[c]||(b[c]=this.shape[c])}),new dB({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof dB){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=dS.create(a(e))}return new dB({...b._def,shape:()=>c})}if(b instanceof dA)return new dA({...b._def,type:a(b.element)});if(b instanceof dS)return dS.create(a(b.unwrap()));if(b instanceof dT)return dT.create(a(b.unwrap()));if(b instanceof dG)return dG.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};return f.objectKeys(this.shape).forEach(c=>{let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}),new dB({...this._def,shape:()=>b})}required(a){let b={};return f.objectKeys(this.shape).forEach(c=>{if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof dS;)a=a._def.innerType;b[c]=a}}),new dB({...this._def,shape:()=>b})}keyof(){return dN(f.objectKeys(this.shape))}}dB.create=(a,b)=>new dB({shape:()=>a,unknownKeys:"strip",catchall:dy.create(),typeName:k.ZodObject,...c3(b)}),dB.strictCreate=(a,b)=>new dB({shape:()=>a,unknownKeys:"strict",catchall:dy.create(),typeName:k.ZodObject,...c3(b)}),dB.lazycreate=(a,b)=>new dB({shape:a,unknownKeys:"strip",catchall:dy.create(),typeName:k.ZodObject,...c3(b)});class dC extends c4{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new cN(a.ctx.common.issues));return cS(b,{code:cM.invalid_union,unionErrors:c}),cU});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new cN(a));return cS(b,{code:cM.invalid_union,unionErrors:e}),cU}}get options(){return this._def.options}}dC.create=(a,b)=>new dC({options:a,typeName:k.ZodUnion,...c3(b)});let dD=a=>{if(a instanceof dL)return dD(a.schema);if(a instanceof dR)return dD(a.innerType());if(a instanceof dM)return[a.value];if(a instanceof dO)return a.options;if(a instanceof dP)return f.objectValues(a.enum);else if(a instanceof dU)return dD(a._def.innerType);else if(a instanceof du)return[void 0];else if(a instanceof dv)return[null];else if(a instanceof dS)return[void 0,...dD(a.unwrap())];else if(a instanceof dT)return[null,...dD(a.unwrap())];else if(a instanceof dY)return dD(a.unwrap());else if(a instanceof d$)return dD(a.unwrap());else if(a instanceof dV)return dD(a._def.innerType);else return[]};class dE extends c4{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==cK.object)return cS(b,{code:cM.invalid_type,expected:cK.object,received:b.parsedType}),cU;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(cS(b,{code:cM.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),cU)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=dD(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new dE({typeName:k.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...c3(c)})}}class dF extends c4{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if(cX(a)||cX(d))return cU;let e=function a(b,c){let d=cL(b),e=cL(c);if(b===c)return{valid:!0,data:b};if(d===cK.object&&e===cK.object){let d=f.objectKeys(c),e=f.objectKeys(b).filter(a=>-1!==d.indexOf(a)),g={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};g[d]=e.data}return{valid:!0,data:g}}if(d===cK.array&&e===cK.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===cK.date&&e===cK.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?((cY(a)||cY(d))&&b.dirty(),{status:b.value,value:e.data}):(cS(c,{code:cM.invalid_intersection_types}),cU)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}dF.create=(a,b,c)=>new dF({left:a,right:b,typeName:k.ZodIntersection,...c3(c)});class dG extends c4{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cK.array)return cS(c,{code:cM.invalid_type,expected:cK.array,received:c.parsedType}),cU;if(c.data.length<this._def.items.length)return cS(c,{code:cM.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),cU;!this._def.rest&&c.data.length>this._def.items.length&&(cS(c,{code:cM.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new c1(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>cT.mergeArray(b,a)):cT.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new dG({...this._def,rest:a})}}dG.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new dG({items:a,typeName:k.ZodTuple,rest:null,...c3(b)})};class dH extends c4{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cK.object)return cS(c,{code:cM.invalid_type,expected:cK.object,received:c.parsedType}),cU;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new c1(c,a,c.path,a)),value:f._parse(new c1(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?cT.mergeObjectAsync(b,d):cT.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new dH(b instanceof c4?{keyType:a,valueType:b,typeName:k.ZodRecord,...c3(c)}:{keyType:dn.create(),valueType:a,typeName:k.ZodRecord,...c3(b)})}}class dI extends c4{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cK.map)return cS(c,{code:cM.invalid_type,expected:cK.map,received:c.parsedType}),cU;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new c1(c,a,c.path,[f,"key"])),value:e._parse(new c1(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return cU;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return cU;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}dI.create=(a,b,c)=>new dI({valueType:b,keyType:a,typeName:k.ZodMap,...c3(c)});class dJ extends c4{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cK.set)return cS(c,{code:cM.invalid_type,expected:cK.set,received:c.parsedType}),cU;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(cS(c,{code:cM.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(cS(c,{code:cM.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return cU;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new c1(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new dJ({...this._def,minSize:{value:a,message:h.toString(b)}})}max(a,b){return new dJ({...this._def,maxSize:{value:a,message:h.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}dJ.create=(a,b)=>new dJ({valueType:a,minSize:null,maxSize:null,typeName:k.ZodSet,...c3(b)});class dK extends c4{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==cK.function)return cS(b,{code:cM.invalid_type,expected:cK.function,received:b.parsedType}),cU;function c(a,c){return cR({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,cQ(),cO].filter(a=>!!a),issueData:{code:cM.invalid_arguments,argumentsError:c}})}function d(a,c){return cR({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,cQ(),cO].filter(a=>!!a),issueData:{code:cM.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof dQ){let a=this;return cW(async function(...b){let g=new cN([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return cW(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new cN([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new cN([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new dK({...this._def,args:dG.create(a).rest(dx.create())})}returns(a){return new dK({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new dK({args:a||dG.create([]).rest(dx.create()),returns:b||dx.create(),typeName:k.ZodFunction,...c3(c)})}}class dL extends c4{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}dL.create=(a,b)=>new dL({getter:a,typeName:k.ZodLazy,...c3(b)});class dM extends c4{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return cS(b,{received:b.data,code:cM.invalid_literal,expected:this._def.value}),cU}return{status:"valid",value:a.data}}get value(){return this._def.value}}function dN(a,b){return new dO({values:a,typeName:k.ZodEnum,...c3(b)})}dM.create=(a,b)=>new dM({value:a,typeName:k.ZodLiteral,...c3(b)});class dO extends c4{constructor(){super(...arguments),i.set(this,void 0)}_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return cS(b,{expected:f.joinValues(c),received:b.parsedType,code:cM.invalid_type}),cU}if(c_(this,i,"f")||c0(this,i,new Set(this._def.values),"f"),!c_(this,i,"f").has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return cS(b,{received:b.data,code:cM.invalid_enum_value,options:c}),cU}return cW(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return dO.create(a,{...this._def,...b})}exclude(a,b=this._def){return dO.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}i=new WeakMap,dO.create=dN;class dP extends c4{constructor(){super(...arguments),j.set(this,void 0)}_parse(a){let b=f.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==cK.string&&c.parsedType!==cK.number){let a=f.objectValues(b);return cS(c,{expected:f.joinValues(a),received:c.parsedType,code:cM.invalid_type}),cU}if(c_(this,j,"f")||c0(this,j,new Set(f.getValidEnumValues(this._def.values)),"f"),!c_(this,j,"f").has(a.data)){let a=f.objectValues(b);return cS(c,{received:c.data,code:cM.invalid_enum_value,options:a}),cU}return cW(a.data)}get enum(){return this._def.values}}j=new WeakMap,dP.create=(a,b)=>new dP({values:a,typeName:k.ZodNativeEnum,...c3(b)});class dQ extends c4{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==cK.promise&&!1===b.common.async?(cS(b,{code:cM.invalid_type,expected:cK.promise,received:b.parsedType}),cU):cW((b.parsedType===cK.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}dQ.create=(a,b)=>new dQ({type:a,typeName:k.ZodPromise,...c3(b)});class dR extends c4{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===k.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{cS(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return cU;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?cU:"dirty"===d.status||"dirty"===b.value?cV(d.value):d});{if("aborted"===b.value)return cU;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?cU:"dirty"===d.status||"dirty"===b.value?cV(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?cU:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?cU:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>cZ(a)?Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})):a);else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if(!cZ(a))return a;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}f.assertNever(d)}}dR.create=(a,b,c)=>new dR({schema:a,typeName:k.ZodEffects,effect:b,...c3(c)}),dR.createWithPreprocess=(a,b,c)=>new dR({schema:b,effect:{type:"preprocess",transform:a},typeName:k.ZodEffects,...c3(c)});class dS extends c4{_parse(a){return this._getType(a)===cK.undefined?cW(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}dS.create=(a,b)=>new dS({innerType:a,typeName:k.ZodOptional,...c3(b)});class dT extends c4{_parse(a){return this._getType(a)===cK.null?cW(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}dT.create=(a,b)=>new dT({innerType:a,typeName:k.ZodNullable,...c3(b)});class dU extends c4{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===cK.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}dU.create=(a,b)=>new dU({innerType:a,typeName:k.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...c3(b)});class dV extends c4{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return c$(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new cN(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new cN(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}dV.create=(a,b)=>new dV({innerType:a,typeName:k.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...c3(b)});class dW extends c4{_parse(a){if(this._getType(a)!==cK.nan){let b=this._getOrReturnCtx(a);return cS(b,{code:cM.invalid_type,expected:cK.nan,received:b.parsedType}),cU}return{status:"valid",value:a.data}}}dW.create=a=>new dW({typeName:k.ZodNaN,...c3(a)});let dX=Symbol("zod_brand");class dY extends c4{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class dZ extends c4{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?cU:"dirty"===a.status?(b.dirty(),cV(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?cU:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new dZ({in:a,out:b,typeName:k.ZodPipeline})}}class d$ extends c4{_parse(a){let b=this._def.innerType._parse(a),c=a=>(cZ(a)&&(a.value=Object.freeze(a.value)),a);return c$(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}function d_(a,b){let c="function"==typeof a?a(b):"string"==typeof a?{message:a}:a;return"string"==typeof c?{message:c}:c}function d0(a,b={},c){return a?dw.create().superRefine((d,e)=>{var f,g;let h=a(d);if(h instanceof Promise)return h.then(a=>{var f,g;if(!a){let a=d_(b,d),h=null==(g=null!=(f=a.fatal)?f:c)||g;e.addIssue({code:"custom",...a,fatal:h})}});if(!h){let a=d_(b,d),h=null==(g=null!=(f=a.fatal)?f:c)||g;e.addIssue({code:"custom",...a,fatal:h})}}):dw.create()}d$.create=(a,b)=>new d$({innerType:a,typeName:k.ZodReadonly,...c3(b)});let d1={object:dB.lazycreate};(e=k||(k={})).ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly";let d2=dn.create,d3=dp.create,d4=dW.create,d5=dq.create,d6=dr.create,d7=ds.create,d8=dt.create,d9=du.create,ea=dv.create,eb=dw.create,ec=dx.create,ed=dy.create,ee=dz.create,ef=dA.create,eg=dB.create,eh=dB.strictCreate,ei=dC.create,ej=dE.create,ek=dF.create,el=dG.create,em=dH.create,en=dI.create,eo=dJ.create,ep=dK.create,eq=dL.create,er=dM.create,es=dO.create,et=dP.create,eu=dQ.create,ev=dR.create,ew=dS.create,ex=dT.create,ey=dR.createWithPreprocess,ez=dZ.create;var eA=Object.freeze({__proto__:null,defaultErrorMap:cO,setErrorMap:function(a){cP=a},getErrorMap:cQ,makeIssue:cR,EMPTY_PATH:[],addIssueToContext:cS,ParseStatus:cT,INVALID:cU,DIRTY:cV,OK:cW,isAborted:cX,isDirty:cY,isValid:cZ,isAsync:c$,get util(){return f},get objectUtil(){return g},ZodParsedType:cK,getParsedType:cL,ZodType:c4,datetimeRegex:dm,ZodString:dn,ZodNumber:dp,ZodBigInt:dq,ZodBoolean:dr,ZodDate:ds,ZodSymbol:dt,ZodUndefined:du,ZodNull:dv,ZodAny:dw,ZodUnknown:dx,ZodNever:dy,ZodVoid:dz,ZodArray:dA,ZodObject:dB,ZodUnion:dC,ZodDiscriminatedUnion:dE,ZodIntersection:dF,ZodTuple:dG,ZodRecord:dH,ZodMap:dI,ZodSet:dJ,ZodFunction:dK,ZodLazy:dL,ZodLiteral:dM,ZodEnum:dO,ZodNativeEnum:dP,ZodPromise:dQ,ZodEffects:dR,ZodTransformer:dR,ZodOptional:dS,ZodNullable:dT,ZodDefault:dU,ZodCatch:dV,ZodNaN:dW,BRAND:dX,ZodBranded:dY,ZodPipeline:dZ,ZodReadonly:d$,custom:d0,Schema:c4,ZodSchema:c4,late:d1,get ZodFirstPartyTypeKind(){return k},coerce:{string:a=>dn.create({...a,coerce:!0}),number:a=>dp.create({...a,coerce:!0}),boolean:a=>dr.create({...a,coerce:!0}),bigint:a=>dq.create({...a,coerce:!0}),date:a=>ds.create({...a,coerce:!0})},any:eb,array:ef,bigint:d5,boolean:d6,date:d7,discriminatedUnion:ej,effect:ev,enum:es,function:ep,instanceof:(a,b={message:`Input not instance of ${a.name}`})=>d0(b=>b instanceof a,b),intersection:ek,lazy:eq,literal:er,map:en,nan:d4,nativeEnum:et,never:ed,null:ea,nullable:ex,number:d3,object:eg,oboolean:()=>d6().optional(),onumber:()=>d3().optional(),optional:ew,ostring:()=>d2().optional(),pipeline:ez,preprocess:ey,promise:eu,record:em,set:eo,strictObject:eh,string:d2,symbol:d8,transformer:ev,tuple:el,undefined:d9,union:ei,unknown:ec,void:ee,NEVER:cU,ZodIssueCode:cM,quotelessJson:a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:cN});let eB={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:0xffffff,INT32_MIN:-0x80000000,INT32_MAX:0x7fffffff,INT32_UNSIGNED_MAX:0xffffffff,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-0x8000000000000000n,INT64_MAX:0x7fffffffffffffffn,INT64_UNSIGNED_MAX:0xffffffffffffffffn};function eC(a,b){return b.includes(a.columnType)}let eD=eA.union([eA.string(),eA.number(),eA.boolean(),eA.null()]),eE=eA.union([eD,eA.record(eA.any()),eA.array(eA.any())]),eF=eA.custom(a=>a instanceof Buffer);function eG(a){return(0,by.isTable)(a)?(0,bA.getTableColumns)(a):(0,bA.getViewSelectedFields)(a)}let eH={never:a=>a?.generated?.type==="always"||a?.generatedIdentity?.type==="always",optional:a=>!a.notNull||a.notNull&&a.hasDefault,nullable:a=>!a.notNull},eI=(a,b)=>(function a(b,c,d,e){let f={};for(let[g,h]of Object.entries(b)){if(!(0,bp.is)(h,bt.Column)&&!(0,bp.is)(h,bu.SQL)&&!(0,bp.is)(h,bu.SQL.Aliased)&&"object"==typeof h){let b=(0,by.isTable)(h)||(0,bu.isView)(h)?eG(h):h;f[g]=a(b,c[g]??{},d,e);continue}let b=c[g];if(void 0!==b&&"function"!=typeof b){f[g]=b;continue}let i=(0,bp.is)(h,bt.Column)?h:void 0,j=i?function a(b,c){let d,e=c?.zodInstance??eA,f=c?.coerce??{};return"enumValues"in b&&Array.isArray(b.enumValues)&&b.enumValues.length>0&&(d=b.enumValues.length?e.enum(b.enumValues):e.string()),d||(eC(b,["PgGeometry","PgPointTuple"])?d=e.tuple([e.number(),e.number()]):eC(b,["PgGeometryObject","PgPointObject"])?d=e.object({x:e.number(),y:e.number()}):eC(b,["PgHalfVector","PgVector"])?(d=e.array(e.number()),d=b.dimensions?d.length(b.dimensions):d):eC(b,["PgLine"])?d=e.tuple([e.number(),e.number(),e.number()]):eC(b,["PgLineABC"])?d=e.object({a:e.number(),b:e.number(),c:e.number()}):eC(b,["PgArray"])?(d=e.array(a(b.baseColumn,e)),d=b.size?d.length(b.size):d):"array"===b.dataType?d=e.array(e.any()):"number"===b.dataType?d=function(a,b,c){let d,e,f=a.getSQLType().includes("unsigned"),g=!1;eC(a,["MySqlTinyInt","SingleStoreTinyInt"])?(d=f?0:eB.INT8_MIN,e=f?eB.INT8_UNSIGNED_MAX:eB.INT8_MAX,g=!0):eC(a,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(d=f?0:eB.INT16_MIN,e=f?eB.INT16_UNSIGNED_MAX:eB.INT16_MAX,g=!0):eC(a,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(d=f?0:eB.INT24_MIN,e=f?eB.INT24_UNSIGNED_MAX:eB.INT24_MAX,g=eC(a,["MySqlMediumInt","SingleStoreMediumInt"])):eC(a,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(d=f?0:eB.INT32_MIN,e=f?eB.INT32_UNSIGNED_MAX:eB.INT32_MAX,g=!0):eC(a,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(d=f?0:eB.INT48_MIN,e=f?eB.INT48_UNSIGNED_MAX:eB.INT48_MAX):eC(a,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(d=(f=f||eC(a,["MySqlSerial","SingleStoreSerial"]))?0:Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER,g=!0):eC(a,["MySqlYear","SingleStoreYear"])?(d=1901,e=2155,g=!0):(d=Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER);let h=!0===c||c?.number?b.coerce.number():b.number();return h=h.min(d).max(e),g?h.int():h}(b,e,f):"bigint"===b.dataType?d=function(a,b,c){let d=a.getSQLType().includes("unsigned"),e=d?0n:eB.INT64_MIN,f=d?eB.INT64_UNSIGNED_MAX:eB.INT64_MAX;return(!0===c||c?.bigint?b.coerce.bigint():b.bigint()).min(e).max(f)}(b,e,f):"boolean"===b.dataType?d=!0===f||f.boolean?e.coerce.boolean():e.boolean():"date"===b.dataType?d=!0===f||f.date?e.coerce.date():e.date():"string"===b.dataType?d=function(a,b,c){let d,e;if(eC(a,["PgUUID"]))return b.string().uuid();let f=!1;eC(a,["PgVarchar","SQLiteText"])?d=a.length:eC(a,["MySqlVarChar","SingleStoreVarChar"])?d=a.length??eB.INT16_UNSIGNED_MAX:eC(a,["MySqlText","SingleStoreText"])&&(d="longtext"===a.textType?eB.INT32_UNSIGNED_MAX:"mediumtext"===a.textType?eB.INT24_UNSIGNED_MAX:"text"===a.textType?eB.INT16_UNSIGNED_MAX:eB.INT8_UNSIGNED_MAX),eC(a,["PgChar","MySqlChar","SingleStoreChar"])&&(d=a.length,f=!0),eC(a,["PgBinaryVector"])&&(e=/^[01]+$/,d=a.dimensions);let g=!0===c||c?.string?b.coerce.string():b.string();return g=e?g.regex(e):g,d&&f?g.length(d):d?g.max(d):g}(b,e,f):"json"===b.dataType?d=eE:"custom"===b.dataType?d=e.any():"buffer"===b.dataType&&(d=eF)),d||(d=e.any()),d}(i,e):eA.any(),k="function"==typeof b?b(j):j;!d.never(i)&&(f[g]=k,i&&(d.nullable(i)&&(f[g]=f[g].nullable()),d.optional(i)&&(f[g]=f[g].optional())))}return eA.object(f)})(eG(a),b??{},eH),eJ=(0,bQ.pgTable)("sessions",{sid:(0,cz.varchar)("sid").primaryKey(),sess:(0,bL.jsonb)("sess").notNull(),expire:(0,bO.timestamp)("expire").notNull()},a=>({expireIdx:cF("IDX_session_expire").on(a.expire)})),eK=(0,bQ.pgTable)("users",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),username:(0,cy.text)("username").notNull().unique(),password:(0,cy.text)("password"),email:(0,cz.varchar)("email").unique(),firstName:(0,cz.varchar)("first_name"),lastName:(0,cz.varchar)("last_name"),profileImageUrl:(0,cz.varchar)("profile_image_url"),location:(0,cz.varchar)("location",{length:100}),totalCoins:(0,cA.integer)("total_coins").notNull().default(0),weeklyEarned:(0,cA.integer)("weekly_earned").notNull().default(0),rank:(0,cA.integer)("rank"),youtubeUrl:(0,cy.text)("youtube_url"),instagramHandle:(0,cy.text)("instagram_handle"),telegramHandle:(0,cy.text)("telegram_handle"),myfxbookLink:(0,cy.text)("myfxbook_link"),investorId:(0,cy.text)("investor_id"),investorPassword:(0,cy.text)("investor_password"),isVerifiedTrader:(0,cB.boolean)("is_verified_trader").notNull().default(!1),emailNotifications:(0,cB.boolean)("email_notifications").notNull().default(!0),hasYoutubeReward:(0,cB.boolean)("has_youtube_reward").notNull().default(!1),hasMyfxbookReward:(0,cB.boolean)("has_myfxbook_reward").notNull().default(!1),hasInvestorReward:(0,cB.boolean)("has_investor_reward").notNull().default(!1),badges:(0,cy.text)("badges").array().default(bu.sql`'{}'::text[]`),onboardingCompleted:(0,cB.boolean)("onboarding_completed").default(!1),onboardingDismissed:(0,cB.boolean)("onboarding_dismissed").default(!1),onboardingProgress:(0,bK.json)("onboarding_progress").default({profilePicture:!1,firstReply:!1,twoReviews:!1,firstThread:!1,firstPublish:!1,fiftyFollowers:!1}),reputationScore:(0,cA.integer)("reputation_score").notNull().default(0),lastReputationUpdate:(0,bO.timestamp)("last_reputation_update"),lastJournalPost:(0,bJ.date)("last_journal_post"),level:(0,cA.integer)("level").default(0).notNull(),role:(0,cz.varchar)("role",{length:20}).notNull().default("member"),status:(0,cz.varchar)("status",{length:20}).notNull().default("active"),suspendedUntil:(0,bO.timestamp)("suspended_until"),bannedAt:(0,bO.timestamp)("banned_at"),bannedBy:(0,cz.varchar)("banned_by"),lastActive:(0,bO.timestamp)("last_active").defaultNow(),createdAt:(0,bO.timestamp)("created_at").defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").defaultNow()},a=>({usernameIdx:cF("idx_users_username").on(a.username),emailIdx:cF("idx_users_email").on(a.email),reputationIdx:cF("idx_users_reputation").on(a.reputationScore),levelIdx:cF("idx_users_level").on(a.level),coinsIdx:cF("idx_users_coins").on(a.totalCoins),roleIdx:cF("idx_users_role").on(a.role),statusIdx:cF("idx_users_status").on(a.status),lastActiveIdx:cF("idx_users_last_active").on(a.lastActive),coinsCheck:new cH("chk_user_coins_nonnegative",bu.sql`${a.totalCoins} >= 0`)})),eL=(0,bQ.pgTable)("user_activity",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),date:(0,bJ.date)("date").notNull(),activeMinutes:(0,cA.integer)("active_minutes").notNull().default(0),coinsEarned:(0,cA.integer)("coins_earned").notNull().default(0),lastActivityAt:(0,bO.timestamp)("last_activity_at").defaultNow(),createdAt:(0,bO.timestamp)("created_at").defaultNow()},a=>({userDateIdx:cG("idx_user_activity_user_date").on(a.userId,a.date)})),eM=(0,bQ.pgTable)("coin_transactions",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),type:(0,cy.text)("type").notNull().$type(),amount:(0,cA.integer)("amount").notNull(),description:(0,cy.text)("description").notNull(),status:(0,cy.text)("status").notNull().$type().default("completed"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_coin_transactions_user_id").on(a.userId)})),eN=(0,bQ.pgTable)("recharge_orders",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),coinAmount:(0,cA.integer)("coin_amount").notNull(),priceUsd:(0,cA.integer)("price_usd").notNull(),paymentMethod:(0,cy.text)("payment_method").notNull().$type(),paymentId:(0,cy.text)("payment_id"),status:(0,cy.text)("status").notNull().$type().default("pending"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),completedAt:(0,bO.timestamp)("completed_at")},a=>({userIdIdx:cF("idx_recharge_orders_user_id").on(a.userId)})),eO=(0,bQ.pgTable)("subscriptions",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),plan:(0,cy.text)("plan").notNull().$type(),priceUsd:(0,cA.integer)("price_usd").notNull(),paymentMethod:(0,cy.text)("payment_method").notNull().$type(),paymentId:(0,cy.text)("payment_id"),status:(0,cy.text)("status").notNull().$type(),startDate:(0,bO.timestamp)("start_date").notNull(),endDate:(0,bO.timestamp)("end_date").notNull(),autoRenew:(0,cB.boolean)("auto_renew").notNull().default(!0),cancelledAt:(0,bO.timestamp)("cancelled_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_subscriptions_user_id").on(a.userId),statusIdx:cF("idx_subscriptions_status").on(a.status),statusEndDateIdx:cF("idx_subscriptions_status_end_date").on(a.status,a.endDate)})),eP=(0,bQ.pgTable)("withdrawal_requests",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),amount:(0,cA.integer)("amount").notNull(),method:(0,cy.text)("method").$type().default("crypto"),paymentReference:(0,cy.text)("payment_reference"),cryptoType:(0,cy.text)("crypto_type").$type(),walletAddress:(0,cy.text)("wallet_address").notNull(),exchangeRate:(0,bM.numeric)("exchange_rate",{precision:20,scale:8}),cryptoAmount:(0,bM.numeric)("crypto_amount",{precision:20,scale:8}),status:(0,cy.text)("status").notNull().$type().default("pending"),processingFee:(0,cA.integer)("processing_fee").notNull(),transactionHash:(0,cy.text)("transaction_hash"),adminNotes:(0,cy.text)("admin_notes"),approvedBy:(0,cz.varchar)("approved_by").references(()=>eK.id),approvedAt:(0,bO.timestamp)("approved_at"),rejectedBy:(0,cz.varchar)("rejected_by").references(()=>eK.id),rejectedAt:(0,bO.timestamp)("rejected_at"),rejectionReason:(0,cy.text)("rejection_reason"),completedBy:(0,cz.varchar)("completed_by").references(()=>eK.id),amountUsd:(0,bM.numeric)("amount_usd",{precision:10,scale:2}),requestedAt:(0,bO.timestamp)("requested_at").notNull().defaultNow(),processedAt:(0,bO.timestamp)("processed_at"),completedAt:(0,bO.timestamp)("completed_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_withdrawal_requests_user_id").on(a.userId),statusIdx:cF("idx_withdrawal_requests_status").on(a.status),methodIdx:cF("idx_withdrawal_requests_method").on(a.method),approvedByIdx:cF("idx_withdrawal_requests_approved_by").on(a.approvedBy),statusMethodIdx:cF("idx_withdrawal_requests_status_method").on(a.status,a.method),amountCheck:new cH("chk_withdrawal_amount_min",bu.sql`${a.amount} >= 1000`)})),eQ=(0,bQ.pgTable)("feedback",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").references(()=>eK.id),type:(0,cy.text)("type").notNull().$type(),subject:(0,cy.text)("subject").notNull(),message:(0,cy.text)("message").notNull(),email:(0,cy.text)("email"),status:(0,cy.text)("status").notNull().$type().default("new"),priority:(0,cy.text)("priority").$type().default("medium"),adminNotes:(0,cy.text)("admin_notes"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_feedback_user_id").on(a.userId),statusIdx:cF("idx_feedback_status").on(a.status),typeIdx:cF("idx_feedback_type").on(a.type)})),eR=(0,bQ.pgTable)("content",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),authorId:(0,cz.varchar)("author_id").notNull().references(()=>eK.id),type:(0,cy.text)("type").notNull().$type(),title:(0,cy.text)("title").notNull(),description:(0,cy.text)("description").notNull(),priceCoins:(0,cA.integer)("price_coins").notNull().default(0),isFree:(0,cB.boolean)("is_free").notNull().default(!0),category:(0,cy.text)("category").notNull(),platform:(0,cy.text)("platform").$type(),version:(0,cy.text)("version"),tags:(0,cy.text)("tags").array(),files:(0,bL.jsonb)("files").$type(),images:(0,bL.jsonb)("images").$type(),brokerCompat:(0,cy.text)("broker_compat").array(),minDeposit:(0,cA.integer)("min_deposit"),hedging:(0,cB.boolean)("hedging"),changelog:(0,cy.text)("changelog"),license:(0,cy.text)("license"),equityCurveImage:(0,cy.text)("equity_curve_image"),profitFactor:(0,cA.integer)("profit_factor"),drawdownPercent:(0,cA.integer)("drawdown_percent"),winPercent:(0,cA.integer)("win_percent"),broker:(0,cy.text)("broker"),monthsTested:(0,cA.integer)("months_tested"),fileUrl:(0,cy.text)("file_url"),imageUrl:(0,cy.text)("image_url"),imageUrls:(0,cy.text)("image_urls").array(),postLogoUrl:(0,cy.text)("post_logo_url"),views:(0,cA.integer)("views").notNull().default(0),downloads:(0,cA.integer)("downloads").notNull().default(0),likes:(0,cA.integer)("likes").notNull().default(0),isFeatured:(0,cB.boolean)("is_featured").notNull().default(!1),averageRating:(0,cA.integer)("average_rating"),reviewCount:(0,cA.integer)("review_count").notNull().default(0),status:(0,cy.text)("status").notNull().$type().default("pending"),slug:(0,cy.text)("slug").notNull().unique(),focusKeyword:(0,cy.text)("focus_keyword"),autoMetaDescription:(0,cy.text)("auto_meta_description"),autoImageAltTexts:(0,cy.text)("auto_image_alt_texts").array(),salesScore:(0,cA.integer)("sales_score").notNull().default(0),lastSalesUpdate:(0,bO.timestamp)("last_sales_update"),approvedBy:(0,cz.varchar)("approved_by").references(()=>eK.id),approvedAt:(0,bO.timestamp)("approved_at"),rejectedBy:(0,cz.varchar)("rejected_by").references(()=>eK.id),rejectedAt:(0,bO.timestamp)("rejected_at"),rejectionReason:(0,cy.text)("rejection_reason"),featured:(0,cB.boolean)("featured").notNull().default(!1),featuredUntil:(0,bO.timestamp)("featured_until"),deletedAt:(0,bO.timestamp)("deleted_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({authorIdIdx:cF("idx_content_author_id").on(a.authorId),statusIdx:cF("idx_content_status").on(a.status),categoryIdx:cF("idx_content_category").on(a.category),slugIdx:cF("idx_content_slug").on(a.slug),salesScoreIdx:cF("idx_content_sales_score").on(a.salesScore),featuredIdx:cF("idx_content_featured").on(a.featured),deletedAtIdx:cF("idx_content_deleted_at").on(a.deletedAt)})),eS=(0,bQ.pgTable)("content_purchases",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),contentId:(0,cz.varchar)("content_id").notNull().references(()=>eR.id),buyerId:(0,cz.varchar)("buyer_id").notNull().references(()=>eK.id),sellerId:(0,cz.varchar)("seller_id").notNull().references(()=>eK.id),priceCoins:(0,cA.integer)("price_coins").notNull(),transactionId:(0,cz.varchar)("transaction_id").notNull().references(()=>eM.id),purchasedAt:(0,bO.timestamp)("purchased_at").notNull().defaultNow()},a=>({buyerIdIdx:cF("idx_content_purchases_user_id").on(a.buyerId),contentIdIdx:cF("idx_content_purchases_content_id").on(a.contentId)})),eT=(0,bQ.pgTable)("content_reviews",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),contentId:(0,cz.varchar)("content_id").notNull().references(()=>eR.id),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),rating:(0,cA.integer)("rating").notNull(),review:(0,cy.text)("review").notNull(),status:(0,cy.text)("status").notNull().$type().default("pending"),rewardGiven:(0,cB.boolean)("reward_given").notNull().default(!1),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({uniqueContentUserReview:cG("idx_content_reviews_unique_content_user").on(a.contentId,a.userId)})),eU=(0,bQ.pgTable)("content_likes",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),contentId:(0,cz.varchar)("content_id").notNull().references(()=>eR.id),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_content_likes_user_id").on(a.userId),uniqueContentUserLike:cG("idx_content_likes_unique_content_user").on(a.contentId,a.userId)})),eV=(0,bQ.pgTable)("content_replies",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),contentId:(0,cz.varchar)("content_id").notNull().references(()=>eR.id),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),parentId:(0,cz.varchar)("parent_id").references(()=>eV.id),body:(0,cy.text)("body").notNull(),rating:(0,cA.integer)("rating"),imageUrls:(0,cy.text)("image_urls").array(),helpful:(0,cA.integer)("helpful").notNull().default(0),isVerified:(0,cB.boolean)("is_verified").notNull().default(!1),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()}),eW=(0,bQ.pgTable)("brokers",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),name:(0,cy.text)("name").notNull(),slug:(0,cy.text)("slug").notNull().unique(),websiteUrl:(0,cy.text)("website_url"),logoUrl:(0,cy.text)("logo_url"),yearFounded:(0,cA.integer)("year_founded"),regulation:(0,cy.text)("regulation"),regulationSummary:(0,cy.text)("regulation_summary"),platform:(0,cy.text)("platform"),spreadType:(0,cy.text)("spread_type"),minSpread:(0,bM.numeric)("min_spread",{precision:10,scale:2}),overallRating:(0,cA.integer)("overall_rating").default(0),reviewCount:(0,cA.integer)("review_count").notNull().default(0),scamReportCount:(0,cA.integer)("scam_report_count").notNull().default(0),isVerified:(0,cB.boolean)("is_verified").notNull().default(!1),status:(0,cy.text)("status").notNull().$type().default("pending"),verifiedBy:(0,cz.varchar)("verified_by").references(()=>eK.id),verifiedAt:(0,bO.timestamp)("verified_at"),rejectedBy:(0,cz.varchar)("rejected_by").references(()=>eK.id),rejectedAt:(0,bO.timestamp)("rejected_at"),rejectionReason:(0,cy.text)("rejection_reason"),scamWarning:(0,cB.boolean)("scam_warning").notNull().default(!1),scamWarningReason:(0,cy.text)("scam_warning_reason"),deletedAt:(0,bO.timestamp)("deleted_at"),country:(0,cy.text)("country"),minDeposit:(0,cy.text)("min_deposit"),leverage:(0,cy.text)("leverage"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({slugIdx:cF("idx_brokers_slug").on(a.slug),statusIdx:cF("idx_brokers_status").on(a.status),regulationIdx:cF("idx_brokers_regulation").on(a.regulation),platformIdx:cF("idx_brokers_platform").on(a.platform),verifiedIdx:cF("idx_brokers_verified").on(a.isVerified),scamWarningIdx:cF("idx_brokers_scam_warning").on(a.scamWarning),deletedAtIdx:cF("idx_brokers_deleted_at").on(a.deletedAt),countryIdx:cF("idx_brokers_country").on(a.country)})),eX=(0,bQ.pgTable)("broker_reviews",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),brokerId:(0,cz.varchar)("broker_id").notNull().references(()=>eW.id),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),rating:(0,cA.integer)("rating").notNull(),reviewTitle:(0,cy.text)("review_title").notNull(),reviewBody:(0,cy.text)("review_body").notNull(),isScamReport:(0,cB.boolean)("is_scam_report").notNull().default(!1),status:(0,cy.text)("status").notNull().$type().default("pending"),approvedBy:(0,cz.varchar)("approved_by").references(()=>eK.id),approvedAt:(0,bO.timestamp)("approved_at"),rejectedBy:(0,cz.varchar)("rejected_by").references(()=>eK.id),rejectedAt:(0,bO.timestamp)("rejected_at"),rejectionReason:(0,cy.text)("rejection_reason"),scamSeverity:(0,cy.text)("scam_severity").$type(),datePosted:(0,bO.timestamp)("date_posted").notNull().defaultNow()},a=>({brokerIdIdx:cF("idx_broker_reviews_broker_id").on(a.brokerId),uniqueBrokerUserReview:cG("idx_broker_reviews_unique_broker_user").on(a.brokerId,a.userId),severityIdx:cF("idx_broker_reviews_severity").on(a.scamSeverity)})),eY=(0,bQ.pgTable)("user_follows",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),followerId:(0,cz.varchar)("follower_id").notNull().references(()=>eK.id),followingId:(0,cz.varchar)("following_id").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({followerIdIdx:cF("idx_user_follows_follower_id").on(a.followerId),uniqueFollowerFollowing:cG("idx_user_follows_unique_follower_following").on(a.followerId,a.followingId)})),eZ=(0,bQ.pgTable)("conversations",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),participant1Id:(0,cz.varchar)("participant1_id").notNull().references(()=>eK.id),participant2Id:(0,cz.varchar)("participant2_id").notNull().references(()=>eK.id),lastMessageAt:(0,bO.timestamp)("last_message_at").notNull().defaultNow(),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()}),e$=(0,bQ.pgTable)("messages",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),conversationId:(0,cz.varchar)("conversation_id").notNull().references(()=>eZ.id),senderId:(0,cz.varchar)("sender_id").notNull().references(()=>eK.id),recipientId:(0,cz.varchar)("recipient_id").notNull().references(()=>eK.id),body:(0,cy.text)("body").notNull(),isRead:(0,cB.boolean)("is_read").notNull().default(!1),deliveredAt:(0,bO.timestamp)("delivered_at"),readAt:(0,bO.timestamp)("read_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({conversationIdIdx:cF("idx_messages_conversation_id").on(a.conversationId),senderIdIdx:cF("idx_messages_sender_id").on(a.senderId),recipientIdIdx:cF("idx_messages_recipient_id").on(a.recipientId),createdAtIdx:cF("idx_messages_created_at").on(a.createdAt),isReadIdx:cF("idx_messages_is_read").on(a.isRead)})),e_=(0,bQ.pgTable)("message_reactions",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),messageId:(0,cz.varchar)("message_id").notNull().references(()=>e$.id,{onDelete:"cascade"}),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id,{onDelete:"cascade"}),emoji:(0,cz.varchar)("emoji",{length:10}).notNull(),createdAt:(0,bO.timestamp)("created_at").defaultNow().notNull()},a=>({messageUserIdx:cF("message_reactions_msg_user_idx").on(a.messageId,a.userId)})),e0=(0,bQ.pgTable)("notifications",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),type:(0,cy.text)("type").notNull().$type(),title:(0,cy.text)("title").notNull(),message:(0,cy.text)("message").notNull(),actionUrl:(0,cy.text)("action_url"),isRead:(0,cB.boolean)("is_read").notNull().default(!1),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_notifications_user_id").on(a.userId),isReadIdx:cF("idx_notifications_is_read").on(a.isRead),createdAtIdx:cF("idx_notifications_created_at").on(a.createdAt)})),e1=(0,bQ.pgTable)("forum_threads",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),authorId:(0,cz.varchar)("author_id").notNull().references(()=>eK.id),categorySlug:(0,cy.text)("category_slug").notNull(),subcategorySlug:(0,cy.text)("subcategory_slug"),title:(0,cy.text)("title").notNull(),body:(0,cy.text)("body").notNull(),slug:(0,cy.text)("slug").notNull().unique(),focusKeyword:(0,cy.text)("focus_keyword"),metaDescription:(0,cy.text)("meta_description"),threadType:(0,cy.text)("thread_type").notNull().$type().default("discussion"),seoExcerpt:(0,cy.text)("seo_excerpt"),primaryKeyword:(0,cy.text)("primary_keyword"),language:(0,cy.text)("language").notNull().default("en"),instruments:(0,cy.text)("instruments").array().default(bu.sql`'{}'::text[]`),timeframes:(0,cy.text)("timeframes").array().default(bu.sql`'{}'::text[]`),strategies:(0,cy.text)("strategies").array().default(bu.sql`'{}'::text[]`),platform:(0,cy.text)("platform"),broker:(0,cy.text)("broker"),riskNote:(0,cy.text)("risk_note"),hashtags:(0,cy.text)("hashtags").array().default(bu.sql`'{}'::text[]`),reviewTarget:(0,cy.text)("review_target"),reviewVersion:(0,cy.text)("review_version"),reviewRating:(0,cA.integer)("review_rating"),reviewPros:(0,cy.text)("review_pros").array(),reviewCons:(0,cy.text)("review_cons").array(),questionSummary:(0,cy.text)("question_summary"),acceptedAnswerId:(0,cz.varchar)("accepted_answer_id"),attachmentUrls:(0,cy.text)("attachment_urls").array().default(bu.sql`'{}'::text[]`),isPinned:(0,cB.boolean)("is_pinned").notNull().default(!1),isLocked:(0,cB.boolean)("is_locked").notNull().default(!1),isSolved:(0,cB.boolean)("is_solved").notNull().default(!1),views:(0,cA.integer)("views").notNull().default(0),replyCount:(0,cA.integer)("reply_count").notNull().default(0),likeCount:(0,cA.integer)("like_count").notNull().default(0),bookmarkCount:(0,cA.integer)("bookmark_count").notNull().default(0),shareCount:(0,cA.integer)("share_count").notNull().default(0),lastActivityAt:(0,bO.timestamp)("last_activity_at").notNull().defaultNow(),status:(0,cy.text)("status").notNull().$type().default("approved"),engagementScore:(0,cA.integer)("engagement_score").notNull().default(0),lastScoreUpdate:(0,bO.timestamp)("last_score_update"),helpfulVotes:(0,cA.integer)("helpful_votes").notNull().default(0),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({categorySlugIdx:cF("idx_forum_threads_category").on(a.categorySlug),subcategorySlugIdx:cF("idx_forum_threads_subcategory").on(a.subcategorySlug),threadTypeIdx:cF("idx_forum_threads_type").on(a.threadType),statusIdx:cF("idx_forum_threads_status").on(a.status),isPinnedIdx:cF("idx_forum_threads_pinned").on(a.isPinned),engagementScoreIdx:cF("idx_forum_threads_engagement").on(a.engagementScore),lastActivityAtIdx:cF("idx_forum_threads_last_activity").on(a.lastActivityAt),slugIdx:cF("idx_forum_threads_slug").on(a.slug),helpfulVotesIdx:cF("idx_forum_threads_helpful_votes").on(a.helpfulVotes)})),e2=(0,bQ.pgTable)("forum_replies",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),threadId:(0,cz.varchar)("thread_id").notNull().references(()=>e1.id),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),parentId:(0,cz.varchar)("parent_id").references(()=>e2.id),body:(0,cy.text)("body").notNull(),slug:(0,cy.text)("slug").notNull().unique(),metaDescription:(0,cy.text)("meta_description"),imageUrls:(0,cy.text)("image_urls").array(),helpful:(0,cA.integer)("helpful").notNull().default(0),helpfulVotes:(0,cA.integer)("helpful_votes").notNull().default(0),isAccepted:(0,cB.boolean)("is_accepted").notNull().default(!1),isVerified:(0,cB.boolean)("is_verified").notNull().default(!1),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow(),status:(0,cy.text)("status").notNull().$type().default("approved"),approvedBy:(0,cz.varchar)("approved_by").references(()=>eK.id),rejectedBy:(0,cz.varchar)("rejected_by").references(()=>eK.id),approvedAt:(0,bO.timestamp)("approved_at"),rejectedAt:(0,bO.timestamp)("rejected_at")},a=>({threadIdIdx:cF("idx_forum_replies_thread_id").on(a.threadId),createdAtIdx:cF("idx_forum_replies_created_at").on(a.createdAt),slugIdx:cF("idx_forum_replies_slug").on(a.slug),helpfulVotesIdx:cF("idx_forum_replies_helpful_votes").on(a.helpfulVotes),statusIdx:cF("idx_forum_replies_status").on(a.status)})),e3=(0,bQ.pgTable)("forum_categories",{slug:(0,cy.text)("slug").primaryKey(),name:(0,cy.text)("name").notNull(),description:(0,cy.text)("description").notNull(),icon:(0,cy.text)("icon").notNull(),color:(0,cy.text)("color").notNull().default("bg-primary"),parentSlug:(0,cy.text)("parent_slug"),threadCount:(0,cA.integer)("thread_count").notNull().default(0),postCount:(0,cA.integer)("post_count").notNull().default(0),sortOrder:(0,cA.integer)("sort_order").notNull().default(0),isActive:(0,cB.boolean)("is_active").notNull().default(!0),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({parentSlugIdx:cF("idx_forum_categories_parent_slug").on(a.parentSlug)})),e4=(0,bQ.pgTable)("user_badges",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),badgeType:(0,cy.text)("badge_type").notNull().$type(),awardedAt:(0,bO.timestamp)("awarded_at").notNull().defaultNow()}),e5=(0,bQ.pgTable)("activity_feed",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),activityType:(0,cy.text)("activity_type").notNull().$type(),entityType:(0,cy.text)("entity_type").notNull().$type(),entityId:(0,cz.varchar)("entity_id").notNull(),title:(0,cy.text)("title").notNull(),description:(0,cy.text)("description"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_activity_feed_user_id").on(a.userId)})),e6=(0,bQ.pgTable)("user_wallet",{walletId:(0,cz.varchar)("wallet_id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),balance:(0,cA.integer)("balance").notNull().default(0),availableBalance:(0,cA.integer)("available_balance").notNull().default(0),status:(0,cy.text)("status").notNull().default("active"),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cG("idx_user_wallet_user_id").on(a.userId),statusIdx:cF("idx_user_wallet_status").on(a.status)})),e7=(0,bQ.pgTable)("coin_ledger_transactions",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),type:(0,cy.text)("type").notNull(),context:(0,bK.json)("context").$type(),externalRef:(0,cy.text)("external_ref"),initiatorUserId:(0,cz.varchar)("initiator_user_id").references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),closedAt:(0,bO.timestamp)("closed_at"),status:(0,cy.text)("status").notNull().default("pending")},a=>({typeIdx:cF("idx_ledger_tx_type").on(a.type),statusIdx:cF("idx_ledger_tx_status").on(a.status),initiatorIdx:cF("idx_ledger_tx_initiator").on(a.initiatorUserId)})),e8=(0,bQ.pgTable)("coin_journal_entries",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),ledgerTransactionId:(0,cz.varchar)("ledger_transaction_id").notNull().references(()=>e7.id),walletId:(0,cz.varchar)("wallet_id").notNull().references(()=>e6.walletId),direction:(0,cy.text)("direction").notNull(),amount:(0,cA.integer)("amount").notNull(),balanceBefore:(0,cA.integer)("balance_before").notNull(),balanceAfter:(0,cA.integer)("balance_after").notNull(),memo:(0,cy.text)("memo"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({ledgerTxIdx:cF("idx_journal_ledger_tx").on(a.ledgerTransactionId),walletIdx:cF("idx_journal_wallet").on(a.walletId),createdAtIdx:cF("idx_journal_created_at").on(a.createdAt),amountCheck:new cH("chk_amount_positive",bu.sql`${a.amount} > 0`)})),e9=(0,bQ.pgTable)("ledger_reconciliation_runs",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),status:(0,cy.text)("status").notNull(),driftCount:(0,cA.integer)("drift_count").notNull().default(0),maxDelta:(0,cA.integer)("max_delta").notNull().default(0),report:(0,bK.json)("report").$type(),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),completedAt:(0,bO.timestamp)("completed_at")}),fa=(0,bQ.pgTable)("dashboard_preferences",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id).unique(),widgetOrder:(0,cy.text)("widget_order").array().notNull(),enabledWidgets:(0,cy.text)("enabled_widgets").array().notNull(),layoutType:(0,cy.text)("layout_type").notNull().$type().default("default"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_dashboard_preferences_user_id").on(a.userId)})),fb=(0,bQ.pgTable)("daily_activity_limits",{id:(0,cz.varchar)("id").primaryKey().default(bu.sql`gen_random_uuid()`),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),activityDate:(0,bO.timestamp)("activity_date").notNull().defaultNow(),repliesCount:(0,cA.integer)("replies_count").notNull().default(0),reportsCount:(0,cA.integer)("reports_count").notNull().default(0),backtestsCount:(0,cA.integer)("backtests_count").notNull().default(0),lastCheckinAt:(0,bO.timestamp)("last_checkin_at"),consecutiveDays:(0,cA.integer)("consecutive_days").notNull().default(0),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userDateIdx:cG("idx_daily_activity_user_date").on(a.userId,a.activityDate),userIdIdx:cF("idx_daily_activity_user_id").on(a.userId)})),fc=(0,bQ.pgTable)("referrals",{id:(0,cJ.serial)("id").primaryKey(),referrerId:(0,cz.varchar)("referrer_id").notNull().references(()=>eK.id),referredUserId:(0,cz.varchar)("referred_user_id").notNull().references(()=>eK.id),referralCode:(0,cz.varchar)("referral_code",{length:50}).notNull().unique(),status:(0,cz.varchar)("status",{length:20}).notNull().default("active"),totalEarnings:(0,cA.integer)("total_earnings").notNull().default(0),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({referrerIdx:cF("idx_referrals_referrer_id").on(a.referrerId),referredIdx:cG("idx_referrals_referred_user_id").on(a.referredUserId),referralCodeIdx:cF("idx_referrals_code").on(a.referralCode)})),fd=(0,bQ.pgTable)("goals",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),goalType:(0,cz.varchar)("goal_type",{length:50}).notNull(),targetValue:(0,cA.integer)("target_value").notNull(),currentValue:(0,cA.integer)("current_value").notNull().default(0),startDate:(0,bO.timestamp)("start_date").notNull(),endDate:(0,bO.timestamp)("end_date").notNull(),status:(0,cz.varchar)("status",{length:20}).notNull().default("active"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_goals_user_id").on(a.userId)})),fe=(0,bQ.pgTable)("achievements",{id:(0,cJ.serial)("id").primaryKey(),slug:(0,cz.varchar)("slug",{length:100}).notNull().unique(),name:(0,cz.varchar)("name",{length:200}).notNull(),description:(0,cy.text)("description").notNull(),icon:(0,cz.varchar)("icon",{length:50}).notNull(),requirement:(0,cA.integer)("requirement").notNull(),category:(0,cz.varchar)("category",{length:50}).notNull(),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({slugIdx:cF("idx_achievements_slug").on(a.slug)})),ff=(0,bQ.pgTable)("user_achievements",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),achievementId:(0,cA.integer)("achievement_id").notNull().references(()=>fe.id),progress:(0,cA.integer)("progress").notNull().default(0),unlockedAt:(0,bO.timestamp)("unlocked_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_user_achievements_user_id").on(a.userId),achievementIdIdx:cF("idx_user_achievements_achievement_id").on(a.achievementId)})),fg=(0,bQ.pgTable)("campaigns",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),name:(0,cz.varchar)("name",{length:200}).notNull(),type:(0,cz.varchar)("type",{length:50}).notNull(),status:(0,cz.varchar)("status",{length:20}).notNull().default("active"),discountPercent:(0,cA.integer)("discount_percent"),discountCode:(0,cz.varchar)("discount_code",{length:50}).unique(),startDate:(0,bO.timestamp)("start_date").notNull(),endDate:(0,bO.timestamp)("end_date").notNull(),uses:(0,cA.integer)("uses").notNull().default(0),revenue:(0,cA.integer)("revenue").notNull().default(0),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_campaigns_user_id").on(a.userId),discountCodeIdx:cF("idx_campaigns_discount_code").on(a.discountCode)})),fh=(0,bQ.pgTable)("dashboard_settings",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id).unique(),layout:(0,bK.json)("layout"),theme:(0,cz.varchar)("theme",{length:20}).default("light"),autoRefresh:(0,cB.boolean)("auto_refresh").default(!0),refreshInterval:(0,cA.integer)("refresh_interval").default(30),favorites:(0,bK.json)("favorites"),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cG("idx_dashboard_settings_user_id").on(a.userId)})),fi=(0,bQ.pgTable)("profiles",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id).unique(),coverPhoto:(0,cy.text)("cover_photo"),bio:(0,cy.text)("bio"),tradingLevel:(0,cz.varchar)("trading_level",{length:50}),tradingStyle:(0,bK.json)("trading_style"),tradingPlatform:(0,bK.json)("trading_platform"),tradingSince:(0,bJ.date)("trading_since"),specialties:(0,bK.json)("specialties"),telegram:(0,cz.varchar)("telegram",{length:100}),discord:(0,cz.varchar)("discord",{length:100}),twitter:(0,cz.varchar)("twitter",{length:100}),youtube:(0,cz.varchar)("youtube",{length:200}),tradingview:(0,cz.varchar)("tradingview",{length:200}),website:(0,cz.varchar)("website",{length:200}),profileLayout:(0,cz.varchar)("profile_layout",{length:20}).default("professional"),customSlug:(0,cz.varchar)("custom_slug",{length:100}).unique(),isPublic:(0,cB.boolean)("is_public").default(!0),isPremium:(0,cB.boolean)("is_premium").default(!1),brandColors:(0,bK.json)("brand_colors"),showRevenue:(0,cB.boolean)("show_revenue").default(!0),showSales:(0,cB.boolean)("show_sales").default(!0),showFollowers:(0,cB.boolean)("show_followers").default(!0),showActivity:(0,cB.boolean)("show_activity").default(!0),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cG("idx_profiles_user_id").on(a.userId),customSlugIdx:cF("idx_profiles_custom_slug").on(a.customSlug)})),fj=(0,bQ.pgTable)("user_settings",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id).unique(),notificationPreferences:(0,bK.json)("notification_preferences"),privacySettings:(0,bK.json)("privacy_settings"),displaySettings:(0,bK.json)("display_settings"),communicationSettings:(0,bK.json)("communication_settings"),publishingDefaults:(0,bK.json)("publishing_defaults"),advancedSettings:(0,bK.json)("advanced_settings"),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({userIdIdx:cG("idx_user_settings_user_id").on(a.userId)})),fk=(0,bQ.pgTable)("admin_actions",{id:(0,cJ.serial)("id").primaryKey(),adminId:(0,cz.varchar)("admin_id").notNull().references(()=>eK.id),actionType:(0,cz.varchar)("action_type").notNull(),targetType:(0,cz.varchar)("target_type").notNull(),targetId:(0,cz.varchar)("target_id"),details:(0,bL.jsonb)("details"),ipAddress:(0,cz.varchar)("ip_address"),userAgent:(0,cz.varchar)("user_agent"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({adminIdIdx:cF("idx_admin_actions_admin_id").on(a.adminId),actionTypeIdx:cF("idx_admin_actions_action_type").on(a.actionType),targetTypeIdx:cF("idx_admin_actions_target_type").on(a.targetType),createdAtIdx:cF("idx_admin_actions_created_at").on(a.createdAt)})),fl=(0,bQ.pgTable)("moderation_queue",{id:(0,cJ.serial)("id").primaryKey(),contentType:(0,cz.varchar)("content_type").notNull(),contentId:(0,cz.varchar)("content_id").notNull(),authorId:(0,cz.varchar)("author_id").notNull().references(()=>eK.id),status:(0,cz.varchar)("status").notNull().default("pending"),priorityScore:(0,cA.integer)("priority_score").notNull().default(0),spamScore:(0,bM.numeric)("spam_score",{precision:3,scale:2}),sentimentScore:(0,bM.numeric)("sentiment_score",{precision:3,scale:2}),flaggedReasons:(0,cy.text)("flagged_reasons").array().default(bu.sql`'{}'::text[]`),reviewedBy:(0,cz.varchar)("reviewed_by").references(()=>eK.id),reviewedAt:(0,bO.timestamp)("reviewed_at"),reviewNotes:(0,cy.text)("review_notes"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({statusIdx:cF("idx_moderation_queue_status").on(a.status),priorityScoreIdx:cF("idx_moderation_queue_priority_score").on(a.priorityScore),createdAtIdx:cF("idx_moderation_queue_created_at").on(a.createdAt)})),fm=(0,bQ.pgTable)("reported_content",{id:(0,cJ.serial)("id").primaryKey(),reporterId:(0,cz.varchar)("reporter_id").notNull().references(()=>eK.id),contentType:(0,cz.varchar)("content_type").notNull(),contentId:(0,cz.varchar)("content_id").notNull(),reportReason:(0,cz.varchar)("report_reason").notNull(),description:(0,cy.text)("description").notNull(),status:(0,cz.varchar)("status").notNull().default("pending"),assignedTo:(0,cz.varchar)("assigned_to").references(()=>eK.id),resolution:(0,cy.text)("resolution"),actionTaken:(0,cz.varchar)("action_taken"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),resolvedAt:(0,bO.timestamp)("resolved_at")},a=>({statusIdx:cF("idx_reported_content_status").on(a.status),contentTypeIdx:cF("idx_reported_content_content_type").on(a.contentType),reporterIdIdx:cF("idx_reported_content_reporter_id").on(a.reporterId),createdAtIdx:cF("idx_reported_content_created_at").on(a.createdAt)})),fn=(0,bQ.pgTable)("system_settings",{id:(0,cJ.serial)("id").primaryKey(),settingKey:(0,cz.varchar)("setting_key").notNull().unique(),settingValue:(0,bL.jsonb)("setting_value").notNull(),category:(0,cz.varchar)("category").notNull(),description:(0,cy.text)("description"),updatedBy:(0,cz.varchar)("updated_by").references(()=>eK.id),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({settingKeyIdx:cF("idx_system_settings_setting_key").on(a.settingKey),categoryIdx:cF("idx_system_settings_category").on(a.category)})),fo=(0,bQ.pgTable)("support_tickets",{id:(0,cJ.serial)("id").primaryKey(),ticketNumber:(0,cz.varchar)("ticket_number").notNull().unique(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),subject:(0,cz.varchar)("subject").notNull(),description:(0,cy.text)("description").notNull(),status:(0,cz.varchar)("status").notNull().default("open"),priority:(0,cz.varchar)("priority").notNull().default("medium"),category:(0,cz.varchar)("category").notNull(),assignedTo:(0,cz.varchar)("assigned_to").references(()=>eK.id),replies:(0,bL.jsonb)("replies").array().default(bu.sql`'{}'::jsonb[]`),tags:(0,cy.text)("tags").array().default(bu.sql`'{}'::text[]`),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow(),resolvedAt:(0,bO.timestamp)("resolved_at")},a=>({statusIdx:cF("idx_support_tickets_status").on(a.status),priorityIdx:cF("idx_support_tickets_priority").on(a.priority),userIdIdx:cF("idx_support_tickets_user_id").on(a.userId),assignedToIdx:cF("idx_support_tickets_assigned_to").on(a.assignedTo),createdAtIdx:cF("idx_support_tickets_created_at").on(a.createdAt)})),fp=(0,bQ.pgTable)("announcements",{id:(0,cJ.serial)("id").primaryKey(),title:(0,cz.varchar)("title").notNull(),content:(0,cy.text)("content").notNull(),type:(0,cz.varchar)("type").notNull().default("info"),targetAudience:(0,cz.varchar)("target_audience").notNull().default("all"),segmentId:(0,cA.integer)("segment_id"),displayType:(0,cz.varchar)("display_type").notNull().default("banner"),isActive:(0,cB.boolean)("is_active").notNull().default(!0),startDate:(0,bO.timestamp)("start_date").notNull(),endDate:(0,bO.timestamp)("end_date"),createdBy:(0,cz.varchar)("created_by").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),views:(0,cA.integer)("views").notNull().default(0),clicks:(0,cA.integer)("clicks").notNull().default(0)},a=>({isActiveIdx:cF("idx_announcements_is_active").on(a.isActive),targetAudienceIdx:cF("idx_announcements_target_audience").on(a.targetAudience),startDateIdx:cF("idx_announcements_start_date").on(a.startDate),endDateIdx:cF("idx_announcements_end_date").on(a.endDate)})),fq=(0,bQ.pgTable)("ip_bans",{id:(0,cJ.serial)("id").primaryKey(),ipAddress:(0,cz.varchar)("ip_address").notNull().unique(),reason:(0,cy.text)("reason").notNull(),banType:(0,cz.varchar)("ban_type").notNull().default("permanent"),expiresAt:(0,bO.timestamp)("expires_at"),bannedBy:(0,cz.varchar)("banned_by").notNull().references(()=>eK.id),bannedAt:(0,bO.timestamp)("banned_at").notNull().defaultNow(),isActive:(0,cB.boolean)("is_active").notNull().default(!0)},a=>({ipAddressIdx:cF("idx_ip_bans_ip_address").on(a.ipAddress),isActiveIdx:cF("idx_ip_bans_is_active").on(a.isActive),expiresAtIdx:cF("idx_ip_bans_expires_at").on(a.expiresAt)})),fr=(0,bQ.pgTable)("email_templates",{id:(0,cJ.serial)("id").primaryKey(),templateKey:(0,cz.varchar)("template_key").notNull().unique(),subject:(0,cz.varchar)("subject").notNull(),htmlBody:(0,cy.text)("html_body").notNull(),textBody:(0,cy.text)("text_body").notNull(),variables:(0,cy.text)("variables").array().default(bu.sql`'{}'::text[]`),category:(0,cz.varchar)("category").notNull(),isActive:(0,cB.boolean)("is_active").notNull().default(!0),updatedBy:(0,cz.varchar)("updated_by").references(()=>eK.id),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({templateKeyIdx:cF("idx_email_templates_template_key").on(a.templateKey),categoryIdx:cF("idx_email_templates_category").on(a.category),isActiveIdx:cF("idx_email_templates_is_active").on(a.isActive)})),fs=(0,bQ.pgTable)("admin_roles",{id:(0,cJ.serial)("id").primaryKey(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id).unique(),role:(0,cz.varchar)("role").notNull(),permissions:(0,bL.jsonb)("permissions").notNull(),grantedBy:(0,cz.varchar)("granted_by").notNull().references(()=>eK.id),grantedAt:(0,bO.timestamp)("granted_at").notNull().defaultNow()},a=>({userIdIdx:cF("idx_admin_roles_user_id").on(a.userId),roleIdx:cF("idx_admin_roles_role").on(a.role)})),ft=(0,bQ.pgTable)("user_segments",{id:(0,cJ.serial)("id").primaryKey(),name:(0,cz.varchar)("name").notNull(),description:(0,cy.text)("description").notNull(),rules:(0,bL.jsonb)("rules").notNull(),userCount:(0,cA.integer)("user_count").notNull().default(0),createdBy:(0,cz.varchar)("created_by").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({nameIdx:cF("idx_user_segments_name").on(a.name),createdAtIdx:cF("idx_user_segments_created_at").on(a.createdAt)})),fu=(0,bQ.pgTable)("automation_rules",{id:(0,cJ.serial)("id").primaryKey(),name:(0,cz.varchar)("name").notNull(),description:(0,cy.text)("description").notNull(),triggerType:(0,cz.varchar)("trigger_type").notNull(),triggerConfig:(0,bL.jsonb)("trigger_config").notNull(),actionType:(0,cz.varchar)("action_type").notNull(),actionConfig:(0,bL.jsonb)("action_config").notNull(),isActive:(0,cB.boolean)("is_active").notNull().default(!0),executionCount:(0,cA.integer)("execution_count").notNull().default(0),lastExecuted:(0,bO.timestamp)("last_executed"),createdBy:(0,cz.varchar)("created_by").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({triggerTypeIdx:cF("idx_automation_rules_trigger_type").on(a.triggerType),isActiveIdx:cF("idx_automation_rules_is_active").on(a.isActive),createdAtIdx:cF("idx_automation_rules_created_at").on(a.createdAt)})),fv=(0,bQ.pgTable)("ab_tests",{id:(0,cJ.serial)("id").primaryKey(),name:(0,cz.varchar)("name").notNull(),description:(0,cy.text)("description").notNull(),variants:(0,bL.jsonb)("variants").array().default(bu.sql`'{}'::jsonb[]`),trafficAllocation:(0,bL.jsonb)("traffic_allocation").notNull(),status:(0,cz.varchar)("status").notNull().default("draft"),startDate:(0,bO.timestamp)("start_date"),endDate:(0,bO.timestamp)("end_date"),winnerVariant:(0,cz.varchar)("winner_variant"),createdBy:(0,cz.varchar)("created_by").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({statusIdx:cF("idx_ab_tests_status").on(a.status),startDateIdx:cF("idx_ab_tests_start_date").on(a.startDate),endDateIdx:cF("idx_ab_tests_end_date").on(a.endDate)})),fw=(0,bQ.pgTable)("feature_flags",{id:(0,cJ.serial)("id").primaryKey(),flagKey:(0,cz.varchar)("flag_key").notNull().unique(),name:(0,cz.varchar)("name").notNull(),description:(0,cy.text)("description").notNull(),isEnabled:(0,cB.boolean)("is_enabled").notNull().default(!1),rolloutPercentage:(0,cA.integer)("rollout_percentage").notNull().default(0),targetUsers:(0,cy.text)("target_users").array().default(bu.sql`'{}'::text[]`),targetSegments:(0,cA.integer)("target_segments").array().default(bu.sql`'{}'::integer[]`),createdBy:(0,cz.varchar)("created_by").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,bO.timestamp)("updated_at").notNull().defaultNow()},a=>({flagKeyIdx:cF("idx_feature_flags_flag_key").on(a.flagKey),isEnabledIdx:cF("idx_feature_flags_is_enabled").on(a.isEnabled)})),fx=(0,bQ.pgTable)("api_keys",{id:(0,cJ.serial)("id").primaryKey(),key:(0,cz.varchar)("key").notNull().unique(),name:(0,cz.varchar)("name").notNull(),userId:(0,cz.varchar)("user_id").notNull().references(()=>eK.id),permissions:(0,cy.text)("permissions").array().default(bu.sql`'{}'::text[]`),rateLimit:(0,cA.integer)("rate_limit").notNull().default(60),isActive:(0,cB.boolean)("is_active").notNull().default(!0),lastUsed:(0,bO.timestamp)("last_used"),expiresAt:(0,bO.timestamp)("expires_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({keyIdx:cF("idx_api_keys_key").on(a.key),userIdIdx:cF("idx_api_keys_user_id").on(a.userId),isActiveIdx:cF("idx_api_keys_is_active").on(a.isActive)})),fy=(0,bQ.pgTable)("webhooks",{id:(0,cJ.serial)("id").primaryKey(),url:(0,cz.varchar)("url").notNull(),events:(0,cy.text)("events").array().default(bu.sql`'{}'::text[]`),secret:(0,cz.varchar)("secret").notNull(),isActive:(0,cB.boolean)("is_active").notNull().default(!0),createdBy:(0,cz.varchar)("created_by").notNull().references(()=>eK.id),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow(),lastTriggered:(0,bO.timestamp)("last_triggered"),successCount:(0,cA.integer)("success_count").notNull().default(0),failureCount:(0,cA.integer)("failure_count").notNull().default(0)},a=>({isActiveIdx:cF("idx_webhooks_is_active").on(a.isActive),createdAtIdx:cF("idx_webhooks_created_at").on(a.createdAt)})),fz=(0,bQ.pgTable)("scheduled_jobs",{id:(0,cJ.serial)("id").primaryKey(),jobKey:(0,cz.varchar)("job_key").notNull().unique(),name:(0,cz.varchar)("name").notNull(),description:(0,cy.text)("description").notNull(),schedule:(0,cz.varchar)("schedule").notNull(),isActive:(0,cB.boolean)("is_active").notNull().default(!0),lastRun:(0,bO.timestamp)("last_run"),nextRun:(0,bO.timestamp)("next_run"),lastStatus:(0,cz.varchar)("last_status"),lastError:(0,cy.text)("last_error"),executionCount:(0,cA.integer)("execution_count").notNull().default(0)},a=>({jobKeyIdx:cF("idx_scheduled_jobs_job_key").on(a.jobKey),isActiveIdx:cF("idx_scheduled_jobs_is_active").on(a.isActive),nextRunIdx:cF("idx_scheduled_jobs_next_run").on(a.nextRun)})),fA=(0,bQ.pgTable)("performance_metrics",{id:(0,cJ.serial)("id").primaryKey(),metricType:(0,cz.varchar)("metric_type").notNull(),metricName:(0,cz.varchar)("metric_name").notNull(),value:(0,bM.numeric)("value",{precision:10,scale:2}).notNull(),unit:(0,cz.varchar)("unit").notNull(),metadata:(0,bL.jsonb)("metadata"),recordedAt:(0,bO.timestamp)("recorded_at").notNull().defaultNow()},a=>({metricTypeIdx:cF("idx_performance_metrics_metric_type").on(a.metricType),metricNameIdx:cF("idx_performance_metrics_metric_name").on(a.metricName),recordedAtIdx:cF("idx_performance_metrics_recorded_at").on(a.recordedAt)})),fB=(0,bQ.pgTable)("security_events",{id:(0,cJ.serial)("id").primaryKey(),eventType:(0,cz.varchar)("event_type").notNull(),severity:(0,cz.varchar)("severity").notNull(),userId:(0,cz.varchar)("user_id").references(()=>eK.id),ipAddress:(0,cz.varchar)("ip_address").notNull(),details:(0,bL.jsonb)("details").notNull(),isResolved:(0,cB.boolean)("is_resolved").notNull().default(!1),resolvedBy:(0,cz.varchar)("resolved_by").references(()=>eK.id),resolvedAt:(0,bO.timestamp)("resolved_at"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({eventTypeIdx:cF("idx_security_events_event_type").on(a.eventType),severityIdx:cF("idx_security_events_severity").on(a.severity),isResolvedIdx:cF("idx_security_events_is_resolved").on(a.isResolved),createdAtIdx:cF("idx_security_events_created_at").on(a.createdAt)})),fC=(0,bQ.pgTable)("media_library",{id:(0,cJ.serial)("id").primaryKey(),filename:(0,cz.varchar)("filename").notNull(),originalFilename:(0,cz.varchar)("original_filename").notNull(),filePath:(0,cz.varchar)("file_path").notNull(),fileSize:(0,cA.integer)("file_size").notNull(),mimeType:(0,cz.varchar)("mime_type").notNull(),width:(0,cA.integer)("width"),height:(0,cA.integer)("height"),altText:(0,cz.varchar)("alt_text"),tags:(0,cy.text)("tags").array().default(bu.sql`'{}'::text[]`),uploadedBy:(0,cz.varchar)("uploaded_by").notNull().references(()=>eK.id),uploadedAt:(0,bO.timestamp)("uploaded_at").notNull().defaultNow(),usageCount:(0,cA.integer)("usage_count").notNull().default(0)},a=>({uploadedByIdx:cF("idx_media_library_uploaded_by").on(a.uploadedBy),mimeTypeIdx:cF("idx_media_library_mime_type").on(a.mimeType),uploadedAtIdx:cF("idx_media_library_uploaded_at").on(a.uploadedAt)})),fD=(0,bQ.pgTable)("content_revisions",{id:(0,cJ.serial)("id").primaryKey(),contentType:(0,cz.varchar)("content_type").notNull(),contentId:(0,cz.varchar)("content_id").notNull(),revisionNumber:(0,cA.integer)("revision_number").notNull(),data:(0,bL.jsonb)("data").notNull(),changedFields:(0,cy.text)("changed_fields").array().default(bu.sql`'{}'::text[]`),changedBy:(0,cz.varchar)("changed_by").notNull().references(()=>eK.id),changeReason:(0,cy.text)("change_reason"),createdAt:(0,bO.timestamp)("created_at").notNull().defaultNow()},a=>({contentTypeIdx:cF("idx_content_revisions_content_type").on(a.contentType),contentIdIdx:cF("idx_content_revisions_content_id").on(a.contentId),revisionNumberIdx:cF("idx_content_revisions_revision_number").on(a.revisionNumber),createdAtIdx:cF("idx_content_revisions_created_at").on(a.createdAt)})),fE=eI(eK).pick({id:!0,email:!0,username:!0,firstName:!0,lastName:!0,profileImageUrl:!0}),fF=eI(eK).omit({id:!0,totalCoins:!0,weeklyEarned:!0,rank:!0,youtubeUrl:!0,instagramHandle:!0,telegramHandle:!0,myfxbookLink:!0,investorId:!0,investorPassword:!0,isVerifiedTrader:!0,emailNotifications:!0,hasYoutubeReward:!0,hasMyfxbookReward:!0,hasInvestorReward:!0,createdAt:!0,updatedAt:!0}).extend({username:eA.string().min(3).max(50),password:eA.string().min(8)}),fG=eI(eM).omit({id:!0,createdAt:!0}),fH=eI(eN).omit({id:!0,createdAt:!0,completedAt:!0}),fI=eI(eO).omit({id:!0,createdAt:!0,updatedAt:!0}),fJ=eI(eP).omit({id:!0,requestedAt:!0,processedAt:!0,completedAt:!0,createdAt:!0,updatedAt:!0,approvedAt:!0,rejectedAt:!0}).extend({amount:eA.number().min(1e3,"Minimum withdrawal is 1000 coins"),method:eA.enum(["crypto","paypal","bank","other"]).optional(),cryptoType:eA.enum(["BTC","ETH"]).optional(),walletAddress:eA.string().min(26,"Invalid wallet address").max(100,"Invalid wallet address")}),fK=eI(eQ).omit({id:!0,createdAt:!0,updatedAt:!0,status:!0,priority:!0,adminNotes:!0}).extend({type:eA.enum(["bug","feature","improvement","other"]),subject:eA.string().min(10,"Subject must be at least 10 characters").max(200,"Subject must be at most 200 characters"),message:eA.string().min(50,"Message must be at least 50 characters").max(5e3,"Message must be at most 5000 characters"),email:eA.string().email("Invalid email format").optional()}),fL=eI(eR).omit({id:!0,createdAt:!0,updatedAt:!0,views:!0,downloads:!0,likes:!0,status:!0}).extend({title:eA.string().min(10).max(120),description:eA.string().min(300),priceCoins:eA.number().min(0).max(1e4),platform:eA.enum(["MT4","MT5","Both"]).optional(),version:eA.string().optional(),tags:eA.array(eA.string()).max(8).optional(),files:eA.array(eA.object({name:eA.string(),size:eA.number(),url:eA.string(),checksum:eA.string()})).min(1,"At least 1 file is required").optional(),images:eA.array(eA.object({url:eA.string(),isCover:eA.boolean(),order:eA.number()})).min(1,"At least 1 image is required").optional(),brokerCompat:eA.array(eA.string()).optional(),minDeposit:eA.number().optional(),hedging:eA.boolean().optional(),changelog:eA.string().optional(),license:eA.string().optional(),equityCurveImage:eA.string().optional(),profitFactor:eA.number().optional(),drawdownPercent:eA.number().optional(),winPercent:eA.number().optional(),broker:eA.string().optional(),monthsTested:eA.number().optional(),slug:eA.string().optional(),focusKeyword:eA.string().optional(),autoMetaDescription:eA.string().optional(),autoImageAltTexts:eA.array(eA.string()).optional()}),fM=eI(eS).omit({id:!0,purchasedAt:!0,sellerId:!0,transactionId:!0,priceCoins:!0}),fN=eI(eT).omit({id:!0,createdAt:!0,status:!0,rewardGiven:!0}).extend({rating:eA.number().min(1,"Rating must be between 1 and 5").max(5,"Rating must be between 1 and 5"),review:eA.string().min(100,"Review must be at least 100 characters").max(1e3,"Review must be at most 1000 characters")}),fO=eI(eU).omit({id:!0,createdAt:!0}),fP=eI(eV).omit({id:!0,createdAt:!0,helpful:!0,isVerified:!0}).extend({body:eA.string().min(10).max(5e3),rating:eA.number().min(1).max(5).optional()}),fQ=eI(eW).omit({id:!0,createdAt:!0,updatedAt:!0,overallRating:!0,reviewCount:!0,scamReportCount:!0,status:!0,isVerified:!0}),fR=eI(eX).omit({id:!0,datePosted:!0,status:!0}).extend({rating:eA.number().min(1).max(5),reviewTitle:eA.string().min(10).max(200),reviewBody:eA.string().min(100).max(2e3)}),fS=eI(eY).omit({id:!0,createdAt:!0}),fT=eI(eZ).omit({id:!0,createdAt:!0,lastMessageAt:!0}),fU=eI(e$).omit({id:!0,createdAt:!0}).extend({body:eA.string().min(1).max(5e3)}),fV=eI(e0).omit({id:!0,createdAt:!0,isRead:!0}).extend({title:eA.string().min(1).max(200),message:eA.string().min(1).max(500)}),fW=eA.object({displayName:eA.string().min(2).max(50).optional(),email:eA.string().email().optional(),bio:eA.string().max(500).optional().or(eA.literal("")),location:eA.string().max(100).optional().or(eA.literal("")),website:eA.string().url().optional().or(eA.literal("")),youtubeUrl:eA.string().url().optional().or(eA.literal("")),instagramHandle:eA.string().min(1).max(50).optional().or(eA.literal("")),telegramHandle:eA.string().min(1).max(50).optional().or(eA.literal("")),myfxbookLink:eA.string().url().optional().or(eA.literal("")),investorId:eA.string().optional().or(eA.literal("")),investorPassword:eA.string().optional().or(eA.literal("")),emailNotifications:eA.boolean().optional()}),fX=eI(e_).omit({id:!0,createdAt:!0}),fY=eI(e1).omit({id:!0,authorId:!0,createdAt:!0,updatedAt:!0,views:!0,replyCount:!0,likeCount:!0,bookmarkCount:!0,shareCount:!0,lastActivityAt:!0,status:!0,lastScoreUpdate:!0,acceptedAnswerId:!0}).extend({title:eA.string().min(15,"Title must be at least 15 characters").max(90,"Title must not exceed 90 characters").refine(a=>{let b=(a.match(/[A-Z]/g)||[]).length,c=(a.match(/[a-zA-Z]/g)||[]).length;return 0===c||b/c<.5},{message:"Let's tone this down a bit so more folks read it"}),body:eA.string().min(150,"A little more context helps people reply. Two more sentences?").max(5e4,"Body is too long"),categorySlug:eA.string().min(1),subcategorySlug:eA.string().optional(),threadType:eA.enum(["question","discussion","review","journal","guide","program_sharing"]).default("discussion"),language:eA.string().default("en"),seoExcerpt:eA.string().min(120,"SEO excerpt should be at least 120 characters").max(160,"SEO excerpt should not exceed 160 characters").optional(),primaryKeyword:eA.string().refine(a=>!a||a.split(/\s+/).length>=1&&a.split(/\s+/).length<=6,{message:"Primary keyword should be 1-6 words"}).optional(),instruments:eA.array(eA.string()).optional().default([]),timeframes:eA.array(eA.string()).optional().default([]),strategies:eA.array(eA.string()).optional().default([]),platform:eA.string().optional(),broker:eA.string().max(40).optional(),riskNote:eA.string().max(500).optional(),hashtags:eA.array(eA.string()).max(10,"Maximum 10 hashtags").optional().default([]),reviewTarget:eA.string().optional(),reviewVersion:eA.string().optional(),reviewRating:eA.number().int().min(1).max(5).optional(),reviewPros:eA.array(eA.string()).optional(),reviewCons:eA.array(eA.string()).optional(),questionSummary:eA.string().max(200).optional(),attachmentUrls:eA.array(eA.string()).optional().default([]),isPinned:eA.boolean().optional().default(!1),isLocked:eA.boolean().optional().default(!1),isSolved:eA.boolean().optional().default(!1),slug:eA.string().optional(),focusKeyword:eA.string().optional(),metaDescription:eA.string().optional(),engagementScore:eA.number().optional()}),fZ=eI(e2).omit({id:!0,createdAt:!0,updatedAt:!0,helpful:!0,isAccepted:!0,isVerified:!0,slug:!0,metaDescription:!0}).extend({body:eA.string().min(10).max(1e4)}),f$=eI(e3).omit({threadCount:!0,postCount:!0,createdAt:!0,updatedAt:!0}).extend({name:eA.string().min(3).max(100),description:eA.string().min(10).max(500)}),f_=eI(e4).omit({id:!0,awardedAt:!0}),f0=eI(e5).omit({id:!0,createdAt:!0}).extend({title:eA.string().min(1).max(300),description:eA.string().max(500).optional()}),f1=eI(e6).omit({walletId:!0,updatedAt:!0}),f2=eI(e7).omit({id:!0,createdAt:!0,closedAt:!0}),f3=eI(e8).omit({id:!0,createdAt:!0}),f4=eI(e9).omit({id:!0,createdAt:!0,completedAt:!0}),f5=eI(fa).omit({id:!0,createdAt:!0,updatedAt:!0}),f6=fL.superRefine((a,b)=>(a.tags?.includes("Performance Report")&&(a.equityCurveImage||b.addIssue({code:eA.ZodIssueCode.custom,message:"Equity curve image is required for Performance Reports",path:["equityCurveImage"]}),a.profitFactor||b.addIssue({code:eA.ZodIssueCode.custom,message:"Profit Factor is required for Performance Reports",path:["profitFactor"]}),a.drawdownPercent||b.addIssue({code:eA.ZodIssueCode.custom,message:"Drawdown % is required for Performance Reports",path:["drawdownPercent"]}),a.winPercent||b.addIssue({code:eA.ZodIssueCode.custom,message:"Win % is required for Performance Reports",path:["winPercent"]}),a.broker||b.addIssue({code:eA.ZodIssueCode.custom,message:"Broker name is required for Performance Reports",path:["broker"]}),a.monthsTested||b.addIssue({code:eA.ZodIssueCode.custom,message:"Months Tested is required for Performance Reports",path:["monthsTested"]})),a)),f7={VERIFIED_TRADER:"verified_trader",TOP_CONTRIBUTOR:"top_contributor",EA_EXPERT:"ea_expert",HELPFUL_MEMBER:"helpful_member",EARLY_ADOPTER:"early_adopter"},f8={[f7.VERIFIED_TRADER]:{name:"Verified Trader",description:"Linked and verified trading account",icon:"ShieldCheck",color:"text-blue-500"},[f7.TOP_CONTRIBUTOR]:{name:"Top Contributor",description:"Top 10 on contributor leaderboard",icon:"Star",color:"text-yellow-500"},[f7.EA_EXPERT]:{name:"EA Expert",description:"Published 5+ Expert Advisors",icon:"Award",color:"text-purple-500"},[f7.HELPFUL_MEMBER]:{name:"Helpful Member",description:"50+ helpful replies",icon:"Heart",color:"text-red-500"},[f7.EARLY_ADOPTER]:{name:"Early Adopter",description:"Joined in the first month",icon:"Zap",color:"text-orange-500"}},f9=eI(fc).omit({id:!0,createdAt:!0}),ga=eI(fd).omit({id:!0,createdAt:!0}),gb=eI(fk).omit({id:!0,createdAt:!0}),gc=eI(fl).omit({id:!0,createdAt:!0}),gd=eI(fm).omit({id:!0,createdAt:!0}),ge=eI(fn).omit({id:!0,updatedAt:!0}),gf=eI(fo).omit({id:!0,createdAt:!0,updatedAt:!0}),gg=eI(fp).omit({id:!0,createdAt:!0,views:!0,clicks:!0}),gh=eI(fq).omit({id:!0,bannedAt:!0}),gi=eI(fr).omit({id:!0,updatedAt:!0}),gj=eI(fs).omit({id:!0,grantedAt:!0}),gk=eI(ft).omit({id:!0,createdAt:!0,updatedAt:!0,userCount:!0}),gl=eI(fu).omit({id:!0,createdAt:!0,executionCount:!0,lastExecuted:!0}),gm=eI(fv).omit({id:!0,createdAt:!0}),gn=eI(fw).omit({id:!0,createdAt:!0,updatedAt:!0}),go=eI(fx).omit({id:!0,createdAt:!0,lastUsed:!0}),gp=eI(fy).omit({id:!0,createdAt:!0,lastTriggered:!0,successCount:!0,failureCount:!0}),gq=eI(fz).omit({id:!0,lastRun:!0,nextRun:!0,lastStatus:!0,lastError:!0,executionCount:!0}),gr=eI(fA).omit({id:!0,recordedAt:!0}),gs=eI(fB).omit({id:!0,createdAt:!0}),gt=eI(fC).omit({id:!0,uploadedAt:!0,usageCount:!0}),gu=eI(fD).omit({id:!0,createdAt:!0}),gv=eI(eL).omit({id:!0,createdAt:!0}),gw=(0,bQ.pgTable)("sitemap_logs",{id:(0,cJ.serial)("id").primaryKey(),action:(0,cz.varchar)("action",{length:50}).notNull(),status:(0,cz.varchar)("status",{length:20}).notNull(),urlCount:(0,cA.integer)("url_count"),submittedTo:(0,cz.varchar)("submitted_to",{length:100}),errorMessage:(0,cy.text)("error_message"),metadata:(0,bL.jsonb)("metadata"),createdAt:(0,bO.timestamp)("created_at").defaultNow().notNull()}),gx=eI(gw).omit({id:!0,createdAt:!0});a.s(["BADGE_METADATA",0,f8,"BADGE_TYPES",0,f7,"abTests",0,fv,"achievements",0,fe,"activityFeed",0,e5,"adminActions",0,fk,"adminRoles",0,fs,"announcements",0,fp,"apiKeys",0,fx,"automationRules",0,fu,"brokerReviews",0,eX,"brokers",0,eW,"campaigns",0,fg,"coinJournalEntries",0,e8,"coinLedgerTransactions",0,e7,"coinTransactions",0,eM,"content",0,eR,"contentLikes",0,eU,"contentPurchases",0,eS,"contentReplies",0,eV,"contentReviews",0,eT,"contentRevisions",0,fD,"conversations",0,eZ,"dailyActivityLimits",0,fb,"dashboardPreferences",0,fa,"dashboardSettings",0,fh,"emailTemplates",0,fr,"featureFlags",0,fw,"feedback",0,eQ,"forumCategories",0,e3,"forumReplies",0,e2,"forumThreads",0,e1,"goals",0,fd,"insertAbTestSchema",0,gm,"insertActivityFeedSchema",0,f0,"insertAdminActionSchema",0,gb,"insertAdminRoleSchema",0,gj,"insertAnnouncementSchema",0,gg,"insertApiKeySchema",0,go,"insertAutomationRuleSchema",0,gl,"insertBrokerReviewSchema",0,fR,"insertBrokerSchema",0,fQ,"insertCoinJournalEntrySchema",0,f3,"insertCoinLedgerTransactionSchema",0,f2,"insertCoinTransactionSchema",0,fG,"insertContentLikeSchema",0,fO,"insertContentPurchaseSchema",0,fM,"insertContentReplySchema",0,fP,"insertContentReviewSchema",0,fN,"insertContentRevisionSchema",0,gu,"insertContentSchema",0,fL,"insertConversationSchema",0,fT,"insertDashboardPreferencesSchema",0,f5,"insertEmailTemplateSchema",0,gi,"insertFeatureFlagSchema",0,gn,"insertFeedbackSchema",0,fK,"insertForumCategorySchema",0,f$,"insertForumReplySchema",0,fZ,"insertForumThreadSchema",0,fY,"insertGoalSchema",0,ga,"insertIpBanSchema",0,gh,"insertLedgerReconciliationRunSchema",0,f4,"insertMediaLibrarySchema",0,gt,"insertMessageReactionSchema",0,fX,"insertMessageSchema",0,fU,"insertModerationQueueSchema",0,gc,"insertNotificationSchema",0,fV,"insertPerformanceMetricSchema",0,gr,"insertRechargeOrderSchema",0,fH,"insertReferralSchema",0,f9,"insertReportedContentSchema",0,gd,"insertScheduledJobSchema",0,gq,"insertSecurityEventSchema",0,gs,"insertSitemapLogSchema",0,gx,"insertSubscriptionSchema",0,fI,"insertSupportTicketSchema",0,gf,"insertSystemSettingSchema",0,ge,"insertUserActivitySchema",0,gv,"insertUserBadgeSchema",0,f_,"insertUserFollowSchema",0,fS,"insertUserSchema",0,fF,"insertUserSegmentSchema",0,gk,"insertUserWalletSchema",0,f1,"insertWebhookSchema",0,gp,"insertWithdrawalRequestSchema",0,fJ,"ipBans",0,fq,"ledgerReconciliationRuns",0,e9,"mediaLibrary",0,fC,"messageReactions",0,e_,"messages",0,e$,"moderationQueue",0,fl,"notifications",0,e0,"performanceMetrics",0,fA,"profiles",0,fi,"publishContentSchema",0,f6,"rechargeOrders",0,eN,"referrals",0,fc,"reportedContent",0,fm,"scheduledJobs",0,fz,"securityEvents",0,fB,"sessions",0,eJ,"sitemapLogs",0,gw,"subscriptions",0,eO,"supportTickets",0,fo,"systemSettings",0,fn,"updateUserProfileSchema",0,fW,"upsertUserSchema",0,fE,"userAchievements",0,ff,"userActivity",0,eL,"userBadges",0,e4,"userFollows",0,eY,"userSegments",0,ft,"userSettings",0,fj,"userWallet",0,e6,"users",0,eK,"webhooks",0,fy,"withdrawalRequests",0,eP],901060);var gy=a.i(901060);if(aO.webSocketConstructor=cx,!process.env.DATABASE_URL)throw Error("DATABASE_URL must be set. Did you forget to provision a database?");let gz=new bn({connectionString:process.env.DATABASE_URL}),gA=cv({client:gz,schema:gy}),gB=new Map;async function gC(a){let b=gB.get(a);if(b&&b.expiry>Date.now())return b.path;let c=[],d=a,e=new Set;for(;d&&!e.has(d);){e.add(d);let[a]=await gA.select().from(e3).where((0,bS.eq)(e3.slug,d)).limit(1);if(!a)break;c.unshift(a.slug),d=a.parentSlug}let f=c.join("/");return gB.set(a,{path:f,expiry:Date.now()+3e5}),f}async function gD(a){let b=a.split("/"),c=b[b.length-1],[d]=await gA.select().from(e3).where((0,bS.eq)(e3.slug,c)).limit(1);return d||null}async function gE(a){let b=await gC(a.categorySlug);return`/category/${b}/${a.slug}`}async function gF(a){let b=await gC(a.category);return`/category/${b}/${a.slug}`}a.s(["getCategoryByPath",()=>gD,"getContentUrl",()=>gF,"getThreadUrl",()=>gE],476414)}];

//# sourceMappingURL=_8e2cc2f9._.js.map