{"version":3,"sources":["turbopack:///[project]/app/content/[slug]/ContentDetailClient.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/app/content/[slug]/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/content/[slug]/ContentDetailClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/content/[slug]/ContentDetailClient.tsx\",\n    \"default\",\n);\n","import { Metadata } from 'next';\nimport { permanentRedirect } from 'next/navigation';\nimport ContentDetailClient from './ContentDetailClient';\nimport type { Content, User as UserType, ContentReview } from '@shared/schema';\nimport { getContentUrl } from '../../../lib/category-path';\n\n// Express API base URL\nconst EXPRESS_URL = process.env.NEXT_PUBLIC_EXPRESS_URL || 'http://localhost:5000';\n\n// Generate metadata for SEO\nexport async function generateMetadata({ params }: { params: Promise<{ slug: string }> }): Promise<Metadata> {\n  const { slug } = await params;\n  try {\n    // Check if slug is UUID format\n    const isUUID = slug.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i);\n    const endpoint = isUUID \n      ? `${EXPRESS_URL}/api/content/${slug}`\n      : `${EXPRESS_URL}/api/content/slug/${slug}`;\n\n    const res = await fetch(endpoint, { cache: 'no-store' });\n    if (!res.ok) {\n      return {\n        title: 'Content Not Found | YoForex Marketplace',\n      };\n    }\n\n    const content: Content = await res.json();\n    \n    // Get cover image\n    const images = content.images || [];\n    const coverImage = images.find(img => img.isCover) || images[0];\n    \n    // Create description from content description (first 150 chars)\n    const description = content.description \n      ? content.description.substring(0, 150) + (content.description.length > 150 ? '...' : '')\n      : `Download ${content.title} - ${content.type} for MT4/MT5`;\n    \n    // Get tags as keywords\n    const tags = content.tags || [];\n    const keywords = tags.length > 0 ? tags.join(', ') : 'forex, EA, indicator, MT4, MT5';\n\n    return {\n      title: `${content.title} | YoForex Marketplace`,\n      description,\n      keywords,\n      openGraph: {\n        title: content.title,\n        description,\n        images: coverImage?.url ? [{ url: coverImage.url }] : [],\n        type: 'article',\n      },\n      twitter: {\n        card: 'summary_large_image',\n        title: content.title,\n        description,\n        images: coverImage?.url ? [coverImage.url] : [],\n      },\n    };\n  } catch (error) {\n    return {\n      title: 'Content Not Found | YoForex Marketplace',\n    };\n  }\n}\n\n// Main page component (Server Component)\nexport default async function ContentDetailPage({ params }: { params: Promise<{ slug: string }> }) {\n  const { slug } = await params;\n  \n  // Check if slug is UUID format\n  const isUUID = slug.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i);\n  const contentEndpoint = isUUID \n    ? `${EXPRESS_URL}/api/content/${slug}`\n    : `${EXPRESS_URL}/api/content/slug/${slug}`;\n\n  // Fetch content with error handling that doesn't trigger Next.js 404\n  let content: Content | undefined = undefined;\n  try {\n    const contentRes = await fetch(contentEndpoint, { \n      cache: 'no-store',\n      // Prevent Next.js from treating this as a 404 route\n    });\n    if (contentRes.ok) {\n      content = await contentRes.json();\n    }\n  } catch (error) {\n    // Swallow error - we'll show custom error card\n    content = undefined;\n  }\n\n  // If content not found, return 404\n  if (!content) {\n    return (\n      <ContentDetailClient\n        slug={slug}\n        initialContent={undefined}\n        initialAuthor={undefined}\n        initialReviews={[]}\n        initialSimilarContent={[]}\n        initialAuthorReleases={[]}\n      />\n    );\n  }\n\n  // Generate hierarchical URL and perform permanent redirect (308 for SEO)\n  // Note: Next.js uses 308 (not 301) for permanent redirects to preserve HTTP method\n  // Both 301 and 308 transfer SEO equity equally; 308 is the modern standard\n  const hierarchicalUrl = await getContentUrl(content);\n  permanentRedirect(hierarchicalUrl);\n}\n\n// Enable dynamic rendering with no caching\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 0;\n"],"names":[],"mappings":"wiCAEe,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,QACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,4SAA8S,EAC3U,2EACA,+DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,QACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,wRAA0R,EACvT,uDACA,yICJJ,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QAGA,IAAM,EAAc,YAAA,YAGb,IAHoD,WAGrC,EAAiB,QAAE,CAAM,CAAyC,EACtF,GAAM,MAAE,CAAI,CAAE,CAAG,MAAM,EACvB,GAAI,CAGF,IAAM,EADS,AACE,EADG,KAAK,CAAC,mEAEtB,CAAA,EAAG,EAAY,aAAa,EAAE,EAAA,CAAM,CACpC,CAAA,EAAG,EAAY,kBAAkB,EAAE,EAAA,CAAM,CAEvC,EAAM,MAAM,MAAM,EAAU,CAAE,MAAO,UAAW,GACtD,GAAI,CAAC,EAAI,EAAE,CACT,CADW,KACJ,CACL,MAAO,yCACT,EAGF,IAAM,EAAmB,MAAM,EAAI,IAAI,GAGjC,EAAS,EAAQ,MAAM,EAAI,EAAE,CAC7B,EAAa,EAAO,IAAI,CAAC,GAAO,EAAI,OAAO,GAAK,CAAM,CAAC,EAAE,CAGzD,EAAc,EAAQ,WAAW,CACnC,EAAQ,WAAW,CAAC,SAAS,CAAC,EAAG,MAAQ,CAAD,CAAS,WAAW,CAAC,MAAM,CAAG,IAAM,MAAQ,EAAA,CAAE,CACtF,CAAC,SAAS,EAAE,EAAQ,KAAK,CAAC,GAAG,EAAE,EAAQ,IAAI,CAAC,YAAY,CAAC,CAGvD,EAAO,EAAQ,IAAI,EAAI,EAAE,CACzB,EAAW,EAAK,MAAM,CAAG,EAAI,EAAK,IAAI,CAAC,MAAQ,iCAErD,MAAO,CACL,MAAO,CAAA,EAAG,EAAQ,KAAK,CAAC,sBAAsB,CAAC,CAC/C,cACA,WACA,UAAW,CACT,MAAO,EAAQ,KAAK,aACpB,EACA,OAAQ,GAAY,IAAM,CAAC,CAAE,IAAK,EAAW,GAAG,AAAC,EAAE,CAAG,EAAE,CACxD,KAAM,SACR,EACA,QAAS,CACP,KAAM,sBACN,MAAO,EAAQ,KAAK,aACpB,EACA,OAAQ,GAAY,IAAM,CAAC,EAAW,GAAG,CAAC,CAAG,EAAE,AACjD,CACF,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,MAAO,yCACT,CACF,CACF,CAGe,eAAe,EAAkB,CAAE,QAAM,CAAyC,EAC/F,IASI,EATE,MAAE,CAAI,CAAE,AASqB,CATlB,MAAM,EAIjB,EAAkB,AADT,EAAK,KAAK,CAAC,mEAEtB,CAAA,EAAG,EAAY,aAAa,EAAE,EAAA,CAAM,CACpC,CAAA,EAAG,EAAY,kBAAkB,EAAE,EAAA,CAAM,CAI7C,GAAI,CACF,IAAM,EAAa,MAAM,MAAM,EAAiB,CAC9C,MAAO,UAET,GACI,EAAW,EAAE,EAAE,CACjB,EAAU,MAAM,EAAW,IAAI,EAAA,CAEnC,CAAE,MAAO,EAAO,CAEd,OAAU,CACZ,CAGA,GAAI,CAAC,EACH,MACE,CAFU,AAEV,EAAA,EAAA,GAAA,EAAC,EAAA,OAAmB,CAAA,CAClB,KAAM,EACN,oBAAgB,EAChB,mBAAe,EACf,eAAgB,EAAE,CAClB,sBAAuB,EAAE,CACzB,sBAAuB,EAAE,GAQ/B,IAAM,EAAkB,MAAM,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,GAC5C,CAAA,EAAA,EAAA,iBAAA,AAAiB,EAAC,EACpB,kCAGuB,wDACG","ignoreList":[0]}