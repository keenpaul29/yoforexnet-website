module.exports=[1238,a=>{"use strict";var b=a.i(187924),c=a.i(238246),d=a.i(50944),e=a.i(572131),f=a.i(811011),g=a.i(400187),h=a.i(170106);let i=(0,h.default)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);var j=a.i(580364),k=a.i(189736),l=a.i(991868),m=a.i(959162),n=a.i(964604),o=a.i(172744),p=a.i(405539),q=a.i(634357);let r=e.createContext(null);function s(){let a=e.useContext(r);if(!a)throw Error("useSidebar must be used within a SidebarProvider.");return a}function t({defaultOpen:a=!0,open:c,onOpenChange:d,className:f,style:g,children:h,...i}){let l=(0,j.useIsMobile)(),[m,n]=e.useState(!1),[o,p]=e.useState(a),s=c??o,t=e.useCallback(a=>{let b="function"==typeof a?a(s):a;d?d(b):p(b),document.cookie=`sidebar_state=${b}; path=/; max-age=604800`},[d,s]),u=e.useCallback(()=>l?n(a=>!a):t(a=>!a),[l,t,n]);e.useEffect(()=>{let a=a=>{"b"===a.key&&(a.metaKey||a.ctrlKey)&&(a.preventDefault(),u())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[u]);let v=s?"expanded":"collapsed",w=e.useMemo(()=>({state:v,open:s,setOpen:t,isMobile:l,openMobile:m,setOpenMobile:n,toggleSidebar:u}),[v,s,t,l,m,n,u]);return(0,b.jsx)(r.Provider,{value:w,children:(0,b.jsx)(q.TooltipProvider,{delayDuration:0,children:(0,b.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...g},className:(0,k.cn)("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",f),...i,children:h})})})}function u({side:a="left",variant:c="sidebar",collapsible:d="offcanvas",className:e,children:f,...g}){let{isMobile:h,state:i,openMobile:j,setOpenMobile:l}=s();return"none"===d?(0,b.jsx)("div",{"data-slot":"sidebar",className:(0,k.cn)("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",e),...g,children:f}):h?(0,b.jsx)(o.Sheet,{open:j,onOpenChange:l,...g,children:(0,b.jsxs)(o.SheetContent,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:a,children:[(0,b.jsxs)(o.SheetHeader,{className:"sr-only",children:[(0,b.jsx)(o.SheetTitle,{children:"Sidebar"}),(0,b.jsx)(o.SheetDescription,{children:"Displays the mobile sidebar."})]}),(0,b.jsx)("div",{className:"flex h-full w-full flex-col",children:f})]})}):(0,b.jsxs)("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":i,"data-collapsible":"collapsed"===i?d:"","data-variant":c,"data-side":a,"data-slot":"sidebar",children:[(0,b.jsx)("div",{"data-slot":"sidebar-gap",className:(0,k.cn)("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===c||"inset"===c?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),(0,b.jsx)("div",{"data-slot":"sidebar-container",className:(0,k.cn)("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex","left"===a?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===c||"inset"===c?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",e),...g,children:(0,b.jsx)("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:f})})]})}function v({className:a,onClick:c,...d}){let{toggleSidebar:e}=s();return(0,b.jsxs)(l.Button,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:(0,k.cn)("h-7 w-7",a),onClick:a=>{c?.(a),e()},...d,children:[(0,b.jsx)(i,{}),(0,b.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function w({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:(0,k.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",a),...c})}function x({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:(0,k.cn)("relative flex w-full min-w-0 flex-col p-2",a),...c})}function y({className:a,asChild:c=!1,...d}){let e=c?f.Slot:"div";return(0,b.jsx)(e,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:(0,k.cn)("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",a),...d})}function z({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:(0,k.cn)("w-full text-sm",a),...c})}function A({className:a,...c}){return(0,b.jsx)("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:(0,k.cn)("flex w-full min-w-0 flex-col gap-1",a),...c})}function B({className:a,...c}){return(0,b.jsx)("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:(0,k.cn)("group/menu-item relative",a),...c})}let C=(0,g.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function D({asChild:a=!1,isActive:c=!1,variant:d="default",size:e="default",tooltip:g,className:h,...i}){let j=a?f.Slot:"button",{isMobile:l,state:m}=s(),n=(0,b.jsx)(j,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":e,"data-active":c,className:(0,k.cn)(C({variant:d,size:e}),h),...i});return g?("string"==typeof g&&(g={children:g}),(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:n}),(0,b.jsx)(q.TooltipContent,{side:"right",align:"center",hidden:"collapsed"!==m||l,...g})]})):n}var E=a.i(839761),F=a.i(660246),G=a.i(104720),H=a.i(257990);let I=(0,h.default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var J=a.i(790166),K=a.i(724669),L=a.i(321161),M=a.i(603314),N=a.i(992258),O=a.i(942211);let P=(0,h.default)("FileChartColumn",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-1",key:"zg0ygc"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"M16 18v-3",key:"j5jt4h"}]]),Q=(0,h.default)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var R=a.i(583077),S=a.i(587532),T=a.i(501027),U=a.i(1631),V=a.i(290669),W=a.i(492596);let X=(0,h.default)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);var Y=a.i(654074),Z=a.i(357178),$=a.i(433217),_=a.i(206893),aa=a.i(910598),ab=a.i(292e3),ac=a.i(717371),ad=a.i(786520),ae=a.i(563588),af=a.i(590545),ag=a.i(910738),ah=a.i(457431),ai=a.i(677924),aj=a.i(618155),ak=a.i(923665),al=a.i(264321),am=a.i(427165),an=a.i(467149),ao=a.i(758042),ap=a.i(994222),aq=a.i(54419),ar=a.i(659854),as=a.i(48662),at=a.i(902274),au=a.i(561792);function av(){let{data:a,isLoading:d}=(0,$.useQuery)({queryKey:["/api/admin/overview/stats"],refetchInterval:3e4}),e=a||{users:{total:0,new24h:0,online:0,dailyRegistrations:0,premiumMembers:0},content:{total:0,new24h:0,avgPostsPerUser:0},revenue:{total:0,today:0},moderation:{pending:0,reports:0}},{data:f,isLoading:g}=(0,$.useQuery)({queryKey:["/api/admin/overview/engagement-metrics"],refetchInterval:3e4}),h=f||{dailyActiveUsers:0,postsToday:0,commentsToday:0,likesToday:0},{data:i,isLoading:j}=(0,$.useQuery)({queryKey:["/api/admin/overview/revenue-breakdown"],refetchInterval:6e4}),k=i||{stripe:0,crypto:0,total:0},{data:l,isLoading:m}=(0,$.useQuery)({queryKey:["/api/admin/overview/top-content"],refetchInterval:6e4}),n=Array.isArray(l)?l:[],{data:o,isLoading:q}=(0,$.useQuery)({queryKey:["/api/admin/overview/top-users"],refetchInterval:6e4}),r=Array.isArray(o)?o:[],{data:s,isLoading:t}=(0,$.useQuery)({queryKey:["/api/admin/overview/activity-feed"],refetchInterval:15e3}),u=Array.isArray(s)?s:[],{data:v,isLoading:w}=(0,$.useQuery)({queryKey:["/api/admin/overview/user-growth"],refetchInterval:6e4}),x=Array.isArray(v)?v:[],{data:y,isLoading:z}=(0,$.useQuery)({queryKey:["/api/admin/overview/content-trend"],refetchInterval:6e4}),A=Array.isArray(y)?y:[],B=[{name:"Stripe",value:k.stripe,fill:"hsl(var(--primary))"},{name:"Crypto",value:k.crypto,fill:"hsl(var(--chart-2))"}];return d?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(p.Skeleton,{className:"h-10 w-64"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Overview Dashboard"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-total-users",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Users"}),(0,b.jsx)(F.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-users",children:e.users.total}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",e.users.new24h," in last 24h"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-total-content",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Content"}),(0,b.jsx)(G.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-content",children:e.content.total}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",e.content.new24h," in last 24h"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-total-revenue",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,b.jsx)(J.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-total-revenue",children:["$",e.revenue.total]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+$",e.revenue.today," today"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-pending-moderation",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Pending Moderation"}),(0,b.jsx)(ab.AlertCircle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-pending-moderation",children:e.moderation.pending}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.moderation.reports," reports"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-online-users",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Online Users"}),(0,b.jsx)(F.Users,{className:"h-4 w-4 text-green-500"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-online-users",children:e.users.online}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active in last 15min"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-daily-registrations",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Daily Registrations"}),(0,b.jsx)(ac.UserPlus,{className:"h-4 w-4 text-blue-500"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-daily-registrations",children:e.users.dailyRegistrations}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Registered today"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-premium-members",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Premium Members"}),(0,b.jsx)(ad.Crown,{className:"h-4 w-4 text-amber-500"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-premium-members",children:e.users.premiumMembers}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Level 5 and above"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-avg-posts-user",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Posts/User"}),(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-purple-500"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-posts-user",children:e.content.avgPostsPerUser.toFixed(1)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per user average"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4","data-testid":"section-engagement-metrics",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-dau",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"DAU"}),(0,b.jsx)(V.Activity,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-xl font-bold","data-testid":"text-dau",children:h.dailyActiveUsers})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-posts-today",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Posts Today"}),(0,b.jsx)(G.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-xl font-bold","data-testid":"text-posts-today",children:h.postsToday})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-comments-today",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Comments Today"}),(0,b.jsx)(ae.MessageSquare,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-xl font-bold","data-testid":"text-comments-today",children:h.commentsToday})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-likes-today",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Likes Today"}),(0,b.jsx)(af.ThumbsUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-xl font-bold","data-testid":"text-likes-today",children:h.likesToday})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-user-growth-chart",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"User Growth (Last 7 Days)"})}),(0,b.jsx)(_.CardContent,{children:w?(0,b.jsx)(p.Skeleton,{className:"h-64"}):x.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:x,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"users",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-content-trend-chart",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Content Trend (Last 7 Days)"})}),(0,b.jsx)(_.CardContent,{children:z?(0,b.jsx)(p.Skeleton,{className:"h-64"}):A.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:A,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-revenue-breakdown-chart",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revenue Breakdown"})}),(0,b.jsx)(_.CardContent,{children:j?(0,b.jsx)(p.Skeleton,{className:"h-64"}):k.total>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:B,cx:"50%",cy:"50%",labelLine:!1,label:a=>`${a.name}: $${a.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:B.map((a,c)=>(0,b.jsx)(an.Cell,{fill:a.fill},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No revenue data"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-top-content",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Content"})}),(0,b.jsx)(_.CardContent,{children:m?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):n.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{"data-testid":"table-top-content",children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{className:"w-12",children:"#"}),(0,b.jsx)(aa.TableHead,{children:"Title"}),(0,b.jsx)(aa.TableHead,{children:"Author"}),(0,b.jsx)(aa.TableHead,{children:"Views"})]})}),(0,b.jsx)(aa.TableBody,{children:n.map((a,d)=>(0,b.jsxs)(aa.TableRow,{"data-testid":`row-top-content-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:d+1}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(c.default,{href:`/thread/${a.slug}`,className:"text-primary hover:underline","data-testid":`link-content-${a.id}`,children:a.title})}),(0,b.jsx)(aa.TableCell,{children:a.author}),(0,b.jsx)(aa.TableCell,{children:a.views})]},a.id))})]})}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No content data"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-top-users",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Users Leaderboard"})}),(0,b.jsx)(_.CardContent,{children:q?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):r.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{"data-testid":"table-top-users",children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{className:"w-12",children:"#"}),(0,b.jsx)(aa.TableHead,{children:"Username"}),(0,b.jsx)(aa.TableHead,{children:"Rep"}),(0,b.jsx)(aa.TableHead,{children:"Coins"}),(0,b.jsx)(aa.TableHead,{children:"Posts"})]})}),(0,b.jsx)(aa.TableBody,{children:r.map((a,d)=>(0,b.jsxs)(aa.TableRow,{"data-testid":`row-top-user-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:d+1}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(c.default,{href:`/user/${a.username}`,className:"text-primary hover:underline","data-testid":`link-user-${a.id}`,children:a.username})}),(0,b.jsx)(aa.TableCell,{children:a.reputation}),(0,b.jsx)(aa.TableCell,{children:a.coinBalance}),(0,b.jsx)(aa.TableCell,{children:a.totalPosts})]},a.id))})]})}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No user data"})})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-activity-feed",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Recent Admin Activity"})}),(0,b.jsx)(_.CardContent,{children:t?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):u.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Admin"}),(0,b.jsx)(aa.TableHead,{children:"Action"}),(0,b.jsx)(aa.TableHead,{children:"Target"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Time"})]})}),(0,b.jsx)(aa.TableBody,{children:u.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`activity-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`activity-admin-${a.id}`,children:a.adminUsername||"System"}),(0,b.jsx)(aa.TableCell,{"data-testid":`activity-action-${a.id}`,children:a.actionType}),(0,b.jsx)(aa.TableCell,{"data-testid":`activity-target-${a.id}`,children:a.targetType}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"success"===a.status?"default":"destructive",children:a.status})}),(0,b.jsx)(aa.TableCell,{"data-testid":`activity-time-${a.id}`,children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]},a.id))})]})}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No recent activity"})})]})]})}var aw=a.i(370025),ax=a.i(397799),ay=a.i(632954),az=a.i(632246),aA=a.i(577573),aB=a.i(276725),aC=a.i(718549),aD=a.i(424371),aE=a.i(756468);let aF=(0,h.default)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var aG=a.i(872089),aH=a.i(284505),aI=a.i(613749),aJ=a.i(50522),aK=a.i(941675),aL=a.i(372228),aM=a.i(971871);function aN(){let[a,d]=(0,e.useState)(""),[f,g]=(0,e.useState)("all"),[h,i]=(0,e.useState)("all"),[j,k]=(0,e.useState)("createdAt"),[n,o]=(0,e.useState)("desc"),[q,r]=(0,e.useState)(1),[s,t]=(0,e.useState)(25),[u,v]=(0,e.useState)(null),[w,x]=(0,e.useState)(!1),[y,z]=(0,e.useState)(!1),[A,B]=(0,e.useState)(),[C,D]=(0,e.useState)(""),[E,G]=(0,e.useState)(""),[H,I]=(0,e.useState)(""),{toast:J}=(0,aB.useToast)(),{data:L,isLoading:N}=(0,$.useQuery)({queryKey:["/api/admin/users",{search:a,role:f,status:h,sortBy:j,sortOrder:n,page:q,limit:s}]}),O=L?.users||[],P=L?.totalPages||1,Q=L?.total||0,{data:R}=(0,$.useQuery)({queryKey:["/api/admin/users/stats",{search:a,role:f,status:h}],queryFn:()=>{let b=new URLSearchParams;a&&b.append("search",a),"all"!==f&&b.append("role",f),"all"!==h&&b.append("status",h);let c=b.toString();return fetch(`/api/admin/users/stats${c?"?"+c:""}`).then(a=>a.json())}}),T=R||{total:0,avgReputation:0,avgCoins:0,bannedCount:0},{data:U}=(0,$.useQuery)({queryKey:["/api/admin/users",u?.id,"activity"],queryFn:()=>fetch(`/api/admin/users/${u?.id}/activity`).then(a=>a.json()),enabled:!!u}),V=U||{totalThreads:0,totalReplies:0,totalContent:0,coinsEarned:0,coinsSpent:0,accountAge:0},{data:W}=(0,$.useQuery)({queryKey:["/api/admin/users",u?.id,"posts"],queryFn:()=>fetch(`/api/admin/users/${u?.id}/posts`).then(a=>a.json()),enabled:!!u}),X=Array.isArray(W)?W:[],{data:Y}=(0,$.useQuery)({queryKey:["/api/admin/users",u?.id,"coin-history"],queryFn:()=>fetch(`/api/admin/users/${u?.id}/coin-history`).then(a=>a.json()),enabled:!!u}),Z=Array.isArray(Y)?Y:[],ab=(0,aw.useMutation)({mutationFn:async({userId:a,reason:b})=>(0,aM.apiRequest)("POST",`/api/admin/users/${a}/ban`,{reason:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),J({title:"User banned successfully"}),v(null)},onError:()=>{J({title:"Failed to ban user",variant:"destructive"})}}),ac=(0,aw.useMutation)({mutationFn:async({userId:a,suspendedUntil:b,reason:c})=>(0,aM.apiRequest)("POST",`/api/admin/users/${a}/suspend`,{suspendedUntil:b,reason:c}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),J({title:"User suspended successfully"}),x(!1),B(void 0),D(""),v(null)},onError:()=>{J({title:"Failed to suspend user",variant:"destructive"})}}),ad=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/users/${a}/activate`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),J({title:"User activated successfully"}),v(null)},onError:()=>{J({title:"Failed to activate user",variant:"destructive"})}}),ae=(0,aw.useMutation)({mutationFn:async({userId:a,role:b,reason:c})=>(0,aM.apiRequest)("POST",`/api/admin/users/${a}/role`,{role:b,reason:c}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),J({title:"User role changed successfully"}),z(!1),G(""),I(""),v(null)},onError:()=>{J({title:"Failed to change user role",variant:"destructive"})}}),af=(0,aw.useMutation)({mutationFn:async({userId:a,amount:b,reason:c})=>(0,aM.apiRequest)("POST",`/api/admin/users/${a}/adjust-coins`,{amount:b,reason:c}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/users"]}),J({title:"Coins adjusted successfully"})},onError:()=>{J({title:"Failed to adjust coins",variant:"destructive"})}}),ah=async()=>{try{let b=new URLSearchParams({search:a,role:f,status:h,sortBy:j,sortOrder:n}),c=await fetch(`/api/admin/users/export/csv?${b}`);if(!c.ok)throw Error("Export failed");let d=await c.blob(),e=window.URL.createObjectURL(d),g=document.createElement("a");g.href=e,g.download=`users-export-${new Date().toISOString()}.csv`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(e),document.body.removeChild(g),J({title:"Users exported successfully"})}catch(a){J({title:"Failed to export users",variant:"destructive"})}};return N?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(p.Skeleton,{className:"h-10 w-64"}),(0,b.jsx)(p.Skeleton,{className:"h-96"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"}),(0,b.jsxs)(l.Button,{onClick:ah,variant:"outline","data-testid":"button-export-users",children:[(0,b.jsx)(aH.Download,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4","data-testid":"section-user-stats",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-total-users-stat",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Users"}),(0,b.jsx)(F.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-users-stat",children:T.total})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-avg-reputation",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Reputation"}),(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-reputation",children:T.avgReputation.toFixed(0)})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-avg-coins",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Coins"}),(0,b.jsx)(aG.Coins,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-coins",children:T.avgCoins.toFixed(0)})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-banned-count",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Banned/Suspended"}),(0,b.jsx)(aE.Ban,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-banned-count",children:T.bannedCount})})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Search & Filters"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(S.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(m.Input,{placeholder:"Search by username or email...",value:a,onChange:a=>d(a.target.value),className:"pl-9","data-testid":"input-user-search"})]}),(0,b.jsxs)(ay.Select,{value:f,onValueChange:g,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-role-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Filter by role"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Roles"}),(0,b.jsx)(ay.SelectItem,{value:"member",children:"Member"}),(0,b.jsx)(ay.SelectItem,{value:"moderator",children:"Moderator"}),(0,b.jsx)(ay.SelectItem,{value:"admin",children:"Admin"})]})]}),(0,b.jsxs)(ay.Select,{value:h,onValueChange:i,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-status-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Filter by status"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(ay.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(ay.SelectItem,{value:"suspended",children:"Suspended"}),(0,b.jsx)(ay.SelectItem,{value:"banned",children:"Banned"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)(ay.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-sort-by",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Sort by"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"username",children:"Username"}),(0,b.jsx)(ay.SelectItem,{value:"email",children:"Email"}),(0,b.jsx)(ay.SelectItem,{value:"coinBalance",children:"Coins"}),(0,b.jsx)(ay.SelectItem,{value:"reputation",children:"Reputation"}),(0,b.jsx)(ay.SelectItem,{value:"createdAt",children:"Created At"}),(0,b.jsx)(ay.SelectItem,{value:"lastActive",children:"Last Active"})]})]}),(0,b.jsxs)(ay.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-sort-order",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Sort order"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"asc",children:"Ascending"}),(0,b.jsx)(ay.SelectItem,{value:"desc",children:"Descending"})]})]})]})]})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Users (",Q,")"]})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Email"}),(0,b.jsx)(aa.TableHead,{children:"Role"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Coins"}),(0,b.jsx)(aa.TableHead,{children:"Joined"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:O.length>0?O.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`user-row-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`user-name-${a.id}`,children:a.username}),(0,b.jsx)(aa.TableCell,{children:a.email}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.role})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"active"===a.status?"default":"destructive",children:a.status})}),(0,b.jsx)(aa.TableCell,{"data-testid":`user-coins-${a.id}`,children:a.coinBalance}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>v(a),"data-testid":`button-view-user-${a.id}`,children:[(0,b.jsx)(aF,{className:"h-4 w-4 mr-1"}),"View"]}),"active"===a.status?(0,b.jsxs)(l.Button,{size:"sm",variant:"destructive",onClick:()=>ab.mutate({userId:a.id,reason:"Manual ban"}),"data-testid":`button-ban-user-${a.id}`,children:[(0,b.jsx)(aE.Ban,{className:"h-4 w-4 mr-1"}),"Ban"]}):(0,b.jsxs)(l.Button,{size:"sm",variant:"default",onClick:()=>ad.mutate(a.id),"data-testid":`button-activate-user-${a.id}`,children:[(0,b.jsx)(aF,{className:"h-4 w-4 mr-1"}),"Activate"]})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Items per page:"}),(0,b.jsxs)(ay.Select,{value:s.toString(),onValueChange:a=>t(parseInt(a)),children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-20","data-testid":"select-items-per-page",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"10",children:"10"}),(0,b.jsx)(ay.SelectItem,{value:"25",children:"25"}),(0,b.jsx)(ay.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(ay.SelectItem,{value:"100",children:"100"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(a=>Math.max(1,a-1)),disabled:1===q,"data-testid":"button-previous-page",children:[(0,b.jsx)(aI.ChevronLeft,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,b.jsxs)("span",{className:"text-sm","data-testid":"text-page-info",children:["Page ",q," of ",P]}),(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(a=>Math.min(P,a+1)),disabled:q===P,"data-testid":"button-next-page",children:["Next",(0,b.jsx)(aJ.ChevronRight,{className:"h-4 w-4 ml-1"})]})]})]})]})]}),(0,b.jsx)(az.Dialog,{open:!!u,onOpenChange:a=>!a&&v(null),children:(0,b.jsxs)(az.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-y-auto","data-testid":"modal-user-detail",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsxs)(az.DialogTitle,{children:["User Details: ",u?.username]}),(0,b.jsx)(az.DialogDescription,{children:"Comprehensive user information and management"})]}),u&&(0,b.jsxs)(aA.Tabs,{defaultValue:"profile",className:"w-full",children:[(0,b.jsxs)(aA.TabsList,{className:"grid w-full grid-cols-4",children:[(0,b.jsx)(aA.TabsTrigger,{value:"profile","data-testid":"tab-profile",children:"Profile"}),(0,b.jsx)(aA.TabsTrigger,{value:"activity","data-testid":"tab-activity",children:"Activity"}),(0,b.jsx)(aA.TabsTrigger,{value:"posts","data-testid":"tab-posts",children:"Posts"}),(0,b.jsx)(aA.TabsTrigger,{value:"coin-history","data-testid":"tab-coin-history",children:"Coin History"})]}),(0,b.jsxs)(aA.TabsContent,{value:"profile",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Username"}),(0,b.jsx)("p",{className:"font-medium",children:u.username})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Email"}),(0,b.jsx)("p",{className:"font-medium",children:u.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Role"}),(0,b.jsx)(au.Badge,{variant:"outline",children:u.role})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,b.jsx)(au.Badge,{variant:"active"===u.status?"default":"destructive",children:u.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Coin Balance"}),(0,b.jsx)("p",{className:"font-medium",children:u.coinBalance})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Reputation"}),(0,b.jsx)("p",{className:"font-medium",children:u.reputation})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Level"}),(0,b.jsx)("p",{className:"font-medium",children:u.level||0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created At"}),(0,b.jsx)("p",{className:"font-medium",children:(0,ag.formatDistanceToNow)(new Date(u.createdAt),{addSuffix:!0})})]}),u.lastActive&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Last Active"}),(0,b.jsx)("p",{className:"font-medium",children:(0,ag.formatDistanceToNow)(new Date(u.lastActive),{addSuffix:!0})})]}),u.suspendedUntil&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Suspended Until"}),(0,b.jsx)("p",{className:"font-medium",children:(0,aL.format)(new Date(u.suspendedUntil),"PPP")})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap pt-4",children:[(0,b.jsxs)(l.Button,{onClick:()=>{x(!0)},variant:"outline",disabled:"active"!==u.status,children:[(0,b.jsx)(aK.Calendar,{className:"h-4 w-4 mr-1"}),"Suspend"]}),(0,b.jsxs)(l.Button,{onClick:()=>{z(!0)},variant:"outline",children:[(0,b.jsx)(M.Shield,{className:"h-4 w-4 mr-1"}),"Change Role"]}),(0,b.jsxs)(l.Button,{onClick:()=>{af.mutate({userId:u.id,amount:100,reason:"Admin adjustment"})},variant:"outline",children:[(0,b.jsx)(aG.Coins,{className:"h-4 w-4 mr-1"}),"Add 100 Coins"]})]})]}),(0,b.jsx)(aA.TabsContent,{value:"activity",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm",children:"Total Threads"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:V.totalThreads})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm",children:"Total Replies"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:V.totalReplies})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm",children:"Content Published"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:V.totalContent})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm",children:"Coins Earned"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:V.coinsEarned})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm",children:"Coins Spent"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:V.coinsSpent})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm",children:"Account Age"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[V.accountAge," days"]})})]})]})}),(0,b.jsx)(aA.TabsContent,{value:"posts",children:X.length>0?(0,b.jsx)("div",{className:"space-y-2",children:X.map(a=>(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"pt-4",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(c.default,{href:`/thread/${a.slug}`,className:"text-primary hover:underline font-medium",children:a.title}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["thread"===a.type?"Thread":"Reply"," Â· ",(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})]})]}),void 0!==a.views&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.views," views"]})]})})},a.id))}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No posts yet"})}),(0,b.jsx)(aA.TabsContent,{value:"coin-history",children:Z.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Date"}),(0,b.jsx)(aa.TableHead,{children:"Type"}),(0,b.jsx)(aa.TableHead,{children:"Amount"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"Balance"})]})}),(0,b.jsx)(aa.TableBody,{children:Z.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"earn"===a.type||"recharge"===a.type?"default":"secondary",children:a.type})}),(0,b.jsxs)(aa.TableCell,{className:a.amount>0?"text-green-600":"text-red-600",children:[a.amount>0?"+":"",a.amount]}),(0,b.jsx)(aa.TableCell,{children:a.description}),(0,b.jsx)(aa.TableCell,{children:a.balance})]},a.id))})]})}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No coin history"})})]})]})}),(0,b.jsx)(az.Dialog,{open:w,onOpenChange:x,children:(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-suspend-user",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Suspend User"}),(0,b.jsxs)(az.DialogDescription,{children:["Temporarily suspend ",u?.username,"'s account"]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Suspended Until"}),(0,b.jsxs)(aD.Popover,{children:[(0,b.jsx)(aD.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(l.Button,{variant:"outline",className:"w-full justify-start text-left font-normal mt-2","data-testid":"input-suspended-until",children:[(0,b.jsx)(aK.Calendar,{className:"mr-2 h-4 w-4"}),A?(0,aL.format)(A,"PPP"):(0,b.jsx)("span",{children:"Pick a date"})]})}),(0,b.jsx)(aD.PopoverContent,{className:"w-auto p-0",children:(0,b.jsx)(aC.Calendar,{mode:"single",selected:A,onSelect:B,initialFocus:!0})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Reason"}),(0,b.jsx)(ax.Textarea,{placeholder:"Enter suspension reason...",value:C,onChange:a=>D(a.target.value),className:"mt-2","data-testid":"input-suspend-reason"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{onClick:()=>{u&&A&&ac.mutate({userId:u.id,suspendedUntil:A.toISOString(),reason:C})},disabled:!A||ac.isPending,"data-testid":"button-suspend-confirm",children:ac.isPending?"Suspending...":"Suspend User"})]})]})}),(0,b.jsx)(az.Dialog,{open:y,onOpenChange:z,children:(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-change-role",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Change User Role"}),(0,b.jsxs)(az.DialogDescription,{children:["Change the role for ",u?.username]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"New Role"}),(0,b.jsxs)(ay.Select,{value:E,onValueChange:G,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full mt-2","data-testid":"select-new-role",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select new role"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"member",children:"Member"}),(0,b.jsx)(ay.SelectItem,{value:"moderator",children:"Moderator"}),(0,b.jsx)(ay.SelectItem,{value:"admin",children:"Admin"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Reason (Optional)"}),(0,b.jsx)(ax.Textarea,{placeholder:"Enter reason for role change...",value:H,onChange:a=>I(a.target.value),className:"mt-2","data-testid":"input-role-change-reason"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{onClick:()=>{u&&E&&ae.mutate({userId:u.id,role:E,reason:H})},disabled:!E||ae.isPending,"data-testid":"button-change-role-confirm",children:ae.isPending?"Changing...":"Change Role"})]})]})})]})}var aO=a.i(27311),aP=a.i(510),aQ=a.i(553465),aR=a.i(816201);let aS=(0,h.default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var aT=a.i(177156),aU=a.i(73570),aV=a.i(641710),aW=a.i(546842),aX=a.i(669520);let aY=(0,h.default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var aZ=a.i(781560),a$=a.i(853390);function a_(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)("all"),[f,g]=(0,e.useState)(1),[h,i]=(0,e.useState)(20),[j,k]=(0,e.useState)([]),[n,o]=(0,e.useState)("pending"),[q,r]=(0,e.useState)(1),[s,t]=(0,e.useState)(20),[u,v]=(0,e.useState)(100),[w,x]=(0,e.useState)("all"),[y,z]=(0,e.useState)(!1),[A,B]=(0,e.useState)(null),[C,D]=(0,e.useState)(!1),[E,F]=(0,e.useState)(null),[H,I]=(0,e.useState)(""),[J,L]=(0,e.useState)(!1),[N,O]=(0,e.useState)(!1),[P,Q]=(0,e.useState)(null),[R,S]=(0,e.useState)(null),[T,U]=(0,e.useState)(!1),[V,W]=(0,e.useState)(""),[X,Y]=(0,e.useState)(!1),[Z,ab]=(0,e.useState)(7),[ac,ad]=(0,e.useState)(""),[ae,af]=(0,e.useState)(null),[ah,ai]=(0,e.useState)(!1),[aj,ak]=(0,e.useState)(""),[al,am]=(0,e.useState)(!1),[an,ao]=(0,e.useState)(null),[ap,aq]=(0,e.useState)(!1),[ar,as]=(0,e.useState)(!1),[at,av]=(0,e.useState)(""),{data:aC,isLoading:aD}=(0,$.useQuery)({queryKey:["/api/moderation/queue",{type:c,page:f,perPage:h}],refetchInterval:3e4}),{data:aF}=(0,$.useQuery)({queryKey:["/api/moderation/queue/count"],refetchInterval:3e4}),{data:aG,isLoading:aH}=(0,$.useQuery)({queryKey:["/api/moderation/reported",{status:n,page:q,perPage:s}],refetchInterval:3e4}),{data:aK}=(0,$.useQuery)({queryKey:["/api/moderation/reported/count"],refetchInterval:3e4}),{data:aN,isLoading:a_}=(0,$.useQuery)({queryKey:["/api/moderation/history",{limit:u,moderatorId:"all"!==w?w:void 0}],refetchInterval:!1}),{data:a0,isLoading:a1}=(0,$.useQuery)({queryKey:["/api/moderation/stats"],refetchInterval:6e4}),a2=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/moderation/${a}/approve`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue/count"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/stats"]}),a({title:"Content approved successfully"}),k([])},onError:()=>{a({title:"Failed to approve content",variant:"destructive"})}}),a3=(0,aw.useMutation)({mutationFn:async({contentId:a,reason:b,deletePermanently:c})=>(0,aM.apiRequest)("POST",`/api/moderation/${a}/reject`,{reason:b,deletePermanently:c}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue/count"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/stats"]}),a({title:"Content rejected successfully"}),D(!1),I(""),L(!1),F(null),z(!1),k([])},onError:()=>{a({title:"Failed to reject content",variant:"destructive"})}}),a4=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST","/api/moderation/bulk-approve",{contentIds:a}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue/count"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/stats"]}),a({title:`Successfully approved ${j.length} items`}),k([]),aq(!1)},onError:()=>{a({title:"Failed to approve selected items",variant:"destructive"})}}),a5=(0,aw.useMutation)({mutationFn:async({contentIds:a,reason:b})=>(0,aM.apiRequest)("POST","/api/moderation/bulk-reject",{contentIds:a,reason:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/queue/count"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/stats"]}),a({title:`Successfully rejected ${j.length} items`}),k([]),as(!1),av("")},onError:()=>{a({title:"Failed to reject selected items",variant:"destructive"})}}),a6=(0,aw.useMutation)({mutationFn:async({reportId:a,reason:b})=>(0,aM.apiRequest)("POST",`/api/moderation/report/${a}/dismiss`,{reason:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/moderation/reported"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/reported/count"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/stats"]}),a({title:"Report dismissed successfully"}),U(!1),W(""),O(!1)},onError:()=>{a({title:"Failed to dismiss report",variant:"destructive"})}}),a7=(0,aw.useMutation)({mutationFn:async({reportId:a,action:b,reason:c,suspendDays:d})=>(0,aM.apiRequest)("POST",`/api/moderation/report/${a}/action`,{action:b,reason:c,suspendDays:d}),onSuccess:(b,c)=>{aM.queryClient.invalidateQueries({queryKey:["/api/moderation/reported"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/reported/count"]}),aM.queryClient.invalidateQueries({queryKey:["/api/moderation/stats"]});let d="delete"===c.action?"deleted":"warn"===c.action?"warned":"suspend"===c.action?"suspended":"banned";a({title:`Author ${d} successfully`}),O(!1),Y(!1),ai(!1),ad(""),ak(""),am(!1)},onError:()=>{a({title:"Failed to take action",variant:"destructive"})}}),a8=async b=>{try{let a=await fetch(`/api/moderation/${b}/details`),c=await a.json();B(c),z(!0)}catch(b){a({title:"Failed to load content details",variant:"destructive"})}},a9=async b=>{try{let a=await fetch(`/api/moderation/report/${b}`),c=await a.json();Q(c),S(b),O(!0)}catch(b){a({title:"Failed to load report details",variant:"destructive"})}},ba=a=>{F(a),D(!0)},bb=(a,b)=>a.length<=b?a:a.substring(0,b)+"...",bc=aC?.items||[],bd=aG?.items||[],be=aN||[],bf=bc.length>0&&j.length===bc.length;return j.length>0&&(j.length,bc.length),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Content Moderation"})}),(0,b.jsxs)(aA.Tabs,{defaultValue:"queue",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsxs)(aA.TabsTrigger,{value:"queue","data-testid":"tab-moderation-queue",children:["Moderation Queue",aF&&aF.pending>0&&(0,b.jsx)(au.Badge,{variant:"destructive",className:"ml-2",children:aF.pending})]}),(0,b.jsxs)(aA.TabsTrigger,{value:"reported","data-testid":"tab-reported-content",children:["Reported Content",aK&&aK.pending>0&&(0,b.jsx)(au.Badge,{variant:"destructive",className:"ml-2",children:aK.pending})]}),(0,b.jsx)(aA.TabsTrigger,{value:"history","data-testid":"tab-moderation-history",children:"Moderation History"}),(0,b.jsx)(aA.TabsTrigger,{value:"stats","data-testid":"tab-moderation-stats",children:"Statistics"})]}),(0,b.jsxs)(aA.TabsContent,{value:"queue",className:"space-y-4",children:[(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsx)(_.CardTitle,{children:"Content Type"}),(0,b.jsx)(aA.Tabs,{value:c,onValueChange:d,className:"w-auto",children:(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"all","data-testid":"filter-content-type-all",children:"All"}),(0,b.jsx)(aA.TabsTrigger,{value:"thread","data-testid":"filter-content-type-thread",children:"Threads"}),(0,b.jsx)(aA.TabsTrigger,{value:"reply","data-testid":"filter-content-type-reply",children:"Replies"})]})})]})})}),j.length>0&&(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(l.Button,{onClick:()=>{0===j.length||j.length>100||aq(!0)},disabled:0===j.length||j.length>100||a4.isPending,"data-testid":"button-bulk-approve",children:[(0,b.jsx)(aR.CheckCircle,{className:"h-4 w-4 mr-2"}),"Approve Selected (",j.length,")"]}),(0,b.jsxs)(l.Button,{variant:"destructive",onClick:()=>{0===j.length||j.length>100||as(!0)},disabled:0===j.length||j.length>100||a5.isPending,"data-testid":"button-bulk-reject",children:[(0,b.jsx)(aS,{className:"h-4 w-4 mr-2"}),"Reject Selected (",j.length,")"]}),j.length>100&&(0,b.jsx)(aQ.Alert,{className:"flex-1",children:(0,b.jsx)(aQ.AlertDescription,{children:"Maximum 100 items can be selected for bulk actions"})})]})})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Pending Content (",aC?.total||0,")"]})}),(0,b.jsxs)(_.CardContent,{children:[aD?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):0===bc.length?(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No pending items in queue"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{"data-testid":"table-moderation-queue",children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{className:"w-12",children:(0,b.jsx)(aO.Checkbox,{checked:bf,onCheckedChange:a=>{a?k((aC?.items||[]).map(a=>a.id)):k([])},"data-testid":"checkbox-select-all"})}),(0,b.jsx)(aa.TableHead,{children:"Content Preview"}),(0,b.jsx)(aa.TableHead,{children:"Author"}),(0,b.jsx)(aa.TableHead,{children:"Category"}),(0,b.jsx)(aa.TableHead,{children:"Submitted"}),(0,b.jsx)(aa.TableHead,{children:"Word Count"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:bc.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(aO.Checkbox,{checked:j.includes(a.id),onCheckedChange:b=>{var c;return c=a.id,void(b?k([...j,c]):k(j.filter(a=>a!==c)))},"data-testid":`checkbox-select-${a.id}`})}),(0,b.jsx)(aa.TableCell,{className:"max-w-md",children:(0,b.jsxs)("div",{className:"space-y-1",children:[a.title&&(0,b.jsx)("div",{className:"font-medium",children:bb(a.title,50)}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:bb(a.body,100)}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)(au.Badge,{variant:"outline",children:a.type}),a.hasLinks&&(0,b.jsx)(au.Badge,{variant:"secondary",children:"Links"}),a.hasImages&&(0,b.jsx)(au.Badge,{variant:"secondary",children:"Images"})]})]})}),(0,b.jsxs)(aa.TableCell,{children:["@",a.authorUsername]}),(0,b.jsx)(aa.TableCell,{children:"thread"===a.type?a.categoryName:a.threadTitle}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:a.wordCount}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(l.Button,{size:"sm",variant:"ghost",onClick:()=>a8(a.id),"data-testid":`button-view-details-${a.id}`,children:[(0,b.jsx)(aT.Eye,{className:"h-4 w-4 mr-1"}),"View"]}),(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>a2.mutate(a.id),disabled:a2.isPending,"data-testid":`button-approve-${a.id}`,children:[(0,b.jsx)(aR.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,b.jsxs)(l.Button,{size:"sm",variant:"destructive",onClick:()=>ba(a.id),"data-testid":`button-reject-${a.id}`,children:[(0,b.jsx)(aS,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},a.id))})]})}),aC&&aC.pages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 mt-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Items per page:"}),(0,b.jsxs)(ay.Select,{value:h.toString(),onValueChange:a=>i(Number(a)),children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-20",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"10",children:"10"}),(0,b.jsx)(ay.SelectItem,{value:"20",children:"20"}),(0,b.jsx)(ay.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(ay.SelectItem,{value:"100",children:"100"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>g(a=>Math.max(1,a-1)),disabled:1===f,children:[(0,b.jsx)(aI.ChevronLeft,{className:"h-4 w-4"}),"Previous"]}),(0,b.jsxs)("span",{className:"text-sm",children:["Page ",f," of ",aC.pages]}),(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>g(a=>Math.min(aC.pages,a+1)),disabled:f===aC.pages,children:["Next",(0,b.jsx)(aJ.ChevronRight,{className:"h-4 w-4"})]})]})]})]})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"reported",className:"space-y-4",children:[(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsx)(_.CardTitle,{children:"Filter by Status"}),(0,b.jsxs)(ay.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(ay.SelectItem,{value:"resolved",children:"Resolved"}),(0,b.jsx)(ay.SelectItem,{value:"dismissed",children:"Dismissed"})]})]})]})})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Reported Content (",aG?.total||0,")"]})}),(0,b.jsxs)(_.CardContent,{children:[aH?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):0===bd.length?(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No reported content found"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{"data-testid":"table-reported-content",children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Content Preview"}),(0,b.jsx)(aa.TableHead,{children:"Author"}),(0,b.jsx)(aa.TableHead,{children:"Reports"}),(0,b.jsx)(aa.TableHead,{children:"Reasons"}),(0,b.jsx)(aa.TableHead,{children:"First Reported"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:bd.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"max-w-md",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-sm",children:bb(a.contentPreview,100)}),(0,b.jsx)(au.Badge,{variant:"outline",children:a.contentType})]})}),(0,b.jsxs)(aa.TableCell,{children:["@",a.authorUsername]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"destructive",children:a.reportCount})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.reasons.slice(0,3).map((a,c)=>(0,b.jsx)(au.Badge,{variant:"secondary",children:a},c)),a.reasons.length>3&&(0,b.jsxs)(au.Badge,{variant:"secondary",children:["+",a.reasons.length-3]})]})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.firstReportedAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"pending"===a.status?"destructive":"resolved"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(l.Button,{size:"sm",variant:"ghost",onClick:()=>a9(a.contentId),children:[(0,b.jsx)(aT.Eye,{className:"h-4 w-4 mr-1"}),"View Details"]}),"pending"===a.status&&(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>a9(a.contentId),"data-testid":`button-take-action-${a.contentId}`,children:[(0,b.jsx)(M.Shield,{className:"h-4 w-4 mr-1"}),"Take Action"]})]})})]},a.contentId))})]})}),aG&&aG.pages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 mt-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Items per page:"}),(0,b.jsxs)(ay.Select,{value:s.toString(),onValueChange:a=>t(Number(a)),children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-20",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"10",children:"10"}),(0,b.jsx)(ay.SelectItem,{value:"20",children:"20"}),(0,b.jsx)(ay.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(ay.SelectItem,{value:"100",children:"100"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(a=>Math.max(1,a-1)),disabled:1===q,children:[(0,b.jsx)(aI.ChevronLeft,{className:"h-4 w-4"}),"Previous"]}),(0,b.jsxs)("span",{className:"text-sm",children:["Page ",q," of ",aG.pages]}),(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(a=>Math.min(aG.pages,a+1)),disabled:q===aG.pages,children:["Next",(0,b.jsx)(aJ.ChevronRight,{className:"h-4 w-4"})]})]})]})]})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"history",className:"space-y-4",children:[(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsx)(_.CardTitle,{children:"Filters"}),(0,b.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:"Moderator:"}),(0,b.jsxs)(ay.Select,{value:w,onValueChange:x,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48","data-testid":"select-moderator-filter",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsx)(ay.SelectContent,{children:(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Moderators"})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:"Limit:"}),(0,b.jsxs)(ay.Select,{value:u.toString(),onValueChange:a=>v(Number(a)),children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-32",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(ay.SelectItem,{value:"100",children:"100"}),(0,b.jsx)(ay.SelectItem,{value:"200",children:"200"}),(0,b.jsx)(ay.SelectItem,{value:"500",children:"500"})]})]})]}),(0,b.jsxs)(l.Button,{variant:"outline",onClick:()=>aM.queryClient.invalidateQueries({queryKey:["/api/moderation/history"]}),children:[(0,b.jsx)(aX.RefreshCw,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]})})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsx)(_.CardTitle,{children:"Moderation History"}),(0,b.jsx)(_.CardDescription,{children:"Read-only log of recent moderation actions"})]}),(0,b.jsx)(_.CardContent,{children:a_?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):0===be.length?(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No moderation history available"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{"data-testid":"table-history",children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Moderator"}),(0,b.jsx)(aa.TableHead,{children:"Action"}),(0,b.jsx)(aa.TableHead,{children:"Content"}),(0,b.jsx)(aa.TableHead,{children:"Reason"})]})}),(0,b.jsx)(aa.TableBody,{children:be.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{children:(0,aL.format)(new Date(a.createdAt),"MMM d, yyyy HH:mm")}),(0,b.jsxs)(aa.TableCell,{children:["@",a.moderatorUsername]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"approve"===a.actionType?"default":"reject"===a.actionType?"destructive":"secondary",children:a.actionType})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-sm",children:bb(a.contentTitle,50)}),(0,b.jsx)(au.Badge,{variant:"outline",children:a.contentType})]})}),(0,b.jsx)(aa.TableCell,{className:"max-w-md",children:a.reason?bb(a.reason,100):"-"})]},a.id))})]})})})]})]}),(0,b.jsx)(aA.TabsContent,{value:"stats",className:"space-y-4",children:a1?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))}):a0?(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-today-approved",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Today Approved"}),(0,b.jsx)(aR.CheckCircle,{className:"h-4 w-4 text-green-500"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:a0.todayApproved})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-today-rejected",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Today Rejected"}),(0,b.jsx)(aS,{className:"h-4 w-4 text-red-500"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:a0.todayRejected})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-today-reports-handled",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Today Reports Handled"}),(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4 text-orange-500"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:a0.todayReportsHandled})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-total-moderated-today",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Moderated Today"}),(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-blue-500"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:a0.totalModeratedToday})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-avg-response-time",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Response Time"}),(0,b.jsx)(aV.Clock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:[a0.avgResponseTimeMinutes,"m"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average time to first action"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-most-active-moderator",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Most Active Moderator"}),(0,b.jsx)(aW.User,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-lg font-bold",children:["@",a0.mostActiveModerator||"N/A"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-pending-under-1hr",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Pending < 1hr"}),(0,b.jsx)(G.FileText,{className:"h-4 w-4 text-green-500"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:a0.pendingUnderOneHour}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Fresh submissions"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-pending-over-24hrs",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Pending > 24hrs"}),(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4 text-red-500"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:a0.pendingOverTwentyFourHours}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Urgent - needs attention"})]})]})]}):null})]}),(0,b.jsx)(az.Dialog,{open:y,onOpenChange:z,children:(0,b.jsxs)(az.DialogContent,{className:"max-w-4xl max-h-[90vh]","data-testid":"dialog-content-details",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsxs)(az.DialogTitle,{children:["Review Content - ",A?.type==="thread"?"Thread":"Reply"]})}),(0,b.jsx)(aP.ScrollArea,{className:"max-h-[calc(90vh-150px)]",children:A&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Content"}),A.title&&(0,b.jsx)("h4",{className:"text-lg font-bold mb-2",children:A.title}),(0,b.jsx)("div",{className:"p-4 bg-muted rounded-lg whitespace-pre-wrap",children:A.body})]}),A.parentThread&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Parent Thread"}),(0,b.jsx)("div",{className:"p-3 bg-muted rounded-lg",children:(0,b.jsx)("p",{className:"text-sm",children:A.parentThread.title})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Author Information"}),(0,b.jsxs)("div",{className:"flex items-start gap-4 p-4 bg-muted rounded-lg",children:[(0,b.jsx)(a$.Avatar,{children:(0,b.jsx)(a$.AvatarFallback,{children:A.author.username[0].toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium",children:["@",A.author.username]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:A.author.role})]}),(0,b.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Reputation:"})," ",(0,b.jsx)("span",{className:"font-medium",children:A.author.reputation})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Member since:"})," ",(0,b.jsx)("span",{className:"font-medium",children:(0,aL.format)(new Date(A.author.createdAt),"MMM d, yyyy")})]})]}),A.author.badges&&A.author.badges.length>0&&(0,b.jsx)("div",{className:"flex gap-1 flex-wrap",children:A.author.badges.map((a,c)=>(0,b.jsx)(au.Badge,{variant:"secondary",children:a},c))})]})]})]}),A.recentPosts.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Author's Recent Posts"}),(0,b.jsx)("div",{className:"space-y-2",children:A.recentPosts.map(a=>(0,b.jsx)("div",{className:"p-3 bg-muted rounded-lg text-sm",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.title}),(0,b.jsx)("div",{className:"text-muted-foreground",children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]}),(0,b.jsx)(au.Badge,{variant:"outline",children:a.type})]})},a.id))})]}),A.warnings.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2 text-orange-600",children:"Warning History"}),(0,b.jsx)("div",{className:"space-y-2",children:A.warnings.map((a,c)=>(0,b.jsxs)("div",{className:"p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg text-sm border border-orange-200 dark:border-orange-800",children:[(0,b.jsx)("div",{className:"font-medium",children:a.reason}),(0,b.jsxs)("div",{className:"text-muted-foreground",children:["By @",a.moderator," â¢ ",(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})]})]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Metadata"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted rounded-lg text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Created:"})," ",(0,aL.format)(new Date(A.metadata.createdAt),"MMM d, yyyy HH:mm")]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Word Count:"})," ",A.metadata.wordCount]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Has Links:"})," ",A.metadata.hasLinks?"Yes":"No"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Has Images:"})," ",A.metadata.hasImages?"Yes":"No"]}),A.metadata.category&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Category:"})," ",A.metadata.category]})]})]})]})}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>z(!1),children:"Close"}),(0,b.jsxs)(l.Button,{variant:"outline",onClick:()=>{A&&a2.mutate(A.id)},children:[(0,b.jsx)(aR.CheckCircle,{className:"h-4 w-4 mr-2"}),"Approve"]}),(0,b.jsxs)(l.Button,{variant:"destructive",onClick:()=>{A&&ba(A.id)},children:[(0,b.jsx)(aS,{className:"h-4 w-4 mr-2"}),"Reject"]})]})]})}),(0,b.jsx)(az.Dialog,{open:C,onOpenChange:D,children:(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-reject-content",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Reject Content"}),(0,b.jsx)(az.DialogDescription,{children:"Please provide a reason for rejecting this content"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Reason (10-500 characters)"}),(0,b.jsx)(ax.Textarea,{value:H,onChange:a=>I(a.target.value),placeholder:"Enter reason for rejection...",className:"min-h-24","data-testid":"textarea-reason"}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[H.length,"/500 characters"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aO.Checkbox,{checked:J,onCheckedChange:a=>L(a),id:"delete-permanently"}),(0,b.jsx)("label",{htmlFor:"delete-permanently",className:"text-sm cursor-pointer",children:"Delete permanently"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>D(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{variant:"destructive",onClick:()=>{!E||!H||H.length<10||H.length>500?a({title:"Reason must be between 10 and 500 characters",variant:"destructive"}):a3.mutate({contentId:E,reason:H,deletePermanently:J})},disabled:a3.isPending||H.length<10||H.length>500,children:"Reject"})]})]})}),(0,b.jsx)(az.Dialog,{open:N,onOpenChange:O,children:(0,b.jsxs)(az.DialogContent,{className:"max-w-4xl max-h-[90vh]","data-testid":"dialog-report-details",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Report Details"})}),(0,b.jsx)(aP.ScrollArea,{className:"max-h-[calc(90vh-150px)]",children:P&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Content"}),P.content.title&&(0,b.jsx)("h4",{className:"text-lg font-bold mb-2",children:P.content.title}),(0,b.jsx)("div",{className:"p-4 bg-muted rounded-lg whitespace-pre-wrap",children:P.content.body})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-semibold mb-2",children:["Reports (",P.reports.length,")"]}),(0,b.jsx)("div",{className:"space-y-3",children:P.reports.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium",children:["@",a.reporterUsername]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]}),(0,b.jsx)(au.Badge,{variant:"destructive",children:a.reason})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Author Information"}),(0,b.jsx)("div",{className:"p-4 bg-muted rounded-lg",children:(0,b.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Username:"})," ",(0,b.jsxs)("span",{className:"font-medium",children:["@",P.author.username]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Reputation:"})," ",(0,b.jsx)("span",{className:"font-medium",children:P.author.reputation})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Role:"})," ",(0,b.jsx)("span",{className:"font-medium",children:P.author.role})]})]})})]})]})}),(0,b.jsxs)(az.DialogFooter,{className:"flex-wrap gap-2",children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>O(!1),children:"Close"}),(0,b.jsx)(l.Button,{variant:"secondary",onClick:()=>{U(!0)},children:"Dismiss Report"}),(0,b.jsxs)(l.Button,{variant:"destructive",onClick:()=>{R&&a7.mutate({reportId:R,action:"delete",reason:"Content deleted by moderator"})},children:[(0,b.jsx)(aZ.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Content"]}),(0,b.jsxs)(l.Button,{variant:"outline",onClick:()=>{R&&a7.mutate({reportId:R,action:"warn",reason:"Warning issued for reported content"})},className:"border-yellow-500 text-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-950/20",children:[(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4 mr-2"}),"Warn Author"]}),(0,b.jsxs)(l.Button,{variant:"outline",onClick:()=>{P&&(af(P.author.username),Y(!0))},className:"border-orange-500 text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-950/20",children:[(0,b.jsx)(aY,{className:"h-4 w-4 mr-2"}),"Suspend Author"]}),(0,b.jsxs)(l.Button,{variant:"destructive",onClick:()=>{P&&(ao(P.author.username),ai(!0))},children:[(0,b.jsx)(aE.Ban,{className:"h-4 w-4 mr-2"}),"Ban Author"]})]})]})}),(0,b.jsx)(az.Dialog,{open:T,onOpenChange:U,children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Dismiss Report"}),(0,b.jsx)(az.DialogDescription,{children:"Optionally provide a reason for dismissing this report"})]}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Reason (optional, max 500 characters)"}),(0,b.jsx)(ax.Textarea,{value:V,onChange:a=>W(a.target.value),placeholder:"Enter reason for dismissal...",className:"min-h-24"})]})}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>U(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{onClick:()=>{R&&a6.mutate({reportId:R,reason:V||void 0})},disabled:a6.isPending,children:"Dismiss Report"})]})]})}),(0,b.jsx)(az.Dialog,{open:X,onOpenChange:Y,children:(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-suspend-author",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Suspend Author"}),(0,b.jsx)(az.DialogDescription,{children:"Temporarily suspend this user's account"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Suspend Days (1-365)"}),(0,b.jsx)(m.Input,{type:"number",min:1,max:365,value:Z,onChange:a=>ab(Number(a.target.value)),"data-testid":"input-suspend-days"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Reason (10-500 characters)"}),(0,b.jsx)(ax.Textarea,{value:ac,onChange:a=>ad(a.target.value),placeholder:"Enter reason for suspension...",className:"min-h-24","data-testid":"textarea-reason"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>Y(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{variant:"destructive",onClick:()=>{!R||!ac||ac.length<10||ac.length>500?a({title:"Reason must be between 10 and 500 characters",variant:"destructive"}):Z<1||Z>365?a({title:"Suspend days must be between 1 and 365",variant:"destructive"}):a7.mutate({reportId:R,action:"suspend",reason:ac,suspendDays:Z})},disabled:a7.isPending||ac.length<10||ac.length>500||Z<1||Z>365,children:"Suspend User"})]})]})}),(0,b.jsx)(az.Dialog,{open:ah,onOpenChange:ai,children:(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-ban-author",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Ban Author"}),(0,b.jsx)(az.DialogDescription,{children:"Permanently ban this user from the platform"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(aQ.Alert,{variant:"destructive",children:[(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(aQ.AlertDescription,{children:"This action is permanent and cannot be undone."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Reason (10-500 characters)"}),(0,b.jsx)(ax.Textarea,{value:aj,onChange:a=>ak(a.target.value),placeholder:"Enter reason for ban...",className:"min-h-24","data-testid":"textarea-reason"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aO.Checkbox,{checked:al,onCheckedChange:a=>am(a),id:"ban-confirm"}),(0,b.jsx)("label",{htmlFor:"ban-confirm",className:"text-sm cursor-pointer",children:"I understand this is permanent"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>ai(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{variant:"destructive",onClick:()=>{!R||!aj||aj.length<10||aj.length>500?a({title:"Reason must be between 10 and 500 characters",variant:"destructive"}):al?a7.mutate({reportId:R,action:"ban",reason:aj}):a({title:"Please confirm that you understand this action is permanent",variant:"destructive"})},disabled:a7.isPending||!al||aj.length<10||aj.length>500,children:"Ban User"})]})]})}),(0,b.jsx)(az.Dialog,{open:ap,onOpenChange:aq,children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Approve Selected Items"}),(0,b.jsxs)(az.DialogDescription,{children:["Are you sure you want to approve ",j.length," items?"]})]}),(0,b.jsxs)(aQ.Alert,{children:[(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(aQ.AlertDescription,{children:"This action cannot be undone."})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>aq(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{onClick:()=>{a4.mutate(j)},disabled:a4.isPending,children:"Approve All"})]})]})}),(0,b.jsx)(az.Dialog,{open:ar,onOpenChange:as,children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Reject Selected Items"}),(0,b.jsxs)(az.DialogDescription,{children:["Reject ",j.length," selected items"]})]}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Reason (10-500 characters)"}),(0,b.jsx)(ax.Textarea,{value:at,onChange:a=>av(a.target.value),placeholder:"This reason will apply to all selected items...",className:"min-h-24","data-testid":"textarea-reason"})]})}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"ghost",onClick:()=>as(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{variant:"destructive",onClick:()=>{!at||at.length<10||at.length>500?a({title:"Reason must be between 10 and 500 characters",variant:"destructive"}):a5.mutate({contentIds:j,reason:at})},disabled:a5.isPending||at.length<10||at.length>500,children:"Reject All"})]})]})})]})}var a0=a.i(695245),a1=a.i(159501),a2=a.i(336570),a3=a.i(139392),a4=a.i(883497),a5=a.i(821374),a6=a.i(915618);let a7=a2.z.object({type:a2.z.enum(["ea","indicator","article","source_code"]),title:a2.z.string().min(10,"Title must be at least 10 characters").max(120),description:a2.z.string().min(300,"Description must be at least 300 characters"),category:a2.z.string().min(1,"Category is required"),priceCoins:a2.z.number().min(0).max(1e4),isFree:a2.z.boolean(),platform:a2.z.enum(["MT4","MT5","Both"]).optional(),version:a2.z.string().optional(),tags:a2.z.string().optional(),license:a2.z.string().optional(),minDeposit:a2.z.number().optional(),hedging:a2.z.boolean().optional(),changelog:a2.z.string().optional()});function a8({trigger:a}){let{toast:c}=(0,aB.useToast)(),[d,f]=(0,e.useState)(!1),[g,h]=(0,e.useState)([]),i=(0,a0.useForm)({resolver:(0,a1.zodResolver)(a7),defaultValues:{type:"ea",title:"",description:"",category:"",priceCoins:0,isFree:!0,platform:"MT4",version:"1.0",tags:"",license:"Standard",minDeposit:void 0,hedging:!1,changelog:""}}),j=(0,aw.useMutation)({mutationFn:async a=>{let b=a.tags?a.tags.split(",").map(a=>a.trim()).filter(Boolean):[],c={...a,tags:b,status:"approved",files:[],images:[]};return(await (0,aM.apiRequest)("POST","/api/admin/content",c)).json()},onSuccess:()=>{c({title:"Content Created!",description:"The marketplace content has been successfully added."}),i.reset(),h([]),f(!1),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/stats"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/items"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-selling"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/revenue-chart"]}),aM.queryClient.invalidateQueries({queryKey:["/api/content"]})},onError:a=>{c({variant:"destructive",title:"Failed to Create Content",description:a.message||"Could not create marketplace content. Please try again."})}}),k=["Expert Advisors","Indicators","Scripts","Templates","Trading Systems","Libraries","Utilities","Educational"],n=["Scalping","Day Trading","Swing Trading","Grid","Martingale","Breakout","Trend Following","Mean Reversion","News Trading","High Frequency","Performance Report"],o=i.watch("isFree");return(0,e.useEffect)(()=>{o&&i.setValue("priceCoins",0)},[o,i]),(0,b.jsxs)(az.Dialog,{open:d,onOpenChange:f,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:a||(0,b.jsxs)(l.Button,{"data-testid":"button-add-content",children:[(0,b.jsx)(a6.Plus,{className:"h-4 w-4 mr-2"}),"Add Content"]})}),(0,b.jsxs)(az.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Add Marketplace Content"}),(0,b.jsx)(az.DialogDescription,{children:"Create new marketplace content (EA, Indicator, Article, or Source Code). All fields marked with * are required."})]}),(0,b.jsx)(a3.Form,{...i,children:(0,b.jsxs)("form",{onSubmit:i.handleSubmit(a=>{j.mutate(a)}),className:"space-y-6",children:[(0,b.jsx)(a3.FormField,{control:i.control,name:"type",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Content Type *"}),(0,b.jsxs)(ay.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-content-type",children:(0,b.jsx)(ay.SelectValue,{})})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"ea",children:"Expert Advisor (EA)"}),(0,b.jsx)(ay.SelectItem,{value:"indicator",children:"Indicator"}),(0,b.jsx)(ay.SelectItem,{value:"article",children:"Article"}),(0,b.jsx)(ay.SelectItem,{value:"source_code",children:"Source Code"})]})]}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"title",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Title *"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"e.g., Gold Scalper Pro EA v2.5",...a,"data-testid":"input-content-title"})}),(0,b.jsxs)(a3.FormDescription,{children:[a.value.length,"/120 characters"]}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"description",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Description *"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ax.Textarea,{placeholder:"Detailed description of the content, features, benefits, and usage instructions...",className:"min-h-[150px]",...a,"data-testid":"textarea-content-description"})}),(0,b.jsxs)(a3.FormDescription,{children:[a.value.length," characters (minimum 300)"]}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"category",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Category *"}),(0,b.jsxs)(ay.Select,{onValueChange:a.onChange,value:a.value||void 0,children:[(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-category",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select a category..."})})}),(0,b.jsx)(ay.SelectContent,{children:k.map(a=>(0,b.jsx)(ay.SelectItem,{value:a,children:a},a))})]}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"platform",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Platform"}),(0,b.jsxs)(ay.Select,{onValueChange:a.onChange,value:a.value||void 0,children:[(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-platform",children:(0,b.jsx)(ay.SelectValue,{})})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"MT4",children:"MT4"}),(0,b.jsx)(ay.SelectItem,{value:"MT5",children:"MT5"}),(0,b.jsx)(ay.SelectItem,{value:"Both",children:"Both MT4 & MT5"})]})]}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(a3.FormField,{control:i.control,name:"isFree",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(aO.Checkbox,{checked:a.value,onCheckedChange:a.onChange,"data-testid":"checkbox-is-free"})}),(0,b.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,b.jsx)(a3.FormLabel,{children:"Free Content"}),(0,b.jsx)(a3.FormDescription,{children:"Check if this content is free"})]})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"priceCoins",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Price (Coins) *"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{type:"number",min:0,max:1e4,disabled:o,...a,onChange:b=>a.onChange(parseInt(b.target.value)||0),"data-testid":"input-price-coins"})}),(0,b.jsx)(a3.FormDescription,{children:"0-10,000 coins"}),(0,b.jsx)(a3.FormMessage,{})]})})]}),(0,b.jsx)(a3.FormField,{control:i.control,name:"tags",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Tags"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:n.map(a=>(0,b.jsx)(au.Badge,{variant:g.includes(a)?"default":"outline",className:"cursor-pointer",onClick:()=>{let b;h(b=g.includes(a)?g.filter(b=>b!==a):[...g,a]),i.setValue("tags",b.join(", "))},"data-testid":`tag-${a.toLowerCase().replace(/\s+/g,"-")}`,children:a},a))}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"Or enter custom tags separated by commas...",...a,"data-testid":"input-tags"})}),(0,b.jsx)(a3.FormDescription,{children:"Click tags above or enter custom tags separated by commas (max 8)"}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(a3.FormField,{control:i.control,name:"version",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Version"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"e.g., 1.0, 2.5.1",...a,"data-testid":"input-version"})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"license",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"License"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"e.g., Standard, Extended, GPL",...a,"data-testid":"input-license"})}),(0,b.jsx)(a3.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(a3.FormField,{control:i.control,name:"minDeposit",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Minimum Deposit"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{type:"number",placeholder:"e.g., 100",...a,onChange:b=>a.onChange(b.target.value?parseInt(b.target.value):void 0),value:a.value||"","data-testid":"input-min-deposit"})}),(0,b.jsx)(a3.FormDescription,{children:"Minimum account balance required"}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:i.control,name:"hedging",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4 mt-2",children:[(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(aO.Checkbox,{checked:a.value,onCheckedChange:a.onChange,"data-testid":"checkbox-hedging"})}),(0,b.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,b.jsx)(a3.FormLabel,{children:"Supports Hedging"}),(0,b.jsx)(a3.FormDescription,{children:"Check if this EA supports hedging"})]})]})})]}),(0,b.jsx)(a3.FormField,{control:i.control,name:"changelog",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Changelog"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ax.Textarea,{placeholder:"Version history and updates...",className:"min-h-[100px]",...a,"data-testid":"textarea-changelog"})}),(0,b.jsx)(a3.FormDescription,{children:"Document version changes and improvements"}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(l.Button,{type:"submit",disabled:j.isPending,"data-testid":"button-submit-content",children:j.isPending?"Creating...":"Create Content"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>{i.reset(),h([]),f(!1)},"data-testid":"button-cancel",children:"Cancel"})]})]})})]})]})}let a9=a2.z.object({reason:a2.z.string().min(10,"Reason must be at least 10 characters").max(500,"Reason must be less than 500 characters")}),ba=a2.z.object({durationDays:a2.z.number().min(1,"Duration must be at least 1 day").max(365,"Duration cannot exceed 365 days")});function bb(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(""),[f,g]=(0,e.useState)(""),[h,i]=(0,e.useState)("all"),[j,k]=(0,e.useState)("all"),[n,o]=(0,e.useState)("all"),[q,r]=(0,e.useState)(1),[s,t]=(0,e.useState)(20),[u,v]=(0,e.useState)(null),[w,x]=(0,e.useState)(null),[y,z]=(0,e.useState)(null);(0,e.useEffect)(()=>{let a=setTimeout(()=>{g(c),r(1)},300);return()=>clearTimeout(a)},[c]),(0,e.useEffect)(()=>{r(1)},[h,j,n]);let A=new URLSearchParams({page:q.toString(),limit:s.toString(),...f&&{search:f},..."all"!==h&&{category:h},..."all"!==j&&{status:j},..."all"!==n&&{priceRange:n}}),{data:B,isLoading:C}=(0,$.useQuery)({queryKey:["/api/admin/marketplace/stats"]}),D=B||{totalItems:0,pendingItems:0,totalSales:0,salesThisWeek:0,totalRevenue:0,revenueThisWeek:0},{data:E,isLoading:F}=(0,$.useQuery)({queryKey:["/api/admin/marketplace/items",q,s,f,h,j,n],queryFn:async()=>{let a=await fetch(`/api/admin/marketplace/items?${A}`);if(!a.ok){let b=await a.json();return{items:Array.isArray(b)?b:[],totalItems:Array.isArray(b)?b.length:0,totalPages:1,currentPage:1,pageSize:Array.isArray(b)?b.length:20}}return a.json()}}),G=E?.items||[],H=E?.totalItems||0,I=E?.totalPages||1,{data:L,isLoading:M}=(0,$.useQuery)({queryKey:["/api/admin/marketplace/top-selling"]}),N=Array.isArray(L)?L:[],{data:O,isLoading:P}=(0,$.useQuery)({queryKey:["/api/admin/marketplace/revenue-chart"]}),Q=Array.isArray(O)?O:[],{data:R,isLoading:S}=(0,$.useQuery)({queryKey:["/api/admin/marketplace/top-vendors"]}),T=Array.isArray(R)?R:[],{data:U,isLoading:V}=(0,$.useQuery)({queryKey:["/api/admin/marketplace/items",u],enabled:!!u,queryFn:async()=>{let a=await fetch(`/api/admin/marketplace/items/${u}`);if(!a.ok)throw Error("Failed to fetch item details");return a.json()}}),W=(0,a0.useForm)({resolver:(0,a1.zodResolver)(a9),defaultValues:{reason:""}}),X=(0,a0.useForm)({resolver:(0,a1.zodResolver)(ba),defaultValues:{durationDays:30}}),Y=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/marketplace/${a}/approve`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/items"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/stats"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-selling"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-vendors"]}),a({title:"Item approved successfully"})},onError:()=>{a({title:"Failed to approve item",variant:"destructive"})}}),Z=(0,aw.useMutation)({mutationFn:async a=>{if(!w)throw Error("No item selected");return(0,aM.apiRequest)("POST",`/api/admin/marketplace/${w}/reject`,a)},onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/items"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/stats"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-selling"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-vendors"]}),x(null),a({title:"Item rejected successfully"}),W.reset()},onError:()=>{a({title:"Failed to reject item",variant:"destructive"})}}),ab=(0,aw.useMutation)({mutationFn:async a=>{if(!y)throw Error("No item selected");return(0,aM.apiRequest)("POST",`/api/admin/marketplace/${y}/feature`,a)},onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/items"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/stats"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-selling"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/marketplace/top-vendors"]}),z(null),a({title:"Item featured successfully"}),X.reset()},onError:()=>{a({title:"Failed to feature item",variant:"destructive"})}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Marketplace Management"}),(0,b.jsx)(a8,{})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(m.Input,{placeholder:"Search by title or seller...",value:c,onChange:a=>d(a.target.value),"data-testid":"input-search-items"})}),(0,b.jsxs)(ay.Select,{value:h,onValueChange:i,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[200px]","data-testid":"select-category-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Categories"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Categories"}),(0,b.jsx)(ay.SelectItem,{value:"Expert Advisors",children:"Expert Advisors"}),(0,b.jsx)(ay.SelectItem,{value:"Indicators",children:"Indicators"}),(0,b.jsx)(ay.SelectItem,{value:"Scripts",children:"Scripts"}),(0,b.jsx)(ay.SelectItem,{value:"Templates",children:"Templates"})]})]}),(0,b.jsxs)(ay.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[180px]","data-testid":"select-status-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Statuses"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Statuses"}),(0,b.jsx)(ay.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(ay.SelectItem,{value:"approved",children:"Approved"}),(0,b.jsx)(ay.SelectItem,{value:"rejected",children:"Rejected"})]})]}),(0,b.jsxs)(ay.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[180px]","data-testid":"select-price-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Prices"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Prices"}),(0,b.jsx)(ay.SelectItem,{value:"free",children:"Free (0 coins)"}),(0,b.jsx)(ay.SelectItem,{value:"low",children:"Low (1-100)"}),(0,b.jsx)(ay.SelectItem,{value:"medium",children:"Medium (101-500)"}),(0,b.jsx)(ay.SelectItem,{value:"high",children:"High (500+)"})]})]}),(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>{d(""),i("all"),k("all"),o("all")},"data-testid":"button-clear-filters",children:"Clear Filters"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-total-items",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Items"}),(0,b.jsx)(a4.Package,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:C?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-items",children:D.totalItems}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[D.pendingItems," pending approval"]})]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-total-sales",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Sales"}),(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:C?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-sales",children:D.totalSales}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",D.salesThisWeek," this week"]})]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-total-revenue",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,b.jsx)(J.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:C?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-marketplace-revenue",children:["$",D.totalRevenue]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+$",D.revenueThisWeek," this week"]})]})})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-revenue-chart",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revenue Trend (Last 30 Days)"})}),(0,b.jsx)(_.CardContent,{children:P?(0,b.jsx)(p.Skeleton,{className:"h-64"}):Q.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:Q,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"revenue",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No revenue data available"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-top-selling",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Selling Items"})}),(0,b.jsx)(_.CardContent,{children:M?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):N.length>0?(0,b.jsx)("div",{className:"space-y-3",children:N.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"text-lg font-bold text-muted-foreground",children:["#",c+1]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.title}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.sales," sales"]})]})]}),(0,b.jsxs)(au.Badge,{children:[a.coinPrice," coins"]})]},a.id))}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No sales data available"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-top-vendors",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Vendors"})}),(0,b.jsx)(_.CardContent,{children:S?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):T.length>0?(0,b.jsx)("div",{className:"space-y-3",children:T.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"text-lg font-bold text-muted-foreground",children:["#",c+1]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.sellerUsername}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.totalSales," sales â¢ ",a.itemCount," items"]})]})]}),(0,b.jsxs)(au.Badge,{children:[a.totalRevenue," coins earned"]})]},a.sellerId))}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No vendor data available"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-marketplace-items",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Marketplace Items (",H,")"]})}),(0,b.jsx)(_.CardContent,{children:F?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Title"}),(0,b.jsx)(aa.TableHead,{children:"Seller"}),(0,b.jsx)(aa.TableHead,{children:"Price"}),(0,b.jsx)(aa.TableHead,{children:"Sales"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Listed"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:G.length>0?G.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`item-row-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`item-title-${a.id}`,children:a.title}),(0,b.jsx)(aa.TableCell,{children:a.sellerUsername}),(0,b.jsxs)(aa.TableCell,{children:[a.coinPrice," coins"]}),(0,b.jsx)(aa.TableCell,{children:a.sales}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"approved"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"ghost",onClick:()=>v(a.id),"data-testid":`button-view-item-${a.id}`,children:(0,b.jsx)(aT.Eye,{className:"h-4 w-4"})}),(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>Y.mutate(a.id),disabled:"approved"===a.status||Y.isPending,"data-testid":`button-approve-item-${a.id}`,children:[(0,b.jsx)(aR.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>x(a.id),disabled:"rejected"===a.status,"data-testid":`button-reject-item-${a.id}`,children:[(0,b.jsx)(aS,{className:"h-4 w-4 mr-1"}),"Reject"]}),(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>z(a.id),disabled:"approved"!==a.status,"data-testid":`button-feature-item-${a.id}`,children:[(0,b.jsx)(a5.Star,{className:"h-4 w-4 mr-1"}),"Feature"]})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No marketplace items found"})})})]})}),H>0&&(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 px-2 py-4 border-t mt-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(q-1)*s+1,"-",Math.min(q*s,H)," of ",H," items"]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:"Items per page:"}),(0,b.jsxs)(ay.Select,{value:s.toString(),onValueChange:a=>t(parseInt(a)),children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-[80px]","data-testid":"select-page-size",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"10",children:"10"}),(0,b.jsx)(ay.SelectItem,{value:"20",children:"20"}),(0,b.jsx)(ay.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(ay.SelectItem,{value:"100",children:"100"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(1),disabled:1===q,"data-testid":"button-first-page",children:"First"}),(0,b.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(q-1),disabled:1===q,"data-testid":"button-prev-page",children:"Previous"}),(0,b.jsxs)("span",{className:"text-sm",children:["Page ",q," of ",I]}),(0,b.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(q+1),disabled:q===I,"data-testid":"button-next-page",children:"Next"}),(0,b.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>r(I),disabled:q===I,"data-testid":"button-last-page",children:"Last"})]})]})]})]})})]}),(0,b.jsx)(az.Dialog,{open:null!==u,onOpenChange:()=>v(null),children:(0,b.jsxs)(az.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Item Details"})}),V?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(p.Skeleton,{className:"h-20"}),(0,b.jsx)(p.Skeleton,{className:"h-20"}),(0,b.jsx)(p.Skeleton,{className:"h-32"})]}):U?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Title"}),(0,b.jsx)("p",{className:"font-medium",children:U.title})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Category"}),(0,b.jsx)("p",{className:"font-medium",children:U.category})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Price"}),(0,b.jsxs)("p",{className:"font-medium",children:[U.coinPrice," coins"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,b.jsx)(au.Badge,{children:U.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Seller"}),(0,b.jsx)("p",{className:"font-medium",children:U.sellerUsername})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sales"}),(0,b.jsx)("p",{className:"font-medium",children:U.sales})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Description"}),(0,b.jsx)("p",{className:"text-sm",children:U.description})]}),U.recentPurchases&&U.recentPurchases.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium mb-2",children:"Recent Purchases"}),(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Buyer"}),(0,b.jsx)(aa.TableHead,{children:"Price"}),(0,b.jsx)(aa.TableHead,{children:"Date"})]})}),(0,b.jsx)(aa.TableBody,{children:U.recentPurchases.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{children:a.buyerUsername}),(0,b.jsxs)(aa.TableCell,{children:[a.coins," coins"]}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.purchasedAt),{addSuffix:!0})})]},a.id))})]})]})]}):(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"Item not found"})]})}),(0,b.jsx)(az.Dialog,{open:null!==w,onOpenChange:()=>x(null),children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Reject Marketplace Item"}),(0,b.jsx)(az.DialogDescription,{children:"Please provide a reason for rejecting this item. The seller will see this reason."})]}),(0,b.jsx)(a3.Form,{...W,children:(0,b.jsxs)("form",{onSubmit:W.handleSubmit(a=>{Z.mutate(a)}),className:"space-y-4",children:[(0,b.jsx)(a3.FormField,{control:W.control,name:"reason",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Rejection Reason *"}),(0,b.jsxs)(ay.Select,{onValueChange:b=>{"custom"!==b&&a.onChange(b)},children:[(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-reject-reason",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select a reason..."})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"Poor description",children:"Poor description"}),(0,b.jsx)(ay.SelectItem,{value:"Inappropriate content",children:"Inappropriate content"}),(0,b.jsx)(ay.SelectItem,{value:"Duplicate listing",children:"Duplicate listing"}),(0,b.jsx)(ay.SelectItem,{value:"Missing files",children:"Missing files"}),(0,b.jsx)(ay.SelectItem,{value:"Price too high",children:"Price too high"}),(0,b.jsx)(ay.SelectItem,{value:"custom",children:"Custom reason..."})]})]}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ax.Textarea,{placeholder:"Or enter a custom reason...",...a,"data-testid":"textarea-reject-reason",className:"min-h-[100px]"})}),(0,b.jsx)(a3.FormDescription,{children:"Minimum 10 characters"}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{type:"submit",disabled:Z.isPending,"data-testid":"button-confirm-reject",children:Z.isPending?"Rejecting...":"Reject Item"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>x(null),children:"Cancel"})]})]})})]})}),(0,b.jsx)(az.Dialog,{open:null!==y,onOpenChange:()=>z(null),children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Feature Marketplace Item"}),(0,b.jsx)(az.DialogDescription,{children:"Featured items appear prominently on the marketplace homepage."})]}),(0,b.jsx)(a3.Form,{...X,children:(0,b.jsxs)("form",{onSubmit:X.handleSubmit(a=>{ab.mutate(a)}),className:"space-y-4",children:[(0,b.jsx)(a3.FormField,{control:X.control,name:"durationDays",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Feature Duration (Days) *"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{type:"number",min:1,max:365,...a,onChange:b=>a.onChange(parseInt(b.target.value)||1),"data-testid":"input-feature-duration"})}),(0,b.jsx)(a3.FormDescription,{children:"How long should this item be featured? (1-365 days)"}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{type:"submit",disabled:ab.isPending,"data-testid":"button-confirm-feature",children:ab.isPending?"Featuring...":"Feature Item"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>z(null),children:"Cancel"})]})]})})]})})]})}var bc=a.i(267900),bd=a.i(167453),be=a.i(104416),bf=a.i(466384),bg=a.i(824569);let bh=a2.z.object({name:a2.z.string().min(1,"Name is required"),country:a2.z.string().optional(),regulation:a2.z.string().optional(),websiteUrl:a2.z.string().url("Must be a valid URL").optional(),minDeposit:a2.z.string().optional(),leverage:a2.z.string().optional(),platform:a2.z.string().optional(),spreadType:a2.z.string().optional(),minSpread:a2.z.string().optional()}),bi=a2.z.object({enabled:a2.z.boolean(),reason:a2.z.string().optional(),severity:a2.z.enum(["low","medium","high","critical"]).optional()}),bj=a2.z.object({reason:a2.z.string().min(10,"Reason must be at least 10 characters")});function bk(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)("brokers"),[f,g]=(0,e.useState)(""),[h,i]=(0,e.useState)(""),[j,k]=(0,e.useState)("all"),[n,o]=(0,e.useState)("all"),[q,r]=(0,e.useState)("all"),[s,t]=(0,e.useState)(1),[u,v]=(0,e.useState)(20),[w,x]=(0,e.useState)(null),[y,z]=(0,e.useState)(null),[A,B]=(0,e.useState)(null),[C,D]=(0,e.useState)(null),[E,F]=(0,e.useState)(null),[G,H]=(0,e.useState)(null),[I,J]=(0,e.useState)(null),[K,L]=(0,e.useState)(!1),[M,N]=(0,e.useState)(!1),[O,P]=(0,e.useState)(!1);(0,e.useEffect)(()=>{let a=setTimeout(()=>{i(f),t(1)},300);return()=>clearTimeout(a)},[f]),(0,e.useEffect)(()=>{t(1)},[j,n,q]);let{data:Q,isLoading:R}=(0,$.useQuery)({queryKey:["/api/admin/brokers/stats"]}),T=Q||{totalBrokers:0,verifiedBrokers:0,scamWarnings:0,totalReviews:0,pendingReviews:0,pendingScamReports:0},{data:U,isLoading:V}=(0,$.useQuery)({queryKey:["/api/admin/brokers",h,j,n,q,s,u],queryFn:async()=>{let a=new URLSearchParams({page:s.toString(),pageSize:u.toString()});h&&a.set("search",h),"all"!==j&&a.set("country",j),"verified"===n&&a.set("isVerified","true"),"unverified"===n&&a.set("isVerified","false"),"scam_warning"===n&&a.set("scamWarning","true"),"all"!==q&&a.set("regulation",q);let b=await fetch(`/api/admin/brokers?${a.toString()}`);if(!b.ok)throw Error("Failed to fetch brokers");return b.json()},enabled:"brokers"===c}),W=U?.items||[],X=U?.total||0,{data:Y,isLoading:Z}=(0,$.useQuery)({queryKey:["/api/admin/scam-reports",s,u],queryFn:async()=>{let a=new URLSearchParams({page:s.toString(),pageSize:u.toString()}),b=await fetch(`/api/admin/scam-reports?${a.toString()}`);if(!b.ok)throw Error("Failed to fetch scam reports");return b.json()},enabled:"scam-reports"===c}),ab=Y?.items||[],ac=Y?.total||0,{data:ad,isLoading:af}=(0,$.useQuery)({queryKey:["/api/admin/broker-reviews",s,u],queryFn:async()=>{let a=new URLSearchParams({page:s.toString(),pageSize:u.toString()}),b=await fetch(`/api/admin/broker-reviews?${a.toString()}`);if(!b.ok)throw Error("Failed to fetch reviews");return b.json()},enabled:"reviews"===c}),ah=ad?.items||[],ai=ad?.total||0,aj=(0,a0.useForm)({resolver:(0,a1.zodResolver)(bh),defaultValues:{name:"",country:"",regulation:"",websiteUrl:"",minDeposit:"",leverage:"",platform:"",spreadType:"",minSpread:""}}),ak=(0,a0.useForm)({resolver:(0,a1.zodResolver)(bh)}),al=(0,a0.useForm)({resolver:(0,a1.zodResolver)(bi),defaultValues:{enabled:!0,reason:"",severity:"medium"}}),am=(0,a0.useForm)({resolver:(0,a1.zodResolver)(bj),defaultValues:{reason:""}}),an=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST","/api/brokers",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),L(!1),aj.reset(),a({title:"Broker added successfully"})},onError:()=>{a({title:"Failed to add broker",variant:"destructive"})}}),ao=(0,aw.useMutation)({mutationFn:async a=>{if(!y)throw Error("No broker selected");return(0,aM.apiRequest)("PATCH",`/api/admin/brokers/${y}`,a)},onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),z(null),a({title:"Broker updated successfully"})},onError:()=>{a({title:"Failed to update broker",variant:"destructive"})}}),ap=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("DELETE",`/api/admin/brokers/${a}`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),B(null),N(!1),a({title:"Broker deleted successfully"})},onError:()=>{a({title:"Failed to delete broker",variant:"destructive"})}}),aq=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/brokers/${a}/verify`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),D(null),P(!1),a({title:"Broker verified successfully"})},onError:()=>{a({title:"Failed to verify broker",variant:"destructive"})}}),ar=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/brokers/${a}/unverify`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),a({title:"Broker verification removed"})},onError:()=>{a({title:"Failed to unverify broker",variant:"destructive"})}}),as=(0,aw.useMutation)({mutationFn:async a=>{if(!E)throw Error("No broker selected");return(0,aM.apiRequest)("POST",`/api/admin/brokers/${E}/scam-warning`,a)},onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),F(null),al.reset(),a({title:"Scam warning updated successfully"})},onError:()=>{a({title:"Failed to update scam warning",variant:"destructive"})}}),at=(0,aw.useMutation)({mutationFn:async({reportId:a,resolution:b})=>(0,aM.apiRequest)("POST",`/api/admin/scam-reports/${a}/resolve`,{resolution:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/scam-reports"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),H(null),a({title:"Scam report resolved"})},onError:()=>{a({title:"Failed to resolve scam report",variant:"destructive"})}}),av=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/broker-reviews/${a}/approve`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/broker-reviews"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),J(null),a({title:"Review approved successfully"})},onError:()=>{a({title:"Failed to approve review",variant:"destructive"})}}),aC=(0,aw.useMutation)({mutationFn:async a=>{if(!I)throw Error("No review selected");return(0,aM.apiRequest)("POST",`/api/admin/broker-reviews/${I}/reject`,a)},onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/broker-reviews"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/brokers/stats"]}),J(null),am.reset(),a({title:"Review rejected"})},onError:()=>{a({title:"Failed to reject review",variant:"destructive"})}}),aD=a=>{t(a),window.scrollTo({top:0,behavior:"smooth"})},aE=W.find(a=>a.id===w||a.id===y||a.id===A||a.id===C||a.id===E),aF=ab.find(a=>a.id===G),aG=ah.find(a=>a.id===I);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Broker Management"}),(0,b.jsx)(l.Button,{onClick:()=>L(!0),"data-testid":"button-add-broker",children:"+ Add Broker"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"stat-total-brokers",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Brokers"}),(0,b.jsx)(bc.Building2,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:R?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold",children:T.totalBrokers})})]}),(0,b.jsxs)(_.Card,{"data-testid":"stat-verified-brokers",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Verified Brokers"}),(0,b.jsx)(bd.CheckCircle2,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:R?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold",children:T.verifiedBrokers})})]}),(0,b.jsxs)(_.Card,{"data-testid":"stat-scam-warnings",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Scam Warnings"}),(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:R?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold",children:T.scamWarnings})})]}),(0,b.jsxs)(_.Card,{"data-testid":"stat-total-reviews",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Reviews"}),(0,b.jsx)(ae.MessageSquare,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:R?(0,b.jsx)(p.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold",children:T.totalReviews})})]})]}),(0,b.jsxs)(aA.Tabs,{value:c,onValueChange:d,className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsxs)(aA.TabsTrigger,{value:"brokers","data-testid":"tab-brokers",children:["Brokers (",T.totalBrokers,")"]}),(0,b.jsxs)(aA.TabsTrigger,{value:"scam-reports","data-testid":"tab-scam-reports",children:["Scam Reports (",T.pendingScamReports,")"]}),(0,b.jsxs)(aA.TabsTrigger,{value:"reviews","data-testid":"tab-reviews",children:["Reviews (",T.totalReviews,")"]})]}),(0,b.jsxs)(aA.TabsContent,{value:"brokers",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(S.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(m.Input,{placeholder:"Search by broker name...",value:f,onChange:a=>g(a.target.value),className:"pl-9","data-testid":"input-search-brokers"})]}),(0,b.jsxs)(ay.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[180px]","data-testid":"select-country-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Countries"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Countries"}),(0,b.jsx)(ay.SelectItem,{value:"USA",children:"USA"}),(0,b.jsx)(ay.SelectItem,{value:"UK",children:"UK"}),(0,b.jsx)(ay.SelectItem,{value:"Cyprus",children:"Cyprus"}),(0,b.jsx)(ay.SelectItem,{value:"Australia",children:"Australia"})]})]}),(0,b.jsxs)(ay.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[180px]","data-testid":"select-verification-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Verification"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(ay.SelectItem,{value:"verified",children:"Verified"}),(0,b.jsx)(ay.SelectItem,{value:"unverified",children:"Unverified"}),(0,b.jsx)(ay.SelectItem,{value:"scam_warning",children:"Scam Warning"})]})]}),(0,b.jsxs)(ay.Select,{value:q,onValueChange:r,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[180px]","data-testid":"select-regulation-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Regulation"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(ay.SelectItem,{value:"FCA",children:"FCA"}),(0,b.jsx)(ay.SelectItem,{value:"ASIC",children:"ASIC"}),(0,b.jsx)(ay.SelectItem,{value:"CySEC",children:"CySEC"}),(0,b.jsx)(ay.SelectItem,{value:"CFTC",children:"CFTC"})]})]}),(0,b.jsxs)(ay.Select,{value:u.toString(),onValueChange:a=>v(parseInt(a)),children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-[120px]","data-testid":"select-page-size",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"10",children:"10 / page"}),(0,b.jsx)(ay.SelectItem,{value:"20",children:"20 / page"}),(0,b.jsx)(ay.SelectItem,{value:"50",children:"50 / page"}),(0,b.jsx)(ay.SelectItem,{value:"100",children:"100 / page"})]})]}),(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>{g(""),k("all"),o("all"),r("all")},"data-testid":"button-clear-filters",children:"Clear"})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Brokers (",X,")"]})}),(0,b.jsx)(_.CardContent,{children:V?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Country"}),(0,b.jsx)(aa.TableHead,{children:"Regulation"}),(0,b.jsx)(aa.TableHead,{children:"Verified"}),(0,b.jsx)(aa.TableHead,{children:"Reviews"}),(0,b.jsx)(aa.TableHead,{children:"Rating"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:W.length>0?W.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`row-broker-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),a.scamWarning&&(0,b.jsx)(au.Badge,{variant:"destructive",className:"text-xs",children:"Scam Warning"})]})})}),(0,b.jsx)(aa.TableCell,{children:a.country||"-"}),(0,b.jsx)(aa.TableCell,{children:a.regulation||"-"}),(0,b.jsx)(aa.TableCell,{children:a.isVerified?(0,b.jsxs)(au.Badge,{variant:"default",children:[(0,b.jsx)(bd.CheckCircle2,{className:"h-3 w-3 mr-1"}),"Verified"]}):(0,b.jsx)(au.Badge,{variant:"secondary",children:"Unverified"})}),(0,b.jsx)(aa.TableCell,{children:a.reviewCount}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(a5.Star,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,b.jsx)("span",{children:a.overallRating||0})]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"approved"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"ghost",onClick:()=>x(a.id),"data-testid":`button-view-broker-${a.id}`,children:(0,b.jsx)(aT.Eye,{className:"h-4 w-4"})}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>{z(a.id),ak.reset({name:a.name,country:a.country||"",regulation:a.regulation||""})},"data-testid":`button-edit-broker-${a.id}`,children:(0,b.jsx)(bg.Edit,{className:"h-4 w-4"})}),a.isVerified?(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>ar.mutate(a.id),"data-testid":`button-unverify-broker-${a.id}`,children:"Unverify"}):(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>D(a.id),"data-testid":`button-verify-broker-${a.id}`,children:[(0,b.jsx)(be.ShieldCheck,{className:"h-4 w-4 mr-1"}),"Verify"]}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>F(a.id),"data-testid":`button-scam-warning-${a.id}`,children:(0,b.jsx)(bf.ShieldAlert,{className:"h-4 w-4"})}),(0,b.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>B(a.id),"data-testid":`button-delete-broker-${a.id}`,children:(0,b.jsx)(aZ.Trash2,{className:"h-4 w-4"})})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:8,className:"text-center text-muted-foreground py-8",children:"No brokers found"})})})]})}),X>u&&(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(s-1)*u+1," to ",Math.min(s*u,X)," of ",X," brokers"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>aD(1),disabled:1===s,"data-testid":"button-first-page",children:"First"}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>aD(s-1),disabled:1===s,"data-testid":"button-prev-page",children:"Previous"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,b.jsx)(m.Input,{type:"number",min:1,max:Math.ceil(X/u),value:s,onChange:a=>{let b=parseInt(a.target.value);b>=1&&b<=Math.ceil(X/u)&&aD(b)},className:"w-16 text-center","data-testid":"input-page-number"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["of ",Math.ceil(X/u)]})]}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>aD(s+1),disabled:s>=Math.ceil(X/u),"data-testid":"button-next-page",children:"Next"}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>aD(Math.ceil(X/u)),disabled:s>=Math.ceil(X/u),"data-testid":"button-last-page",children:"Last"})]})]})]})})]})]}),(0,b.jsx)(aA.TabsContent,{value:"scam-reports",className:"space-y-4",children:(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Scam Reports (",ac,")"]})}),(0,b.jsx)(_.CardContent,{children:Z?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Broker"}),(0,b.jsx)(aa.TableHead,{children:"Reporter"}),(0,b.jsx)(aa.TableHead,{children:"Severity"}),(0,b.jsx)(aa.TableHead,{children:"Report"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Date"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:ab.length>0?ab.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`row-scam-report-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.brokerName}),(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsx)(aa.TableCell,{children:a.scamSeverity?(0,b.jsx)(au.Badge,{variant:"critical"===a.scamSeverity||"high"===a.scamSeverity?"destructive":"medium"===a.scamSeverity?"default":"secondary",children:a.scamSeverity}):"-"}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.reviewTitle}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"approved"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.datePosted),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>H(a.id),"data-testid":`button-view-report-${a.id}`,children:(0,b.jsx)(aT.Eye,{className:"h-4 w-4"})}),"pending"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>at.mutate({reportId:a.id,resolution:"confirmed"}),disabled:at.isPending,"data-testid":`button-confirm-scam-${a.id}`,children:"Confirm"}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>at.mutate({reportId:a.id,resolution:"dismissed"}),disabled:at.isPending,"data-testid":`button-dismiss-scam-${a.id}`,children:"Dismiss"})]})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No scam reports found"})})})]})})})]})}),(0,b.jsx)(aA.TabsContent,{value:"reviews",className:"space-y-4",children:(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Broker Reviews (",ai,")"]})}),(0,b.jsx)(_.CardContent,{children:af?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Broker"}),(0,b.jsx)(aa.TableHead,{children:"Reviewer"}),(0,b.jsx)(aa.TableHead,{children:"Rating"}),(0,b.jsx)(aa.TableHead,{children:"Review"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Date"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:ah.length>0?ah.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`row-review-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.brokerName}),(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(a5.Star,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,b.jsx)("span",{children:a.rating})]})}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.reviewTitle}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"approved"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.datePosted),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>J(a.id),"data-testid":`button-view-review-${a.id}`,children:(0,b.jsx)(aT.Eye,{className:"h-4 w-4"})}),"pending"===a.status&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>av.mutate(a.id),disabled:av.isPending,"data-testid":`button-approve-review-${a.id}`,children:"Approve"})})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No reviews found"})})})]})})})]})})]}),(0,b.jsx)(az.Dialog,{open:K,onOpenChange:L,children:(0,b.jsxs)(az.DialogContent,{"data-testid":"modal-add-broker",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Add New Broker"}),(0,b.jsx)(az.DialogDescription,{children:"Add a new broker to the directory"})]}),(0,b.jsx)(a3.Form,{...aj,children:(0,b.jsxs)("form",{onSubmit:aj.handleSubmit(a=>{an.mutate(a)}),className:"space-y-4",children:[(0,b.jsx)(a3.FormField,{control:aj.control,name:"name",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Broker Name *"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a,"data-testid":"input-broker-name"})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:aj.control,name:"country",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Country"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a,"data-testid":"input-country"})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:aj.control,name:"regulation",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Regulation"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a,placeholder:"e.g., FCA, ASIC","data-testid":"input-regulation"})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:aj.control,name:"websiteUrl",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Website URL"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a,type:"url",placeholder:"https://...","data-testid":"input-website"})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,b.jsx)(l.Button,{type:"submit",disabled:an.isPending,"data-testid":"button-submit-add-broker",children:"Add Broker"})]})]})})]})}),(0,b.jsx)(az.Dialog,{open:!!w,onOpenChange:()=>x(null),children:(0,b.jsxs)(az.DialogContent,{"data-testid":"modal-view-broker",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Broker Details"})}),aE&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Name"}),(0,b.jsx)("div",{className:"text-lg font-semibold",children:aE.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Country"}),(0,b.jsx)("div",{children:aE.country||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Regulation"}),(0,b.jsx)("div",{children:aE.regulation||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)(au.Badge,{variant:aE.isVerified?"default":"secondary",children:aE.isVerified?"Verified":"Unverified"}),aE.scamWarning&&(0,b.jsx)(au.Badge,{variant:"destructive",children:"Scam Warning"}),(0,b.jsx)(au.Badge,{children:aE.status})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Reviews & Rating"}),(0,b.jsxs)("div",{children:[aE.reviewCount," reviews â¢ ",aE.overallRating,"/5 rating"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Scam Reports"}),(0,b.jsx)("div",{children:aE.scamReportCount})]})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>x(null),children:"Close"})})]})}),(0,b.jsx)(az.Dialog,{open:!!y,onOpenChange:()=>z(null),children:(0,b.jsxs)(az.DialogContent,{"data-testid":"modal-edit-broker",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Edit Broker"})}),(0,b.jsx)(a3.Form,{...ak,children:(0,b.jsxs)("form",{onSubmit:ak.handleSubmit(a=>{ao.mutate(a)}),className:"space-y-4",children:[(0,b.jsx)(a3.FormField,{control:ak.control,name:"name",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Broker Name *"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:ak.control,name:"country",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Country"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:ak.control,name:"regulation",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Regulation"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(m.Input,{...a})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>z(null),children:"Cancel"}),(0,b.jsx)(l.Button,{type:"submit",disabled:ao.isPending,children:"Save Changes"})]})]})})]})}),(0,b.jsx)(az.Dialog,{open:!!A,onOpenChange:()=>{B(null),N(!1)},children:(0,b.jsxs)(az.DialogContent,{"data-testid":"modal-delete-broker",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Delete Broker"}),(0,b.jsx)(az.DialogDescription,{children:"This will soft-delete the broker. Reviews will be preserved for audit trail."})]}),aE&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,b.jsx)("div",{className:"font-medium",children:aE.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[aE.reviewCount," reviews"]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aO.Checkbox,{id:"delete-confirm",checked:M,onCheckedChange:a=>N(a),"data-testid":"checkbox-delete-confirm"}),(0,b.jsx)("label",{htmlFor:"delete-confirm",className:"text-sm font-medium cursor-pointer",children:"Yes, I want to delete this broker"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>{B(null),N(!1)},children:"Cancel"}),(0,b.jsx)(l.Button,{variant:"destructive",disabled:!M||ap.isPending,onClick:()=>A&&ap.mutate(A),"data-testid":"button-confirm-delete",children:"Delete Broker"})]})]})}),(0,b.jsx)(az.Dialog,{open:!!C,onOpenChange:()=>{D(null),P(!1)},children:(0,b.jsxs)(az.DialogContent,{"data-testid":"modal-verify-broker",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Verify Broker"}),(0,b.jsx)(az.DialogDescription,{children:"Mark this broker as verified after confirming they meet standards"})]}),aE&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,b.jsx)("div",{className:"font-medium",children:aE.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[aE.country," â¢ ",aE.regulation]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aO.Checkbox,{id:"verify-confirm",checked:O,onCheckedChange:a=>P(a),"data-testid":"checkbox-verify-confirm"}),(0,b.jsx)("label",{htmlFor:"verify-confirm",className:"text-sm font-medium cursor-pointer",children:"I've verified this broker meets our standards"})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>{D(null),P(!1)},children:"Cancel"}),(0,b.jsxs)(l.Button,{disabled:!O||aq.isPending,onClick:()=>C&&aq.mutate(C),"data-testid":"button-confirm-verify",children:[(0,b.jsx)(be.ShieldCheck,{className:"h-4 w-4 mr-2"}),"Verify Broker"]})]})]})}),(0,b.jsx)(az.Dialog,{open:!!E,onOpenChange:()=>F(null),children:(0,b.jsxs)(az.DialogContent,{"data-testid":"modal-scam-warning",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Scam Warning"}),(0,b.jsx)(az.DialogDescription,{children:"Add or remove scam warning for this broker"})]}),(0,b.jsx)(a3.Form,{...al,children:(0,b.jsxs)("form",{onSubmit:al.handleSubmit(a=>{as.mutate(a)}),className:"space-y-4",children:[(0,b.jsx)(a3.FormField,{control:al.control,name:"enabled",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(a3.FormLabel,{className:"text-base",children:"Enable Scam Warning"}),(0,b.jsx)(a3.FormDescription,{children:"Mark this broker with a scam warning"})]}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(aO.Checkbox,{checked:a.value,onCheckedChange:a.onChange,"data-testid":"checkbox-enable-warning"})})]})}),(0,b.jsx)(a3.FormField,{control:al.control,name:"severity",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Severity"}),(0,b.jsxs)(ay.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-severity",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select severity"})})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"low",children:"Low"}),(0,b.jsx)(ay.SelectItem,{value:"medium",children:"Medium"}),(0,b.jsx)(ay.SelectItem,{value:"high",children:"High"}),(0,b.jsx)(ay.SelectItem,{value:"critical",children:"Critical"})]})]}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsx)(a3.FormField,{control:al.control,name:"reason",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Reason"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ax.Textarea,{...a,rows:3,"data-testid":"textarea-warning-reason"})}),(0,b.jsx)(a3.FormDescription,{children:"Optional explanation for the warning"}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)(az.DialogFooter,{children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>F(null),children:"Cancel"}),(0,b.jsx)(l.Button,{type:"submit",disabled:as.isPending,children:"Save"})]})]})})]})}),(0,b.jsx)(az.Dialog,{open:!!G,onOpenChange:()=>H(null),children:(0,b.jsxs)(az.DialogContent,{className:"max-w-2xl","data-testid":"modal-view-scam-report",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Scam Report Details"})}),aF&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Broker"}),(0,b.jsx)("div",{className:"font-semibold",children:aF.brokerName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Reporter"}),(0,b.jsx)("div",{children:aF.username})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Severity"}),(0,b.jsx)(au.Badge,{variant:"critical"===aF.scamSeverity||"high"===aF.scamSeverity?"destructive":"default",children:aF.scamSeverity||"Not specified"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Title"}),(0,b.jsx)("div",{children:aF.reviewTitle})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Report"}),(0,b.jsx)("div",{className:"p-4 bg-muted rounded-lg whitespace-pre-wrap",children:aF.reviewBody})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,b.jsx)(au.Badge,{children:aF.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Submitted"}),(0,b.jsx)("div",{children:(0,ag.formatDistanceToNow)(new Date(aF.datePosted),{addSuffix:!0})})]})]}),(0,b.jsxs)(az.DialogFooter,{children:[aF?.status==="pending"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>G&&at.mutate({reportId:G,resolution:"dismissed"}),disabled:at.isPending,"data-testid":"button-dismiss-report",children:"Dismiss Report"}),(0,b.jsx)(l.Button,{onClick:()=>G&&at.mutate({reportId:G,resolution:"confirmed"}),disabled:at.isPending,"data-testid":"button-confirm-report",children:"Confirm Scam"})]}),aF?.status!=="pending"&&(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>H(null),children:"Close"})]})]})}),(0,b.jsx)(az.Dialog,{open:!!I,onOpenChange:()=>J(null),children:(0,b.jsxs)(az.DialogContent,{className:"max-w-2xl","data-testid":"modal-view-review",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Review Details"})}),aG&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Broker"}),(0,b.jsx)("div",{className:"font-semibold",children:aG.brokerName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Reviewer"}),(0,b.jsx)("div",{children:aG.username})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Rating"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(a5.Star,{className:`h-4 w-4 ${c<aG.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},c)),(0,b.jsxs)("span",{className:"ml-2",children:[aG.rating,"/5"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Title"}),(0,b.jsx)("div",{children:aG.reviewTitle})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Review"}),(0,b.jsx)("div",{className:"p-4 bg-muted rounded-lg whitespace-pre-wrap",children:aG.reviewBody})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,b.jsx)(au.Badge,{children:aG.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Submitted"}),(0,b.jsx)("div",{children:(0,ag.formatDistanceToNow)(new Date(aG.datePosted),{addSuffix:!0})})]}),"pending"===aG.status&&(0,b.jsx)(a3.Form,{...am,children:(0,b.jsxs)("form",{onSubmit:am.handleSubmit(a=>{aC.mutate(a)}),className:"space-y-4 pt-4 border-t",children:[(0,b.jsx)(a3.FormField,{control:am.control,name:"reason",render:({field:a})=>(0,b.jsxs)(a3.FormItem,{children:[(0,b.jsx)(a3.FormLabel,{children:"Rejection Reason (if rejecting)"}),(0,b.jsx)(a3.FormControl,{children:(0,b.jsx)(ax.Textarea,{...a,rows:3,placeholder:"Explain why this review is being rejected...","data-testid":"textarea-reject-reason"})}),(0,b.jsx)(a3.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>aG&&av.mutate(aG.id),disabled:av.isPending,"data-testid":"button-approve-review",children:"Approve"}),(0,b.jsx)(l.Button,{type:"submit",variant:"destructive",disabled:aC.isPending,"data-testid":"button-reject-review",children:"Reject"})]})]})})]}),aG?.status!=="pending"&&(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>J(null),children:"Close"})})]})})]})}var bl=a.i(653277);let bm=["hsl(var(--primary))","hsl(var(--secondary))","hsl(var(--accent))","hsl(var(--muted))"];function bn(){let[a,c]=(0,e.useState)("30d"),{toast:d}=(0,aB.useToast)(),{data:f,isLoading:g}=(0,$.useQuery)({queryKey:["/api/admin/finance/overview"]}),h=f??{totalRevenue:0,revenueGrowth:0,pendingWithdrawals:0,pendingWithdrawalCount:0,totalTransactions:0,transactionsToday:0},{data:i,isLoading:j}=(0,$.useQuery)({queryKey:["/api/admin/finance/transactions",{period:a}]}),k=Array.isArray(i)?i:[],{data:m,isLoading:n}=(0,$.useQuery)({queryKey:["/api/admin/finance/withdrawals/pending"]}),o=Array.isArray(m)?m:[],{data:q,isLoading:r}=(0,$.useQuery)({queryKey:["/api/admin/finance/revenue-chart",{period:a}]}),s=Array.isArray(q)?q:[],{data:t,isLoading:u}=(0,$.useQuery)({queryKey:["/api/admin/finance/revenue-by-source"]}),v=Array.isArray(t)?t:[],w=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/finance/withdrawals/${a}/approve`,{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/finance"]}),d({title:"Withdrawal approved successfully"})},onError:()=>{d({title:"Failed to approve withdrawal",variant:"destructive"})}}),x=(0,aw.useMutation)({mutationFn:async({withdrawalId:a,reason:b})=>(0,aM.apiRequest)("POST",`/api/admin/finance/withdrawals/${a}/reject`,{reason:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/finance"]}),d({title:"Withdrawal rejected successfully"})},onError:()=>{d({title:"Failed to reject withdrawal",variant:"destructive"})}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Finance Management"}),(0,b.jsxs)(ay.Select,{value:a,onValueChange:c,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48","data-testid":"select-period-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select period"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"7d",children:"Last 7 Days"}),(0,b.jsx)(ay.SelectItem,{value:"30d",children:"Last 30 Days"}),(0,b.jsx)(ay.SelectItem,{value:"90d",children:"Last 90 Days"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-total-revenue",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,b.jsx)(J.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:g?(0,b.jsx)(p.Skeleton,{className:"h-8 w-24"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-finance-revenue",children:["$",h.totalRevenue]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(K.TrendingUp,{className:"h-3 w-3"}),"+",h.revenueGrowth,"% vs last period"]})]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-pending-withdrawals",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Pending Withdrawals"}),(0,b.jsx)(bl.TrendingDown,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:g?(0,b.jsx)(p.Skeleton,{className:"h-8 w-24"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-pending-withdrawals",children:["$",h.pendingWithdrawals]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[h.pendingWithdrawalCount," requests"]})]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-total-transactions",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Transactions"}),(0,b.jsx)(aG.Coins,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:g?(0,b.jsx)(p.Skeleton,{className:"h-8 w-24"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-total-transactions",children:h.totalTransactions}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[h.transactionsToday," today"]})]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-top-earner",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Top Earner"}),(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:g?(0,b.jsx)(p.Skeleton,{className:"h-8 w-24"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-lg font-bold truncate",children:h.topEarner?.username||"N/A"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",h.topEarner?.earnings||0," earned"]})]})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-revenue-trend",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revenue Trend"})}),(0,b.jsx)(_.CardContent,{children:r?(0,b.jsx)(p.Skeleton,{className:"h-64"}):s.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:s,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"revenue",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No revenue data available"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-revenue-by-source",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revenue by Source"})}),(0,b.jsx)(_.CardContent,{children:u?(0,b.jsx)(p.Skeleton,{className:"h-64"}):v.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:v,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:v.map((a,c)=>(0,b.jsx)(an.Cell,{fill:bm[c%bm.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No source data available"})})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Pending Withdrawals (",o.length,")"]})}),(0,b.jsx)(_.CardContent,{children:n?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Amount"}),(0,b.jsx)(aa.TableHead,{children:"Method"}),(0,b.jsx)(aa.TableHead,{children:"Wallet"}),(0,b.jsx)(aa.TableHead,{children:"Requested"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:o.length>0?o.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`withdrawal-row-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`withdrawal-user-${a.id}`,children:a.username}),(0,b.jsxs)(aa.TableCell,{"data-testid":`withdrawal-amount-${a.id}`,children:["$",a.amount]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.method||"USDT"})}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.walletAddress||"N/A"}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>w.mutate(a.id),"data-testid":`button-approve-withdrawal-${a.id}`,children:[(0,b.jsx)(aR.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,b.jsxs)(l.Button,{size:"sm",variant:"destructive",onClick:()=>x.mutate({withdrawalId:a.id,reason:"Manual rejection"}),"data-testid":`button-reject-withdrawal-${a.id}`,children:[(0,b.jsx)(aS,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No pending withdrawals"})})})]})})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Recent Transactions (",k.length,")"]})}),(0,b.jsx)(_.CardContent,{children:j?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-16"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Type"}),(0,b.jsx)(aa.TableHead,{children:"Amount"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"Date"})]})}),(0,b.jsx)(aa.TableBody,{children:k.length>0?k.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`transaction-row-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"credit"===a.type?"default":"secondary",children:a.type})}),(0,b.jsxs)(aa.TableCell,{"data-testid":`transaction-amount-${a.id}`,children:["credit"===a.type?"+":"-",a.amount," coins"]}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.description||"N/A"}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No transactions found"})})})]})})})]})]})}var bo=a.i(39622),bp=a.i(985811);let bq=["hsl(var(--primary))","hsl(var(--secondary))","hsl(var(--accent))","hsl(var(--muted))","#8884d8","#82ca9d","#ffc658","#ff7c7c"];function br(){let[a,c]=(0,e.useState)("users"),{data:d,isLoading:f}=(0,$.useQuery)({queryKey:["/api/admin/analytics/users"]}),g=d||{dau:0,mau:0,newUsers:0,churnRate:0,growthData:[],countryData:[],activeInactiveData:[]},{data:h,isLoading:i}=(0,$.useQuery)({queryKey:["/api/admin/analytics/content"]}),j=h||{trendData:[],typeDistribution:[],topCreators:[],qualityScores:[]},{data:k,isLoading:l}=(0,$.useQuery)({queryKey:["/api/admin/analytics/financial"]}),m=k||{revenueTrend:[],revenueBySource:[],topEarners:[],transactionVolume:[]},{data:n,isLoading:o}=(0,$.useQuery)({queryKey:["/api/admin/analytics/engagement"]}),q=n||{avgSessionDuration:"0m",bounceRate:0,pagesPerSession:0,heatmapData:[]};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics & Reports"}),(0,b.jsxs)(aA.Tabs,{value:a,onValueChange:c,"data-testid":"tabs-analytics",children:[(0,b.jsxs)(aA.TabsList,{className:"grid w-full grid-cols-4",children:[(0,b.jsx)(aA.TabsTrigger,{value:"users","data-testid":"tab-users",children:"Users"}),(0,b.jsx)(aA.TabsTrigger,{value:"content","data-testid":"tab-content",children:"Content"}),(0,b.jsx)(aA.TabsTrigger,{value:"financial","data-testid":"tab-financial",children:"Financial"}),(0,b.jsx)(aA.TabsTrigger,{value:"engagement","data-testid":"tab-engagement",children:"Engagement"})]}),(0,b.jsx)(aA.TabsContent,{value:"users",className:"space-y-4",children:f?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))}),(0,b.jsx)(p.Skeleton,{className:"h-96"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-dau",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"DAU"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-dau",children:g.dau}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Daily Active Users"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-mau",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"MAU"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-mau",children:g.mau}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monthly Active Users"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-new-users",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"New Users"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-new-users",children:g.newUsers}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last 30 days"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-churn-rate",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Churn Rate"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-churn-rate",children:[g.churnRate,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monthly churn"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-user-growth",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"User Growth (Last 30 Days)"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:g.growthData,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"users",stroke:"hsl(var(--primary))",strokeWidth:2})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-users-by-country",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Users by Country (Top 10)"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:g.countryData,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"country"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"users",fill:"hsl(var(--primary))"})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-active-inactive",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Active vs Inactive Users"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:g.activeInactiveData,cx:"50%",cy:"50%",labelLine:!1,label:a=>`${a.name}: ${a.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:g.activeInactiveData.map((a,c)=>(0,b.jsx)(an.Cell,{fill:bq[c%bq.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{})]})})})]})]})]})}),(0,b.jsx)(aA.TabsContent,{value:"content",className:"space-y-4",children:i?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(p.Skeleton,{className:"h-96"}),(0,b.jsx)(p.Skeleton,{className:"h-64"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-content-trend",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Content Creation Trend (Last 30 Days)"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:j.trendData,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"count",stroke:"hsl(var(--primary))",strokeWidth:2})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-content-type-distribution",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Content Type Distribution"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:j.typeDistribution,cx:"50%",cy:"50%",labelLine:!1,label:a=>`${a.name}: ${a.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:j.typeDistribution.map((a,c)=>(0,b.jsx)(an.Cell,{fill:bq[c%bq.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{})]})})})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-top-creators",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Content Creators"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Rank"}),(0,b.jsx)(aa.TableHead,{children:"Creator"}),(0,b.jsx)(aa.TableHead,{children:"Posts"}),(0,b.jsx)(aa.TableHead,{children:"Views"}),(0,b.jsx)(aa.TableHead,{children:"Avg Quality"})]})}),(0,b.jsx)(aa.TableBody,{children:j.topCreators.length>0?j.topCreators.map((a,c)=>(0,b.jsxs)(aa.TableRow,{"data-testid":`creator-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`creator-rank-${a.id}`,children:c+1}),(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsx)(aa.TableCell,{children:a.posts}),(0,b.jsx)(aa.TableCell,{children:a.views}),(0,b.jsx)(aa.TableCell,{children:a.avgQuality?.toFixed(1)||"N/A"})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No data available"})})})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-quality-scores",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Quality Scores Histogram"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:j.qualityScores,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"score"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})})})]})]})}),(0,b.jsx)(aA.TabsContent,{value:"financial",className:"space-y-4",children:l?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(p.Skeleton,{className:"h-96"}),(0,b.jsx)(p.Skeleton,{className:"h-64"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-revenue-trend",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revenue Trend (Last 30 Days)"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(bo.AreaChart,{data:m.revenueTrend,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{}),(0,b.jsx)(bp.Area,{type:"monotone",dataKey:"revenue",stroke:"hsl(var(--primary))",fill:"hsl(var(--primary))",fillOpacity:.6})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-revenue-by-source",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revenue by Source"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:m.revenueBySource,cx:"50%",cy:"50%",labelLine:!1,label:a=>`${a.name}: $${a.value}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:m.revenueBySource.map((a,c)=>(0,b.jsx)(an.Cell,{fill:bq[c%bq.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{})]})})})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-top-earners",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Earners"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Rank"}),(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Total Earnings"}),(0,b.jsx)(aa.TableHead,{children:"This Month"}),(0,b.jsx)(aa.TableHead,{children:"Sales"})]})}),(0,b.jsx)(aa.TableBody,{children:m.topEarners.length>0?m.topEarners.map((a,c)=>(0,b.jsxs)(aa.TableRow,{"data-testid":`earner-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`earner-rank-${a.id}`,children:c+1}),(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsxs)(aa.TableCell,{children:["$",a.totalEarnings]}),(0,b.jsxs)(aa.TableCell,{children:["$",a.monthlyEarnings]}),(0,b.jsx)(aa.TableCell,{children:a.sales})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No data available"})})})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-transaction-volume",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Transaction Volume"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:m.transactionVolume,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"volume",fill:"hsl(var(--primary))"})]})})})]})]})}),(0,b.jsx)(aA.TabsContent,{value:"engagement",className:"space-y-4",children:o?(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-avg-session",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Session Duration"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-session",children:q.avgSessionDuration}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per user session"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-bounce-rate",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Bounce Rate"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-bounce-rate",children:[q.bounceRate,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Single page visits"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-pages-per-session",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Pages Per Session"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-pages-per-session",children:q.pagesPerSession}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average pages"})]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-engagement-heatmap",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Engagement Heatmap (Hourly Activity)"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(aj.BarChart,{data:q.heatmapData,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"hour"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{}),(0,b.jsx)(ak.Bar,{dataKey:"activity",fill:"hsl(var(--primary))"})]})})})]})]})})]})]})}var bs=a.i(81615),bt=a.i(337689),bu=a.i(535221);function bv(){let[a,c]=(0,e.useState)("general"),[d,f]=(0,e.useState)(""),{toast:g}=(0,aB.useToast)(),{data:h,isLoading:i}=(0,$.useQuery)({queryKey:["/api/admin/settings/general"]}),j=h||{siteName:"YoForex",siteDescription:"",maintenanceMode:!1,registrationEnabled:!0},{data:k,isLoading:n}=(0,$.useQuery)({queryKey:["/api/admin/settings/coin-economy"]}),o=k||{usdToCoinsRate:100,packages:[],minWithdrawal:1e3,withdrawalFee:5},{data:q,isLoading:r}=(0,$.useQuery)({queryKey:["/api/admin/settings/email-templates",{search:d}]}),s=Array.isArray(q)?q:[],{data:t,isLoading:u}=(0,$.useQuery)({queryKey:["/api/admin/settings/feature-flags"]}),v=Array.isArray(t)?t:[],{data:w,isLoading:x}=(0,$.useQuery)({queryKey:["/api/admin/settings/admin-roles"]}),y=Array.isArray(w)?w:[],z=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("PUT","/api/admin/settings/general",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/settings/general"]}),g({title:"Settings updated successfully"})},onError:()=>{g({title:"Failed to update settings",variant:"destructive"})}});(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("PUT","/api/admin/settings/coin-economy",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/settings/coin-economy"]}),g({title:"Coin settings updated successfully"})},onError:()=>{g({title:"Failed to update coin settings",variant:"destructive"})}});let A=(0,aw.useMutation)({mutationFn:async({flagId:a,enabled:b})=>(0,aM.apiRequest)("PUT",`/api/admin/settings/feature-flags/${a}`,{enabled:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/settings/feature-flags"]}),g({title:"Feature flag updated"})},onError:()=>{g({title:"Failed to update feature flag",variant:"destructive"})}});return(0,aw.useMutation)({mutationFn:async({userId:a,role:b})=>(0,aM.apiRequest)("POST","/api/admin/settings/admin-roles/grant",{userId:a,role:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/settings/admin-roles"]}),g({title:"Admin role granted successfully"})},onError:()=>{g({title:"Failed to grant admin role",variant:"destructive"})}}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"System Settings"}),(0,b.jsxs)(aA.Tabs,{value:a,onValueChange:c,"data-testid":"tabs-settings",children:[(0,b.jsxs)(aA.TabsList,{className:"grid w-full grid-cols-5",children:[(0,b.jsx)(aA.TabsTrigger,{value:"general","data-testid":"tab-general",children:"General"}),(0,b.jsx)(aA.TabsTrigger,{value:"coin-economy","data-testid":"tab-coin-economy",children:"Coin Economy"}),(0,b.jsx)(aA.TabsTrigger,{value:"email-templates","data-testid":"tab-email-templates",children:"Email Templates"}),(0,b.jsx)(aA.TabsTrigger,{value:"feature-flags","data-testid":"tab-feature-flags",children:"Feature Flags"}),(0,b.jsx)(aA.TabsTrigger,{value:"admin-roles","data-testid":"tab-admin-roles",children:"Admin Roles"})]}),(0,b.jsx)(aA.TabsContent,{value:"general",className:"space-y-4",children:i?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-general-settings",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"General Settings"})}),(0,b.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"site-name",children:"Site Name"}),(0,b.jsx)(m.Input,{id:"site-name",defaultValue:j.siteName,"data-testid":"input-site-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"site-description",children:"Site Description"}),(0,b.jsx)(ax.Textarea,{id:"site-description",defaultValue:j.siteDescription,"data-testid":"textarea-site-description"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(bu.Label,{htmlFor:"maintenance-mode",children:"Maintenance Mode"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enable site maintenance mode"})]}),(0,b.jsx)(bs.Switch,{id:"maintenance-mode",defaultChecked:j.maintenanceMode,"data-testid":"switch-maintenance-mode"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(bu.Label,{htmlFor:"registration-enabled",children:"Registration Enabled"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Allow new user registrations"})]}),(0,b.jsx)(bs.Switch,{id:"registration-enabled",defaultChecked:j.registrationEnabled,"data-testid":"switch-registration-enabled"})]}),(0,b.jsx)(l.Button,{onClick:()=>z.mutate(j),disabled:z.isPending,"data-testid":"button-save-general",children:"Save Changes"})]})]})}),(0,b.jsx)(aA.TabsContent,{value:"coin-economy",className:"space-y-4",children:n?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-exchange-rate",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Exchange Rate"})}),(0,b.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"usd-to-coins",children:"USD to Coins Rate"}),(0,b.jsx)(m.Input,{id:"usd-to-coins",type:"number",defaultValue:o.usdToCoinsRate,"data-testid":"input-usd-to-coins"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"1 USD = X coins"})]}),(0,b.jsx)(l.Button,{"data-testid":"button-save-exchange-rate",children:"Save Exchange Rate"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-recharge-packages",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Recharge Packages"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Package"}),(0,b.jsx)(aa.TableHead,{children:"Coins"}),(0,b.jsx)(aa.TableHead,{children:"Price (USD)"}),(0,b.jsx)(aa.TableHead,{children:"Bonus"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:o.packages.length>0?o.packages.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`package-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.name}),(0,b.jsx)(aa.TableCell,{children:a.coins}),(0,b.jsxs)(aa.TableCell,{children:["$",a.price]}),(0,b.jsxs)(aa.TableCell,{children:[a.bonus,"%"]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-edit-package-${a.id}`,children:"Edit"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No packages configured"})})})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-withdrawal-settings",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Withdrawal Settings"})}),(0,b.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"min-withdrawal",children:"Minimum Withdrawal Amount"}),(0,b.jsx)(m.Input,{id:"min-withdrawal",type:"number",defaultValue:o.minWithdrawal,"data-testid":"input-min-withdrawal"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"withdrawal-fee",children:"Withdrawal Fee (%)"}),(0,b.jsx)(m.Input,{id:"withdrawal-fee",type:"number",defaultValue:o.withdrawalFee,"data-testid":"input-withdrawal-fee"})]}),(0,b.jsx)(l.Button,{"data-testid":"button-save-withdrawal",children:"Save Withdrawal Settings"})]})]})]})}),(0,b.jsxs)(aA.TabsContent,{value:"email-templates",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Search Templates"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(m.Input,{placeholder:"Search templates...",value:d,onChange:a=>f(a.target.value),"data-testid":"input-search-templates"})})]}),r?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-email-templates",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Email Templates"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Subject"}),(0,b.jsx)(aa.TableHead,{children:"Type"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:s.length>0?s.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`template-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.name}),(0,b.jsx)(aa.TableCell,{children:a.subject}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.type})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-edit-template-${a.id}`,children:"Edit"}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-preview-template-${a.id}`,children:"Preview"})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No templates found"})})})]})})})]})]}),(0,b.jsx)(aA.TabsContent,{value:"feature-flags",className:"space-y-4",children:u?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-feature-flags",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Feature Flags"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Feature"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"Enabled"}),(0,b.jsx)(aa.TableHead,{children:"Rollout %"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:v.length>0?v.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`flag-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.name}),(0,b.jsx)(aa.TableCell,{children:a.description}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(bs.Switch,{checked:a.enabled,onCheckedChange:b=>A.mutate({flagId:a.id,enabled:b}),"data-testid":`switch-flag-${a.id}`})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)("div",{className:"w-24",children:(0,b.jsx)(bt.Slider,{defaultValue:[a.rolloutPercentage],max:100,step:1,"data-testid":`slider-rollout-${a.id}`})})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-configure-flag-${a.id}`,children:"Configure"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No feature flags configured"})})})]})})})]})}),(0,b.jsx)(aA.TabsContent,{value:"admin-roles",className:"space-y-4",children:x?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-admin-roles",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Admin Roles & Permissions"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Email"}),(0,b.jsx)(aa.TableHead,{children:"Role"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:y.length>0?y.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`admin-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsx)(aa.TableCell,{children:a.email}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{children:a.role})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-edit-permissions-${a.id}`,children:"Edit Permissions"}),(0,b.jsx)(l.Button,{size:"sm",variant:"destructive","data-testid":`button-revoke-admin-${a.id}`,children:"Revoke"})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No admins found"})})})]})})})]})})]})]})}function bw(){let[a,c]=(0,e.useState)("security-events"),[d,f]=(0,e.useState)("all"),[g,h]=(0,e.useState)("all"),[i,j]=(0,e.useState)("all"),[k,n]=(0,e.useState)("active"),[o,q]=(0,e.useState)(null),{toast:r}=(0,aB.useToast)(),{data:s,isLoading:t}=(0,$.useQuery)({queryKey:["/api/admin/security/events",{type:d,severity:g,resolved:i}]}),u=Array.isArray(s)?s:[],{data:v,isLoading:w}=(0,$.useQuery)({queryKey:["/api/admin/security/ip-bans",{status:k}]}),x=Array.isArray(v)?v:[],{data:y,isLoading:z}=(0,$.useQuery)({queryKey:["/api/admin/security/performance-metrics"]}),A=y||{cpu:0,memory:0,disk:0,network:0,responseTimeData:[],errorRateData:[],dbQueryTime:{avg:0,min:0,max:0},alerts:[]},B=(0,aw.useMutation)({mutationFn:async({eventId:a,notes:b})=>(0,aM.apiRequest)("POST",`/api/admin/security/events/${a}/resolve`,{notes:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/security/events"]}),r({title:"Event resolved successfully"}),q(null)},onError:()=>{r({title:"Failed to resolve event",variant:"destructive"})}}),C=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST","/api/admin/security/ip-bans",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/security/ip-bans"]}),r({title:"IP banned successfully"})},onError:()=>{r({title:"Failed to ban IP",variant:"destructive"})}}),D=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("DELETE",`/api/admin/security/ip-bans/${a}`),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/security/ip-bans"]}),r({title:"IP unbanned successfully"})},onError:()=>{r({title:"Failed to unban IP",variant:"destructive"})}}),E=a=>{switch(a){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Security & Safety"}),(0,b.jsxs)(aA.Tabs,{value:a,onValueChange:c,"data-testid":"tabs-security",children:[(0,b.jsxs)(aA.TabsList,{className:"grid w-full grid-cols-3",children:[(0,b.jsx)(aA.TabsTrigger,{value:"security-events","data-testid":"tab-security-events",children:"Security Events"}),(0,b.jsx)(aA.TabsTrigger,{value:"ip-bans","data-testid":"tab-ip-bans",children:"IP Bans"}),(0,b.jsx)(aA.TabsTrigger,{value:"performance","data-testid":"tab-performance",children:"Performance Metrics"})]}),(0,b.jsxs)(aA.TabsContent,{value:"security-events",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Filters"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)(ay.Select,{value:d,onValueChange:f,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-type-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Event Type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Types"}),(0,b.jsx)(ay.SelectItem,{value:"login_attempt",children:"Login Attempt"}),(0,b.jsx)(ay.SelectItem,{value:"suspicious_activity",children:"Suspicious Activity"}),(0,b.jsx)(ay.SelectItem,{value:"data_breach",children:"Data Breach"})]})]}),(0,b.jsxs)(ay.Select,{value:g,onValueChange:h,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-severity-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Severity"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Severities"}),(0,b.jsx)(ay.SelectItem,{value:"critical",children:"Critical"}),(0,b.jsx)(ay.SelectItem,{value:"high",children:"High"}),(0,b.jsx)(ay.SelectItem,{value:"medium",children:"Medium"}),(0,b.jsx)(ay.SelectItem,{value:"low",children:"Low"})]})]}),(0,b.jsxs)(ay.Select,{value:i,onValueChange:j,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-resolved-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(ay.SelectItem,{value:"resolved",children:"Resolved"}),(0,b.jsx)(ay.SelectItem,{value:"unresolved",children:"Unresolved"})]})]})]})})]}),t?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-security-events",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Security Events (",u.length,")"]})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Type"}),(0,b.jsx)(aa.TableHead,{children:"Severity"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:u.length>0?u.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`event-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:a.type}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:E(a.severity),children:a.severity})}),(0,b.jsx)(aa.TableCell,{children:a.description}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:a.resolved?"secondary":"default",children:a.resolved?"Resolved":"Unresolved"})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>q(a),"data-testid":`button-view-event-${a.id}`,children:a.resolved?"View":"Resolve"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No security events found"})})})]})})})]}),(0,b.jsx)(az.Dialog,{open:!!o,onOpenChange:()=>q(null),children:(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-event-detail",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Security Event Details"}),(0,b.jsxs)(az.DialogDescription,{children:["Event ID: ",o?.id]})]}),o&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Type"}),(0,b.jsx)("p",{className:"font-medium",children:o.type})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Severity"}),(0,b.jsx)(au.Badge,{variant:E(o.severity),children:o.severity})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Description"}),(0,b.jsx)("p",{children:o.description})]}),!o.resolved&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"resolution-notes",children:"Resolution Notes"}),(0,b.jsx)(ax.Textarea,{id:"resolution-notes",placeholder:"Enter resolution notes...","data-testid":"textarea-resolution-notes"}),(0,b.jsx)(l.Button,{onClick:()=>{let a=document.getElementById("resolution-notes")?.value;B.mutate({eventId:o.id,notes:a})},disabled:B.isPending,"data-testid":"button-resolve-event",children:"Resolve Event"})]})]})]})})]}),(0,b.jsxs)(aA.TabsContent,{value:"ip-bans",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Add IP Ban"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsx)(m.Input,{placeholder:"IP Address",id:"ban-ip-address","data-testid":"input-ban-ip-address"}),(0,b.jsx)(m.Input,{placeholder:"Reason",id:"ban-reason","data-testid":"input-ban-reason"}),(0,b.jsxs)(ay.Select,{defaultValue:"permanent",children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-ban-duration",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Duration"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"permanent",children:"Permanent"}),(0,b.jsx)(ay.SelectItem,{value:"7",children:"7 Days"}),(0,b.jsx)(ay.SelectItem,{value:"30",children:"30 Days"})]})]}),(0,b.jsx)(l.Button,{onClick:()=>{let a=document.getElementById("ban-ip-address")?.value,b=document.getElementById("ban-reason")?.value;C.mutate({ipAddress:a,reason:b,duration:0})},disabled:C.isPending,"data-testid":"button-add-ban",children:"Add Ban"})]})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-4 space-y-0",children:[(0,b.jsx)(_.CardTitle,{children:"IP Bans"}),(0,b.jsxs)(ay.Select,{value:k,onValueChange:n,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48","data-testid":"select-ban-status-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Filter"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(ay.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(ay.SelectItem,{value:"expired",children:"Expired"})]})]})]}),(0,b.jsx)(_.CardContent,{children:w?(0,b.jsx)(p.Skeleton,{className:"h-64"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"IP Address"}),(0,b.jsx)(aa.TableHead,{children:"Reason"}),(0,b.jsx)(aa.TableHead,{children:"Banned By"}),(0,b.jsx)(aa.TableHead,{children:"Banned At"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:x.length>0?x.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`ban-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.ipAddress}),(0,b.jsx)(aa.TableCell,{children:a.reason}),(0,b.jsx)(aa.TableCell,{children:a.bannedBy}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:a.active?"destructive":"secondary",children:a.active?"Active":"Expired"})}),(0,b.jsx)(aa.TableCell,{children:a.active&&(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>D.mutate(a.id),disabled:D.isPending,"data-testid":`button-unban-${a.id}`,children:"Unban"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No IP bans found"})})})]})})})]})]}),(0,b.jsx)(aA.TabsContent,{value:"performance",className:"space-y-4",children:z?(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-cpu",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"CPU Usage"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-cpu",children:[A.cpu,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current usage"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-memory",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Memory"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-memory",children:[A.memory,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-disk",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Disk"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-disk",children:[A.disk,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-network",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Network"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-network",children:[A.network," MB/s"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Throughput"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-response-time",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Response Time (Last 24 Hours)"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:A.responseTimeData,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"time"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"responseTime",stroke:"hsl(var(--primary))",strokeWidth:2})]})})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-error-rate",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Error Rate"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:A.errorRateData,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"time"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"errors",stroke:"hsl(var(--destructive))",strokeWidth:2})]})})})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-db-metrics",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Database Query Time Metrics"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Average"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[A.dbQueryTime.avg,"ms"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Min"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[A.dbQueryTime.min,"ms"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Max"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[A.dbQueryTime.max,"ms"]})]})]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-performance-alerts",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Performance Alerts"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Alert"}),(0,b.jsx)(aa.TableHead,{children:"Severity"}),(0,b.jsx)(aa.TableHead,{children:"Time"})]})}),(0,b.jsx)(aa.TableBody,{children:A.alerts.length>0?A.alerts.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{children:a.message}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:E(a.severity),children:a.severity})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.time),{addSuffix:!0})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:3,className:"text-center py-8 text-muted-foreground",children:"No performance alerts"})})})]})})})]})]})})]})]})}var bx=a.i(765910);function by(){let[a,c]=(0,e.useState)("announcements"),[d,f]=(0,e.useState)(!1),{toast:g}=(0,aB.useToast)(),{data:h,isLoading:i}=(0,$.useQuery)({queryKey:["/api/admin/communications/announcements"]}),j=Array.isArray(h)?h:[],{data:k,isLoading:n}=(0,$.useQuery)({queryKey:["/api/admin/communications/campaigns"]}),o=Array.isArray(k)?k:[],{data:q,isLoading:r}=(0,$.useQuery)({queryKey:["/api/admin/communications/campaign-stats"]}),s=q||{sent:0,opened:0,openRate:0,clicked:0,clickRate:0,bounced:0,bounceRate:0},t=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST","/api/admin/communications/announcements",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/communications/announcements"]}),g({title:"Announcement created successfully"}),f(!1)},onError:()=>{g({title:"Failed to create announcement",variant:"destructive"})}}),u=(0,aw.useMutation)({mutationFn:async({id:a,active:b})=>(0,aM.apiRequest)("PUT",`/api/admin/communications/announcements/${a}`,{active:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/communications/announcements"]}),g({title:"Announcement updated"})},onError:()=>{g({title:"Failed to update announcement",variant:"destructive"})}}),v=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("DELETE",`/api/admin/communications/announcements/${a}`),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/communications/announcements"]}),g({title:"Announcement deleted"})},onError:()=>{g({title:"Failed to delete announcement",variant:"destructive"})}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Communications"}),(0,b.jsxs)(aA.Tabs,{value:a,onValueChange:c,"data-testid":"tabs-communications",children:[(0,b.jsxs)(aA.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsx)(aA.TabsTrigger,{value:"announcements","data-testid":"tab-announcements",children:"Announcements"}),(0,b.jsx)(aA.TabsTrigger,{value:"email-campaigns","data-testid":"tab-email-campaigns",children:"Email Campaigns"})]}),(0,b.jsxs)(aA.TabsContent,{value:"announcements",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Announcements"}),(0,b.jsxs)(az.Dialog,{open:d,onOpenChange:f,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-announcement",children:"Create Announcement"})}),(0,b.jsxs)(az.DialogContent,{"data-testid":"dialog-create-announcement",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsx)(az.DialogTitle,{children:"Create Announcement"}),(0,b.jsx)(az.DialogDescription,{children:"Create a new announcement for your users"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-title",children:"Title"}),(0,b.jsx)(m.Input,{id:"announcement-title",placeholder:"Announcement title","data-testid":"input-announcement-title"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-content",children:"Content"}),(0,b.jsx)(ax.Textarea,{id:"announcement-content",placeholder:"Announcement content",rows:4,"data-testid":"textarea-announcement-content"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-type",children:"Type"}),(0,b.jsxs)(ay.Select,{defaultValue:"info",children:[(0,b.jsx)(ay.SelectTrigger,{id:"announcement-type","data-testid":"select-announcement-type",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"info",children:"Info"}),(0,b.jsx)(ay.SelectItem,{value:"warning",children:"Warning"}),(0,b.jsx)(ay.SelectItem,{value:"success",children:"Success"}),(0,b.jsx)(ay.SelectItem,{value:"error",children:"Error"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-audience",children:"Target Audience"}),(0,b.jsxs)(ay.Select,{defaultValue:"all",children:[(0,b.jsx)(ay.SelectTrigger,{id:"announcement-audience","data-testid":"select-announcement-audience",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select audience"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Users"}),(0,b.jsx)(ay.SelectItem,{value:"premium",children:"Premium Users"}),(0,b.jsx)(ay.SelectItem,{value:"free",children:"Free Users"}),(0,b.jsx)(ay.SelectItem,{value:"sellers",children:"Sellers"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-display",children:"Display Type"}),(0,b.jsxs)(ay.Select,{defaultValue:"banner",children:[(0,b.jsx)(ay.SelectTrigger,{id:"announcement-display","data-testid":"select-announcement-display",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select display type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"banner",children:"Banner"}),(0,b.jsx)(ay.SelectItem,{value:"modal",children:"Modal"}),(0,b.jsx)(ay.SelectItem,{value:"toast",children:"Toast"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-start",children:"Start Date"}),(0,b.jsx)(m.Input,{id:"announcement-start",type:"date","data-testid":"input-announcement-start"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"announcement-end",children:"End Date"}),(0,b.jsx)(m.Input,{id:"announcement-end",type:"date","data-testid":"input-announcement-end"})]})]}),(0,b.jsx)(l.Button,{onClick:()=>{let a=document.getElementById("announcement-title")?.value,b=document.getElementById("announcement-content")?.value;t.mutate({title:a,content:b,type:"info",audience:"all"})},disabled:t.isPending,"data-testid":"button-submit-announcement",children:"Create Announcement"})]})]})]})]}),i?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsx)(_.Card,{"data-testid":"card-announcements",children:(0,b.jsx)(_.CardContent,{className:"p-0",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Title"}),(0,b.jsx)(aa.TableHead,{children:"Type"}),(0,b.jsx)(aa.TableHead,{children:"Audience"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Views"}),(0,b.jsx)(aa.TableHead,{children:"Clicks"}),(0,b.jsx)(aa.TableHead,{children:"Created"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:j.length>0?j.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`announcement-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.title}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.type})}),(0,b.jsx)(aa.TableCell,{children:a.audience}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(bs.Switch,{checked:a.active,onCheckedChange:b=>u.mutate({id:a.id,active:b}),"data-testid":`switch-announcement-${a.id}`})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(aT.Eye,{className:"h-4 w-4"}),a.views||0]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(bx.MousePointer,{className:"h-4 w-4"}),a.clicks||0]})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-edit-announcement-${a.id}`,children:"Edit"}),(0,b.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>v.mutate(a.id),disabled:v.isPending,"data-testid":`button-delete-announcement-${a.id}`,children:"Delete"})]})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No announcements found"})})})]})})})})]}),(0,b.jsxs)(aA.TabsContent,{value:"email-campaigns",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Email Campaigns"}),(0,b.jsx)(l.Button,{"data-testid":"button-create-campaign",children:"Create Campaign"})]}),r?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))}):(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-sent",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Sent"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-sent",children:s.sent}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Emails sent"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-opened",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Opened"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-opened",children:s.opened}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.openRate,"% open rate"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-clicked",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Clicked"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-clicked",children:s.clicked}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.clickRate,"% click rate"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-bounced",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Bounced"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-bounced",children:s.bounced}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.bounceRate,"% bounce rate"]})]})]})]}),n?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-campaigns",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Recent Campaigns"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Subject"}),(0,b.jsx)(aa.TableHead,{children:"Sent"}),(0,b.jsx)(aa.TableHead,{children:"Opened"}),(0,b.jsx)(aa.TableHead,{children:"Clicked"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Created"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:o.length>0?o.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`campaign-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:a.name}),(0,b.jsx)(aa.TableCell,{children:a.subject}),(0,b.jsx)(aa.TableCell,{children:a.sent||0}),(0,b.jsx)(aa.TableCell,{children:a.opened||0}),(0,b.jsx)(aa.TableCell,{children:a.clicked||0}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"sent"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-view-campaign-${a.id}`,children:"View Report"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No campaigns found"})})})]})})})]})]})]})]})}function bz(){let[a,c]=(0,e.useState)("all"),[d,f]=(0,e.useState)("all"),[g,h]=(0,e.useState)("all"),[i,j]=(0,e.useState)(null),{toast:k}=(0,aB.useToast)(),{data:m,isLoading:o}=(0,$.useQuery)({queryKey:["/api/admin/support/tickets",{status:a,priority:d,category:g}]}),q=Array.isArray(m)?m:[],{data:r,isLoading:s}=(0,$.useQuery)({queryKey:["/api/admin/support/stats"]}),t=r||{openTickets:0,avgResponseTime:"0h",avgResolutionTime:"0h",satisfactionScore:0},u=(0,aw.useMutation)({mutationFn:async({ticketId:a,data:b})=>(0,aM.apiRequest)("PUT",`/api/admin/support/tickets/${a}`,b),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/support/tickets"]}),k({title:"Ticket updated successfully"})},onError:()=>{k({title:"Failed to update ticket",variant:"destructive"})}}),v=(0,aw.useMutation)({mutationFn:async({ticketId:a,message:b})=>(0,aM.apiRequest)("POST",`/api/admin/support/tickets/${a}/reply`,{message:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/support/tickets"]}),k({title:"Reply sent successfully"})},onError:()=>{k({title:"Failed to send reply",variant:"destructive"})}}),w=(0,aw.useMutation)({mutationFn:async a=>(0,aM.apiRequest)("POST",`/api/admin/support/tickets/${a}/close`),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/support/tickets"]}),k({title:"Ticket closed"}),j(null)},onError:()=>{k({title:"Failed to close ticket",variant:"destructive"})}}),x=a=>{switch(a){case"urgent":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Support & Tickets"}),s?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c))}):(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-open-tickets",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Open Tickets"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-open-tickets",children:t.openTickets}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting response"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-avg-response-time",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Response Time"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-response-time",children:t.avgResponseTime}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Time to first response"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-avg-resolution-time",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Resolution Time"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-resolution-time",children:t.avgResolutionTime}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Time to close"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-satisfaction-score",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Satisfaction Score"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-satisfaction-score",children:[t.satisfactionScore,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"User satisfaction"})]})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Filters"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)(ay.Select,{value:a,onValueChange:c,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-status-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(ay.SelectItem,{value:"open",children:"Open"}),(0,b.jsx)(ay.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(ay.SelectItem,{value:"resolved",children:"Resolved"}),(0,b.jsx)(ay.SelectItem,{value:"closed",children:"Closed"})]})]}),(0,b.jsxs)(ay.Select,{value:d,onValueChange:f,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-priority-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Priority"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Priorities"}),(0,b.jsx)(ay.SelectItem,{value:"urgent",children:"Urgent"}),(0,b.jsx)(ay.SelectItem,{value:"high",children:"High"}),(0,b.jsx)(ay.SelectItem,{value:"medium",children:"Medium"}),(0,b.jsx)(ay.SelectItem,{value:"low",children:"Low"})]})]}),(0,b.jsxs)(ay.Select,{value:g,onValueChange:h,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-category-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Category"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Categories"}),(0,b.jsx)(ay.SelectItem,{value:"technical",children:"Technical"}),(0,b.jsx)(ay.SelectItem,{value:"billing",children:"Billing"}),(0,b.jsx)(ay.SelectItem,{value:"general",children:"General"})]})]})]})})]}),o?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-tickets",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Support Tickets (",q.length,")"]})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Ticket #"}),(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Subject"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Priority"}),(0,b.jsx)(aa.TableHead,{children:"Created"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:q.length>0?q.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`ticket-${a.id}`,children:[(0,b.jsxs)(aa.TableCell,{children:["#",a.id]}),(0,b.jsx)(aa.TableCell,{children:a.username}),(0,b.jsx)(aa.TableCell,{children:a.subject}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:x(a.priority),children:a.priority})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>j(a),"data-testid":`button-view-ticket-${a.id}`,children:"View"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No tickets found"})})})]})})})]}),(0,b.jsx)(az.Dialog,{open:!!i,onOpenChange:()=>j(null),children:(0,b.jsxs)(az.DialogContent,{className:"max-w-3xl","data-testid":"dialog-ticket-detail",children:[(0,b.jsxs)(az.DialogHeader,{children:[(0,b.jsxs)(az.DialogTitle,{children:["Ticket #",i?.id]}),(0,b.jsx)(az.DialogDescription,{children:i?.subject})]}),i&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"User"}),(0,b.jsx)("p",{className:"font-medium",children:i.username})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,b.jsx)(au.Badge,{variant:"outline",children:i.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Priority"}),(0,b.jsx)(au.Badge,{variant:x(i.priority),children:i.priority})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Category"}),(0,b.jsx)("p",{className:"font-medium",children:i.category||"N/A"})]})]}),(0,b.jsx)(n.Separator,{}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{children:"Conversation"}),(0,b.jsx)("div",{className:"border rounded-md p-4 space-y-4 max-h-96 overflow-y-auto",children:i.messages&&i.messages.length>0?i.messages.map(a=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"font-medium",children:a.sender}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]}),(0,b.jsx)("p",{className:"text-sm",children:a.content}),(0,b.jsx)(n.Separator,{className:"mt-2"})]},a.id)):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No messages yet"})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"reply-message",children:"Reply"}),(0,b.jsx)(ax.Textarea,{id:"reply-message",placeholder:"Type your reply...",rows:4,"data-testid":"textarea-reply"}),(0,b.jsx)(l.Button,{onClick:()=>{let a=document.getElementById("reply-message")?.value;v.mutate({ticketId:i.id,message:a})},disabled:v.isPending,"data-testid":"button-send-reply",children:"Send Reply"})]}),(0,b.jsx)(n.Separator,{}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"assign-admin",children:"Assign to Admin"}),(0,b.jsxs)(ay.Select,{children:[(0,b.jsx)(ay.SelectTrigger,{id:"assign-admin","data-testid":"select-assign-admin",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select admin"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"admin1",children:"Admin 1"}),(0,b.jsx)(ay.SelectItem,{value:"admin2",children:"Admin 2"})]})]})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"update-status",children:"Update Status"}),(0,b.jsxs)(ay.Select,{defaultValue:i.status,onValueChange:a=>{u.mutate({ticketId:i.id,data:{status:a}})},children:[(0,b.jsx)(ay.SelectTrigger,{id:"update-status","data-testid":"select-update-status",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"open",children:"Open"}),(0,b.jsx)(ay.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(ay.SelectItem,{value:"resolved",children:"Resolved"}),(0,b.jsx)(ay.SelectItem,{value:"closed",children:"Closed"})]})]})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(l.Button,{variant:"destructive",onClick:()=>w.mutate(i.id),disabled:w.isPending,"data-testid":"button-close-ticket",children:"Close Ticket"})}),i.tags&&i.tags.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{children:"Tags"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:i.tags.map((a,c)=>(0,b.jsx)(au.Badge,{variant:"secondary",children:a},c))})]})]})]})})]})}function bA(){let[a,c]=(0,e.useState)("admin-actions"),[d,f]=(0,e.useState)("all"),[g,h]=(0,e.useState)("all"),[i,j]=(0,e.useState)("all"),[k,n]=(0,e.useState)(""),[o,q]=(0,e.useState)("all"),[r,s]=(0,e.useState)("all"),[t,u]=(0,e.useState)("all"),{data:v,isLoading:w}=(0,$.useQuery)({queryKey:["/api/admin/logs/admin-actions",{admin:d,actionType:g,targetType:i,search:k}]}),x=Array.isArray(v)?v:[],{data:y,isLoading:z}=(0,$.useQuery)({queryKey:["/api/admin/logs/security",{severity:o,eventType:t}]}),A=Array.isArray(y)?y:[],{data:B,isLoading:C}=(0,$.useQuery)({queryKey:["/api/admin/logs/performance",{metricType:r}]}),D=B??{aggregations:{avg:0,min:0,max:0},logs:[]},{data:E,isLoading:F}=(0,$.useQuery)({queryKey:["/api/admin/logs/system-events",{severity:o,eventType:t}]}),G=Array.isArray(E)?E:[],H=a=>{console.log(`Exporting logs as ${a}`)},I=a=>{switch(a){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Audit Logs"}),(0,b.jsxs)(aA.Tabs,{value:a,onValueChange:c,"data-testid":"tabs-logs",children:[(0,b.jsxs)(aA.TabsList,{className:"grid w-full grid-cols-4",children:[(0,b.jsx)(aA.TabsTrigger,{value:"admin-actions","data-testid":"tab-admin-actions",children:"Admin Actions"}),(0,b.jsx)(aA.TabsTrigger,{value:"security","data-testid":"tab-security-logs",children:"Security Logs"}),(0,b.jsx)(aA.TabsTrigger,{value:"performance","data-testid":"tab-performance-logs",children:"Performance Logs"}),(0,b.jsx)(aA.TabsTrigger,{value:"system","data-testid":"tab-system-events",children:"System Events"})]}),(0,b.jsxs)(aA.TabsContent,{value:"admin-actions",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Filters & Search"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,b.jsx)(m.Input,{placeholder:"Search logs...",value:k,onChange:a=>{let b=a.target.value;setTimeout(()=>n(b),300)},"data-testid":"input-search-logs"}),(0,b.jsxs)(ay.Select,{value:d,onValueChange:f,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-admin-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Admin User"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Admins"}),(0,b.jsx)(ay.SelectItem,{value:"admin1",children:"Admin 1"}),(0,b.jsx)(ay.SelectItem,{value:"admin2",children:"Admin 2"})]})]}),(0,b.jsxs)(ay.Select,{value:g,onValueChange:h,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-action-type-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Action Type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Actions"}),(0,b.jsx)(ay.SelectItem,{value:"create",children:"Create"}),(0,b.jsx)(ay.SelectItem,{value:"update",children:"Update"}),(0,b.jsx)(ay.SelectItem,{value:"delete",children:"Delete"})]})]}),(0,b.jsxs)(ay.Select,{value:i,onValueChange:j,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-target-type-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Target Type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Targets"}),(0,b.jsx)(ay.SelectItem,{value:"user",children:"User"}),(0,b.jsx)(ay.SelectItem,{value:"content",children:"Content"}),(0,b.jsx)(ay.SelectItem,{value:"settings",children:"Settings"})]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)(m.Input,{type:"date",placeholder:"Start Date",className:"w-full md:w-auto","data-testid":"input-start-date"}),(0,b.jsx)(m.Input,{type:"date",placeholder:"End Date",className:"w-full md:w-auto","data-testid":"input-end-date"}),(0,b.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,b.jsxs)(l.Button,{variant:"outline",onClick:()=>H("csv"),"data-testid":"button-export-csv",children:[(0,b.jsx)(aH.Download,{className:"h-4 w-4 mr-1"}),"CSV"]}),(0,b.jsxs)(l.Button,{variant:"outline",onClick:()=>H("json"),"data-testid":"button-export-json",children:[(0,b.jsx)(aH.Download,{className:"h-4 w-4 mr-1"}),"JSON"]})]})]})]})]}),w?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-admin-logs",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Admin Action Logs (",x.length,")"]})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Admin"}),(0,b.jsx)(aa.TableHead,{children:"Action Type"}),(0,b.jsx)(aa.TableHead,{children:"Target"}),(0,b.jsx)(aa.TableHead,{children:"Details"}),(0,b.jsx)(aa.TableHead,{children:"IP Address"})]})}),(0,b.jsx)(aa.TableBody,{children:x.length>0?x.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`log-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:a.adminUsername}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.actionType})}),(0,b.jsx)(aa.TableCell,{children:a.targetType}),(0,b.jsx)(aa.TableCell,{children:a.details}),(0,b.jsx)(aa.TableCell,{children:a.ipAddress})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No logs found"})})})]})})})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"security",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Filters"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)(ay.Select,{value:o,onValueChange:q,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-security-severity-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Severity"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Severities"}),(0,b.jsx)(ay.SelectItem,{value:"critical",children:"Critical"}),(0,b.jsx)(ay.SelectItem,{value:"high",children:"High"}),(0,b.jsx)(ay.SelectItem,{value:"medium",children:"Medium"}),(0,b.jsx)(ay.SelectItem,{value:"low",children:"Low"})]})]}),(0,b.jsxs)(ay.Select,{value:t,onValueChange:u,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-security-event-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Event Type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Events"}),(0,b.jsx)(ay.SelectItem,{value:"login",children:"Login"}),(0,b.jsx)(ay.SelectItem,{value:"access",children:"Access"}),(0,b.jsx)(ay.SelectItem,{value:"breach",children:"Breach"})]})]})]})})]}),z?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-security-logs",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Security Event Logs (",A.length,")"]})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Event Type"}),(0,b.jsx)(aa.TableHead,{children:"Severity"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"IP Address"})]})}),(0,b.jsx)(aa.TableBody,{children:A.length>0?A.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`security-log-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:a.eventType}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:I(a.severity),children:a.severity})}),(0,b.jsx)(aa.TableCell,{children:a.description}),(0,b.jsx)(aa.TableCell,{children:a.username||"N/A"}),(0,b.jsx)(aa.TableCell,{children:a.ipAddress})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No security logs found"})})})]})})})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"performance",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Filters"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)(ay.Select,{value:r,onValueChange:s,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-metric-type-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Metric Type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Metrics"}),(0,b.jsx)(ay.SelectItem,{value:"cpu",children:"CPU"}),(0,b.jsx)(ay.SelectItem,{value:"memory",children:"Memory"}),(0,b.jsx)(ay.SelectItem,{value:"response_time",children:"Response Time"})]})]}),(0,b.jsx)(m.Input,{type:"date",placeholder:"Start Date","data-testid":"input-perf-start-date"}),(0,b.jsx)(m.Input,{type:"date",placeholder:"End Date","data-testid":"input-perf-end-date"})]})})]}),C?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-avg-metric",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Average"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-avg-metric",children:D.aggregations?.avg||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average value"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-min-metric",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Minimum"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-min-metric",children:D.aggregations?.min||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Minimum value"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-max-metric",children:[(0,b.jsx)(_.CardHeader,{className:"pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Maximum"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-max-metric",children:D.aggregations?.max||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Maximum value"})]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-performance-logs",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["Performance Metrics (",D.logs.length,")"]})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Metric Type"}),(0,b.jsx)(aa.TableHead,{children:"Value"}),(0,b.jsx)(aa.TableHead,{children:"Unit"}),(0,b.jsx)(aa.TableHead,{children:"Status"})]})}),(0,b.jsx)(aa.TableBody,{children:D.logs.length>0?D.logs.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`perf-log-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:a.metricType}),(0,b.jsx)(aa.TableCell,{children:a.value}),(0,b.jsx)(aa.TableCell,{children:a.unit}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"normal"===a.status?"secondary":"destructive",children:a.status})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No performance logs found"})})})]})})})]})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"system",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Filters"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)(ay.Select,{value:t,onValueChange:u,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-system-event-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Event Type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Events"}),(0,b.jsx)(ay.SelectItem,{value:"startup",children:"Startup"}),(0,b.jsx)(ay.SelectItem,{value:"shutdown",children:"Shutdown"}),(0,b.jsx)(ay.SelectItem,{value:"error",children:"Error"})]})]}),(0,b.jsxs)(ay.Select,{value:o,onValueChange:q,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-full md:w-48","data-testid":"select-system-severity-filter",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Severity"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Severities"}),(0,b.jsx)(ay.SelectItem,{value:"critical",children:"Critical"}),(0,b.jsx)(ay.SelectItem,{value:"high",children:"High"}),(0,b.jsx)(ay.SelectItem,{value:"medium",children:"Medium"}),(0,b.jsx)(ay.SelectItem,{value:"low",children:"Low"})]})]})]})})]}),F?(0,b.jsx)(p.Skeleton,{className:"h-96"}):(0,b.jsxs)(_.Card,{"data-testid":"card-system-events",children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{children:["System Events (",G.length,")"]})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Event Type"}),(0,b.jsx)(aa.TableHead,{children:"Severity"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"Component"})]})}),(0,b.jsx)(aa.TableBody,{children:G.length>0?G.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`system-event-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:a.eventType}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:I(a.severity),children:a.severity})}),(0,b.jsx)(aa.TableCell,{children:a.description}),(0,b.jsx)(aa.TableCell,{children:a.component})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No system events found"})})})]})})})]})]})]})]})}let bB=(0,h.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);function bC(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)([70]),{data:h,isLoading:i}=(0,$.useQuery)({queryKey:["/api/admin/automation/rules"]}),j=Array.isArray(h)?h:[],{data:k,isLoading:n}=(0,$.useQuery)({queryKey:["/api/admin/ai/moderation-stats"]}),o=k||{accuracyRate:0,falsePositives:0,falseNegatives:0,timeSavedHours:0},{data:q,isLoading:r}=(0,$.useQuery)({queryKey:["/api/admin/ai/moderation-decisions"]}),s=Array.isArray(q)?q:[],{data:t,isLoading:u}=(0,$.useQuery)({queryKey:["/api/admin/ai/sentiment-distribution"]}),v=Array.isArray(t)?t:[],{data:w,isLoading:x}=(0,$.useQuery)({queryKey:["/api/admin/ai/spam-metrics"]}),y=w||{accuracy:0,blocked:0,flagged:0},{data:z,isLoading:A}=(0,$.useQuery)({queryKey:["/api/admin/ai/flagged-content"]}),B=Array.isArray(z)?z:[],C=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/automation/rules","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/automation/rules"]}),a({title:"Rule created successfully"}),d(!1)}}),D=(0,aw.useMutation)({mutationFn:({id:a,enabled:b})=>(0,aM.apiRequest)(`/api/admin/automation/rules/${a}`,"PATCH",{enabled:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/automation/rules"]}),a({title:"Rule updated"})}}),E=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/automation/rules/${a}/execute`,"POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/automation/rules"]}),a({title:"Rule executed successfully"})}}),F=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/ai/moderation-decisions/${a}/override`,"POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/ai/moderation-decisions"]}),a({title:"Decision overridden"})}}),G=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/ai/spam-sensitivity","PATCH",{sensitivity:a}),onSuccess:()=>{a({title:"Sensitivity updated"})}}),H=["hsl(var(--primary))","hsl(var(--accent))","hsl(var(--muted))"];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"AI & Automation"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"automation",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"automation","data-testid":"tab-automation",children:"Automation Rules"}),(0,b.jsx)(aA.TabsTrigger,{value:"moderation","data-testid":"tab-moderation",children:"Content Moderation AI"}),(0,b.jsx)(aA.TabsTrigger,{value:"spam","data-testid":"tab-spam",children:"Spam Detection"})]}),(0,b.jsxs)(aA.TabsContent,{value:"automation",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Automation Rules"}),(0,b.jsxs)(az.Dialog,{open:c,onOpenChange:d,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-rule",children:"Create Rule"})}),(0,b.jsxs)(az.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create Automation Rule"})}),(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault();let c=new FormData(b.currentTarget),d=c.get("triggerConfig"),e=c.get("actionConfig");try{JSON.parse(d),JSON.parse(e)}catch(b){a({title:"Invalid JSON in configuration",variant:"destructive"});return}C.mutate({name:c.get("name"),triggerType:c.get("triggerType"),triggerConfig:d,actionType:c.get("actionType"),actionConfig:e})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"name",children:"Rule Name"}),(0,b.jsx)(m.Input,{id:"name",name:"name",required:!0,"data-testid":"input-rule-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"triggerType",children:"Trigger Type"}),(0,b.jsxs)(ay.Select,{name:"triggerType",required:!0,children:[(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-trigger-type",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select trigger type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"user_signup",children:"User Signup"}),(0,b.jsx)(ay.SelectItem,{value:"content_published",children:"Content Published"}),(0,b.jsx)(ay.SelectItem,{value:"time_based",children:"Time Based"}),(0,b.jsx)(ay.SelectItem,{value:"threshold_reached",children:"Threshold Reached"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"triggerConfig",children:"Trigger Configuration (JSON)"}),(0,b.jsx)(ax.Textarea,{id:"triggerConfig",name:"triggerConfig",placeholder:'{"key": "value"}',className:"font-mono text-sm",required:!0,"data-testid":"textarea-trigger-config"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"actionType",children:"Action Type"}),(0,b.jsxs)(ay.Select,{name:"actionType",required:!0,children:[(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-action-type",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select action type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"send_email",children:"Send Email"}),(0,b.jsx)(ay.SelectItem,{value:"create_notification",children:"Create Notification"}),(0,b.jsx)(ay.SelectItem,{value:"award_coins",children:"Award Coins"}),(0,b.jsx)(ay.SelectItem,{value:"assign_badge",children:"Assign Badge"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"actionConfig",children:"Action Configuration (JSON)"}),(0,b.jsx)(ax.Textarea,{id:"actionConfig",name:"actionConfig",placeholder:'{"key": "value"}',className:"font-mono text-sm",required:!0,"data-testid":"textarea-action-config"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:C.isPending,"data-testid":"button-submit-rule",children:C.isPending?"Creating...":"Create Rule"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:i?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Trigger"}),(0,b.jsx)(aa.TableHead,{children:"Action"}),(0,b.jsx)(aa.TableHead,{children:"Executions"}),(0,b.jsx)(aa.TableHead,{children:"Last Executed"}),(0,b.jsx)(aa.TableHead,{children:"Enabled"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[j.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`rule-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{"data-testid":`rule-name-${a.id}`,children:a.name}),(0,b.jsx)(aa.TableCell,{children:a.triggerType}),(0,b.jsx)(aa.TableCell,{children:a.actionType}),(0,b.jsx)(aa.TableCell,{children:a.executionCount||0}),(0,b.jsx)(aa.TableCell,{children:a.lastExecutedAt?(0,ag.formatDistanceToNow)(new Date(a.lastExecutedAt),{addSuffix:!0}):"Never"}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(bs.Switch,{checked:a.enabled,onCheckedChange:b=>D.mutate({id:a.id,enabled:b}),"data-testid":`switch-rule-${a.id}`})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>E.mutate(a.id),disabled:E.isPending,"data-testid":`button-execute-${a.id}`,children:[(0,b.jsx)(bB,{className:"w-3 h-3 mr-1"}),"Execute"]})})]},a.id)),0===j.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No automation rules created"})})]})]})})})})]}),(0,b.jsxs)(aA.TabsContent,{value:"moderation",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Content Moderation AI"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:n?[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-accuracy-rate",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Accuracy Rate"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-accuracy-rate",children:[o.accuracyRate,"%"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-false-positives",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"False Positives"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-false-positives",children:o.falsePositives})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-false-negatives",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"False Negatives"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-false-negatives",children:o.falseNegatives})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-time-saved",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Time Saved"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-time-saved",children:[o.timeSavedHours,"h"]})})]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Recent AI Decisions"})}),(0,b.jsx)(_.CardContent,{children:r?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Content"}),(0,b.jsx)(aa.TableHead,{children:"Decision"}),(0,b.jsx)(aa.TableHead,{children:"Confidence"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[s.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.contentPreview}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"approved"===a.decision?"default":"destructive",children:a.decision})}),(0,b.jsxs)(aa.TableCell,{children:[a.confidence,"%"]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>F.mutate(a.id),"data-testid":`button-override-${a.id}`,children:"Override"})})]},a.id)),0===s.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No recent decisions"})})]})]})})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Sentiment Distribution"})}),(0,b.jsx)(_.CardContent,{children:u?(0,b.jsx)(p.Skeleton,{className:"h-64"}):v.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:v,cx:"50%",cy:"50%",labelLine:!1,label:a=>a.name,outerRadius:80,fill:"hsl(var(--primary))",dataKey:"value",children:v.map((a,c)=>(0,b.jsx)(an.Cell,{fill:H[c%H.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"spam",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Spam Detection"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:x?[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-spam-accuracy",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Detection Accuracy"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-spam-accuracy",children:[y.accuracy,"%"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-spam-blocked",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Spam Blocked"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-spam-blocked",children:y.blocked})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-spam-flagged",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Currently Flagged"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-spam-flagged",children:y.flagged})})]})]})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Adjust Sensitivity"})}),(0,b.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(bu.Label,{children:["Sensitivity Level: ",f[0],"%"]}),(0,b.jsx)(bt.Slider,{value:f,onValueChange:g,max:100,step:1,"data-testid":"slider-sensitivity"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Higher values will flag more content as potential spam"})]}),(0,b.jsx)(l.Button,{onClick:()=>G.mutate(f[0]),disabled:G.isPending,"data-testid":"button-update-sensitivity",children:"Update Sensitivity"})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Flagged Content"})}),(0,b.jsx)(_.CardContent,{children:A?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Content"}),(0,b.jsx)(aa.TableHead,{children:"Spam Score"}),(0,b.jsx)(aa.TableHead,{children:"Author"}),(0,b.jsx)(aa.TableHead,{children:"Flagged At"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[B.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.contentPreview}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:a.spamScore>80?"destructive":"secondary",children:[a.spamScore,"%"]})}),(0,b.jsx)(aa.TableCell,{children:a.authorUsername}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.flaggedAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline","data-testid":`button-approve-${a.id}`,children:"Approve"})})]},a.id)),0===B.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No flagged content"})})]})]})})})]})]})]})]})}var bD=a.i(93518);function bE(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[h,i]=(0,e.useState)("contributors"),[j,k]=(0,e.useState)("all-time"),{data:n,isLoading:o}=(0,$.useQuery)({queryKey:["/api/admin/gamification/badges"]}),q=Array.isArray(n)?n:[],{data:r,isLoading:s}=(0,$.useQuery)({queryKey:["/api/admin/gamification/achievements"]}),t=Array.isArray(r)?r:[],{data:u,isLoading:v}=(0,$.useQuery)({queryKey:["/api/admin/gamification/leaderboard",h,j]}),w=Array.isArray(u)?u:[],{data:x,isLoading:y}=(0,$.useQuery)({queryKey:["/api/admin/gamification/goals"]}),z=Array.isArray(x)?x:[],{data:A,isLoading:B}=(0,$.useQuery)({queryKey:["/api/admin/gamification/goal-completion"]}),C=Array.isArray(A)?A:[],D=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/gamification/badges","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/gamification/badges"]}),a({title:"Badge created successfully"}),d(!1)}}),E=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/gamification/achievements","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/gamification/achievements"]}),a({title:"Achievement created successfully"}),g(!1)}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Gamification"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"badges",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"badges","data-testid":"tab-badges",children:"Badges"}),(0,b.jsx)(aA.TabsTrigger,{value:"achievements","data-testid":"tab-achievements",children:"Achievements"}),(0,b.jsx)(aA.TabsTrigger,{value:"leaderboards","data-testid":"tab-leaderboards",children:"Leaderboards"}),(0,b.jsx)(aA.TabsTrigger,{value:"goals","data-testid":"tab-goals",children:"Goals"})]}),(0,b.jsxs)(aA.TabsContent,{value:"badges",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Badges"}),(0,b.jsxs)(az.Dialog,{open:c,onOpenChange:d,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-badge",children:"Create Badge"})}),(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create New Badge"})}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);D.mutate({name:b.get("name"),description:b.get("description"),imageUrl:b.get("imageUrl"),rarity:b.get("rarity")})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"name",children:"Badge Name"}),(0,b.jsx)(m.Input,{id:"name",name:"name",required:!0,"data-testid":"input-badge-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(m.Input,{id:"description",name:"description",required:!0,"data-testid":"input-badge-description"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"imageUrl",children:"Image URL"}),(0,b.jsx)(m.Input,{id:"imageUrl",name:"imageUrl",type:"url",required:!0,"data-testid":"input-badge-image"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"rarity",children:"Rarity"}),(0,b.jsxs)(ay.Select,{name:"rarity",required:!0,children:[(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-badge-rarity",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select rarity"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"common",children:"Common"}),(0,b.jsx)(ay.SelectItem,{value:"rare",children:"Rare"}),(0,b.jsx)(ay.SelectItem,{value:"epic",children:"Epic"}),(0,b.jsx)(ay.SelectItem,{value:"legendary",children:"Legendary"})]})]})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:D.isPending,"data-testid":"button-submit-badge",children:D.isPending?"Creating...":"Create Badge"})})]})]})]})]}),o?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-48"},c))}):(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[q.map(a=>(0,b.jsxs)(_.Card,{"data-testid":`badge-card-${a.id}`,children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center gap-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center",children:a.imageUrl?(0,b.jsx)("img",{src:a.imageUrl,alt:a.name,className:"w-12 h-12"}):(0,b.jsx)(bD.Award,{className:"w-8 h-8"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(_.CardTitle,{className:"text-lg","data-testid":`badge-name-${a.id}`,children:a.name}),(0,b.jsx)(au.Badge,{variant:"secondary",children:a.rarity})]})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})}),(0,b.jsx)(_.CardFooter,{className:"flex justify-between gap-2",children:(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.totalEarned||0})," earned"]})})]},a.id)),0===q.length&&(0,b.jsx)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"No badges created yet"})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"achievements",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Achievements"}),(0,b.jsxs)(az.Dialog,{open:f,onOpenChange:g,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-achievement",children:"Create Achievement"})}),(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create New Achievement"})}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);E.mutate({name:b.get("name"),description:b.get("description"),criteria:b.get("criteria"),rewardCoins:parseInt(b.get("rewardCoins"))})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"ach-name",children:"Achievement Name"}),(0,b.jsx)(m.Input,{id:"ach-name",name:"name",required:!0,"data-testid":"input-achievement-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"ach-description",children:"Description"}),(0,b.jsx)(m.Input,{id:"ach-description",name:"description",required:!0,"data-testid":"input-achievement-description"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"criteria",children:"Criteria"}),(0,b.jsx)(m.Input,{id:"criteria",name:"criteria",required:!0,"data-testid":"input-achievement-criteria"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"rewardCoins",children:"Reward Coins"}),(0,b.jsx)(m.Input,{id:"rewardCoins",name:"rewardCoins",type:"number",required:!0,"data-testid":"input-achievement-reward"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:E.isPending,"data-testid":"button-submit-achievement",children:E.isPending?"Creating...":"Create Achievement"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:s?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Description"}),(0,b.jsx)(aa.TableHead,{children:"Criteria"}),(0,b.jsx)(aa.TableHead,{children:"Reward"}),(0,b.jsx)(aa.TableHead,{children:"Completion Rate"})]})}),(0,b.jsxs)(aa.TableBody,{children:[t.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`achievement-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium","data-testid":`achievement-name-${a.id}`,children:a.name}),(0,b.jsx)(aa.TableCell,{children:a.description}),(0,b.jsx)(aa.TableCell,{children:a.criteria}),(0,b.jsxs)(aa.TableCell,{children:[a.rewardCoins," coins"]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:[a.completionRate||0,"%"]})})]},a.id)),0===t.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No achievements created"})})]})]})})})})]}),(0,b.jsxs)(aA.TabsContent,{value:"leaderboards",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Leaderboards"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(ay.Select,{value:h,onValueChange:i,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48","data-testid":"select-leaderboard-type",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"contributors",children:"Top Contributors"}),(0,b.jsx)(ay.SelectItem,{value:"earners",children:"Top Earners"}),(0,b.jsx)(ay.SelectItem,{value:"uploaders",children:"Top Uploaders"})]})]}),(0,b.jsxs)(ay.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-40","data-testid":"select-time-period",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"weekly",children:"Weekly"}),(0,b.jsx)(ay.SelectItem,{value:"monthly",children:"Monthly"}),(0,b.jsx)(ay.SelectItem,{value:"all-time",children:"All Time"})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:v?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[...Array(10)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{className:"w-20",children:"Rank"}),(0,b.jsx)(aa.TableHead,{children:"User"}),(0,b.jsx)(aa.TableHead,{children:"Score"})]})}),(0,b.jsxs)(aa.TableBody,{children:[w.map((a,c)=>(0,b.jsxs)(aa.TableRow,{"data-testid":`leaderboard-${c}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[c<3&&(0,b.jsx)(R.Trophy,{className:`w-4 h-4 ${0===c?"text-yellow-500":1===c?"text-gray-400":"text-amber-700"}`}),(0,b.jsxs)("span",{className:"font-semibold",children:["#",c+1]})]})}),(0,b.jsx)(aa.TableCell,{"data-testid":`leaderboard-user-${c}`,children:a.username}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{children:a.score})})]},a.id)),0===w.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:3,className:"text-center text-muted-foreground py-8",children:"No data available"})})]})]})})})})]}),(0,b.jsxs)(aA.TabsContent,{value:"goals",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"User Goals Analytics"}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Goal Completion Rate"})}),(0,b.jsx)(_.CardContent,{children:B?(0,b.jsx)(p.Skeleton,{className:"h-64"}):C.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:C,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"completionRate",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Goals by Participation"})}),(0,b.jsx)(_.CardContent,{children:y?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):z.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:z,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"name"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"participants",fill:"hsl(var(--primary))"})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]})]})}var bF=a.i(452495);function bG(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(""),[f,g]=(0,e.useState)(!1),[h,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)(null),{data:n,isLoading:o}=(0,$.useQuery)({queryKey:["/api/admin/seo/content",c]}),q=Array.isArray(n)?n:[],{data:r,isLoading:s}=(0,$.useQuery)({queryKey:["/api/admin/seo/campaigns"]}),t=Array.isArray(r)?r:[],{data:u,isLoading:v}=(0,$.useQuery)({queryKey:["/api/admin/seo/campaign-stats"]}),w=u||{reach:0,conversions:0,roi:0},{data:x,isLoading:y}=(0,$.useQuery)({queryKey:["/api/admin/seo/search-rankings"]}),z=Array.isArray(x)?x:[],{data:A,isLoading:B}=(0,$.useQuery)({queryKey:["/api/admin/seo/top-queries"]}),C=Array.isArray(A)?A:[],{data:D,isLoading:E}=(0,$.useQuery)({queryKey:["/api/admin/seo/sitemap-status"]}),F=D||{totalUrls:0},H=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/seo/meta/${a.id}`,"PATCH",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/seo/content"]}),a({title:"Meta tags updated successfully"}),g(!1)}}),I=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/seo/campaigns","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/seo/campaigns"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/seo/campaign-stats"]}),a({title:"Campaign created successfully"}),i(!1)}}),J=(0,aw.useMutation)({mutationFn:()=>(0,aM.apiRequest)("/api/admin/seo/sitemap/generate","POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/seo/sitemap-status"]}),a({title:"Sitemap generated successfully"})}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"SEO & Marketing"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"meta",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"meta","data-testid":"tab-meta",children:"Meta Tags"}),(0,b.jsx)(aA.TabsTrigger,{value:"campaigns","data-testid":"tab-campaigns",children:"Campaigns"}),(0,b.jsx)(aA.TabsTrigger,{value:"analytics","data-testid":"tab-seo-analytics",children:"SEO Analytics"})]}),(0,b.jsxs)(aA.TabsContent,{value:"meta",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Meta Tags Management"}),(0,b.jsxs)("div",{className:"relative w-full md:w-auto md:min-w-80",children:[(0,b.jsx)(S.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,b.jsx)(m.Input,{placeholder:"Search content...",value:c,onChange:a=>d(a.target.value),className:"pl-10","data-testid":"input-search-content"})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:o?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Title"}),(0,b.jsx)(aa.TableHead,{children:"Type"}),(0,b.jsx)(aa.TableHead,{children:"Meta Title"}),(0,b.jsx)(aa.TableHead,{children:"Meta Description"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[q.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`content-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium max-w-xs truncate","data-testid":`content-title-${a.id}`,children:a.title}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"secondary",children:a.type})}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.metaTitle||"-"}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.metaDescription||"-"}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>{k(a),g(!0)},"data-testid":`button-edit-meta-${a.id}`,children:"Edit Meta"})})]},a.id)),0===q.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No content found"})})]})]})})})}),(0,b.jsx)(az.Dialog,{open:f,onOpenChange:g,children:(0,b.jsxs)(az.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Edit Meta Tags"})}),j&&(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);H.mutate({id:j.id,title:b.get("title"),description:b.get("description"),keywords:b.get("keywords")})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"title",children:"Meta Title"}),(0,b.jsx)(m.Input,{id:"title",name:"title",defaultValue:j.metaTitle,maxLength:60,"data-testid":"input-meta-title"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recommended: 50-60 characters"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"description",children:"Meta Description"}),(0,b.jsx)(ax.Textarea,{id:"description",name:"description",defaultValue:j.metaDescription,maxLength:160,rows:3,"data-testid":"textarea-meta-description"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recommended: 150-160 characters"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"keywords",children:"Keywords (comma-separated)"}),(0,b.jsx)(m.Input,{id:"keywords",name:"keywords",defaultValue:j.metaKeywords,"data-testid":"input-meta-keywords"})]}),(0,b.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"Search Result Preview"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-sm text-blue-600 hover:underline cursor-pointer",children:j.metaTitle||j.title}),(0,b.jsx)("div",{className:"text-xs text-green-700",children:"https://yoforex.com/..."}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:j.metaDescription||"No description provided"})]})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:H.isPending,"data-testid":"button-save-meta",children:H.isPending?"Saving...":"Save Changes"})})]})]})})]}),(0,b.jsxs)(aA.TabsContent,{value:"campaigns",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Marketing Campaigns"}),(0,b.jsxs)(az.Dialog,{open:h,onOpenChange:i,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-campaign",children:"Create Campaign"})}),(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create Marketing Campaign"})}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);I.mutate({name:b.get("name"),description:b.get("description"),startDate:b.get("startDate"),endDate:b.get("endDate"),budget:parseFloat(b.get("budget"))})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"camp-name",children:"Campaign Name"}),(0,b.jsx)(m.Input,{id:"camp-name",name:"name",required:!0,"data-testid":"input-campaign-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"camp-description",children:"Description"}),(0,b.jsx)(ax.Textarea,{id:"camp-description",name:"description",required:!0,"data-testid":"textarea-campaign-description"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"startDate",children:"Start Date"}),(0,b.jsx)(m.Input,{id:"startDate",name:"startDate",type:"date",required:!0,"data-testid":"input-campaign-start"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"endDate",children:"End Date"}),(0,b.jsx)(m.Input,{id:"endDate",name:"endDate",type:"date",required:!0,"data-testid":"input-campaign-end"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"budget",children:"Budget ($)"}),(0,b.jsx)(m.Input,{id:"budget",name:"budget",type:"number",step:"0.01",required:!0,"data-testid":"input-campaign-budget"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:I.isPending,"data-testid":"button-submit-campaign",children:I.isPending?"Creating...":"Create Campaign"})})]})]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:v?[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-campaign-reach",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Reach"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-campaign-reach",children:w.reach.toLocaleString()})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-campaign-conversions",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Conversions"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold","data-testid":"text-campaign-conversions",children:w.conversions})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-campaign-roi",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"ROI"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-campaign-roi",children:[w.roi,"%"]})})]})]})}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:s?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Start Date"}),(0,b.jsx)(aa.TableHead,{children:"End Date"}),(0,b.jsx)(aa.TableHead,{children:"Budget"}),(0,b.jsx)(aa.TableHead,{children:"Performance"})]})}),(0,b.jsxs)(aa.TableBody,{children:[t.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`campaign-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium","data-testid":`campaign-name-${a.id}`,children:a.name}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"active"===a.status?"default":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:new Date(a.startDate).toLocaleDateString()}),(0,b.jsx)(aa.TableCell,{children:new Date(a.endDate).toLocaleDateString()}),(0,b.jsxs)(aa.TableCell,{children:["$",a.budget.toLocaleString()]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"outline",children:[a.performance||0,"% CTR"]})})]},a.id)),0===t.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No campaigns created"})})]})]})})})})]}),(0,b.jsxs)(aA.TabsContent,{value:"analytics",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"SEO Analytics"}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Search Rankings"})}),(0,b.jsx)(_.CardContent,{children:y?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Page"}),(0,b.jsx)(aa.TableHead,{children:"Keyword"}),(0,b.jsx)(aa.TableHead,{children:"Position"}),(0,b.jsx)(aa.TableHead,{children:"Change"})]})}),(0,b.jsxs)(aa.TableBody,{children:[z.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.page}),(0,b.jsx)(aa.TableCell,{children:a.keyword}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:["#",a.position]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:(a.change??0)>0?"default":"destructive",children:[(a.change??0)>0?"+":"",a.change??0]})})]},a.id)),0===z.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No ranking data available"})})]})]})})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Top Search Queries"})}),(0,b.jsx)(_.CardContent,{children:B?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Query"}),(0,b.jsx)(aa.TableHead,{children:"Impressions"}),(0,b.jsx)(aa.TableHead,{children:"Clicks"}),(0,b.jsx)(aa.TableHead,{children:"CTR"})]})}),(0,b.jsxs)(aa.TableBody,{children:[C.map((a,c)=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:a.query}),(0,b.jsx)(aa.TableCell,{children:a.impressions.toLocaleString()}),(0,b.jsx)(aa.TableCell,{children:a.clicks.toLocaleString()}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"outline",children:[a.ctr,"%"]})})]},c)),0===C.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No query data available"})})]})]})})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,b.jsx)(_.CardTitle,{children:"Sitemap Status"}),(0,b.jsxs)(l.Button,{onClick:()=>J.mutate(),disabled:J.isPending,"data-testid":"button-generate-sitemap",children:[(0,b.jsx)(G.FileText,{className:"w-4 h-4 mr-2"}),"Generate Sitemap"]})]}),(0,b.jsx)(_.CardContent,{children:E?(0,b.jsx)(p.Skeleton,{className:"h-20"}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Last Generated:"}),(0,b.jsx)("span",{className:"font-medium",children:F.lastGenerated?(0,ag.formatDistanceToNow)(new Date(F.lastGenerated),{addSuffix:!0}):"Never"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total URLs:"}),(0,b.jsx)(au.Badge,{variant:"secondary",children:F.totalUrls})]}),F.sitemapUrl&&(0,b.jsx)("div",{className:"flex items-center gap-2 pt-2",children:(0,b.jsxs)("a",{href:F.sitemapUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline flex items-center gap-1",children:["View Sitemap ",(0,b.jsx)(bF.ExternalLink,{className:"w-3 h-3"})]})})]})})]})]})]})]})}var bH=a.i(331122),bI=a.i(481402);let bJ=(0,h.default)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]),bK=(0,h.default)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),bL=[{id:"user.created",label:"User Created"},{id:"user.updated",label:"User Updated"},{id:"content.published",label:"Content Published"},{id:"content.deleted",label:"Content Deleted"},{id:"transaction.completed",label:"Transaction Completed"},{id:"comment.posted",label:"Comment Posted"}];function bM(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[h,i]=(0,e.useState)(null),[j,k]=(0,e.useState)([]),[n,o]=(0,e.useState)("all"),[q,r]=(0,e.useState)("all"),[s,t]=(0,e.useState)("all"),{data:u,isLoading:v}=(0,$.useQuery)({queryKey:["/api/admin/integrations/api-keys"]}),w=Array.isArray(u)?u:[],{data:x,isLoading:y}=(0,$.useQuery)({queryKey:["/api/admin/integrations/webhooks"]}),z=Array.isArray(x)?x:[],{data:A,isLoading:B}=(0,$.useQuery)({queryKey:["/api/admin/integrations/event-logs",n,q,s]}),C=Array.isArray(A)?A:[],D=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/integrations/api-keys","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/api-keys"]}),a({title:"API key created successfully"}),d(!1)}}),E=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/integrations/api-keys/${a}/revoke`,"DELETE"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/api-keys"]}),a({title:"API key revoked"}),i(null)}}),F=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/integrations/webhooks","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/webhooks"]}),a({title:"Webhook created successfully"}),g(!1),k([])}}),G=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/integrations/webhooks/${a}/test`,"POST"),onSuccess:()=>{a({title:"Test webhook sent"})}}),H=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/integrations/event-logs/${a}/retry`,"POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/integrations/event-logs"]}),a({title:"Event retry initiated"})}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"API & Integrations"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"api-keys",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"api-keys","data-testid":"tab-api-keys",children:"API Keys"}),(0,b.jsx)(aA.TabsTrigger,{value:"webhooks","data-testid":"tab-webhooks",children:"Webhooks"}),(0,b.jsx)(aA.TabsTrigger,{value:"event-logs","data-testid":"tab-event-logs",children:"Event Logs"})]}),(0,b.jsxs)(aA.TabsContent,{value:"api-keys",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"API Keys"}),(0,b.jsxs)(az.Dialog,{open:c,onOpenChange:d,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(l.Button,{"data-testid":"button-create-api-key",children:[(0,b.jsx)(bI.Key,{className:"w-4 h-4 mr-2"}),"Create API Key"]})}),(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create API Key"})}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);D.mutate({name:b.get("name"),permissions:b.get("permissions"),rateLimit:parseInt(b.get("rateLimit"))})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"key-name",children:"Name"}),(0,b.jsx)(m.Input,{id:"key-name",name:"name",required:!0,"data-testid":"input-api-key-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"permissions",children:"Permissions"}),(0,b.jsxs)(ay.Select,{name:"permissions",required:!0,children:[(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-api-key-permissions",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select permissions"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"read",children:"Read Only"}),(0,b.jsx)(ay.SelectItem,{value:"write",children:"Read & Write"}),(0,b.jsx)(ay.SelectItem,{value:"admin",children:"Admin"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"rateLimit",children:"Rate Limit (requests/hour)"}),(0,b.jsx)(m.Input,{id:"rateLimit",name:"rateLimit",type:"number",defaultValue:"1000",required:!0,"data-testid":"input-api-key-rate-limit"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:D.isPending,"data-testid":"button-submit-api-key",children:D.isPending?"Creating...":"Create API Key"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:v?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Key"}),(0,b.jsx)(aa.TableHead,{children:"Permissions"}),(0,b.jsx)(aa.TableHead,{children:"Rate Limit"}),(0,b.jsx)(aa.TableHead,{children:"Last Used"}),(0,b.jsx)(aa.TableHead,{children:"Usage"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[w.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`api-key-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium","data-testid":`api-key-name-${a.id}`,children:a.name}),(0,b.jsxs)(aa.TableCell,{className:"font-mono text-xs",children:[a.key.substring(0,12),"...",a.key.substring(a.key.length-4)]}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.permissions})}),(0,b.jsxs)(aa.TableCell,{children:[a.rateLimit,"/hr"]}),(0,b.jsx)(aa.TableCell,{children:a.lastUsedAt?(0,ag.formatDistanceToNow)(new Date(a.lastUsedAt),{addSuffix:!0}):"Never"}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:[a.usageCount||0," requests"]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>i(a.id),"data-testid":`button-revoke-${a.id}`,children:"Revoke"})})]},a.id)),0===w.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No API keys created"})})]})]})})})}),(0,b.jsx)(bH.AlertDialog,{open:!!h,onOpenChange:a=>!a&&i(null),children:(0,b.jsxs)(bH.AlertDialogContent,{children:[(0,b.jsxs)(bH.AlertDialogHeader,{children:[(0,b.jsx)(bH.AlertDialogTitle,{children:"Revoke API Key"}),(0,b.jsx)(bH.AlertDialogDescription,{children:"Are you sure you want to revoke this API key? This action cannot be undone and will immediately invalidate the key."})]}),(0,b.jsxs)(bH.AlertDialogFooter,{children:[(0,b.jsx)(bH.AlertDialogCancel,{"data-testid":"button-cancel-revoke",children:"Cancel"}),(0,b.jsx)(bH.AlertDialogAction,{onClick:()=>h&&E.mutate(h),"data-testid":"button-confirm-revoke",children:"Revoke"})]})]})})]}),(0,b.jsxs)(aA.TabsContent,{value:"webhooks",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Webhooks"}),(0,b.jsxs)(az.Dialog,{open:f,onOpenChange:g,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(l.Button,{"data-testid":"button-create-webhook",children:[(0,b.jsx)(bJ,{className:"w-4 h-4 mr-2"}),"Create Webhook"]})}),(0,b.jsxs)(az.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create Webhook"})}),(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault();let c=new FormData(b.currentTarget);0===j.length?a({title:"Please select at least one event",variant:"destructive"}):F.mutate({url:c.get("url"),events:j,secret:c.get("secret")})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"url",children:"Webhook URL"}),(0,b.jsx)(m.Input,{id:"url",name:"url",type:"url",placeholder:"https://example.com/webhook",required:!0,"data-testid":"input-webhook-url"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{children:"Events"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 p-4 border rounded-lg",children:bL.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aO.Checkbox,{id:a.id,checked:j.includes(a.id),onCheckedChange:b=>{k(b?[...j,a.id]:j.filter(b=>b!==a.id))},"data-testid":`checkbox-event-${a.id}`}),(0,b.jsx)(bu.Label,{htmlFor:a.id,className:"text-sm cursor-pointer",children:a.label})]},a.id))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"secret",children:"Secret (optional)"}),(0,b.jsx)(m.Input,{id:"secret",name:"secret",placeholder:"Webhook signing secret","data-testid":"input-webhook-secret"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used to verify webhook authenticity"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:F.isPending,"data-testid":"button-submit-webhook",children:F.isPending?"Creating...":"Create Webhook"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:y?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"URL"}),(0,b.jsx)(aa.TableHead,{children:"Events"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Success"}),(0,b.jsx)(aa.TableHead,{children:"Failures"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[z.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`webhook-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-mono text-xs max-w-xs truncate","data-testid":`webhook-url-${a.id}`,children:a.url}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.events?.slice(0,2).map(a=>(0,b.jsx)(au.Badge,{variant:"secondary",className:"text-xs",children:a},a)),(a.events?.length??0)>2&&(0,b.jsxs)(au.Badge,{variant:"secondary",className:"text-xs",children:["+",(a.events?.length??0)-2]})]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:a.active?"default":"secondary",children:a.active?"Active":"Inactive"})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"outline",children:a.successCount||0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:(a.failureCount??0)>0?"destructive":"outline",children:a.failureCount||0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>G.mutate(a.id),disabled:G.isPending,"data-testid":`button-test-webhook-${a.id}`,children:"Test"})})]},a.id)),0===z.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No webhooks configured"})})]})]})})})})]}),(0,b.jsxs)(aA.TabsContent,{value:"event-logs",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Event Logs"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(ay.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48","data-testid":"select-filter-webhook",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Webhooks"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Webhooks"}),z.map(a=>(0,b.jsxs)(ay.SelectItem,{value:a.id,children:[a.url.substring(0,30),"..."]},a.id))]})]}),(0,b.jsxs)(ay.Select,{value:q,onValueChange:r,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-48","data-testid":"select-filter-event-type",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Events"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Events"}),bL.map(a=>(0,b.jsx)(ay.SelectItem,{value:a.id,children:a.label},a.id))]})]}),(0,b.jsxs)(ay.Select,{value:s,onValueChange:t,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-40","data-testid":"select-filter-status",children:(0,b.jsx)(ay.SelectValue,{placeholder:"All Status"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(ay.SelectItem,{value:"success",children:"Success"}),(0,b.jsx)(ay.SelectItem,{value:"failed",children:"Failed"}),(0,b.jsx)(ay.SelectItem,{value:"pending",children:"Pending"})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:B?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[...Array(10)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Event Type"}),(0,b.jsx)(aa.TableHead,{children:"Webhook"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Response"}),(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[C.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"secondary",children:a.eventType})}),(0,b.jsx)(aa.TableCell,{className:"font-mono text-xs max-w-xs truncate",children:a.webhookUrl}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"success"===a.status?"default":"failed"===a.status?"destructive":"secondary",children:a.status})}),(0,b.jsx)(aa.TableCell,{className:"max-w-xs truncate",children:a.response||"-"}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:"failed"===a.status&&(0,b.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:()=>H.mutate(a.id),disabled:H.isPending,"data-testid":`button-retry-${a.id}`,children:[(0,b.jsx)(bK,{className:"w-3 h-3 mr-1"}),"Retry"]})})]},a.id)),0===C.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No event logs found"})})]})]})})})})]})]})]})}var bN=a.i(523312);let bO=["hsl(var(--primary))","hsl(var(--accent))","hsl(var(--muted))","hsl(var(--destructive))"];function bP(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)("all"),{data:f,isLoading:g}=(0,$.useQuery)({queryKey:["/api/admin/mobile/notification-history"]}),h=Array.isArray(f)?f:[],{data:i,isLoading:j}=(0,$.useQuery)({queryKey:["/api/admin/mobile/app-versions"]}),k=Array.isArray(i)?i:[],{data:n,isLoading:o}=(0,$.useQuery)({queryKey:["/api/admin/mobile/version-distribution"]}),q=Array.isArray(n)?n:[],{data:r,isLoading:s}=(0,$.useQuery)({queryKey:["/api/admin/mobile/device-types"]}),t=Array.isArray(r)?r:[],{data:u,isLoading:v}=(0,$.useQuery)({queryKey:["/api/admin/mobile/os-distribution"]}),w=Array.isArray(u)?u:[],{data:x,isLoading:y}=(0,$.useQuery)({queryKey:["/api/admin/mobile/browser-distribution"]}),z=Array.isArray(x)?x:[],{data:A,isLoading:B}=(0,$.useQuery)({queryKey:["/api/admin/mobile/screen-resolutions"]}),C=Array.isArray(A)?A:[],D=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/mobile/send-notification","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/mobile/notification-history"]}),a({title:"Notification sent successfully"})}}),E=(0,aw.useMutation)({mutationFn:({id:a,forceUpdate:b})=>(0,aM.apiRequest)(`/api/admin/mobile/app-versions/${a}/force-update`,"PATCH",{forceUpdate:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/mobile/app-versions"]}),a({title:"Force update setting updated"})}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Mobile & Push Notifications"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"push",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"push","data-testid":"tab-push",children:"Push Notifications"}),(0,b.jsx)(aA.TabsTrigger,{value:"versions","data-testid":"tab-versions",children:"App Versions"}),(0,b.jsx)(aA.TabsTrigger,{value:"analytics","data-testid":"tab-device-analytics",children:"Device Analytics"})]}),(0,b.jsxs)(aA.TabsContent,{value:"push",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Send Push Notification"}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"pt-6",children:(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);D.mutate({title:b.get("title"),body:b.get("body"),targetType:c,targetValue:b.get("targetValue")})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"title",children:"Notification Title"}),(0,b.jsx)(m.Input,{id:"title",name:"title",required:!0,"data-testid":"input-notification-title"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"body",children:"Notification Body"}),(0,b.jsx)(ax.Textarea,{id:"body",name:"body",rows:3,required:!0,"data-testid":"textarea-notification-body"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{children:"Target"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aO.Checkbox,{id:"target-all",checked:"all"===c,onCheckedChange:()=>d("all"),"data-testid":"checkbox-target-all"}),(0,b.jsx)(bu.Label,{htmlFor:"target-all",className:"cursor-pointer",children:"All Users"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aO.Checkbox,{id:"target-segments",checked:"segments"===c,onCheckedChange:()=>d("segments"),"data-testid":"checkbox-target-segments"}),(0,b.jsx)(bu.Label,{htmlFor:"target-segments",className:"cursor-pointer",children:"Specific Segments"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aO.Checkbox,{id:"target-users",checked:"users"===c,onCheckedChange:()=>d("users"),"data-testid":"checkbox-target-users"}),(0,b.jsx)(bu.Label,{htmlFor:"target-users",className:"cursor-pointer",children:"Specific User IDs"})]})]})]}),("segments"===c||"users"===c)&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"targetValue",children:"segments"===c?"Segment Names (comma-separated)":"User IDs (comma-separated)"}),(0,b.jsx)(m.Input,{id:"targetValue",name:"targetValue",placeholder:"segments"===c?"premium, active-traders":"user-123, user-456","data-testid":"input-target-value"})]}),(0,b.jsxs)(l.Button,{type:"submit",disabled:D.isPending,"data-testid":"button-send-notification",children:[(0,b.jsx)(bN.Bell,{className:"w-4 h-4 mr-2"}),D.isPending?"Sending...":"Send Notification"]})]})})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Notification History"})}),(0,b.jsx)(_.CardContent,{children:g?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Title"}),(0,b.jsx)(aa.TableHead,{children:"Target"}),(0,b.jsx)(aa.TableHead,{children:"Delivered"}),(0,b.jsx)(aa.TableHead,{children:"Opened"}),(0,b.jsx)(aa.TableHead,{children:"CTR"}),(0,b.jsx)(aa.TableHead,{children:"Sent At"})]})}),(0,b.jsxs)(aa.TableBody,{children:[h.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-medium max-w-xs truncate",children:a.title}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"secondary",children:a.targetType})}),(0,b.jsx)(aa.TableCell,{children:a.deliveredCount}),(0,b.jsx)(aa.TableCell,{children:a.openedCount}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"outline",children:[a.ctr,"%"]})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.sentAt),{addSuffix:!0})})]},a.id)),0===h.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No notifications sent yet"})})]})]})})})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"versions",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"App Versions"}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:j?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Version"}),(0,b.jsx)(aa.TableHead,{children:"Platform"}),(0,b.jsx)(aa.TableHead,{children:"Release Date"}),(0,b.jsx)(aa.TableHead,{children:"Users"}),(0,b.jsx)(aa.TableHead,{children:"Force Update"})]})}),(0,b.jsxs)(aa.TableBody,{children:[k.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`version-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:a.version}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"secondary",children:a.platform})}),(0,b.jsx)(aa.TableCell,{children:new Date(a.releaseDate).toLocaleDateString()}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"outline",children:[a.userCount," users"]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(bs.Switch,{checked:a.forceUpdate,onCheckedChange:b=>E.mutate({id:a.id,forceUpdate:b}),"data-testid":`switch-force-update-${a.id}`})})]},a.id)),0===k.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No app versions found"})})]})]})})})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"User Distribution by Version"})}),(0,b.jsx)(_.CardContent,{children:o?(0,b.jsx)(p.Skeleton,{className:"h-64"}):q.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:q,cx:"50%",cy:"50%",labelLine:!1,label:a=>`v${a.version}: ${a.percentage}%`,outerRadius:80,fill:"hsl(var(--primary))",dataKey:"count",children:q.map((a,c)=>(0,b.jsx)(an.Cell,{fill:bO[c%bO.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"analytics",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Device Analytics"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Device Types"})}),(0,b.jsx)(_.CardContent,{children:s?(0,b.jsx)(p.Skeleton,{className:"h-64"}):t.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(al.PieChart,{children:[(0,b.jsx)(am.Pie,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:a=>`${a.name}: ${a.percentage}%`,outerRadius:80,fill:"hsl(var(--primary))",dataKey:"value",children:t.map((a,c)=>(0,b.jsx)(an.Cell,{fill:bO[c%bO.length]},`cell-${c}`))}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(at.Legend,{})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"OS Distribution"})}),(0,b.jsx)(_.CardContent,{children:v?(0,b.jsx)(p.Skeleton,{className:"h-64"}):w.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:w,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"name"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Browser Distribution"})}),(0,b.jsx)(_.CardContent,{children:y?(0,b.jsx)(p.Skeleton,{className:"h-64"}):z.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:z,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"name"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Screen Resolutions"})}),(0,b.jsx)(_.CardContent,{children:B?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-8"},c))}):C.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Resolution"}),(0,b.jsx)(aa.TableHead,{children:"Users"}),(0,b.jsx)(aa.TableHead,{children:"Percentage"})]})}),(0,b.jsx)(aa.TableBody,{children:C.map((a,c)=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:a.resolution}),(0,b.jsx)(aa.TableCell,{children:a.count}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:[a.percentage,"%"]})})]},c))})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]})]})]})}let bQ=(0,h.default)("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),bR=(0,h.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function bS(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),{data:h,isLoading:i}=(0,$.useQuery)({queryKey:["/api/admin/performance/system-metrics"]}),j=h||{cpu:0,memory:0,diskIO:0,network:0},{data:k,isLoading:n}=(0,$.useQuery)({queryKey:["/api/admin/performance/response-time"]}),o=Array.isArray(k)?k:[],{data:q,isLoading:r}=(0,$.useQuery)({queryKey:["/api/admin/performance/throughput"]}),s=Array.isArray(q)?q:[],{data:t,isLoading:u}=(0,$.useQuery)({queryKey:["/api/admin/performance/alerts"]}),v=Array.isArray(t)?t:[],{data:w,isLoading:x}=(0,$.useQuery)({queryKey:["/api/admin/performance/alert-history"]}),y=Array.isArray(w)?w:[],{data:z,isLoading:A}=(0,$.useQuery)({queryKey:["/api/admin/performance/slow-queries"]}),B=Array.isArray(z)?z:[],{data:C,isLoading:D}=(0,$.useQuery)({queryKey:["/api/admin/performance/database-metrics"]}),E=C||{avgQueryTime:0,activeConnections:0,maxConnections:0,poolUsage:0},{data:F,isLoading:G}=(0,$.useQuery)({queryKey:["/api/admin/performance/query-histogram"]}),H=Array.isArray(F)?F:[],{data:I,isLoading:J}=(0,$.useQuery)({queryKey:["/api/admin/performance/cache-stats"]}),K=I||{hitRate:0,hits:0,misses:0,size:0,keyCount:0},{data:L,isLoading:M}=(0,$.useQuery)({queryKey:["/api/admin/performance/cached-keys"]}),N=Array.isArray(L)?L:[],O=(0,aw.useMutation)({mutationFn:()=>(0,aM.apiRequest)("/api/admin/performance/record-metric","POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/performance/system-metrics"]}),a({title:"Metric recorded"})}}),P=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/performance/alerts","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/performance/alerts"]}),a({title:"Alert threshold configured"}),d(!1)}}),Q=(0,aw.useMutation)({mutationFn:()=>(0,aM.apiRequest)("/api/admin/performance/cache/clear","DELETE"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/performance/cache-stats"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/performance/cached-keys"]}),a({title:"Cache cleared successfully"}),g(!1)}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Performance Monitor"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"metrics",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"metrics","data-testid":"tab-metrics",children:"Metrics"}),(0,b.jsx)(aA.TabsTrigger,{value:"alerts","data-testid":"tab-alerts",children:"Alerts"}),(0,b.jsx)(aA.TabsTrigger,{value:"database","data-testid":"tab-database",children:"Database Performance"}),(0,b.jsx)(aA.TabsTrigger,{value:"cache","data-testid":"tab-cache",children:"Cache Stats"})]}),(0,b.jsxs)(aA.TabsContent,{value:"metrics",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"System Metrics"}),(0,b.jsxs)(l.Button,{onClick:()=>O.mutate(),disabled:O.isPending,"data-testid":"button-record-metric",children:[(0,b.jsx)(V.Activity,{className:"w-4 h-4 mr-2"}),"Record Metric"]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i?[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-cpu",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"CPU Usage"}),(0,b.jsx)(bQ,{className:"w-4 h-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-cpu-usage",children:[j.cpu,"%"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-memory",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Memory Usage"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-memory-usage",children:[j.memory,"%"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-disk",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Disk I/O"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-disk-io",children:[j.diskIO," MB/s"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-network",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Network"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-network",children:[j.network," MB/s"]})})]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Response Time (Last 24 Hours)"})}),(0,b.jsx)(_.CardContent,{children:n?(0,b.jsx)(p.Skeleton,{className:"h-64"}):o.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:o,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"time"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"responseTime",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Throughput (Requests/Second)"})}),(0,b.jsx)(_.CardContent,{children:r?(0,b.jsx)(p.Skeleton,{className:"h-64"}):s.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(ah.LineChart,{data:s,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"time"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ai.Line,{type:"monotone",dataKey:"rps",stroke:"hsl(var(--primary))",strokeWidth:2})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"alerts",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Performance Alerts"}),(0,b.jsxs)(az.Dialog,{open:c,onOpenChange:d,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-configure-alert",children:"Configure Alert"})}),(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Configure Alert Threshold"})}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget);P.mutate({metricType:b.get("metricType"),threshold:parseFloat(b.get("threshold")),condition:b.get("condition")})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"metricType",children:"Metric Type"}),(0,b.jsx)(m.Input,{id:"metricType",name:"metricType",required:!0,"data-testid":"input-metric-type"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"threshold",children:"Threshold Value"}),(0,b.jsx)(m.Input,{id:"threshold",name:"threshold",type:"number",step:"0.01",required:!0,"data-testid":"input-threshold"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"condition",children:"Condition"}),(0,b.jsx)(m.Input,{id:"condition",name:"condition",placeholder:"e.g., greater than",required:!0,"data-testid":"input-condition"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:P.isPending,"data-testid":"button-submit-alert",children:P.isPending?"Configuring...":"Configure Alert"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:u?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Metric"}),(0,b.jsx)(aa.TableHead,{children:"Condition"}),(0,b.jsx)(aa.TableHead,{children:"Threshold"}),(0,b.jsx)(aa.TableHead,{children:"Current Value"}),(0,b.jsx)(aa.TableHead,{children:"Status"})]})}),(0,b.jsxs)(aa.TableBody,{children:[v.map(a=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:a.metricType}),(0,b.jsx)(aa.TableCell,{children:a.condition}),(0,b.jsx)(aa.TableCell,{children:a.threshold}),(0,b.jsx)(aa.TableCell,{children:a.currentValue}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:a.triggered?"destructive":"default",children:a.triggered?"Triggered":"OK"})})]},a.id)),0===v.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No alerts configured"})})]})]})})})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Alert History"})}),(0,b.jsx)(_.CardContent,{children:x?(0,b.jsx)(p.Skeleton,{className:"h-64"}):y.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:y,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"date"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"count",fill:"hsl(var(--destructive))"})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No alert history"})})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"database",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Database Performance"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:D?[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-query-time",children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Avg Query Time"}),(0,b.jsx)(bR,{className:"w-4 h-4 text-muted-foreground"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-query-time",children:[E.avgQueryTime,"ms"]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-connections",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Active Connections"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-connections",children:[E.activeConnections," / ",E.maxConnections]})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-pool-usage",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Pool Usage"})}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-pool-usage",children:[E.poolUsage,"%"]})})]})]})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Slow Queries"})}),(0,b.jsx)(_.CardContent,{children:A?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Query"}),(0,b.jsx)(aa.TableHead,{children:"Execution Time"}),(0,b.jsx)(aa.TableHead,{children:"Calls"}),(0,b.jsx)(aa.TableHead,{children:"Last Run"})]})}),(0,b.jsxs)(aa.TableBody,{children:[B.map((a,c)=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-mono text-xs max-w-md truncate",children:a.query}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"destructive",children:[a.executionTime,"ms"]})}),(0,b.jsx)(aa.TableCell,{children:a.callCount}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.lastRun),{addSuffix:!0})})]},c)),0===B.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No slow queries detected"})})]})]})})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Query Execution Time Histogram"})}),(0,b.jsx)(_.CardContent,{children:G?(0,b.jsx)(p.Skeleton,{className:"h-64"}):H.length>0?(0,b.jsx)(as.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(aj.BarChart,{data:H,children:[(0,b.jsx)(aq.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ao.XAxis,{dataKey:"range"}),(0,b.jsx)(ap.YAxis,{}),(0,b.jsx)(ar.Tooltip,{}),(0,b.jsx)(ak.Bar,{dataKey:"count",fill:"hsl(var(--primary))"})]})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No data available"})})]})]}),(0,b.jsxs)(aA.TabsContent,{value:"cache",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Cache Statistics"}),(0,b.jsxs)(l.Button,{variant:"destructive",onClick:()=>g(!0),"data-testid":"button-clear-cache",children:[(0,b.jsx)(aZ.Trash2,{className:"w-4 h-4 mr-2"}),"Clear Cache"]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:J?[void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-32"},c)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(_.Card,{"data-testid":"card-hit-rate",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Cache Hit Rate"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-hit-rate",children:[K.hitRate,"%"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[K.hits," hits / ",K.misses," misses"]})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-cache-size",children:[(0,b.jsx)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Cache Size"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-cache-size",children:[K.size," MB"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[K.keyCount," keys stored"]})]})]})]})}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Most Cached Keys"})}),(0,b.jsx)(_.CardContent,{children:M?(0,b.jsx)("div",{className:"space-y-2",children:[...Array(10)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Key"}),(0,b.jsx)(aa.TableHead,{children:"Hits"}),(0,b.jsx)(aa.TableHead,{children:"Size"}),(0,b.jsx)(aa.TableHead,{children:"TTL"})]})}),(0,b.jsxs)(aa.TableBody,{children:[N.map((a,c)=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-mono text-xs max-w-md truncate",children:a.key}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"secondary",children:a.hits})}),(0,b.jsxs)(aa.TableCell,{children:[a.size," KB"]}),(0,b.jsxs)(aa.TableCell,{children:[a.ttl,"s"]})]},c)),0===N.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:4,className:"text-center text-muted-foreground py-8",children:"No cached keys"})})]})]})})})]})]})]}),(0,b.jsx)(bH.AlertDialog,{open:f,onOpenChange:g,children:(0,b.jsxs)(bH.AlertDialogContent,{children:[(0,b.jsxs)(bH.AlertDialogHeader,{children:[(0,b.jsx)(bH.AlertDialogTitle,{children:"Clear Cache"}),(0,b.jsx)(bH.AlertDialogDescription,{children:"Are you sure you want to clear the entire cache? This action cannot be undone and may temporarily affect performance."})]}),(0,b.jsxs)(bH.AlertDialogFooter,{children:[(0,b.jsx)(bH.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(bH.AlertDialogAction,{onClick:()=>Q.mutate(),className:"bg-destructive hover:bg-destructive/90",children:"Clear Cache"})]})]})})]})}var bT=a.i(773320),bU=a.i(838632);let bV=(0,h.default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function bW(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(""),[f,g]=(0,e.useState)("all"),[h,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)(null),[n,o]=(0,e.useState)(null),[q,r]=(0,e.useState)(""),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)(!1),[w,x]=(0,e.useState)(null),{data:y,isLoading:z}=(0,$.useQuery)({queryKey:["/api/admin/content-studio/media",c,f]}),A=Array.isArray(y)?y:[],{data:B,isLoading:C}=(0,$.useQuery)({queryKey:["/api/admin/content-studio/revisions",q,s],enabled:!!q&&!!s}),D=Array.isArray(B)?B:[],E=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/content-studio/media/upload","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/media"]}),a({title:"Media uploaded successfully"})}}),F=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/content-studio/media/${a.id}`,"PATCH",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/media"]}),a({title:"Media updated successfully"}),i(!1)}}),H=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/content-studio/media/${a}`,"DELETE"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/media"]}),a({title:"Media deleted successfully"}),k(null)}}),I=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/content-studio/revisions/${a}/restore`,"POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/content-studio/revisions"]}),a({title:"Revision restored successfully"}),v(!1)}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Content Studio"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"media",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"media","data-testid":"tab-media",children:"Media Library"}),(0,b.jsx)(aA.TabsTrigger,{value:"revisions","data-testid":"tab-revisions",children:"Content Revisions"})]}),(0,b.jsxs)(aA.TabsContent,{value:"media",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Media Library"}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(m.Input,{placeholder:"Search files...",value:c,onChange:a=>d(a.target.value),className:"w-64","data-testid":"input-search-media"}),(0,b.jsxs)(ay.Select,{value:f,onValueChange:g,children:[(0,b.jsx)(ay.SelectTrigger,{className:"w-40","data-testid":"select-file-type",children:(0,b.jsx)(ay.SelectValue,{})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"all",children:"All Types"}),(0,b.jsx)(ay.SelectItem,{value:"images",children:"Images"}),(0,b.jsx)(ay.SelectItem,{value:"documents",children:"Documents"}),(0,b.jsx)(ay.SelectItem,{value:"videos",children:"Videos"})]})]}),(0,b.jsx)(l.Button,{asChild:!0,"data-testid":"button-upload-media",children:(0,b.jsxs)("label",{className:"cursor-pointer",children:[(0,b.jsx)(bT.Upload,{className:"w-4 h-4 mr-2"}),"Upload File",(0,b.jsx)("input",{type:"file",className:"hidden",onChange:a=>{let b=a.target.files?.[0];if(b){let a=new FormData;a.append("file",b),E.mutate(a)}},accept:"image/*,video/*,.pdf,.doc,.docx"})]})})]})]}),z?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[...Array(8)].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-64"},c))}):(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[A.map(a=>{var c;return(0,b.jsxs)(_.Card,{"data-testid":`media-card-${a.id}`,children:[(0,b.jsx)(_.CardHeader,{className:"p-0",children:(0,b.jsx)("div",{className:"aspect-video bg-muted rounded-t-lg flex items-center justify-center overflow-hidden",children:a.type?.startsWith("image/")?(0,b.jsx)("img",{src:a.url,alt:a.altText||a.filename,className:"w-full h-full object-cover"}):(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[(c=a.type).startsWith("image/")?(0,b.jsx)(bU.Image,{className:"w-4 h-4"}):c.startsWith("video/")?(0,b.jsx)(bV,{className:"w-4 h-4"}):(0,b.jsx)(G.FileText,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-xs",children:a.type})]})})}),(0,b.jsxs)(_.CardContent,{className:"pt-4 space-y-2",children:[(0,b.jsx)("div",{className:"font-medium truncate","data-testid":`media-filename-${a.id}`,children:a.filename}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.tags?.map((a,c)=>(0,b.jsx)(au.Badge,{variant:"secondary",className:"text-xs",children:a},c))}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Used ",a.usageCount||0," times"]})]}),(0,b.jsxs)(_.CardFooter,{className:"flex justify-between gap-2",children:[(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>{o(a),i(!0)},"data-testid":`button-edit-media-${a.id}`,children:"Edit"}),(0,b.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>k(a.id),"data-testid":`button-delete-media-${a.id}`,children:(0,b.jsx)(aZ.Trash2,{className:"w-3 h-3"})})]})]},a.id)}),0===A.length&&(0,b.jsx)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"No media files found"})]}),(0,b.jsx)(az.Dialog,{open:h,onOpenChange:i,children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Edit Media"})}),n&&(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget),c=b.get("tags").split(",").map(a=>a.trim()).filter(Boolean);F.mutate({id:n?.id,altText:b.get("altText"),tags:c})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"altText",children:"Alt Text"}),(0,b.jsx)(m.Input,{id:"altText",name:"altText",defaultValue:n.altText,"data-testid":"input-alt-text"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"tags",children:"Tags (comma-separated)"}),(0,b.jsx)(m.Input,{id:"tags",name:"tags",defaultValue:n.tags?.join(", "),placeholder:"tag1, tag2, tag3","data-testid":"input-tags"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:F.isPending,"data-testid":"button-save-media",children:F.isPending?"Saving...":"Save Changes"})})]})]})}),(0,b.jsx)(bH.AlertDialog,{open:!!j,onOpenChange:a=>!a&&k(null),children:(0,b.jsxs)(bH.AlertDialogContent,{children:[(0,b.jsxs)(bH.AlertDialogHeader,{children:[(0,b.jsx)(bH.AlertDialogTitle,{children:"Delete Media"}),(0,b.jsx)(bH.AlertDialogDescription,{children:"Are you sure you want to delete this media file? This action cannot be undone."})]}),(0,b.jsxs)(bH.AlertDialogFooter,{children:[(0,b.jsx)(bH.AlertDialogCancel,{"data-testid":"button-cancel-delete",children:"Cancel"}),(0,b.jsx)(bH.AlertDialogAction,{onClick:()=>j&&H.mutate(j),"data-testid":"button-confirm-delete",children:"Delete"})]})]})})]}),(0,b.jsxs)(aA.TabsContent,{value:"revisions",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Content Revisions"}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"pt-6 space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"contentType",children:"Content Type"}),(0,b.jsxs)(ay.Select,{value:q,onValueChange:r,children:[(0,b.jsx)(ay.SelectTrigger,{"data-testid":"select-content-type",children:(0,b.jsx)(ay.SelectValue,{placeholder:"Select type"})}),(0,b.jsxs)(ay.SelectContent,{children:[(0,b.jsx)(ay.SelectItem,{value:"thread",children:"Thread"}),(0,b.jsx)(ay.SelectItem,{value:"comment",children:"Comment"}),(0,b.jsx)(ay.SelectItem,{value:"content",children:"Content"}),(0,b.jsx)(ay.SelectItem,{value:"user",children:"User Profile"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"contentId",children:"Content ID"}),(0,b.jsx)(m.Input,{id:"contentId",value:s,onChange:a=>t(a.target.value),placeholder:"Enter content ID","data-testid":"input-content-id"})]})]})})}),q&&s&&(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsx)(_.CardTitle,{children:"Revision History"})}),(0,b.jsx)(_.CardContent,{children:C?(0,b.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Revision #"}),(0,b.jsx)(aa.TableHead,{children:"Changed By"}),(0,b.jsx)(aa.TableHead,{children:"Changed Fields"}),(0,b.jsx)(aa.TableHead,{children:"Timestamp"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[D.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`revision-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:["#",a.revisionNumber]})}),(0,b.jsx)(aa.TableCell,{children:a.changedBy}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.changedFields?.map((a,c)=>(0,b.jsx)(au.Badge,{variant:"outline",className:"text-xs",children:a},c))})}),(0,b.jsx)(aa.TableCell,{children:(0,ag.formatDistanceToNow)(new Date(a.timestamp),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(l.Button,{size:"sm",variant:"outline","data-testid":`button-view-diff-${a.id}`,children:[(0,b.jsx)(aT.Eye,{className:"w-3 h-3 mr-1"}),"View Diff"]}),(0,b.jsx)(l.Button,{size:"sm",variant:"default",onClick:()=>{x(a),v(!0)},"data-testid":`button-restore-${a.id}`,children:"Restore"})]})})]},a.id)),0===D.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No revisions found"})})]})]})})})]}),(0,b.jsx)(bH.AlertDialog,{open:u,onOpenChange:v,children:(0,b.jsxs)(bH.AlertDialogContent,{children:[(0,b.jsxs)(bH.AlertDialogHeader,{children:[(0,b.jsx)(bH.AlertDialogTitle,{children:"Restore Revision"}),(0,b.jsxs)(bH.AlertDialogDescription,{children:["Are you sure you want to restore this revision? This will overwrite the current content with revision #",w?.revisionNumber,"."]})]}),(0,b.jsxs)(bH.AlertDialogFooter,{children:[(0,b.jsx)(bH.AlertDialogCancel,{"data-testid":"button-cancel-restore",children:"Cancel"}),(0,b.jsx)(bH.AlertDialogAction,{onClick:()=>w&&I.mutate(w.id),"data-testid":"button-confirm-restore",children:"Restore"})]})]})})]})]})]})}let bX=(0,h.default)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function bY(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[h,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)(null),[n,o]=(0,e.useState)([0]),{data:q,isLoading:r}=(0,$.useQuery)({queryKey:["/api/admin/testing/ab-tests"]}),s=Array.isArray(q)?q:[],{data:t,isLoading:u}=(0,$.useQuery)({queryKey:["/api/admin/testing/feature-flags"]}),v=Array.isArray(t)?t:[],w=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/testing/ab-tests","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),a({title:"A/B test created successfully"}),d(!1)}}),x=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/testing/ab-tests/${a}/start`,"POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),a({title:"Test started"})}}),y=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)(`/api/admin/testing/ab-tests/${a}/stop`,"POST"),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),a({title:"Test stopped"})}}),z=(0,aw.useMutation)({mutationFn:({testId:a,variantId:b})=>(0,aM.apiRequest)(`/api/admin/testing/ab-tests/${a}/winner`,"POST",{variantId:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/ab-tests"]}),a({title:"Winner declared"})}}),A=(0,aw.useMutation)({mutationFn:a=>(0,aM.apiRequest)("/api/admin/testing/feature-flags","POST",a),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/feature-flags"]}),a({title:"Feature flag created successfully"}),g(!1)}}),B=(0,aw.useMutation)({mutationFn:({id:a,enabled:b})=>(0,aM.apiRequest)(`/api/admin/testing/feature-flags/${a}/toggle`,"PATCH",{enabled:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/feature-flags"]}),a({title:"Feature flag updated"})}}),C=(0,aw.useMutation)({mutationFn:({id:a,rollout:b})=>(0,aM.apiRequest)(`/api/admin/testing/feature-flags/${a}/rollout`,"PATCH",{rollout:b}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/testing/feature-flags"]}),a({title:"Rollout percentage updated"}),i(!1)}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Testing & Experiments"}),(0,b.jsxs)(aA.Tabs,{defaultValue:"ab-tests",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"ab-tests","data-testid":"tab-ab-tests",children:"A/B Tests"}),(0,b.jsx)(aA.TabsTrigger,{value:"feature-flags","data-testid":"tab-feature-flags",children:"Feature Flags"})]}),(0,b.jsxs)(aA.TabsContent,{value:"ab-tests",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"A/B Tests"}),(0,b.jsxs)(az.Dialog,{open:c,onOpenChange:d,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-test",children:"Create A/B Test"})}),(0,b.jsxs)(az.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create A/B Test"})}),(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault();let c=new FormData(b.currentTarget),d=c.get("variants"),e=c.get("trafficAllocation");try{let a=JSON.parse(d),b=JSON.parse(e);w.mutate({name:c.get("name"),description:c.get("description"),variants:a,trafficAllocation:b})}catch(b){a({title:"Invalid JSON format",variant:"destructive"})}},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"test-name",children:"Test Name"}),(0,b.jsx)(m.Input,{id:"test-name",name:"name",required:!0,"data-testid":"input-test-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"test-description",children:"Description"}),(0,b.jsx)(ax.Textarea,{id:"test-description",name:"description",required:!0,"data-testid":"textarea-test-description"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"variants",children:"Variants (JSON Array)"}),(0,b.jsx)(ax.Textarea,{id:"variants",name:"variants",placeholder:'[{"id": "A", "name": "Control"}, {"id": "B", "name": "Variant B"}]',className:"font-mono text-sm",rows:3,required:!0,"data-testid":"textarea-variants"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"trafficAllocation",children:"Traffic Allocation (JSON Object)"}),(0,b.jsx)(ax.Textarea,{id:"trafficAllocation",name:"trafficAllocation",placeholder:'{"A": 50, "B": 50}',className:"font-mono text-sm",rows:2,required:!0,"data-testid":"textarea-traffic-allocation"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Percentages should add up to 100"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:w.isPending,"data-testid":"button-submit-test",children:w.isPending?"Creating...":"Create Test"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:r?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"Variants"}),(0,b.jsx)(aa.TableHead,{children:"Traffic"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[s.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`test-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-medium","data-testid":`test-name-${a.id}`,children:a.name}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(au.Badge,{variant:"running"===a.status?"default":"completed"===a.status?"secondary":"outline",children:a.status})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.variants.map(a=>(0,b.jsx)(au.Badge,{variant:"outline",className:"text-xs",children:a.name},a.id))})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)("div",{className:"text-xs",children:Object.entries(a.trafficAllocation).map(([a,c])=>(0,b.jsxs)("div",{children:[a,": ",c,"%"]},a))})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:["draft"===a.status&&(0,b.jsxs)(l.Button,{size:"sm",variant:"default",onClick:()=>x.mutate(a.id),disabled:x.isPending,"data-testid":`button-start-${a.id}`,children:[(0,b.jsx)(bB,{className:"w-3 h-3 mr-1"}),"Start"]}),"running"===a.status&&(0,b.jsxs)(l.Button,{size:"sm",variant:"destructive",onClick:()=>y.mutate(a.id),disabled:y.isPending,"data-testid":`button-stop-${a.id}`,children:[(0,b.jsx)(bX,{className:"w-3 h-3 mr-1"}),"Stop"]})]})})]},a.id)),0===s.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No A/B tests created"})})]})]})})})}),s.filter(a=>"running"===a.status||"completed"===a.status).map(a=>(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,b.jsxs)(_.CardTitle,{children:["Results: ",a.name]}),"completed"===a.status&&a.winner&&(0,b.jsxs)(au.Badge,{variant:"default",children:[(0,b.jsx)(R.Trophy,{className:"w-3 h-3 mr-1"}),"Winner: ",a.winner]})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Variant"}),(0,b.jsx)(aa.TableHead,{children:"Impressions"}),(0,b.jsx)(aa.TableHead,{children:"Conversions"}),(0,b.jsx)(aa.TableHead,{children:"Conversion Rate"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsx)(aa.TableBody,{children:(a.results||[]).map(c=>(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableCell,{className:"font-medium",children:c.variantName}),(0,b.jsx)(aa.TableCell,{children:c.impressions}),(0,b.jsx)(aa.TableCell,{children:c.conversions}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:[c.conversionRate,"%"]})}),(0,b.jsx)(aa.TableCell,{children:"running"===a.status&&!a.winner&&(0,b.jsx)(l.Button,{size:"sm",variant:"default",onClick:()=>z.mutate({testId:a.id,variantId:c.variantId}),disabled:z.isPending,"data-testid":`button-declare-winner-${c.variantId}`,children:"Declare Winner"})})]},c.variantId))})]})})})]},`results-${a.id}`))]}),(0,b.jsxs)(aA.TabsContent,{value:"feature-flags",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Feature Flags"}),(0,b.jsxs)(az.Dialog,{open:f,onOpenChange:g,children:[(0,b.jsx)(az.DialogTrigger,{asChild:!0,children:(0,b.jsx)(l.Button,{"data-testid":"button-create-flag",children:"Create Feature Flag"})}),(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Create Feature Flag"})}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b=new FormData(a.currentTarget),c=b.get("targetUsers").split(",").map(a=>a.trim()).filter(Boolean);A.mutate({key:b.get("key"),name:b.get("name"),description:b.get("description"),enabled:!1,rollout:0,targetUsers:c})},className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"flag-key",children:"Flag Key"}),(0,b.jsx)(m.Input,{id:"flag-key",name:"key",placeholder:"new_feature_enabled",required:!0,"data-testid":"input-flag-key"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"flag-name",children:"Flag Name"}),(0,b.jsx)(m.Input,{id:"flag-name",name:"name",required:!0,"data-testid":"input-flag-name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"flag-description",children:"Description"}),(0,b.jsx)(ax.Textarea,{id:"flag-description",name:"description","data-testid":"textarea-flag-description"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bu.Label,{htmlFor:"targetUsers",children:"Target Users (comma-separated IDs, optional)"}),(0,b.jsx)(ax.Textarea,{id:"targetUsers",name:"targetUsers",placeholder:"user-123, user-456","data-testid":"textarea-target-users"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{type:"submit",disabled:A.isPending,"data-testid":"button-submit-flag",children:A.isPending?"Creating...":"Create Flag"})})]})]})]})]}),(0,b.jsx)(_.Card,{children:(0,b.jsx)(_.CardContent,{className:"p-0",children:u?(0,b.jsx)("div",{className:"p-4 space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(p.Skeleton,{className:"h-12"},c))}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Flag Key"}),(0,b.jsx)(aa.TableHead,{children:"Name"}),(0,b.jsx)(aa.TableHead,{children:"Enabled"}),(0,b.jsx)(aa.TableHead,{children:"Rollout %"}),(0,b.jsx)(aa.TableHead,{children:"Target Users"}),(0,b.jsx)(aa.TableHead,{children:"Actions"})]})}),(0,b.jsxs)(aa.TableBody,{children:[v.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`flag-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{className:"font-mono text-sm","data-testid":`flag-key-${a.id}`,children:a.key}),(0,b.jsx)(aa.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(bs.Switch,{checked:a.enabled,onCheckedChange:b=>B.mutate({id:a.id,enabled:b}),"data-testid":`switch-flag-${a.id}`})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"secondary",children:[a.rollout,"%"]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsxs)(au.Badge,{variant:"outline",children:[a.targetUsers.length," users"]})}),(0,b.jsx)(aa.TableCell,{children:(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>{k(a),o([a.rollout]),i(!0)},"data-testid":`button-rollout-${a.id}`,children:"Adjust Rollout"})})]},a.id)),0===v.length&&(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No feature flags created"})})]})]})})})}),(0,b.jsx)(az.Dialog,{open:h,onOpenChange:i,children:(0,b.jsxs)(az.DialogContent,{children:[(0,b.jsx)(az.DialogHeader,{children:(0,b.jsx)(az.DialogTitle,{children:"Adjust Rollout Percentage"})}),j&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(bu.Label,{children:["Rollout: ",n[0],"%"]}),(0,b.jsx)(bt.Slider,{value:n,onValueChange:o,max:100,step:1,"data-testid":"slider-rollout"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Percentage of users who will see this feature"})]}),(0,b.jsx)(az.DialogFooter,{children:(0,b.jsx)(l.Button,{onClick:()=>C.mutate({id:j.id,rollout:n[0]}),disabled:C.isPending,"data-testid":"button-save-rollout",children:C.isPending?"Saving...":"Save"})})]})]})})]})]})]})}let bZ=(0,h.default)("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),b$=[{url:"/",type:"Homepage",schemaTypes:["Organization","WebSite"],status:"valid"},{url:"/category/trading-strategies/martingale-strategy",type:"Thread (Forum)",schemaTypes:["DiscussionForumPosting","BreadcrumbList","Comment"],status:"valid"},{url:"/category/expert-advisors/mt4/trend-ea",type:"Product (Marketplace)",schemaTypes:["Product","AggregateRating","Review","BreadcrumbList"],status:"valid"},{url:"/user/forex_newbie423",type:"Profile",schemaTypes:["Person"],status:"valid"},{url:"/category/forex-education/beginner-guide",type:"Article/Blog",schemaTypes:["Article","BreadcrumbList"],status:"warning",warning:"Consider adding author image for rich results"}],b_=[{id:"1",url:"/",pageType:"Homepage",status:"valid",errorCount:0,warningCount:0,timestamp:new Date().toISOString()},{id:"2",url:"/thread/best-scalping-ea",pageType:"Article",status:"valid",errorCount:0,warningCount:1,timestamp:new Date(Date.now()-3e5).toISOString(),details:"Missing recommended property: image dimensions"},{id:"3",url:"/content/invalid-product",pageType:"Product",status:"invalid",errorCount:2,warningCount:0,timestamp:new Date(Date.now()-6e5).toISOString(),details:"Missing required properties: price, availability"}];function b0(){let[a,c]=(0,e.useState)(""),[d,f]=(0,e.useState)(""),[g,h]=(0,e.useState)([]),[i,j]=(0,e.useState)(!1),{data:k}=(0,$.useQuery)({queryKey:["/api/admin/schema/stats"],refetchInterval:6e4}),{data:o}=(0,$.useQuery)({queryKey:["/api/admin/schema/logs"],refetchInterval:3e4}),p=(0,aw.useMutation)({mutationFn:async()=>await (0,aM.apiRequest)("POST","/api/admin/schema/validate-all",{}),onSuccess:()=>{aM.queryClient.invalidateQueries({queryKey:["/api/admin/schema/stats"]}),aM.queryClient.invalidateQueries({queryKey:["/api/admin/schema/logs"]})}}),q=async a=>{j(!0);try{let b=await (0,aM.apiRequest)("POST","/api/admin/schema/validate",{url:a}),c=await b.json();h([c,...g.slice(0,9)])}catch(a){console.error("Validation error:",a)}finally{j(!1)}},r=a=>{switch(a){case"valid":return(0,b.jsx)(bd.CheckCircle2,{className:"w-4 h-4 text-green-600"});case"invalid":return(0,b.jsx)(aS,{className:"w-4 h-4 text-red-600"});case"warning":return(0,b.jsx)(aU.AlertTriangle,{className:"w-4 h-4 text-yellow-600"})}},s=a=>(0,b.jsxs)(au.Badge,{variant:{valid:"default",invalid:"destructive",warning:"outline"}[a],className:"gap-1",children:[r(a),a.toUpperCase()]});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Schema Validation Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Real-time monitoring and validation of Schema.org JSON-LD structured data across all pages"})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Total Pages"}),(0,b.jsx)(bZ,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:k?.totalPages||b$.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"With schema markup"})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Valid Schemas"}),(0,b.jsx)(bd.CheckCircle2,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:k?.validPages||5}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[k?Math.round(k.validPages/k.totalPages*100):83,"% success rate"]})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Warnings"}),(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4 text-yellow-600"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:k?.warningPages||1}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Need attention"})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Errors"}),(0,b.jsx)(aS,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-red-600",children:k?.invalidPages||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Require fixes"})]})]})]}),(0,b.jsxs)(aA.Tabs,{defaultValue:"overview",className:"space-y-4",children:[(0,b.jsxs)(aA.TabsList,{children:[(0,b.jsx)(aA.TabsTrigger,{value:"overview",children:"Overview"}),(0,b.jsx)(aA.TabsTrigger,{value:"validator",children:"Live Validator"}),(0,b.jsx)(aA.TabsTrigger,{value:"logs",children:"Validation Logs"}),(0,b.jsx)(aA.TabsTrigger,{value:"schema-types",children:"Schema Types"})]}),(0,b.jsxs)(aA.TabsContent,{value:"overview",className:"space-y-4",children:[(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsxs)(_.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(V.Activity,{className:"w-5 h-5"}),"Page Validation Status"]}),(0,b.jsx)(_.CardDescription,{children:"Current schema validation status for all pages"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Last validation: ",k?.lastValidationRun||"Just now"]}),(0,b.jsxs)(l.Button,{onClick:()=>p.mutate(),disabled:p.isPending,size:"sm",className:"gap-2",children:[(0,b.jsx)(aX.RefreshCw,{className:`w-4 h-4 ${p.isPending?"animate-spin":""}`}),"Validate All Pages"]})]}),(0,b.jsx)(aP.ScrollArea,{className:"h-[400px]",children:(0,b.jsx)("div",{className:"space-y-2",children:b$.map((a,d)=>{let e=b_.find(b=>b.url===a.url),g=e?.status||"valid";return(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.url}),(0,b.jsx)(au.Badge,{variant:"secondary",className:"text-xs",children:a.type})]}),(0,b.jsx)("div",{className:"flex gap-1",children:a.schemaTypes.map((a,c)=>(0,b.jsx)(au.Badge,{variant:"outline",className:"text-xs",children:a},c))}),e?.details&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:e.details})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[s(g),(0,b.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{f(a.url),c(a.url)},className:"gap-1",children:[(0,b.jsx)(aT.Eye,{className:"w-4 h-4"}),"View"]})]})]},d)})})})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsx)(_.CardHeader,{children:(0,b.jsxs)(_.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(T.Zap,{className:"w-5 h-5"}),"Quick Testing Tools"]})}),(0,b.jsxs)(_.CardContent,{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)(l.Button,{variant:"outline",className:"justify-start gap-2",onClick:()=>window.open("https://search.google.com/test/rich-results","_blank"),children:[(0,b.jsx)(bF.ExternalLink,{className:"w-4 h-4"}),"Google Rich Results Test"]}),(0,b.jsxs)(l.Button,{variant:"outline",className:"justify-start gap-2",onClick:()=>window.open("https://validator.schema.org/","_blank"),children:[(0,b.jsx)(bF.ExternalLink,{className:"w-4 h-4"}),"Schema.org Validator"]}),(0,b.jsxs)(l.Button,{variant:"outline",className:"justify-start gap-2",onClick:()=>window.open("https://search.google.com/search-console","_blank"),children:[(0,b.jsx)(bF.ExternalLink,{className:"w-4 h-4"}),"Google Search Console"]}),(0,b.jsxs)(l.Button,{variant:"outline",className:"justify-start gap-2",onClick:()=>window.open("https://json-ld.org/playground/","_blank"),children:[(0,b.jsx)(bF.ExternalLink,{className:"w-4 h-4"}),"JSON-LD Playground"]})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsx)(_.CardTitle,{className:"text-lg",children:"Schema Type Distribution"}),(0,b.jsx)(_.CardDescription,{children:"Number of pages by schema type"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"DiscussionForumPosting"}),(0,b.jsx)(au.Badge,{variant:"secondary",children:"Threads"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"Product"}),(0,b.jsx)(au.Badge,{variant:"secondary",children:"Marketplace"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"Person"}),(0,b.jsx)(au.Badge,{variant:"secondary",children:"Profiles"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"Article/BlogPosting"}),(0,b.jsx)(au.Badge,{variant:"secondary",children:"Content"})]})]})})]}),(0,b.jsxs)(_.Card,{className:"col-span-full",children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsxs)(_.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(S.Search,{className:"h-5 w-5"}),"Google Rich Results Testing"]}),(0,b.jsx)(_.CardDescription,{children:"Test your schemas with Google's official validation tools"})]}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h4",{className:"font-medium",children:"Rich Results Test"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Test how Google sees your structured data"}),(0,b.jsxs)("a",{href:"https://search.google.com/test/rich-results",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:underline","data-testid":"link-google-rich-results",children:["Open Rich Results Test ",(0,b.jsx)(bF.ExternalLink,{className:"h-3 w-3"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h4",{className:"font-medium",children:"Schema Markup Validator"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Validate your JSON-LD against Schema.org standards"}),(0,b.jsxs)("a",{href:"https://validator.schema.org/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:underline","data-testid":"link-schema-validator",children:["Open Schema Validator ",(0,b.jsx)(bF.ExternalLink,{className:"h-3 w-3"})]})]})]}),(0,b.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,b.jsx)("h4",{className:"font-medium text-sm",children:"Quick Test URLs"}),(0,b.jsx)("div",{className:"grid gap-2",children:[{type:"Thread",url:"/category/trading-strategies/best-scalping-ea"},{type:"Marketplace",url:"/category/expert-advisors/trend-ea"},{type:"Profile",url:"/user/forex_newbie423"}].map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:a.type}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>{let b=`${window.location.origin}${a.url}`,c=`https://search.google.com/test/rich-results?url=${encodeURIComponent(b)}`;window.open(c,"_blank")},"data-testid":`button-test-google-${a.type.toLowerCase()}`,children:["Test in Google ",(0,b.jsx)(bF.ExternalLink,{className:"h-3 w-3 ml-1"})]}),(0,b.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>navigator.clipboard.writeText(`${window.location.origin}${a.url}`),"data-testid":`button-copy-url-${a.type.toLowerCase()}`,children:"Copy URL"})]})]},a.type))})]})]})]}),(0,b.jsxs)(_.Card,{className:"col-span-full",children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsxs)(_.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(G.FileText,{className:"h-5 w-5"}),"Validation Logs"]}),(0,b.jsx)(_.CardDescription,{children:"Recent schema validation events and errors"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-950 rounded",children:[(0,b.jsx)(bd.CheckCircle2,{className:"h-4 w-4 text-green-600"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"All schemas validated successfully"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last check: Just now"})]})]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground text-center py-4",children:"No validation errors detected"})]})})]}),(0,b.jsxs)(_.Card,{className:"col-span-full",children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsx)(_.CardTitle,{children:"Schema.org 2025 Compliance Checklist"}),(0,b.jsx)(_.CardDescription,{children:"Ensure all schemas meet the latest standards"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:[{item:'All schemas use @context: "https://schema.org"',status:!0},{item:"Required properties present for each type",status:!0},{item:"Publisher includes Organization with logo",status:!0},{item:"Dates in ISO 8601 format",status:!0},{item:"Images include proper dimensions",status:!1,note:"Optional but recommended"},{item:"Videos use ISO 8601 duration format",status:!0}].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[a.status?(0,b.jsx)(bd.CheckCircle2,{className:"h-5 w-5 text-green-600 mt-0.5"}):(0,b.jsx)(ab.AlertCircle,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.item}),a.note&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.note})]})]},c))})})]})]}),(0,b.jsx)(aA.TabsContent,{value:"validator",className:"space-y-4",children:(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsx)(_.CardTitle,{children:"Live Schema Validator"}),(0,b.jsx)(_.CardDescription,{children:"Test and validate schema markup for any page URL"})]}),(0,b.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(bu.Label,{htmlFor:"test-url",children:"Page URL"}),(0,b.jsx)(m.Input,{id:"test-url",placeholder:"/thread/best-scalping-ea",value:d,onChange:a=>f(a.target.value)})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(l.Button,{onClick:()=>q(d),disabled:!d||i,className:"gap-2",children:[(0,b.jsx)(S.Search,{className:"w-4 h-4"}),"Validate"]})})]}),g.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(n.Separator,{}),(0,b.jsx)("div",{className:"text-sm font-medium",children:"Validation Results"}),(0,b.jsx)(aP.ScrollArea,{className:"h-[500px]",children:(0,b.jsx)("div",{className:"space-y-4",children:g.map((a,c)=>(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(_.CardTitle,{className:"text-base",children:a.url}),s(a.isValid?"valid":"invalid")]}),(0,b.jsxs)(_.CardDescription,{children:["Schema Type: ",a.schemaType," â¢ Page Type: ",a.pageType]})]}),(0,b.jsxs)(_.CardContent,{className:"space-y-3",children:[a.errors.length>0&&(0,b.jsxs)(aQ.Alert,{variant:"destructive",children:[(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(aQ.AlertTitle,{children:"Errors Found"}),(0,b.jsx)(aQ.AlertDescription,{children:(0,b.jsx)("ul",{className:"list-disc list-inside space-y-1",children:a.errors.map((a,c)=>(0,b.jsx)("li",{className:"text-sm",children:a},c))})})]}),a.warnings.length>0&&(0,b.jsxs)(aQ.Alert,{children:[(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(aQ.AlertTitle,{children:"Warnings"}),(0,b.jsx)(aQ.AlertDescription,{children:(0,b.jsx)("ul",{className:"list-disc list-inside space-y-1",children:a.warnings.map((a,c)=>(0,b.jsx)("li",{className:"text-sm",children:a},c))})})]}),a.isValid&&0===a.errors.length&&(0,b.jsxs)(aQ.Alert,{children:[(0,b.jsx)(bd.CheckCircle2,{className:"h-4 w-4 text-green-600"}),(0,b.jsx)(aQ.AlertTitle,{children:"Schema Valid"}),(0,b.jsx)(aQ.AlertDescription,{children:"All required properties present and valid"})]}),(0,b.jsxs)("details",{className:"border rounded-lg p-3",children:[(0,b.jsxs)("summary",{className:"cursor-pointer font-medium text-sm flex items-center gap-2",children:[(0,b.jsx)(Y.Code,{className:"w-4 h-4"}),"View Schema JSON"]}),(0,b.jsx)("pre",{className:"mt-3 text-xs bg-muted p-3 rounded overflow-x-auto",children:JSON.stringify(a.schema,null,2)})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>{window.open(`https://search.google.com/test/rich-results?url=${encodeURIComponent("http://localhost:3000"+a.url)}`,"_blank")},children:[(0,b.jsx)(bF.ExternalLink,{className:"w-3 h-3"}),"Test in Google"]}),(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>{window.open(`https://validator.schema.org/#url=${encodeURIComponent("http://localhost:3000"+a.url)}`,"_blank")},children:[(0,b.jsx)(bF.ExternalLink,{className:"w-3 h-3"}),"Schema.org Validator"]})]})]})]},c))})})]})]})]})}),(0,b.jsx)(aA.TabsContent,{value:"logs",className:"space-y-4",children:(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsxs)(_.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(bR,{className:"w-5 h-5"}),"Validation History"]}),(0,b.jsx)(_.CardDescription,{children:"Historical log of all schema validation runs"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)(aP.ScrollArea,{className:"h-[500px]",children:(0,b.jsx)("div",{className:"space-y-2",children:(o||b_).map(a=>(0,b.jsxs)("div",{className:"flex items-start justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[r(a.status),(0,b.jsx)("span",{className:"font-medium",children:a.url}),(0,b.jsx)(au.Badge,{variant:"secondary",className:"text-xs",children:a.pageType})]}),a.details&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.details}),(0,b.jsxs)("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Errors: ",a.errorCount]}),(0,b.jsxs)("span",{children:["Warnings: ",a.warningCount]}),(0,b.jsx)("span",{children:new Date(a.timestamp).toLocaleString()})]})]}),s(a.status)]},a.id))})})})]})}),(0,b.jsx)(aA.TabsContent,{value:"schema-types",className:"space-y-4",children:(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsxs)(_.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(K.TrendingUp,{className:"w-5 h-5"}),"Schema Type Distribution"]}),(0,b.jsx)(_.CardDescription,{children:"Overview of schema types implemented across the platform"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:[{type:"Organization",count:1,validCount:1,description:"Company information on homepage"},{type:"WebSite",count:1,validCount:1,description:"Site-wide search capability"},{type:"Article",count:15,validCount:14,description:"Forum threads and blog posts"},{type:"Product",count:10,validCount:10,description:"Marketplace EA listings"},{type:"BreadcrumbList",count:25,validCount:25,description:"Navigation breadcrumbs"},{type:"ProfilePage",count:15,validCount:15,description:"User profile pages"},{type:"LocalBusiness",count:7,validCount:7,description:"Broker listings"}].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.type}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})]}),(0,b.jsxs)("div",{className:"text-right space-y-1",children:[(0,b.jsxs)("div",{className:"text-sm font-medium",children:[a.validCount,"/",a.count," valid"]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:[Math.round(a.validCount/a.count*100),"% success rate"]})]})]},c))})})]})})]})]})}let b1=(0,h.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);function b2(){let{toast:a}=(0,aB.useToast)(),[c,d]=(0,e.useState)(!1),{data:f,isLoading:g}=(0,$.useQuery)({queryKey:["/api/admin/sitemap/status"],refetchInterval:3e4}),h=(0,aw.useMutation)({mutationFn:async()=>(d(!0),(await (0,aM.apiRequest)("POST","/api/admin/sitemap/generate",{})).json()),onSuccess:b=>{d(!1),aM.queryClient.invalidateQueries({queryKey:["/api/admin/sitemap/status"]}),a({title:"Sitemap Generated Successfully!",description:`${b.urlCount} URLs added. Submitted to search engines.`})},onError:b=>{d(!1),a({title:"Failed to Generate Sitemap",description:b instanceof Error?b.message:"Unknown error",variant:"destructive"})}});return g?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(p.Skeleton,{className:"h-10 w-64"}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:[1,2,3].map(a=>(0,b.jsx)(p.Skeleton,{className:"h-32"},a))})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Sitemap Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Automated sitemap generation and search engine submission"})]}),(0,b.jsx)(l.Button,{onClick:()=>h.mutate(),disabled:c,size:"lg","data-testid":"button-generate-sitemap",children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aX.RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aX.RefreshCw,{className:"w-4 h-4 mr-2"}),"Generate Now"]})})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)(_.Card,{"data-testid":"card-last-generation",children:[(0,b.jsx)(_.CardHeader,{className:"pb-3",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Last Generation"})}),(0,b.jsx)(_.CardContent,{children:f?.lastGeneration?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold","data-testid":"text-url-count",children:[f.lastGeneration.urlCount," URLs"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,ag.formatDistanceToNow)(new Date(f.lastGeneration.createdAt),{addSuffix:!0})})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Never generated"})})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-automation-status",children:[(0,b.jsx)(_.CardHeader,{className:"pb-3",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Automation Status"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(bd.CheckCircle2,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("span",{className:"font-semibold",children:"Active"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Runs daily at 2:00 AM"})]})]}),(0,b.jsxs)(_.Card,{"data-testid":"card-sitemap-url",children:[(0,b.jsx)(_.CardHeader,{className:"pb-3",children:(0,b.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Sitemap URL"})}),(0,b.jsxs)(_.CardContent,{children:[(0,b.jsxs)("a",{href:"/sitemap.xml",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1","data-testid":"link-sitemap-xml",children:["/sitemap.xml",(0,b.jsx)(bF.ExternalLink,{className:"w-3 h-3"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Public sitemap file"})]})]})]}),f?.lastError&&(0,b.jsxs)(aQ.Alert,{variant:"destructive","data-testid":"alert-last-error",children:[(0,b.jsx)(aU.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsxs)(aQ.AlertDescription,{children:[(0,b.jsx)("strong",{children:"Last Error:"})," ",f.lastError.errorMessage,(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"text-xs",children:(0,ag.formatDistanceToNow)(new Date(f.lastError.createdAt),{addSuffix:!0})})]})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsx)(_.CardTitle,{children:"Recent Activity"}),(0,b.jsx)(_.CardDescription,{children:"Last 20 sitemap operations"})]}),(0,b.jsx)(_.CardContent,{children:(0,b.jsxs)(aa.Table,{children:[(0,b.jsx)(aa.TableHeader,{children:(0,b.jsxs)(aa.TableRow,{children:[(0,b.jsx)(aa.TableHead,{children:"Action"}),(0,b.jsx)(aa.TableHead,{children:"Status"}),(0,b.jsx)(aa.TableHead,{children:"URLs"}),(0,b.jsx)(aa.TableHead,{children:"Submitted To"}),(0,b.jsx)(aa.TableHead,{children:"Time"}),(0,b.jsx)(aa.TableHead,{children:"Details"})]})}),(0,b.jsx)(aa.TableBody,{children:f?.recentLogs&&f.recentLogs.length>0?f.recentLogs.map(a=>(0,b.jsxs)(aa.TableRow,{"data-testid":`row-log-${a.id}`,children:[(0,b.jsx)(aa.TableCell,{children:(a=>{switch(a){case"generate":return(0,b.jsxs)(au.Badge,{variant:"outline",children:[(0,b.jsx)(G.FileText,{className:"w-3 h-3 mr-1"}),"Generate"]});case"submit_google":return(0,b.jsxs)(au.Badge,{variant:"outline",children:[(0,b.jsx)(b1,{className:"w-3 h-3 mr-1"}),"Google"]});case"submit_indexnow":return(0,b.jsxs)(au.Badge,{variant:"outline",children:[(0,b.jsx)(b1,{className:"w-3 h-3 mr-1"}),"IndexNow"]});default:return(0,b.jsx)(au.Badge,{variant:"outline",children:a})}})(a.action)}),(0,b.jsx)(aa.TableCell,{children:(a=>{switch(a){case"success":return(0,b.jsxs)(au.Badge,{variant:"default",className:"bg-green-600",children:[(0,b.jsx)(bd.CheckCircle2,{className:"w-3 h-3 mr-1"}),"Success"]});case"error":return(0,b.jsxs)(au.Badge,{variant:"destructive",children:[(0,b.jsx)(aS,{className:"w-3 h-3 mr-1"}),"Error"]});case"pending":return(0,b.jsxs)(au.Badge,{variant:"secondary",children:[(0,b.jsx)(aV.Clock,{className:"w-3 h-3 mr-1"}),"Pending"]});default:return(0,b.jsx)(au.Badge,{children:a})}})(a.status)}),(0,b.jsx)(aa.TableCell,{children:a.urlCount||"-"}),(0,b.jsx)(aa.TableCell,{children:a.submittedTo||"-"}),(0,b.jsx)(aa.TableCell,{className:"text-sm text-muted-foreground",children:(0,ag.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})}),(0,b.jsx)(aa.TableCell,{className:"text-sm text-muted-foreground",children:a.errorMessage?(0,b.jsx)("span",{className:"text-red-600 truncate max-w-xs block",children:a.errorMessage}):(0,b.jsx)("span",{className:"text-green-600",children:"OK"})})]},a.id)):(0,b.jsx)(aa.TableRow,{children:(0,b.jsx)(aa.TableCell,{colSpan:6,className:"text-center text-muted-foreground",children:'No activity yet. Click "Generate Now" to create your first sitemap.'})})})]})})]}),(0,b.jsxs)(_.Card,{children:[(0,b.jsxs)(_.CardHeader,{children:[(0,b.jsx)(_.CardTitle,{children:"Setup Instructions"}),(0,b.jsx)(_.CardDescription,{children:"Configure your environment for optimal search engine submission"})]}),(0,b.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"1. IndexNow API Key (Bing & Yandex)"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["Generate an API key and set ",(0,b.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded",children:"INDEXNOW_API_KEY"})," environment variable."]}),(0,b.jsxs)("a",{href:"https://www.bing.com/indexnow/getstarted",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline inline-flex items-center gap-1",children:["Get IndexNow Key ",(0,b.jsx)(bF.ExternalLink,{className:"w-3 h-3"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"2. Add Sitemap to robots.txt"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["Add this line to your ",(0,b.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded",children:"/public/robots.txt"}),":"]}),(0,b.jsx)("code",{className:"block bg-muted px-3 py-2 rounded text-sm",children:"Sitemap: https://yoforex.net/sitemap.xml"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"3. Verify in Search Console"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Submit your sitemap manually in"," ",(0,b.jsx)("a",{href:"https://search.google.com/search-console",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Google Search Console"})," ","and"," ",(0,b.jsx)("a",{href:"https://www.bing.com/webmasters",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Bing Webmaster Tools"}),"."]})]})]})]})]})}let b3=[{id:"overview",icon:E.BarChart3,label:"Overview",path:"/admin"},{id:"users",icon:F.Users,label:"Users",path:"/admin/users"},{id:"content",icon:G.FileText,label:"Content",path:"/admin/content"},{id:"marketplace",icon:H.Store,label:"Marketplace",path:"/admin/marketplace"},{id:"brokers",icon:I,label:"Brokers",path:"/admin/brokers"},{id:"finance",icon:J.DollarSign,label:"Finance",path:"/admin/finance"},{id:"analytics",icon:K.TrendingUp,label:"Analytics",path:"/admin/analytics"},{id:"ai-automation",icon:Q,label:"AI & Automation",path:"/admin/ai-automation"},{id:"gamification",icon:R.Trophy,label:"Gamification",path:"/admin/gamification"},{id:"seo-marketing",icon:S.Search,label:"SEO & Marketing",path:"/admin/seo-marketing"},{id:"sitemap",icon:G.FileText,label:"Sitemap",path:"/admin/sitemap"},{id:"schema-validation",icon:Y.Code,label:"Schema Validation",path:"/admin/schema-validation"},{id:"integrations",icon:T.Zap,label:"API & Integrations",path:"/admin/integrations"},{id:"mobile",icon:U.Smartphone,label:"Mobile & Push",path:"/admin/mobile"},{id:"performance",icon:V.Activity,label:"Performance",path:"/admin/performance"},{id:"content-studio",icon:W.Folder,label:"Content Studio",path:"/admin/content-studio"},{id:"testing",icon:X,label:"Testing",path:"/admin/testing"},{id:"settings",icon:L.Settings,label:"Settings",path:"/admin/settings"},{id:"security",icon:M.Shield,label:"Security",path:"/admin/security"},{id:"communications",icon:N.Mail,label:"Communications",path:"/admin/communications"},{id:"support",icon:O.HelpCircle,label:"Support",path:"/admin/support"},{id:"logs",icon:P,label:"Audit Logs",path:"/admin/logs"}];function b4(){let a=(0,d.usePathname)();return(0,b.jsx)(u,{children:(0,b.jsx)(w,{children:(0,b.jsxs)(x,{children:[(0,b.jsx)(y,{children:"Admin Dashboard"}),(0,b.jsx)(z,{children:(0,b.jsx)(A,{children:b3.map(d=>{let e=a===d.path;return(0,b.jsx)(B,{children:(0,b.jsx)(D,{asChild:!0,isActive:e,children:(0,b.jsxs)(c.default,{href:d.path,"data-testid":`nav-${d.id}`,children:[(0,b.jsx)(d.icon,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:d.label})]})})},d.id)})})})]})})})}function b5(){let a=(0,d.usePathname)();return(0,b.jsx)(t,{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"},children:(0,b.jsxs)("div",{className:"flex h-screen w-full",children:[(0,b.jsx)(b4,{}),(0,b.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,b.jsxs)("header",{className:"flex items-center justify-between p-4 border-b gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(v,{"data-testid":"button-sidebar-toggle"}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"})]}),(0,b.jsx)(Z.ThemeToggle,{})]}),(0,b.jsx)("main",{className:"flex-1 overflow-auto p-6",children:(()=>{switch(a){case"/admin/users":return(0,b.jsx)(aN,{});case"/admin/content":return(0,b.jsx)(a_,{});case"/admin/marketplace":return(0,b.jsx)(bb,{});case"/admin/brokers":return(0,b.jsx)(bk,{});case"/admin/finance":return(0,b.jsx)(bn,{});case"/admin/analytics":return(0,b.jsx)(br,{});case"/admin/ai-automation":return(0,b.jsx)(bC,{});case"/admin/gamification":return(0,b.jsx)(bE,{});case"/admin/seo-marketing":return(0,b.jsx)(bG,{});case"/admin/sitemap":return(0,b.jsx)(b2,{});case"/admin/schema-validation":return(0,b.jsx)(b0,{});case"/admin/integrations":return(0,b.jsx)(bM,{});case"/admin/mobile":return(0,b.jsx)(bP,{});case"/admin/performance":return(0,b.jsx)(bS,{});case"/admin/content-studio":return(0,b.jsx)(bW,{});case"/admin/testing":return(0,b.jsx)(bY,{});case"/admin/settings":return(0,b.jsx)(bv,{});case"/admin/security":return(0,b.jsx)(bw,{});case"/admin/communications":return(0,b.jsx)(by,{});case"/admin/support":return(0,b.jsx)(bz,{});case"/admin/logs":return(0,b.jsx)(bA,{});default:return(0,b.jsx)(av,{})}})()})]})]})})}a.s(["AdminDashboardClient",()=>b5],1238)}];

//# sourceMappingURL=app_admin_AdminDashboardClient_tsx_b65f2f43._.js.map