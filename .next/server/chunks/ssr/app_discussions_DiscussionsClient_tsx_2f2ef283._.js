module.exports=[65725,a=>{"use strict";var b=a.i(87924),c=a.i(33217),d=a.i(6893),e=a.i(61792),f=a.i(53390),g=a.i(63588),h=a.i(77156),i=a.i(16201),j=a.i(24669),k=a.i(15618),l=a.i(87532),m=a.i(16106),n=a.i(41710),o=a.i(90669),p=a.i(8406),q=a.i(50751),r=a.i(91868),s=a.i(59162),t=a.i(32954),u=a.i(38246),v=a.i(10738),w=a.i(72131),x=a.i(47036),y=a.i(5539);function z({initialThreads:a}){let{isAuthenticated:z,login:A}=(0,x.useAuth)(),[B,C]=(0,w.useState)(""),[D,E]=(0,w.useState)("all"),[F,G]=(0,w.useState)("latest"),[H,I]=(0,w.useState)("all"),[J,K]=(0,w.useState)(new Set),{data:L,isLoading:M}=(0,c.useQuery)({queryKey:["/api/threads"],initialData:a,queryFn:async()=>{let a=await fetch("/api/threads?sortBy=newest&limit=100",{credentials:"include"});if(!a.ok)throw Error("Failed to fetch threads");return a.json()},refetchInterval:3e4}),{data:N,isLoading:O}=(0,c.useQuery)({queryKey:["/api/stats"],queryFn:async()=>{let a=await fetch("/api/stats",{credentials:"include"});if(!a.ok)throw Error("Failed to fetch stats");let b=await a.json();return{totalThreads:b.totalThreads||0,totalPosts:b.totalPosts||0,activeUsers:b.totalMembers||0,trendingThreads:0}},refetchInterval:3e4}),{data:P,isLoading:Q}=(0,c.useQuery)({queryKey:["/api/discussions/trending"],queryFn:async()=>{let a=await fetch("/api/discussions/trending?period=24h&limit=5",{credentials:"include"});if(!a.ok)throw Error("Failed to fetch trending");return a.json()},refetchInterval:3e4}),{data:R,isLoading:S}=(0,c.useQuery)({queryKey:["/api/discussions/activity"],queryFn:async()=>{let a=await fetch("/api/discussions/activity?limit=10",{credentials:"include"});if(!a.ok)throw Error("Failed to fetch activity");return a.json()},refetchInterval:3e4}),T=(0,w.useMemo)(()=>N?{...N,trendingThreads:P?.length||0}:null,[N,P]),U=(0,w.useMemo)(()=>L?Array.from(new Set(L.map(a=>a.categorySlug))):[],[L]),V=(0,w.useMemo)(()=>{if(!L)return[];let a=[...L];if(B){let b=B.toLowerCase();a=a.filter(a=>a.title.toLowerCase().includes(b)||a.body.toLowerCase().includes(b))}switch("all"!==D&&(a=a.filter(a=>a.categorySlug===D)),"hot"===H?a=a.filter(a=>(a.engagementScore||0)>50):"trending"===H?a=a.filter(a=>{let b=new Date;return b.setHours(b.getHours()-24),new Date(a.lastActivityAt)>b&&a.replyCount>0}):"unanswered"===H?a=a.filter(a=>0===a.replyCount):"solved"===H&&(a=a.filter(a=>a.hasAcceptedAnswer)),F){case"popular":case"views":a.sort((a,b)=>b.views-a.views);break;case"replies":a.sort((a,b)=>b.replyCount-a.replyCount);break;default:a.sort((a,b)=>new Date(b.lastActivityAt).getTime()-new Date(a.lastActivityAt).getTime())}return[...a.filter(a=>a.isPinned),...a.filter(a=>!a.isPinned)]},[L,B,D,F,H]),W=a=>a.split("-").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ");return M?(0,b.jsxs)("main",{className:"container max-w-7xl mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)(y.Skeleton,{className:"h-10 w-64 mb-2"}),(0,b.jsx)(y.Skeleton,{className:"h-4 w-96"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(a=>(0,b.jsx)(y.Skeleton,{className:"h-48"},a))})]}):(0,b.jsxs)("main",{className:"container max-w-7xl mx-auto px-4 py-6",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4 flex-wrap mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3","data-testid":"heading-discussions",children:[(0,b.jsx)(q.MessagesSquare,{className:"w-8 h-8 text-primary"}),"Recent Discussions"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Join the conversation. Browse active threads and share your insights."})]}),(0,b.jsxs)(r.Button,{onClick:()=>{z?window.location.href="/discussions/new":A()},"data-testid":"button-new-thread",children:[(0,b.jsx)(k.Plus,{className:"w-4 h-4 mr-2"}),"New Thread"]})]}),!O&&T&&(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[(0,b.jsx)(d.Card,{className:"bg-card/50 backdrop-blur-sm",children:(0,b.jsx)(d.CardContent,{className:"p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/10",children:(0,b.jsx)(g.MessageSquare,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold","data-testid":"stat-total-threads",children:T.totalThreads}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Threads"})]})]})})}),(0,b.jsx)(d.Card,{className:"bg-card/50 backdrop-blur-sm",children:(0,b.jsx)(d.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-green-500/10",children:(0,b.jsx)(o.Activity,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold","data-testid":"stat-active-today",children:V.filter(a=>{let b=new Date;return b.setHours(0,0,0,0),new Date(a.lastActivityAt)>b}).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active Today"})]})]})})}),(0,b.jsx)(d.Card,{className:"bg-card/50 backdrop-blur-sm",children:(0,b.jsx)(d.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-purple-500/10",children:(0,b.jsx)(q.MessagesSquare,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold","data-testid":"stat-replies-24h",children:T.totalPosts}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Replies"})]})]})})}),(0,b.jsx)(d.Card,{className:"bg-card/50 backdrop-blur-sm",children:(0,b.jsx)(d.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-orange-500/10",children:(0,b.jsx)(j.TrendingUp,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold","data-testid":"stat-trending-now",children:T.trendingThreads}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Trending Now"})]})]})})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(s.Input,{type:"search",placeholder:"Search discussions...",className:"pl-9",value:B,onChange:a=>C(a.target.value),"data-testid":"input-search-discussions"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(t.Select,{value:D,onValueChange:E,children:[(0,b.jsx)(t.SelectTrigger,{"data-testid":"select-category",children:(0,b.jsx)(t.SelectValue,{placeholder:"All Categories"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All Categories"}),U.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:W(a)},a))]})]}),(0,b.jsxs)(t.Select,{value:F,onValueChange:G,children:[(0,b.jsx)(t.SelectTrigger,{"data-testid":"select-sort",children:(0,b.jsx)(t.SelectValue,{placeholder:"Sort by"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"latest",children:"Latest Activity"}),(0,b.jsx)(t.SelectItem,{value:"popular",children:"Most Popular"}),(0,b.jsx)(t.SelectItem,{value:"replies",children:"Most Replies"}),(0,b.jsx)(t.SelectItem,{value:"views",children:"Most Views"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(r.Button,{variant:"all"===H?"default":"outline",size:"sm",onClick:()=>I("all"),"data-testid":"chip-all",children:"All"}),(0,b.jsxs)(r.Button,{variant:"hot"===H?"default":"outline",size:"sm",onClick:()=>I("hot"),"data-testid":"chip-hot",children:[(0,b.jsx)(m.Flame,{className:"w-3 h-3 mr-1"}),"Hot"]}),(0,b.jsxs)(r.Button,{variant:"trending"===H?"default":"outline",size:"sm",onClick:()=>I("trending"),"data-testid":"chip-trending",children:[(0,b.jsx)(j.TrendingUp,{className:"w-3 h-3 mr-1"}),"Trending"]}),(0,b.jsx)(r.Button,{variant:"unanswered"===H?"default":"outline",size:"sm",onClick:()=>I("unanswered"),"data-testid":"chip-unanswered",children:"Unanswered"}),(0,b.jsxs)(r.Button,{variant:"solved"===H?"default":"outline",size:"sm",onClick:()=>I("solved"),"data-testid":"chip-solved",children:[(0,b.jsx)(i.CheckCircle,{className:"w-3 h-3 mr-1"}),"Solved"]})]})]})}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:V&&V.length>0?V.map(a=>{let c,k,l=(c=a.categorySlug.toLowerCase()).includes("strategy")||c.includes("discussion")?{bg:"bg-blue-100 dark:bg-blue-950",text:"text-blue-700 dark:text-blue-300",border:"border-blue-200 dark:border-blue-800"}:c.includes("performance")||c.includes("report")?{bg:"bg-green-100 dark:bg-green-950",text:"text-green-700 dark:text-green-300",border:"border-green-200 dark:border-green-800"}:c.includes("ea")||c.includes("library")?{bg:"bg-purple-100 dark:bg-purple-950",text:"text-purple-700 dark:text-purple-300",border:"border-purple-200 dark:border-purple-800"}:c.includes("beginner")||c.includes("question")?{bg:"bg-orange-100 dark:bg-orange-950",text:"text-orange-700 dark:text-orange-300",border:"border-orange-200 dark:border-orange-800"}:c.includes("support")||c.includes("technical")?{bg:"bg-red-100 dark:bg-red-950",text:"text-red-700 dark:text-red-300",border:"border-red-200 dark:border-red-800"}:{bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-700 dark:text-gray-300",border:"border-gray-200 dark:border-gray-700"},o=(a.engagementScore||0)>50,p=((k=new Date).setHours(k.getHours()-24),new Date(a.lastActivityAt)>k&&a.replyCount>2),q=J.has(a.id);return(0,b.jsx)(u.default,{href:`/thread/${a.slug}`,children:(0,b.jsx)(d.Card,{className:"h-full hover:border-primary/30 hover-elevate active-elevate-2 cursor-pointer transition-all duration-200","data-testid":`card-thread-${a.slug}`,children:(0,b.jsxs)(d.CardContent,{className:"p-3 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[(0,b.jsx)(e.Badge,{variant:"outline",className:`text-[10px] px-2 py-0.5 ${l.bg} ${l.text} ${l.border}`,"data-testid":`badge-category-${a.slug}`,children:W(a.categorySlug)}),(0,b.jsxs)("div",{className:"flex gap-1",children:[a.isPinned&&(0,b.jsx)(e.Badge,{variant:"secondary",className:"text-[10px] px-1.5 py-0","data-testid":`badge-pinned-${a.slug}`,children:"Pinned"}),p&&(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-orange-500/10 text-orange-700 dark:text-orange-400 border-orange-500/30",children:[(0,b.jsx)(j.TrendingUp,{className:"w-2.5 h-2.5 mr-0.5"}),"Trending"]}),o&&(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-red-500/10 text-red-700 dark:text-red-400 border-red-500/30",children:[(0,b.jsx)(m.Flame,{className:"w-2.5 h-2.5 mr-0.5"}),"Hot"]}),a.hasAcceptedAnswer&&(0,b.jsx)(e.Badge,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-green-500/10 text-green-700 dark:text-green-400 border-green-500/30",children:(0,b.jsx)(i.CheckCircle,{className:"w-2.5 h-2.5"})})]})]}),(0,b.jsx)("h3",{className:"font-semibold text-sm line-clamp-2 leading-tight","data-testid":`title-${a.slug}`,children:a.title}),a.body&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-xs text-muted-foreground leading-relaxed ${q?"":"line-clamp-3"}`,"data-testid":`body-preview-${a.slug}`,children:a.body.replace(/<[^>]*>/g,"")}),a.body.length>150&&(0,b.jsx)("button",{onClick:b=>{var c;b.preventDefault(),b.stopPropagation(),c=a.id,K(a=>{let b=new Set(a);return b.has(c)?b.delete(c):b.add(c),b})},className:"text-xs text-primary hover:underline mt-1 font-medium","data-testid":`button-toggle-${a.slug}`,children:q?"Show less":"Show more"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(f.Avatar,{className:"h-6 w-6 shrink-0",children:[(0,b.jsx)(f.AvatarImage,{src:a.author?.profileImageUrl}),(0,b.jsx)(f.AvatarFallback,{className:"text-[10px]",children:a.author?.username?.[0]?.toUpperCase()||"U"})]}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground truncate","data-testid":`author-${a.slug}`,children:a.author?.username||"Unknown"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-2 border-t",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(g.MessageSquare,{className:"w-3 h-3"}),(0,b.jsx)("span",{"data-testid":`replies-${a.slug}`,children:a.replyCount})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(h.Eye,{className:"w-3 h-3"}),(0,b.jsx)("span",{"data-testid":`views-${a.slug}`,children:a.views})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.Clock,{className:"w-3 h-3"}),(0,b.jsx)("span",{suppressHydrationWarning:!0,className:"text-[10px]","data-testid":`activity-${a.slug}`,children:(0,v.formatDistanceToNow)(new Date(a.lastActivityAt),{addSuffix:!0})})]})]})]})})},a.id)}):(0,b.jsx)("div",{className:"col-span-full text-center py-12",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No discussions found matching your filters."})})})]}),(0,b.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(d.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(j.TrendingUp,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),"Trending Now"]}),(0,b.jsx)(d.CardDescription,{className:"text-xs",children:"Hot discussions in the last 24 hours"})]}),(0,b.jsx)(d.CardContent,{className:"space-y-3","data-testid":"widget-trending",children:Q?[,,,,,].fill(0).map((a,c)=>(0,b.jsx)(y.Skeleton,{className:"h-16"},c)):P&&P.length>0?P.map((a,c)=>(0,b.jsx)(u.default,{href:`/thread/${a.slug}`,children:(0,b.jsx)("div",{className:"p-3 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer","data-testid":`trending-item-${c}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsxs)(e.Badge,{variant:"outline",className:"shrink-0 text-[10px] px-1.5 py-0.5",children:["#",c+1]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium line-clamp-2 mb-1",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(g.MessageSquare,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:a.replyCount})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(h.Eye,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:a.views})]})]})]})]})})},a.threadId)):(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No trending discussions right now"})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(d.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(o.Activity,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),"Recent Activity"]}),(0,b.jsx)(d.CardDescription,{className:"text-xs",children:"Live community updates"})]}),(0,b.jsx)(d.CardContent,{className:"space-y-2","data-testid":"widget-activity",children:S?[,,,,,].fill(0).map((a,c)=>(0,b.jsx)(y.Skeleton,{className:"h-12"},c)):R&&R.length>0?R.slice(0,10).map((a,c)=>(0,b.jsx)(u.default,{href:`/thread/${a.threadId}`,children:(0,b.jsx)("div",{className:"p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer text-xs","data-testid":`activity-item-${c}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsxs)(f.Avatar,{className:"h-6 w-6 shrink-0",children:[(0,b.jsx)(f.AvatarImage,{src:a.profileImageUrl}),(0,b.jsx)(f.AvatarFallback,{className:"text-[10px]",children:a.username[0]?.toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("p",{className:"line-clamp-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.username})," ",(0,b.jsx)("span",{className:"text-muted-foreground",children:a.action})," ",(0,b.jsx)("span",{className:"font-medium line-clamp-1",children:a.threadTitle})]}),(0,b.jsx)("p",{suppressHydrationWarning:!0,className:"text-[10px] text-muted-foreground mt-0.5",children:(0,v.formatDistanceToNow)(new Date(a.timestamp),{addSuffix:!0})})]})]})})},c)):(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No recent activity"})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsxs)(d.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(p.Sparkles,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),"Quick Stats"]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3","data-testid":"widget-stats",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Active Discussions"}),(0,b.jsx)("span",{className:"text-sm font-bold",children:V.filter(a=>{let b=new Date;return b.setHours(0,0,0,0),new Date(a.lastActivityAt)>b}).length})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unanswered"}),(0,b.jsx)("span",{className:"text-sm font-bold",children:V.filter(a=>0===a.replyCount).length})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Solved"}),(0,b.jsx)("span",{className:"text-sm font-bold",children:V.filter(a=>a.hasAcceptedAnswer).length})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Categories"}),(0,b.jsx)("span",{className:"text-sm font-bold",children:U.length})]})]})]})]})]})]})}a.s(["default",()=>z])}];

//# sourceMappingURL=app_discussions_DiscussionsClient_tsx_2f2ef283._.js.map